Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='192_336', model='PatchTST', data='custom', root_path='./dataset/', data_path='weather.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=192, label_len=48, pred_len=336, fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=21, dec_in=7, c_out=7, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=32, patience=5, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=1, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:1
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.dropout.Dropout'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.container.Sequential'>.
[INFO] Register count_normalization() for <class 'torch.nn.modules.batchnorm.BatchNorm1d'>.
MACs: 222437376.0
Params: 1432144.0
222.44M MACs
>>>>>>>start training : 192_336_PatchTST_custom_ftM_sl192_ll48_pl336_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36360
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.9031162
	speed: 0.0802s/iter; left time: 2729.0077s
	iters: 200, epoch: 1 | loss: 0.6049227
	speed: 0.0682s/iter; left time: 2311.6972s
	iters: 300, epoch: 1 | loss: 0.7826707
	speed: 0.0769s/iter; left time: 2599.3653s
	iters: 400, epoch: 1 | loss: 0.9763098
	speed: 0.0712s/iter; left time: 2400.2623s
	iters: 500, epoch: 1 | loss: 0.6578078
	speed: 0.0663s/iter; left time: 2228.5154s
	iters: 600, epoch: 1 | loss: 0.8847116
	speed: 0.0802s/iter; left time: 2687.1659s
	iters: 700, epoch: 1 | loss: 0.8245034
	speed: 0.0728s/iter; left time: 2433.3406s
	iters: 800, epoch: 1 | loss: 0.5875196
	speed: 0.0720s/iter; left time: 2398.2509s
	iters: 900, epoch: 1 | loss: 0.6298460
	speed: 0.0706s/iter; left time: 2343.3865s
	iters: 1000, epoch: 1 | loss: 0.6703535
	speed: 0.0731s/iter; left time: 2419.5535s
	iters: 1100, epoch: 1 | loss: 0.7333048
	speed: 0.0726s/iter; left time: 2397.3896s
Epoch: 1 cost time: 83.23231291770935
Epoch: 1, Steps: 1137 | Train Loss: 0.7894311 Vali Loss: 0.6626007 Test Loss: 0.2995172
Validation loss decreased (inf --> 0.662601).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6777942
	speed: 0.4793s/iter; left time: 15755.1515s
	iters: 200, epoch: 2 | loss: 0.4771481
	speed: 0.0689s/iter; left time: 2259.2459s
	iters: 300, epoch: 2 | loss: 0.8104172
	speed: 0.0802s/iter; left time: 2618.9098s
	iters: 400, epoch: 2 | loss: 0.6037833
	speed: 0.0745s/iter; left time: 2427.2698s
	iters: 500, epoch: 2 | loss: 0.5450773
	speed: 0.0722s/iter; left time: 2345.7223s
	iters: 600, epoch: 2 | loss: 0.4495437
	speed: 0.0716s/iter; left time: 2316.7789s
	iters: 700, epoch: 2 | loss: 0.4271698
	speed: 0.0750s/iter; left time: 2420.2044s
	iters: 800, epoch: 2 | loss: 0.6079792
	speed: 0.0726s/iter; left time: 2335.0375s
	iters: 900, epoch: 2 | loss: 0.5235650
	speed: 0.0677s/iter; left time: 2171.0186s
	iters: 1000, epoch: 2 | loss: 0.5067499
	speed: 0.0654s/iter; left time: 2092.2117s
	iters: 1100, epoch: 2 | loss: 0.8109708
	speed: 0.0653s/iter; left time: 2082.0191s
Epoch: 2 cost time: 81.22500729560852
Epoch: 2, Steps: 1137 | Train Loss: 0.6008662 Vali Loss: 0.5788299 Test Loss: 0.2690458
Validation loss decreased (0.662601 --> 0.578830).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.8900800
	speed: 0.4930s/iter; left time: 15647.5750s
	iters: 200, epoch: 3 | loss: 0.5751653
	speed: 0.0742s/iter; left time: 2346.7532s
	iters: 300, epoch: 3 | loss: 0.4563250
	speed: 0.0749s/iter; left time: 2363.0518s
	iters: 400, epoch: 3 | loss: 0.5845246
	speed: 0.0756s/iter; left time: 2375.1125s
	iters: 500, epoch: 3 | loss: 0.5665699
	speed: 0.0729s/iter; left time: 2283.2356s
	iters: 600, epoch: 3 | loss: 0.4320073
	speed: 0.0681s/iter; left time: 2126.5414s
	iters: 700, epoch: 3 | loss: 0.7664324
	speed: 0.0709s/iter; left time: 2208.2700s
	iters: 800, epoch: 3 | loss: 0.4996723
	speed: 0.0674s/iter; left time: 2092.1418s
	iters: 900, epoch: 3 | loss: 0.4650722
	speed: 0.0793s/iter; left time: 2452.3365s
	iters: 1000, epoch: 3 | loss: 0.5645011
	speed: 0.0671s/iter; left time: 2068.3082s
	iters: 1100, epoch: 3 | loss: 0.4185044
	speed: 0.0729s/iter; left time: 2241.3824s
Epoch: 3 cost time: 83.26875257492065
Epoch: 3, Steps: 1137 | Train Loss: 0.5765195 Vali Loss: 0.5693817 Test Loss: 0.2635836
Validation loss decreased (0.578830 --> 0.569382).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.5133727
	speed: 0.5075s/iter; left time: 15528.9937s
	iters: 200, epoch: 4 | loss: 0.4088894
	speed: 0.0693s/iter; left time: 2112.2697s
	iters: 300, epoch: 4 | loss: 0.5205474
	speed: 0.0697s/iter; left time: 2117.6424s
	iters: 400, epoch: 4 | loss: 0.4265931
	speed: 0.0752s/iter; left time: 2278.6770s
	iters: 500, epoch: 4 | loss: 0.4197637
	speed: 0.0750s/iter; left time: 2265.1890s
	iters: 600, epoch: 4 | loss: 0.5391375
	speed: 0.0684s/iter; left time: 2057.5380s
	iters: 700, epoch: 4 | loss: 0.4923278
	speed: 0.0693s/iter; left time: 2079.4211s
	iters: 800, epoch: 4 | loss: 1.0186024
	speed: 0.0649s/iter; left time: 1940.5424s
	iters: 900, epoch: 4 | loss: 0.4410562
	speed: 0.0803s/iter; left time: 2391.7683s
	iters: 1000, epoch: 4 | loss: 0.4940950
	speed: 0.0733s/iter; left time: 2176.9184s
	iters: 1100, epoch: 4 | loss: 0.5039543
	speed: 0.0734s/iter; left time: 2171.9475s
Epoch: 4 cost time: 82.64824366569519
Epoch: 4, Steps: 1137 | Train Loss: 0.5677860 Vali Loss: 0.5669770 Test Loss: 0.2607839
Validation loss decreased (0.569382 --> 0.566977).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.4727818
	speed: 0.4645s/iter; left time: 13684.1490s
	iters: 200, epoch: 5 | loss: 0.5549467
	speed: 0.0832s/iter; left time: 2444.0311s
	iters: 300, epoch: 5 | loss: 0.4352599
	speed: 0.0710s/iter; left time: 2076.2731s
	iters: 400, epoch: 5 | loss: 1.0092168
	speed: 0.0647s/iter; left time: 1887.3912s
	iters: 500, epoch: 5 | loss: 0.5128915
	speed: 0.0756s/iter; left time: 2196.7561s
	iters: 600, epoch: 5 | loss: 0.5011593
	speed: 0.0767s/iter; left time: 2221.4313s
	iters: 700, epoch: 5 | loss: 0.5374702
	speed: 0.0722s/iter; left time: 2083.2370s
	iters: 800, epoch: 5 | loss: 0.4711491
	speed: 0.0756s/iter; left time: 2173.9995s
	iters: 900, epoch: 5 | loss: 0.5755795
	speed: 0.0740s/iter; left time: 2120.8863s
	iters: 1000, epoch: 5 | loss: 0.6719060
	speed: 0.0726s/iter; left time: 2074.5539s
	iters: 1100, epoch: 5 | loss: 0.4594001
	speed: 0.0696s/iter; left time: 1979.6689s
Epoch: 5 cost time: 84.06953430175781
Epoch: 5, Steps: 1137 | Train Loss: 0.5622024 Vali Loss: 0.5612049 Test Loss: 0.2613324
Validation loss decreased (0.566977 --> 0.561205).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.4556886
	speed: 0.4841s/iter; left time: 13713.5932s
	iters: 200, epoch: 6 | loss: 0.4359326
	speed: 0.0789s/iter; left time: 2227.4566s
	iters: 300, epoch: 6 | loss: 0.4115374
	speed: 0.0713s/iter; left time: 2004.4049s
	iters: 400, epoch: 6 | loss: 0.5400734
	speed: 0.0759s/iter; left time: 2128.3867s
	iters: 500, epoch: 6 | loss: 0.5576591
	speed: 0.0732s/iter; left time: 2043.7253s
	iters: 600, epoch: 6 | loss: 0.5406477
	speed: 0.0749s/iter; left time: 2083.3322s
	iters: 700, epoch: 6 | loss: 0.7124099
	speed: 0.0726s/iter; left time: 2013.7225s
	iters: 800, epoch: 6 | loss: 0.5079323
	speed: 0.0707s/iter; left time: 1952.7531s
	iters: 900, epoch: 6 | loss: 0.7924662
	speed: 0.0669s/iter; left time: 1841.5601s
	iters: 1000, epoch: 6 | loss: 0.4166817
	speed: 0.0716s/iter; left time: 1962.4343s
	iters: 1100, epoch: 6 | loss: 0.4087482
	speed: 0.0768s/iter; left time: 2098.8202s
Epoch: 6 cost time: 84.0652801990509
Epoch: 6, Steps: 1137 | Train Loss: 0.5573854 Vali Loss: 0.5593855 Test Loss: 0.2574873
Validation loss decreased (0.561205 --> 0.559386).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.5691072
	speed: 0.4949s/iter; left time: 13456.3758s
	iters: 200, epoch: 7 | loss: 0.4895368
	speed: 0.0763s/iter; left time: 2068.2030s
	iters: 300, epoch: 7 | loss: 0.4128145
	speed: 0.0713s/iter; left time: 1924.0836s
	iters: 400, epoch: 7 | loss: 0.6767156
	speed: 0.0719s/iter; left time: 1934.4455s
	iters: 500, epoch: 7 | loss: 0.5175166
	speed: 0.0702s/iter; left time: 1881.1877s
	iters: 600, epoch: 7 | loss: 0.4397307
	speed: 0.0738s/iter; left time: 1968.6489s
	iters: 700, epoch: 7 | loss: 0.4425040
	speed: 0.0694s/iter; left time: 1845.6196s
	iters: 800, epoch: 7 | loss: 0.7314312
	speed: 0.0761s/iter; left time: 2016.3219s
	iters: 900, epoch: 7 | loss: 0.4108199
	speed: 0.0697s/iter; left time: 1839.9683s
	iters: 1000, epoch: 7 | loss: 0.3913116
	speed: 0.0683s/iter; left time: 1795.2247s
	iters: 1100, epoch: 7 | loss: 0.5112849
	speed: 0.0812s/iter; left time: 2126.3119s
Epoch: 7 cost time: 83.86229467391968
Epoch: 7, Steps: 1137 | Train Loss: 0.5528072 Vali Loss: 0.5570253 Test Loss: 0.2578103
Validation loss decreased (0.559386 --> 0.557025).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.4301465
	speed: 0.4854s/iter; left time: 12645.1303s
	iters: 200, epoch: 8 | loss: 0.7247100
	speed: 0.0748s/iter; left time: 1940.2061s
	iters: 300, epoch: 8 | loss: 1.0010906
	speed: 0.0706s/iter; left time: 1825.3685s
	iters: 400, epoch: 8 | loss: 0.5127611
	speed: 0.0787s/iter; left time: 2027.1139s
	iters: 500, epoch: 8 | loss: 0.5829566
	speed: 0.0700s/iter; left time: 1795.7067s
	iters: 600, epoch: 8 | loss: 0.6554821
	speed: 0.0677s/iter; left time: 1730.4100s
	iters: 700, epoch: 8 | loss: 0.7097444
	speed: 0.0708s/iter; left time: 1800.8566s
	iters: 800, epoch: 8 | loss: 0.5015670
	speed: 0.0767s/iter; left time: 1945.2745s
	iters: 900, epoch: 8 | loss: 0.4996535
	speed: 0.0726s/iter; left time: 1833.1820s
	iters: 1000, epoch: 8 | loss: 0.4488092
	speed: 0.0727s/iter; left time: 1828.1967s
	iters: 1100, epoch: 8 | loss: 0.4503006
	speed: 0.0742s/iter; left time: 1860.0639s
Epoch: 8 cost time: 83.20690846443176
Epoch: 8, Steps: 1137 | Train Loss: 0.5478880 Vali Loss: 0.5601110 Test Loss: 0.2578496
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.4303148
	speed: 0.4851s/iter; left time: 12085.3682s
	iters: 200, epoch: 9 | loss: 0.3931911
	speed: 0.0727s/iter; left time: 1803.0235s
	iters: 300, epoch: 9 | loss: 0.5190167
	speed: 0.0679s/iter; left time: 1677.2801s
	iters: 400, epoch: 9 | loss: 0.4230370
	speed: 0.0767s/iter; left time: 1887.4425s
	iters: 500, epoch: 9 | loss: 0.4551035
	speed: 0.0703s/iter; left time: 1723.0234s
	iters: 600, epoch: 9 | loss: 0.4608006
	speed: 0.0747s/iter; left time: 1824.1398s
	iters: 700, epoch: 9 | loss: 0.3923203
	speed: 0.0706s/iter; left time: 1715.6979s
	iters: 800, epoch: 9 | loss: 0.5088928
	speed: 0.0754s/iter; left time: 1825.7575s
	iters: 900, epoch: 9 | loss: 0.5818696
	speed: 0.0744s/iter; left time: 1794.8766s
	iters: 1000, epoch: 9 | loss: 0.5358067
	speed: 0.0727s/iter; left time: 1746.6142s
	iters: 1100, epoch: 9 | loss: 0.3417243
	speed: 0.0684s/iter; left time: 1636.1497s
Epoch: 9 cost time: 83.71302390098572
Epoch: 9, Steps: 1137 | Train Loss: 0.5442785 Vali Loss: 0.5575624 Test Loss: 0.2580428
EarlyStopping counter: 2 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.4120727
	speed: 0.4982s/iter; left time: 11845.3061s
	iters: 200, epoch: 10 | loss: 0.5410568
	speed: 0.0715s/iter; left time: 1692.2748s
	iters: 300, epoch: 10 | loss: 0.5050926
	speed: 0.0737s/iter; left time: 1737.3271s
	iters: 400, epoch: 10 | loss: 0.4636961
	speed: 0.0756s/iter; left time: 1774.2506s
	iters: 500, epoch: 10 | loss: 0.5489588
	speed: 0.0700s/iter; left time: 1637.1615s
	iters: 600, epoch: 10 | loss: 0.5001159
	speed: 0.0729s/iter; left time: 1696.2465s
	iters: 700, epoch: 10 | loss: 0.7909384
	speed: 0.0663s/iter; left time: 1535.9575s
	iters: 800, epoch: 10 | loss: 0.6641320
	speed: 0.0697s/iter; left time: 1607.8225s
	iters: 900, epoch: 10 | loss: 0.4496967
	speed: 0.0676s/iter; left time: 1552.3650s
	iters: 1000, epoch: 10 | loss: 0.7914883
	speed: 0.0741s/iter; left time: 1695.7349s
	iters: 1100, epoch: 10 | loss: 0.8589133
	speed: 0.0694s/iter; left time: 1580.3600s
Epoch: 10 cost time: 82.30146408081055
Epoch: 10, Steps: 1137 | Train Loss: 0.5414057 Vali Loss: 0.5564668 Test Loss: 0.2578495
Validation loss decreased (0.557025 --> 0.556467).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.6934695
	speed: 0.4375s/iter; left time: 9905.4765s
	iters: 200, epoch: 11 | loss: 0.6300374
	speed: 0.0650s/iter; left time: 1464.9168s
	iters: 300, epoch: 11 | loss: 0.4276082
	speed: 0.0670s/iter; left time: 1504.1640s
	iters: 400, epoch: 11 | loss: 0.7659742
	speed: 0.0639s/iter; left time: 1426.8759s
	iters: 500, epoch: 11 | loss: 0.6757584
	speed: 0.0631s/iter; left time: 1404.3354s
	iters: 600, epoch: 11 | loss: 0.7385671
	speed: 0.0678s/iter; left time: 1501.9452s
	iters: 700, epoch: 11 | loss: 0.6946599
	speed: 0.0738s/iter; left time: 1626.7209s
	iters: 800, epoch: 11 | loss: 0.7700905
	speed: 0.0691s/iter; left time: 1517.0969s
	iters: 900, epoch: 11 | loss: 0.4862830
	speed: 0.0801s/iter; left time: 1750.1494s
	iters: 1000, epoch: 11 | loss: 0.4707770
	speed: 0.0675s/iter; left time: 1467.3547s
	iters: 1100, epoch: 11 | loss: 0.5591698
	speed: 0.0694s/iter; left time: 1502.1532s
Epoch: 11 cost time: 79.50475907325745
Epoch: 11, Steps: 1137 | Train Loss: 0.5388765 Vali Loss: 0.5575824 Test Loss: 0.2571396
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.5235951
	speed: 0.5057s/iter; left time: 10875.3978s
	iters: 200, epoch: 12 | loss: 0.6468717
	speed: 0.0683s/iter; left time: 1460.8996s
	iters: 300, epoch: 12 | loss: 0.7046568
	speed: 0.0748s/iter; left time: 1593.3098s
	iters: 400, epoch: 12 | loss: 0.5252686
	speed: 0.0683s/iter; left time: 1448.6211s
	iters: 500, epoch: 12 | loss: 0.4601182
	speed: 0.0814s/iter; left time: 1718.6295s
	iters: 600, epoch: 12 | loss: 0.7431113
	speed: 0.0713s/iter; left time: 1497.4562s
	iters: 700, epoch: 12 | loss: 0.4270836
	speed: 0.0680s/iter; left time: 1421.2420s
	iters: 800, epoch: 12 | loss: 0.4444017
	speed: 0.0780s/iter; left time: 1623.2987s
	iters: 900, epoch: 12 | loss: 0.5349342
	speed: 0.0737s/iter; left time: 1525.1409s
	iters: 1000, epoch: 12 | loss: 0.4901283
	speed: 0.0748s/iter; left time: 1540.9159s
	iters: 1100, epoch: 12 | loss: 0.4811962
	speed: 0.0761s/iter; left time: 1560.9753s
Epoch: 12 cost time: 84.09288668632507
Epoch: 12, Steps: 1137 | Train Loss: 0.5374046 Vali Loss: 0.5547413 Test Loss: 0.2575000
Validation loss decreased (0.556467 --> 0.554741).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.4372679
	speed: 0.4960s/iter; left time: 10102.7409s
	iters: 200, epoch: 13 | loss: 0.8209807
	speed: 0.0707s/iter; left time: 1433.5767s
	iters: 300, epoch: 13 | loss: 0.3366635
	speed: 0.0734s/iter; left time: 1480.8000s
	iters: 400, epoch: 13 | loss: 0.6716797
	speed: 0.0800s/iter; left time: 1605.0814s
	iters: 500, epoch: 13 | loss: 0.5340345
	speed: 0.0759s/iter; left time: 1515.4394s
	iters: 600, epoch: 13 | loss: 0.4254389
	speed: 0.0723s/iter; left time: 1435.6770s
	iters: 700, epoch: 13 | loss: 0.6869288
	speed: 0.0739s/iter; left time: 1461.3669s
	iters: 800, epoch: 13 | loss: 0.4029702
	speed: 0.0742s/iter; left time: 1459.2807s
	iters: 900, epoch: 13 | loss: 0.4280652
	speed: 0.0693s/iter; left time: 1355.1062s
	iters: 1000, epoch: 13 | loss: 0.4384743
	speed: 0.0671s/iter; left time: 1306.1822s
	iters: 1100, epoch: 13 | loss: 0.4413435
	speed: 0.0749s/iter; left time: 1450.3195s
Epoch: 13 cost time: 84.13242793083191
Epoch: 13, Steps: 1137 | Train Loss: 0.5351933 Vali Loss: 0.5585841 Test Loss: 0.2568944
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.5205973
	speed: 0.5044s/iter; left time: 9698.8140s
	iters: 200, epoch: 14 | loss: 0.4126840
	speed: 0.0754s/iter; left time: 1443.2939s
	iters: 300, epoch: 14 | loss: 0.4946522
	speed: 0.0718s/iter; left time: 1366.4527s
	iters: 400, epoch: 14 | loss: 0.4796709
	speed: 0.0740s/iter; left time: 1401.2110s
	iters: 500, epoch: 14 | loss: 0.6611839
	speed: 0.0738s/iter; left time: 1390.2602s
	iters: 600, epoch: 14 | loss: 0.5978101
	speed: 0.0692s/iter; left time: 1296.6044s
	iters: 700, epoch: 14 | loss: 0.4049883
	speed: 0.0719s/iter; left time: 1339.8643s
	iters: 800, epoch: 14 | loss: 0.4275368
	speed: 0.0678s/iter; left time: 1256.3319s
	iters: 900, epoch: 14 | loss: 0.4886729
	speed: 0.0785s/iter; left time: 1445.9742s
	iters: 1000, epoch: 14 | loss: 0.7186029
	speed: 0.0707s/iter; left time: 1295.7427s
	iters: 1100, epoch: 14 | loss: 0.4347225
	speed: 0.0661s/iter; left time: 1205.5369s
Epoch: 14 cost time: 82.75704407691956
Epoch: 14, Steps: 1137 | Train Loss: 0.5335848 Vali Loss: 0.5566524 Test Loss: 0.2567974
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.7163877
	speed: 0.5059s/iter; left time: 9153.1183s
	iters: 200, epoch: 15 | loss: 0.9672474
	speed: 0.0701s/iter; left time: 1262.0477s
	iters: 300, epoch: 15 | loss: 0.5153651
	speed: 0.0694s/iter; left time: 1242.2176s
	iters: 400, epoch: 15 | loss: 0.4716104
	speed: 0.0725s/iter; left time: 1289.5220s
	iters: 500, epoch: 15 | loss: 0.4163943
	speed: 0.0811s/iter; left time: 1435.3705s
	iters: 600, epoch: 15 | loss: 0.4025482
	speed: 0.0711s/iter; left time: 1251.0960s
	iters: 700, epoch: 15 | loss: 0.7950988
	speed: 0.0704s/iter; left time: 1231.7875s
	iters: 800, epoch: 15 | loss: 0.7647261
	speed: 0.0677s/iter; left time: 1176.9669s
	iters: 900, epoch: 15 | loss: 1.1527439
	speed: 0.0816s/iter; left time: 1411.7057s
	iters: 1000, epoch: 15 | loss: 0.4652172
	speed: 0.0782s/iter; left time: 1344.5142s
	iters: 1100, epoch: 15 | loss: 0.7002736
	speed: 0.0698s/iter; left time: 1192.6030s
Epoch: 15 cost time: 84.46877765655518
Epoch: 15, Steps: 1137 | Train Loss: 0.5323882 Vali Loss: 0.5589434 Test Loss: 0.2569349
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.5018840
	speed: 0.4829s/iter; left time: 8187.5787s
	iters: 200, epoch: 16 | loss: 0.3981189
	speed: 0.0752s/iter; left time: 1268.2098s
	iters: 300, epoch: 16 | loss: 0.4474478
	speed: 0.0686s/iter; left time: 1149.2592s
	iters: 400, epoch: 16 | loss: 0.7003589
	speed: 0.0685s/iter; left time: 1141.1273s
	iters: 500, epoch: 16 | loss: 0.9972405
	speed: 0.0785s/iter; left time: 1299.9179s
	iters: 600, epoch: 16 | loss: 0.4212403
	speed: 0.0709s/iter; left time: 1167.4834s
	iters: 700, epoch: 16 | loss: 0.9390695
	speed: 0.0685s/iter; left time: 1120.8839s
	iters: 800, epoch: 16 | loss: 0.3804809
	speed: 0.0726s/iter; left time: 1180.3506s
	iters: 900, epoch: 16 | loss: 0.5115585
	speed: 0.0734s/iter; left time: 1185.2829s
	iters: 1000, epoch: 16 | loss: 0.3844073
	speed: 0.0688s/iter; left time: 1105.0922s
	iters: 1100, epoch: 16 | loss: 0.4711590
	speed: 0.0716s/iter; left time: 1142.1352s
Epoch: 16 cost time: 82.33583045005798
Epoch: 16, Steps: 1137 | Train Loss: 0.5312600 Vali Loss: 0.5566164 Test Loss: 0.2557859
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.6060317
	speed: 0.4929s/iter; left time: 7797.3065s
	iters: 200, epoch: 17 | loss: 0.7764812
	speed: 0.0746s/iter; left time: 1172.5939s
	iters: 300, epoch: 17 | loss: 0.3899204
	speed: 0.0746s/iter; left time: 1165.0734s
	iters: 400, epoch: 17 | loss: 0.7174003
	speed: 0.0742s/iter; left time: 1151.6870s
	iters: 500, epoch: 17 | loss: 0.4288804
	speed: 0.0742s/iter; left time: 1143.5901s
	iters: 600, epoch: 17 | loss: 0.5939196
	speed: 0.0738s/iter; left time: 1129.8346s
	iters: 700, epoch: 17 | loss: 0.3658999
	speed: 0.0700s/iter; left time: 1064.7062s
	iters: 800, epoch: 17 | loss: 0.6697524
	speed: 0.0716s/iter; left time: 1081.9834s
	iters: 900, epoch: 17 | loss: 0.4417225
	speed: 0.0714s/iter; left time: 1072.3976s
	iters: 1000, epoch: 17 | loss: 0.6822646
	speed: 0.0725s/iter; left time: 1081.4488s
	iters: 1100, epoch: 17 | loss: 0.7070521
	speed: 0.0788s/iter; left time: 1167.3954s
Epoch: 17 cost time: 85.40329885482788
Epoch: 17, Steps: 1137 | Train Loss: 0.5307589 Vali Loss: 0.5577950 Test Loss: 0.2559504
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : 192_336_PatchTST_custom_ftM_sl192_ll48_pl336_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
mse:0.2575114369392395, mae:0.2847001850605011, rse:0.6664748787879944
