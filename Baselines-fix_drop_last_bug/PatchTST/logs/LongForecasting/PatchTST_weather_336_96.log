Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='custom', data_path='weather.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=21, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='type3', model='PatchTST', model_id='336_96', moving_avg=25, n_heads=16, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.3, pred_len=96, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : 336_96_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.7089927
	speed: 0.1985s/iter; left time: 5616.7457s
	iters: 200, epoch: 1 | loss: 0.7085072
	speed: 0.1871s/iter; left time: 5276.3100s
Epoch: 1 cost time: 54.33006024360657
Epoch: 1, Steps: 284 | Train Loss: 0.7473582 Vali Loss: 0.5420405 Test Loss: 0.2202310
Validation loss decreased (inf --> 0.542040).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3546966
	speed: 0.7189s/iter; left time: 20142.0419s
	iters: 200, epoch: 2 | loss: 0.4091986
	speed: 0.1869s/iter; left time: 5218.1827s
Epoch: 2 cost time: 54.23424458503723
Epoch: 2, Steps: 284 | Train Loss: 0.4927066 Vali Loss: 0.4146194 Test Loss: 0.1676066
Validation loss decreased (0.542040 --> 0.414619).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.4489665
	speed: 0.6988s/iter; left time: 19380.9553s
	iters: 200, epoch: 3 | loss: 0.4211670
	speed: 0.1927s/iter; left time: 5323.9537s
Epoch: 3 cost time: 55.05845594406128
Epoch: 3, Steps: 284 | Train Loss: 0.4478940 Vali Loss: 0.4045983 Test Loss: 0.1609459
Validation loss decreased (0.414619 --> 0.404598).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3704086
	speed: 0.7467s/iter; left time: 20496.2546s
	iters: 200, epoch: 4 | loss: 0.6353363
	speed: 0.1898s/iter; left time: 5191.9531s
Epoch: 4 cost time: 54.1396701335907
Epoch: 4, Steps: 284 | Train Loss: 0.4410601 Vali Loss: 0.3953396 Test Loss: 0.1579778
Validation loss decreased (0.404598 --> 0.395340).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.3680178
	speed: 0.6888s/iter; left time: 18711.0605s
	iters: 200, epoch: 5 | loss: 0.8126428
	speed: 0.1919s/iter; left time: 5193.1295s
Epoch: 5 cost time: 55.349732875823975
Epoch: 5, Steps: 284 | Train Loss: 0.4357035 Vali Loss: 0.3962049 Test Loss: 0.1569813
EarlyStopping counter: 1 out of 20
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.3608336
	speed: 0.7350s/iter; left time: 19757.8893s
	iters: 200, epoch: 6 | loss: 0.4251752
	speed: 0.1893s/iter; left time: 5069.9555s
Epoch: 6 cost time: 54.56301426887512
Epoch: 6, Steps: 284 | Train Loss: 0.4322210 Vali Loss: 0.3940893 Test Loss: 0.1545752
Validation loss decreased (0.395340 --> 0.394089).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.5585888
	speed: 0.6699s/iter; left time: 17818.0109s
	iters: 200, epoch: 7 | loss: 0.3132062
	speed: 0.1904s/iter; left time: 5044.1390s
Epoch: 7 cost time: 54.423646450042725
Epoch: 7, Steps: 284 | Train Loss: 0.4295316 Vali Loss: 0.3936827 Test Loss: 0.1545050
Validation loss decreased (0.394089 --> 0.393683).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.3639442
	speed: 0.7656s/iter; left time: 20146.4357s
	iters: 200, epoch: 8 | loss: 0.5492088
	speed: 0.1900s/iter; left time: 4979.9861s
Epoch: 8 cost time: 55.23353624343872
Epoch: 8, Steps: 284 | Train Loss: 0.4271467 Vali Loss: 0.3956525 Test Loss: 0.1525638
EarlyStopping counter: 1 out of 20
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.6032100
	speed: 0.7602s/iter; left time: 19787.8446s
	iters: 200, epoch: 9 | loss: 0.3097956
	speed: 0.1937s/iter; left time: 5022.2106s
Epoch: 9 cost time: 55.7202262878418
Epoch: 9, Steps: 284 | Train Loss: 0.4247415 Vali Loss: 0.3983163 Test Loss: 0.1542649
EarlyStopping counter: 2 out of 20
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.4003643
	speed: 0.7437s/iter; left time: 19145.4957s
	iters: 200, epoch: 10 | loss: 0.3185645
	speed: 0.1897s/iter; left time: 4864.0575s
Epoch: 10 cost time: 53.517380714416504
Epoch: 10, Steps: 284 | Train Loss: 0.4241888 Vali Loss: 0.3957125 Test Loss: 0.1521290
EarlyStopping counter: 3 out of 20
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.3054640
	speed: 0.6363s/iter; left time: 16201.7796s
	iters: 200, epoch: 11 | loss: 0.5225404
	speed: 0.1872s/iter; left time: 4748.5763s
Epoch: 11 cost time: 54.04421639442444
Epoch: 11, Steps: 284 | Train Loss: 0.4218935 Vali Loss: 0.3943823 Test Loss: 0.1524104
EarlyStopping counter: 4 out of 20
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.7232369
	speed: 0.6751s/iter; left time: 16997.8119s
	iters: 200, epoch: 12 | loss: 0.4100592
	speed: 0.1875s/iter; left time: 4701.4016s
Epoch: 12 cost time: 54.17485594749451
Epoch: 12, Steps: 284 | Train Loss: 0.4213824 Vali Loss: 0.3970080 Test Loss: 0.1513973
EarlyStopping counter: 5 out of 20
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.6128367
	speed: 0.7104s/iter; left time: 17683.5336s
	iters: 200, epoch: 13 | loss: 0.3230795
	speed: 0.1866s/iter; left time: 4626.5681s
Epoch: 13 cost time: 54.15327024459839
Epoch: 13, Steps: 284 | Train Loss: 0.4191757 Vali Loss: 0.3939909 Test Loss: 0.1515149
EarlyStopping counter: 6 out of 20
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.2974343
	speed: 0.7083s/iter; left time: 17431.1818s
	iters: 200, epoch: 14 | loss: 0.3122219
	speed: 0.1882s/iter; left time: 4612.2519s
Epoch: 14 cost time: 54.44924759864807
Epoch: 14, Steps: 284 | Train Loss: 0.4176205 Vali Loss: 0.3958593 Test Loss: 0.1517820
EarlyStopping counter: 7 out of 20
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.4916801
	speed: 0.7197s/iter; left time: 17507.2045s
	iters: 200, epoch: 15 | loss: 0.4108517
	speed: 0.1867s/iter; left time: 4523.3839s
Epoch: 15 cost time: 54.720813035964966
Epoch: 15, Steps: 284 | Train Loss: 0.4178269 Vali Loss: 0.3958071 Test Loss: 0.1505757
EarlyStopping counter: 8 out of 20
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.3202386
	speed: 0.7291s/iter; left time: 17527.8696s
	iters: 200, epoch: 16 | loss: 0.6285076
	speed: 0.1890s/iter; left time: 4523.7192s
Epoch: 16 cost time: 54.89284920692444
Epoch: 16, Steps: 284 | Train Loss: 0.4163353 Vali Loss: 0.3970360 Test Loss: 0.1516961
EarlyStopping counter: 9 out of 20
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.2886135
	speed: 0.7240s/iter; left time: 17200.6970s
	iters: 200, epoch: 17 | loss: 0.5836278
	speed: 0.1900s/iter; left time: 4494.2592s
Epoch: 17 cost time: 54.8984739780426
Epoch: 17, Steps: 284 | Train Loss: 0.4160998 Vali Loss: 0.3966040 Test Loss: 0.1505415
EarlyStopping counter: 10 out of 20
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.3157903
	speed: 0.7261s/iter; left time: 17043.6468s
	iters: 200, epoch: 18 | loss: 0.6283959
	speed: 0.1900s/iter; left time: 4440.3473s
Epoch: 18 cost time: 54.87021565437317
Epoch: 18, Steps: 284 | Train Loss: 0.4142613 Vali Loss: 0.3925978 Test Loss: 0.1507493
Validation loss decreased (0.393683 --> 0.392598).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.4838490
	speed: 0.7260s/iter; left time: 16834.7996s
	iters: 200, epoch: 19 | loss: 0.5153456
	speed: 0.1908s/iter; left time: 4405.7625s
Epoch: 19 cost time: 54.84239482879639
Epoch: 19, Steps: 284 | Train Loss: 0.4137708 Vali Loss: 0.3965200 Test Loss: 0.1503138
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.3093248
	speed: 0.7242s/iter; left time: 16587.4125s
	iters: 200, epoch: 20 | loss: 0.3057086
	speed: 0.1905s/iter; left time: 4343.4163s
Epoch: 20 cost time: 55.24189591407776
Epoch: 20, Steps: 284 | Train Loss: 0.4130653 Vali Loss: 0.3950134 Test Loss: 0.1495479
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.8358309
	speed: 0.7245s/iter; left time: 16389.4976s
	iters: 200, epoch: 21 | loss: 0.2987207
	speed: 0.1908s/iter; left time: 4297.0183s
Epoch: 21 cost time: 54.70242381095886
Epoch: 21, Steps: 284 | Train Loss: 0.4131739 Vali Loss: 0.3982263 Test Loss: 0.1498151
EarlyStopping counter: 3 out of 20
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.3238148
	speed: 0.7209s/iter; left time: 16102.6605s
	iters: 200, epoch: 22 | loss: 0.3020407
	speed: 0.1868s/iter; left time: 4154.4315s
Epoch: 22 cost time: 55.13494515419006
Epoch: 22, Steps: 284 | Train Loss: 0.4119389 Vali Loss: 0.3954717 Test Loss: 0.1499158
EarlyStopping counter: 4 out of 20
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.3720643
	speed: 0.6817s/iter; left time: 15032.4539s
	iters: 200, epoch: 23 | loss: 0.3318075
	speed: 0.1867s/iter; left time: 4097.7834s
Epoch: 23 cost time: 52.100029945373535
Epoch: 23, Steps: 284 | Train Loss: 0.4124627 Vali Loss: 0.3969639 Test Loss: 0.1500571
EarlyStopping counter: 5 out of 20
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.5904965
	speed: 0.6587s/iter; left time: 14340.1647s
	iters: 200, epoch: 24 | loss: 0.5558282
	speed: 0.1942s/iter; left time: 4207.2566s
Epoch: 24 cost time: 54.986801624298096
Epoch: 24, Steps: 284 | Train Loss: 0.4115864 Vali Loss: 0.3935320 Test Loss: 0.1498635
EarlyStopping counter: 6 out of 20
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.3835653
	speed: 0.7543s/iter; left time: 16205.7894s
	iters: 200, epoch: 25 | loss: 0.5089389
	speed: 0.1915s/iter; left time: 4095.5431s
Epoch: 25 cost time: 54.955872535705566
Epoch: 25, Steps: 284 | Train Loss: 0.4117145 Vali Loss: 0.3950628 Test Loss: 0.1504938
EarlyStopping counter: 7 out of 20
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.2733546
	speed: 0.7346s/iter; left time: 15575.1515s
	iters: 200, epoch: 26 | loss: 0.4895941
	speed: 0.1914s/iter; left time: 4037.9457s
Epoch: 26 cost time: 54.74728226661682
Epoch: 26, Steps: 284 | Train Loss: 0.4102504 Vali Loss: 0.3952684 Test Loss: 0.1496159
EarlyStopping counter: 8 out of 20
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.3344143
	speed: 0.7220s/iter; left time: 15103.0015s
	iters: 200, epoch: 27 | loss: 0.5442504
	speed: 0.1862s/iter; left time: 3875.5784s
Epoch: 27 cost time: 53.9395637512207
Epoch: 27, Steps: 284 | Train Loss: 0.4111909 Vali Loss: 0.3936352 Test Loss: 0.1496891
EarlyStopping counter: 9 out of 20
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.5116102
	speed: 0.7199s/iter; left time: 14854.2141s
	iters: 200, epoch: 28 | loss: 0.4128025
	speed: 0.1872s/iter; left time: 3844.3730s
Epoch: 28 cost time: 54.7174391746521
Epoch: 28, Steps: 284 | Train Loss: 0.4101103 Vali Loss: 0.3953496 Test Loss: 0.1499177
EarlyStopping counter: 10 out of 20
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.3661117
	speed: 0.6684s/iter; left time: 13600.3182s
	iters: 200, epoch: 29 | loss: 0.6039005
	speed: 0.1886s/iter; left time: 3818.2067s
Epoch: 29 cost time: 54.43777823448181
Epoch: 29, Steps: 284 | Train Loss: 0.4105263 Vali Loss: 0.3948367 Test Loss: 0.1498014
EarlyStopping counter: 11 out of 20
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.3909823
	speed: 0.7348s/iter; left time: 14743.3538s
	iters: 200, epoch: 30 | loss: 0.2939837
	speed: 0.1884s/iter; left time: 3761.2291s
Epoch: 30 cost time: 54.89798307418823
Epoch: 30, Steps: 284 | Train Loss: 0.4105015 Vali Loss: 0.3968622 Test Loss: 0.1500336
EarlyStopping counter: 12 out of 20
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.3343413
	speed: 0.7419s/iter; left time: 14676.0590s
	iters: 200, epoch: 31 | loss: 0.3671284
	speed: 0.1922s/iter; left time: 3782.2420s
Epoch: 31 cost time: 55.535661697387695
Epoch: 31, Steps: 284 | Train Loss: 0.4101626 Vali Loss: 0.3947810 Test Loss: 0.1498017
EarlyStopping counter: 13 out of 20
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.5364923
	speed: 0.7376s/iter; left time: 14380.1410s
	iters: 200, epoch: 32 | loss: 0.3700745
	speed: 0.1884s/iter; left time: 3655.0210s
Epoch: 32 cost time: 54.91118764877319
Epoch: 32, Steps: 284 | Train Loss: 0.4091447 Vali Loss: 0.3942005 Test Loss: 0.1491225
EarlyStopping counter: 14 out of 20
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.5232113
	speed: 0.7372s/iter; left time: 14162.8989s
	iters: 200, epoch: 33 | loss: 0.3228710
	speed: 0.1728s/iter; left time: 3303.5034s
Epoch: 33 cost time: 51.830326557159424
Epoch: 33, Steps: 284 | Train Loss: 0.4092019 Vali Loss: 0.3950292 Test Loss: 0.1497612
EarlyStopping counter: 15 out of 20
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.2887709
	speed: 0.6782s/iter; left time: 12837.8042s
	iters: 200, epoch: 34 | loss: 0.5637905
	speed: 0.1886s/iter; left time: 3550.5898s
Epoch: 34 cost time: 54.7772490978241
Epoch: 34, Steps: 284 | Train Loss: 0.4097146 Vali Loss: 0.3936555 Test Loss: 0.1494883
EarlyStopping counter: 16 out of 20
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.4003683
	speed: 0.7171s/iter; left time: 13370.7432s
	iters: 200, epoch: 35 | loss: 0.2715706
	speed: 0.1905s/iter; left time: 3533.6665s
Epoch: 35 cost time: 55.012332916259766
Epoch: 35, Steps: 284 | Train Loss: 0.4096135 Vali Loss: 0.3936603 Test Loss: 0.1497169
EarlyStopping counter: 17 out of 20
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.5656230
	speed: 0.7253s/iter; left time: 13316.3648s
	iters: 200, epoch: 36 | loss: 0.3360889
	speed: 0.1873s/iter; left time: 3420.2954s
Epoch: 36 cost time: 54.16507148742676
Epoch: 36, Steps: 284 | Train Loss: 0.4095894 Vali Loss: 0.3951479 Test Loss: 0.1496375
EarlyStopping counter: 18 out of 20
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.5418338
	speed: 0.6968s/iter; left time: 12596.7641s
	iters: 200, epoch: 37 | loss: 0.9882491
	speed: 0.1890s/iter; left time: 3397.0905s
Epoch: 37 cost time: 54.071247816085815
Epoch: 37, Steps: 284 | Train Loss: 0.4095798 Vali Loss: 0.3938519 Test Loss: 0.1498400
EarlyStopping counter: 19 out of 20
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.5752027
	speed: 0.7370s/iter; left time: 13114.0147s
	iters: 200, epoch: 38 | loss: 0.5270478
	speed: 0.1891s/iter; left time: 3345.2315s
Epoch: 38 cost time: 54.936200857162476
Epoch: 38, Steps: 284 | Train Loss: 0.4094029 Vali Loss: 0.3934841 Test Loss: 0.1495088
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : 336_96_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
mse:0.15124833583831787, mae:0.19990117847919464, rse:0.5125043392181396
