True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ECL_336_192         Model:              TimesNet            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/          
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            336                 Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ECL_336_192_TimesNet_custom_ftM_sl336_ll48_pl192_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17885
val 2441
test 5069
	iters: 100, epoch: 1 | loss: 0.4366030
	speed: 0.5033s/iter; left time: 8389.7442s
	iters: 200, epoch: 1 | loss: 0.3486389
	speed: 0.4360s/iter; left time: 7225.1916s
	iters: 300, epoch: 1 | loss: 0.2891984
	speed: 0.4421s/iter; left time: 7281.8529s
	iters: 400, epoch: 1 | loss: 0.2596186
	speed: 0.4260s/iter; left time: 6974.6870s
	iters: 500, epoch: 1 | loss: 0.2397650
	speed: 0.4428s/iter; left time: 7205.1845s
Epoch: 1 cost time: 252.1004514694214
Epoch: 1, Steps: 559 | Train Loss: 0.3671969 Vali Loss: 0.2261611 Test Loss: 0.2630760
Validation loss decreased (inf --> 0.226161).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2552991
	speed: 1.5596s/iter; left time: 25128.7558s
	iters: 200, epoch: 2 | loss: 0.2466902
	speed: 0.4705s/iter; left time: 7534.3545s
	iters: 300, epoch: 2 | loss: 0.2239289
	speed: 0.4640s/iter; left time: 7383.6285s
	iters: 400, epoch: 2 | loss: 0.2515654
	speed: 0.4535s/iter; left time: 7170.0462s
	iters: 500, epoch: 2 | loss: 0.2403880
	speed: 0.4318s/iter; left time: 6783.8022s
Epoch: 2 cost time: 254.99259734153748
Epoch: 2, Steps: 559 | Train Loss: 0.2478926 Vali Loss: 0.2175002 Test Loss: 0.2531330
Validation loss decreased (0.226161 --> 0.217500).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2351045
	speed: 1.5162s/iter; left time: 23580.8023s
	iters: 200, epoch: 3 | loss: 0.2285502
	speed: 0.4523s/iter; left time: 6989.5634s
	iters: 300, epoch: 3 | loss: 0.2165826
	speed: 0.4607s/iter; left time: 7072.4306s
	iters: 400, epoch: 3 | loss: 0.2356704
	speed: 0.4595s/iter; left time: 7008.6382s
	iters: 500, epoch: 3 | loss: 0.2612932
	speed: 0.4565s/iter; left time: 6916.6653s
Epoch: 3 cost time: 255.69687056541443
Epoch: 3, Steps: 559 | Train Loss: 0.2392014 Vali Loss: 0.2132270 Test Loss: 0.2470977
Validation loss decreased (0.217500 --> 0.213227).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2380201
	speed: 1.4862s/iter; left time: 22284.2898s
	iters: 200, epoch: 4 | loss: 0.2307392
	speed: 0.4476s/iter; left time: 6666.8656s
	iters: 300, epoch: 4 | loss: 0.2090122
	speed: 0.4531s/iter; left time: 6702.4867s
	iters: 400, epoch: 4 | loss: 0.2416235
	speed: 0.4533s/iter; left time: 6661.2963s
	iters: 500, epoch: 4 | loss: 0.2277783
	speed: 0.4548s/iter; left time: 6637.2834s
Epoch: 4 cost time: 253.60656595230103
Epoch: 4, Steps: 559 | Train Loss: 0.2327541 Vali Loss: 0.2132569 Test Loss: 0.2435002
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2511258
	speed: 1.5656s/iter; left time: 22599.5013s
	iters: 200, epoch: 5 | loss: 0.2133077
	speed: 0.4575s/iter; left time: 6558.1490s
	iters: 300, epoch: 5 | loss: 0.2218008
	speed: 0.4720s/iter; left time: 6719.2313s
	iters: 400, epoch: 5 | loss: 0.2145602
	speed: 0.4767s/iter; left time: 6737.6401s
	iters: 500, epoch: 5 | loss: 0.2291770
	speed: 0.4873s/iter; left time: 6839.4927s
Epoch: 5 cost time: 264.59369230270386
Epoch: 5, Steps: 559 | Train Loss: 0.2269852 Vali Loss: 0.2055676 Test Loss: 0.2358723
Validation loss decreased (0.213227 --> 0.205568).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2326872
	speed: 1.6685s/iter; left time: 23152.2262s
	iters: 200, epoch: 6 | loss: 0.2148219
	speed: 0.4690s/iter; left time: 6460.4465s
	iters: 300, epoch: 6 | loss: 0.2157241
	speed: 0.4699s/iter; left time: 6426.6696s
	iters: 400, epoch: 6 | loss: 0.2172575
	speed: 0.4821s/iter; left time: 6544.8661s
	iters: 500, epoch: 6 | loss: 0.1804135
	speed: 0.4871s/iter; left time: 6563.7963s
Epoch: 6 cost time: 267.7746012210846
Epoch: 6, Steps: 559 | Train Loss: 0.2099269 Vali Loss: 0.1884219 Test Loss: 0.2189408
Validation loss decreased (0.205568 --> 0.188422).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2103321
	speed: 1.6363s/iter; left time: 21790.1028s
	iters: 200, epoch: 7 | loss: 0.1987718
	speed: 0.4833s/iter; left time: 6387.5667s
	iters: 300, epoch: 7 | loss: 0.2267450
	speed: 0.4833s/iter; left time: 6339.4741s
	iters: 400, epoch: 7 | loss: 0.1921628
	speed: 0.4757s/iter; left time: 6192.4576s
	iters: 500, epoch: 7 | loss: 0.1982687
	speed: 0.4891s/iter; left time: 6317.7151s
Epoch: 7 cost time: 270.2355260848999
Epoch: 7, Steps: 559 | Train Loss: 0.1977127 Vali Loss: 0.1844693 Test Loss: 0.2152688
Validation loss decreased (0.188422 --> 0.184469).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2135816
	speed: 1.6453s/iter; left time: 20991.0585s
	iters: 200, epoch: 8 | loss: 0.1941913
	speed: 0.4870s/iter; left time: 6164.6618s
	iters: 300, epoch: 8 | loss: 0.1818072
	speed: 0.4691s/iter; left time: 5891.3455s
	iters: 400, epoch: 8 | loss: 0.1756593
	speed: 0.4753s/iter; left time: 5920.8183s
	iters: 500, epoch: 8 | loss: 0.1944412
	speed: 0.4839s/iter; left time: 5980.5673s
Epoch: 8 cost time: 271.17656564712524
Epoch: 8, Steps: 559 | Train Loss: 0.1936261 Vali Loss: 0.1822582 Test Loss: 0.2125725
Validation loss decreased (0.184469 --> 0.182258).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1903032
	speed: 1.6893s/iter; left time: 20608.0099s
	iters: 200, epoch: 9 | loss: 0.1730092
	speed: 0.4769s/iter; left time: 5769.8433s
	iters: 300, epoch: 9 | loss: 0.1968613
	speed: 0.4692s/iter; left time: 5630.1603s
	iters: 400, epoch: 9 | loss: 0.1843067
	speed: 0.4598s/iter; left time: 5471.0475s
	iters: 500, epoch: 9 | loss: 0.1903943
	speed: 0.4659s/iter; left time: 5496.6596s
Epoch: 9 cost time: 266.1497447490692
Epoch: 9, Steps: 559 | Train Loss: 0.1919329 Vali Loss: 0.1812857 Test Loss: 0.2120976
Validation loss decreased (0.182258 --> 0.181286).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2009469
	speed: 1.6044s/iter; left time: 18675.6021s
	iters: 200, epoch: 10 | loss: 0.1684424
	speed: 0.4808s/iter; left time: 5548.8839s
	iters: 300, epoch: 10 | loss: 0.1934885
	speed: 0.4786s/iter; left time: 5474.8217s
	iters: 400, epoch: 10 | loss: 0.1831938
	speed: 0.4734s/iter; left time: 5367.8370s
	iters: 500, epoch: 10 | loss: 0.1921477
	speed: 0.4755s/iter; left time: 5345.0513s
Epoch: 10 cost time: 268.01073002815247
Epoch: 10, Steps: 559 | Train Loss: 0.1911289 Vali Loss: 0.1808711 Test Loss: 0.2117375
Validation loss decreased (0.181286 --> 0.180871).  Saving model ...
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1790965
	speed: 1.6156s/iter; left time: 17902.1641s
	iters: 200, epoch: 11 | loss: 0.1714696
	speed: 0.4691s/iter; left time: 5150.8975s
	iters: 300, epoch: 11 | loss: 0.2080000
	speed: 0.4704s/iter; left time: 5118.8337s
	iters: 400, epoch: 11 | loss: 0.1781764
	speed: 0.4724s/iter; left time: 5092.8639s
	iters: 500, epoch: 11 | loss: 0.2237887
	speed: 0.4703s/iter; left time: 5023.4793s
Epoch: 11 cost time: 265.67184948921204
Epoch: 11, Steps: 559 | Train Loss: 0.1907545 Vali Loss: 0.1805067 Test Loss: 0.2113175
Validation loss decreased (0.180871 --> 0.180507).  Saving model ...
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1892861
	speed: 1.6543s/iter; left time: 17406.7275s
	iters: 200, epoch: 12 | loss: 0.1932344
	speed: 0.4798s/iter; left time: 5000.9732s
	iters: 300, epoch: 12 | loss: 0.1874802
	speed: 0.4719s/iter; left time: 4870.9523s
	iters: 400, epoch: 12 | loss: 0.1767437
	speed: 0.4680s/iter; left time: 4784.0919s
	iters: 500, epoch: 12 | loss: 0.2011067
	speed: 0.4731s/iter; left time: 4788.9210s
Epoch: 12 cost time: 267.68409037590027
Epoch: 12, Steps: 559 | Train Loss: 0.1905603 Vali Loss: 0.1805018 Test Loss: 0.2111884
Validation loss decreased (0.180507 --> 0.180502).  Saving model ...
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.1854206
	speed: 1.6170s/iter; left time: 16110.6251s
	iters: 200, epoch: 13 | loss: 0.2005069
	speed: 0.4833s/iter; left time: 4766.5692s
	iters: 300, epoch: 13 | loss: 0.1831208
	speed: 0.4690s/iter; left time: 4578.9075s
	iters: 400, epoch: 13 | loss: 0.1803945
	speed: 0.4683s/iter; left time: 4524.8825s
	iters: 500, epoch: 13 | loss: 0.1820751
	speed: 0.4654s/iter; left time: 4451.0377s
Epoch: 13 cost time: 265.3568911552429
Epoch: 13, Steps: 559 | Train Loss: 0.1904508 Vali Loss: 0.1806252 Test Loss: 0.2112430
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.1978411
	speed: 1.6257s/iter; left time: 15287.8143s
	iters: 200, epoch: 14 | loss: 0.1965109
	speed: 0.4664s/iter; left time: 4339.4394s
	iters: 300, epoch: 14 | loss: 0.1983510
	speed: 0.4676s/iter; left time: 4304.1871s
	iters: 400, epoch: 14 | loss: 0.1887986
	speed: 0.4670s/iter; left time: 4251.4693s
	iters: 500, epoch: 14 | loss: 0.2053414
	speed: 0.4705s/iter; left time: 4236.1994s
Epoch: 14 cost time: 263.585488319397
Epoch: 14, Steps: 559 | Train Loss: 0.1904014 Vali Loss: 0.1804441 Test Loss: 0.2112102
Validation loss decreased (0.180502 --> 0.180444).  Saving model ...
Updating learning rate to 1.220703125e-08
	iters: 100, epoch: 15 | loss: 0.1709294
	speed: 1.6588s/iter; left time: 14672.1843s
	iters: 200, epoch: 15 | loss: 0.2149468
	speed: 0.4791s/iter; left time: 4189.5306s
	iters: 300, epoch: 15 | loss: 0.2004124
	speed: 0.4784s/iter; left time: 4135.5271s
	iters: 400, epoch: 15 | loss: 0.2384669
	speed: 0.4825s/iter; left time: 4123.0050s
	iters: 500, epoch: 15 | loss: 0.1678007
	speed: 0.4741s/iter; left time: 4004.0929s
Epoch: 15 cost time: 268.89305567741394
Epoch: 15, Steps: 559 | Train Loss: 0.1903973 Vali Loss: 0.1803847 Test Loss: 0.2111977
Validation loss decreased (0.180444 --> 0.180385).  Saving model ...
Updating learning rate to 6.103515625e-09
	iters: 100, epoch: 16 | loss: 0.1842707
	speed: 1.5678s/iter; left time: 12990.6553s
	iters: 200, epoch: 16 | loss: 0.1709544
	speed: 0.4683s/iter; left time: 3833.6854s
	iters: 300, epoch: 16 | loss: 0.1983448
	speed: 0.4699s/iter; left time: 3800.0097s
	iters: 400, epoch: 16 | loss: 0.1726808
	speed: 0.4864s/iter; left time: 3884.1492s
	iters: 500, epoch: 16 | loss: 0.2364686
	speed: 0.4813s/iter; left time: 3795.8540s
Epoch: 16 cost time: 266.17265796661377
Epoch: 16, Steps: 559 | Train Loss: 0.1903783 Vali Loss: 0.1804118 Test Loss: 0.2111924
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.0517578125e-09
	iters: 100, epoch: 17 | loss: 0.2009337
	speed: 1.6325s/iter; left time: 12614.4852s
	iters: 200, epoch: 17 | loss: 0.1950853
	speed: 0.4775s/iter; left time: 3642.0162s
	iters: 300, epoch: 17 | loss: 0.1815052
	speed: 0.4791s/iter; left time: 3606.3365s
	iters: 400, epoch: 17 | loss: 0.1913282
	speed: 0.4648s/iter; left time: 3452.0103s
	iters: 500, epoch: 17 | loss: 0.1957115
	speed: 0.4709s/iter; left time: 3450.3989s
Epoch: 17 cost time: 267.3980417251587
Epoch: 17, Steps: 559 | Train Loss: 0.1903807 Vali Loss: 0.1802707 Test Loss: 0.2111894
Validation loss decreased (0.180385 --> 0.180271).  Saving model ...
Updating learning rate to 1.52587890625e-09
	iters: 100, epoch: 18 | loss: 0.1671722
	speed: 1.6568s/iter; left time: 11876.2721s
	iters: 200, epoch: 18 | loss: 0.2106864
	speed: 0.4758s/iter; left time: 3363.2179s
	iters: 300, epoch: 18 | loss: 0.2003814
	speed: 0.4724s/iter; left time: 3291.8048s
	iters: 400, epoch: 18 | loss: 0.2008922
	speed: 0.4721s/iter; left time: 3242.2704s
	iters: 500, epoch: 18 | loss: 0.2112103
	speed: 0.4804s/iter; left time: 3251.1256s
Epoch: 18 cost time: 268.0541729927063
Epoch: 18, Steps: 559 | Train Loss: 0.1903568 Vali Loss: 0.1804316 Test Loss: 0.2111885
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.62939453125e-10
	iters: 100, epoch: 19 | loss: 0.1893850
	speed: 1.6165s/iter; left time: 10683.3337s
	iters: 200, epoch: 19 | loss: 0.1809338
	speed: 0.4792s/iter; left time: 3119.0807s
	iters: 300, epoch: 19 | loss: 0.1830972
	speed: 0.4561s/iter; left time: 2922.8755s
	iters: 400, epoch: 19 | loss: 0.1936161
	speed: 0.4604s/iter; left time: 2904.8616s
	iters: 500, epoch: 19 | loss: 0.1716472
	speed: 0.4703s/iter; left time: 2919.8189s
Epoch: 19 cost time: 263.443571805954
Epoch: 19, Steps: 559 | Train Loss: 0.1903852 Vali Loss: 0.1803640 Test Loss: 0.2111883
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.814697265625e-10
	iters: 100, epoch: 20 | loss: 0.2142911
	speed: 1.5986s/iter; left time: 9671.4254s
	iters: 200, epoch: 20 | loss: 0.1684695
	speed: 0.4808s/iter; left time: 2860.7081s
	iters: 300, epoch: 20 | loss: 0.1911741
	speed: 0.4886s/iter; left time: 2858.4291s
	iters: 400, epoch: 20 | loss: 0.1752716
	speed: 0.4879s/iter; left time: 2805.1548s
	iters: 500, epoch: 20 | loss: 0.1979255
	speed: 0.4898s/iter; left time: 2767.4396s
Epoch: 20 cost time: 273.04432916641235
Epoch: 20, Steps: 559 | Train Loss: 0.1903575 Vali Loss: 0.1802481 Test Loss: 0.2111882
Validation loss decreased (0.180271 --> 0.180248).  Saving model ...
Updating learning rate to 1.9073486328125e-10
	iters: 100, epoch: 21 | loss: 0.1784779
	speed: 1.6496s/iter; left time: 9057.9318s
	iters: 200, epoch: 21 | loss: 0.1958961
	speed: 0.4532s/iter; left time: 2443.1891s
	iters: 300, epoch: 21 | loss: 0.1733738
	speed: 0.4781s/iter; left time: 2529.6360s
	iters: 400, epoch: 21 | loss: 0.1944750
	speed: 0.4861s/iter; left time: 2523.1769s
	iters: 500, epoch: 21 | loss: 0.2069744
	speed: 0.4807s/iter; left time: 2447.2236s
Epoch: 21 cost time: 266.96292209625244
Epoch: 21, Steps: 559 | Train Loss: 0.1903539 Vali Loss: 0.1802731 Test Loss: 0.2111882
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.5367431640625e-11
	iters: 100, epoch: 22 | loss: 0.1871179
	speed: 1.5751s/iter; left time: 7768.4905s
	iters: 200, epoch: 22 | loss: 0.1942131
	speed: 0.4585s/iter; left time: 2215.5293s
	iters: 300, epoch: 22 | loss: 0.1738760
	speed: 0.4753s/iter; left time: 2249.3038s
	iters: 400, epoch: 22 | loss: 0.1782650
	speed: 0.4749s/iter; left time: 2199.8704s
	iters: 500, epoch: 22 | loss: 0.1867088
	speed: 0.4649s/iter; left time: 2106.8942s
Epoch: 22 cost time: 263.3543207645416
Epoch: 22, Steps: 559 | Train Loss: 0.1903746 Vali Loss: 0.1803837 Test Loss: 0.2111882
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.76837158203125e-11
	iters: 100, epoch: 23 | loss: 0.1890530
	speed: 1.6309s/iter; left time: 7132.1202s
	iters: 200, epoch: 23 | loss: 0.2012727
	speed: 0.4715s/iter; left time: 2014.9204s
	iters: 300, epoch: 23 | loss: 0.1878166
	speed: 0.4794s/iter; left time: 2000.4562s
	iters: 400, epoch: 23 | loss: 0.1894366
	speed: 0.4801s/iter; left time: 1955.5862s
	iters: 500, epoch: 23 | loss: 0.1798498
	speed: 0.4833s/iter; left time: 1919.9777s
Epoch: 23 cost time: 267.9433603286743
Epoch: 23, Steps: 559 | Train Loss: 0.1903721 Vali Loss: 0.1803139 Test Loss: 0.2111882
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ECL_336_192_TimesNet_custom_ftM_sl336_ll48_pl192_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5069
test shape: (5069, 192, 321) (5069, 192, 321)
test shape: (5069, 192, 321) (5069, 192, 321)
mse:0.21010354161262512, mae:0.3136995732784271, dtw:not calculated
