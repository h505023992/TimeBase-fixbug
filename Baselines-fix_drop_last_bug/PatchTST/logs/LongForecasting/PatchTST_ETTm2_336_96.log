Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='ETTm2', data_path='ETTm2.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='TST', model='PatchTST', model_id='336_96', moving_avg=25, n_heads=16, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.4, pred_len=96, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : 336_96_PatchTST_ETTm2_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.4159779
	speed: 0.1221s/iter; left time: 3236.2152s
	iters: 200, epoch: 1 | loss: 0.3986554
	speed: 0.1212s/iter; left time: 3200.6680s
Epoch: 1 cost time: 32.38655757904053
Epoch: 1, Steps: 266 | Train Loss: 0.3406419 Vali Loss: 0.1469432 Test Loss: 0.2047679
Validation loss decreased (inf --> 0.146943).  Saving model ...
Updating learning rate to 4.147995783958166e-06
	iters: 100, epoch: 2 | loss: 0.2716403
	speed: 0.6571s/iter; left time: 17239.2429s
	iters: 200, epoch: 2 | loss: 0.2881055
	speed: 0.1210s/iter; left time: 3162.0954s
Epoch: 2 cost time: 33.300617933273315
Epoch: 2, Steps: 266 | Train Loss: 0.2697158 Vali Loss: 0.1316582 Test Loss: 0.1841287
Validation loss decreased (0.146943 --> 0.131658).  Saving model ...
Updating learning rate to 4.591070521163098e-06
	iters: 100, epoch: 3 | loss: 0.2425627
	speed: 0.6452s/iter; left time: 16754.3011s
	iters: 200, epoch: 3 | loss: 0.1707354
	speed: 0.1305s/iter; left time: 3374.7587s
Epoch: 3 cost time: 34.56734108924866
Epoch: 3, Steps: 266 | Train Loss: 0.2484540 Vali Loss: 0.1258857 Test Loss: 0.1756364
Validation loss decreased (0.131658 --> 0.125886).  Saving model ...
Updating learning rate to 5.326491995236255e-06
	iters: 100, epoch: 4 | loss: 0.2289676
	speed: 0.7158s/iter; left time: 18398.6625s
	iters: 200, epoch: 4 | loss: 0.2430209
	speed: 0.1325s/iter; left time: 3392.7570s
Epoch: 4 cost time: 36.27600693702698
Epoch: 4, Steps: 266 | Train Loss: 0.2366906 Vali Loss: 0.1227484 Test Loss: 0.1702713
Validation loss decreased (0.125886 --> 0.122748).  Saving model ...
Updating learning rate to 6.349725236277868e-06
	iters: 100, epoch: 5 | loss: 0.2005412
	speed: 0.6836s/iter; left time: 17389.3743s
	iters: 200, epoch: 5 | loss: 0.2412075
	speed: 0.1169s/iter; left time: 2961.3118s
Epoch: 5 cost time: 32.82548451423645
Epoch: 5, Steps: 266 | Train Loss: 0.2293946 Vali Loss: 0.1206474 Test Loss: 0.1668555
Validation loss decreased (0.122748 --> 0.120647).  Saving model ...
Updating learning rate to 7.654460485717921e-06
	iters: 100, epoch: 6 | loss: 0.2360822
	speed: 0.6849s/iter; left time: 17239.6695s
	iters: 200, epoch: 6 | loss: 0.1541380
	speed: 0.1302s/iter; left time: 3264.2796s
Epoch: 6 cost time: 34.687647104263306
Epoch: 6, Steps: 266 | Train Loss: 0.2247372 Vali Loss: 0.1196533 Test Loss: 0.1663388
Validation loss decreased (0.120647 --> 0.119653).  Saving model ...
Updating learning rate to 9.232652105385623e-06
	iters: 100, epoch: 7 | loss: 0.2419590
	speed: 0.6772s/iter; left time: 16864.7534s
	iters: 200, epoch: 7 | loss: 0.2765723
	speed: 0.1272s/iter; left time: 3155.1966s
Epoch: 7 cost time: 34.646507024765015
Epoch: 7, Steps: 266 | Train Loss: 0.2212770 Vali Loss: 0.1198628 Test Loss: 0.1641963
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.1074568190864783e-05
	iters: 100, epoch: 8 | loss: 0.2011000
	speed: 0.6868s/iter; left time: 16923.1464s
	iters: 200, epoch: 8 | loss: 0.2190565
	speed: 0.1274s/iter; left time: 3126.8862s
Epoch: 8 cost time: 34.18845081329346
Epoch: 8, Steps: 266 | Train Loss: 0.2188046 Vali Loss: 0.1185561 Test Loss: 0.1640925
Validation loss decreased (0.119653 --> 0.118556).  Saving model ...
Updating learning rate to 1.316885058319476e-05
	iters: 100, epoch: 9 | loss: 0.1888233
	speed: 0.6930s/iter; left time: 16890.4233s
	iters: 200, epoch: 9 | loss: 0.1692868
	speed: 0.1256s/iter; left time: 3049.3633s
Epoch: 9 cost time: 34.285927295684814
Epoch: 9, Steps: 266 | Train Loss: 0.2167165 Vali Loss: 0.1185007 Test Loss: 0.1633752
Validation loss decreased (0.118556 --> 0.118501).  Saving model ...
Updating learning rate to 1.5502584908855415e-05
	iters: 100, epoch: 10 | loss: 0.1503515
	speed: 0.6922s/iter; left time: 16687.2274s
	iters: 200, epoch: 10 | loss: 0.2039520
	speed: 0.1261s/iter; left time: 3026.5038s
Epoch: 10 cost time: 34.1601197719574
Epoch: 10, Steps: 266 | Train Loss: 0.2149309 Vali Loss: 0.1190974 Test Loss: 0.1638428
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.806138021613527e-05
	iters: 100, epoch: 11 | loss: 0.2035686
	speed: 0.6976s/iter; left time: 16630.4719s
	iters: 200, epoch: 11 | loss: 0.2219639
	speed: 0.1224s/iter; left time: 2906.2541s
Epoch: 11 cost time: 34.092713832855225
Epoch: 11, Steps: 266 | Train Loss: 0.2124980 Vali Loss: 0.1190290 Test Loss: 0.1645273
EarlyStopping counter: 2 out of 20
Updating learning rate to 2.0829457716805565e-05
	iters: 100, epoch: 12 | loss: 0.1923470
	speed: 0.6637s/iter; left time: 15646.4022s
	iters: 200, epoch: 12 | loss: 0.1547503
	speed: 0.1152s/iter; left time: 2704.8043s
Epoch: 12 cost time: 32.57143235206604
Epoch: 12, Steps: 266 | Train Loss: 0.2095814 Vali Loss: 0.1195767 Test Loss: 0.1649374
EarlyStopping counter: 3 out of 20
Updating learning rate to 2.3789748085875986e-05
	iters: 100, epoch: 13 | loss: 0.1690150
	speed: 0.6909s/iter; left time: 16103.4901s
	iters: 200, epoch: 13 | loss: 0.1909709
	speed: 0.1234s/iter; left time: 2863.2728s
Epoch: 13 cost time: 33.744975090026855
Epoch: 13, Steps: 266 | Train Loss: 0.2061646 Vali Loss: 0.1191237 Test Loss: 0.1639008
EarlyStopping counter: 4 out of 20
Updating learning rate to 2.6923996719433387e-05
	iters: 100, epoch: 14 | loss: 0.2322710
	speed: 0.6432s/iter; left time: 14821.3638s
	iters: 200, epoch: 14 | loss: 0.1756967
	speed: 0.1213s/iter; left time: 2783.4591s
Epoch: 14 cost time: 33.50537419319153
Epoch: 14, Steps: 266 | Train Loss: 0.2036009 Vali Loss: 0.1209798 Test Loss: 0.1686081
EarlyStopping counter: 5 out of 20
Updating learning rate to 3.021287630149266e-05
	iters: 100, epoch: 15 | loss: 0.1614006
	speed: 0.6713s/iter; left time: 15290.8731s
	iters: 200, epoch: 15 | loss: 0.2108041
	speed: 0.1222s/iter; left time: 2771.3588s
Epoch: 15 cost time: 33.96589541435242
Epoch: 15, Steps: 266 | Train Loss: 0.2000087 Vali Loss: 0.1221215 Test Loss: 0.1672522
EarlyStopping counter: 6 out of 20
Updating learning rate to 3.363610598571669e-05
	iters: 100, epoch: 16 | loss: 0.2111024
	speed: 0.7239s/iter; left time: 16294.6960s
	iters: 200, epoch: 16 | loss: 0.1624999
	speed: 0.1265s/iter; left time: 2833.9482s
Epoch: 16 cost time: 35.348567962646484
Epoch: 16, Steps: 266 | Train Loss: 0.1970695 Vali Loss: 0.1248842 Test Loss: 0.1694895
EarlyStopping counter: 7 out of 20
Updating learning rate to 3.717257645707274e-05
	iters: 100, epoch: 17 | loss: 0.2080269
	speed: 0.6856s/iter; left time: 15251.4905s
	iters: 200, epoch: 17 | loss: 0.1718073
	speed: 0.1385s/iter; left time: 3065.9988s
Epoch: 17 cost time: 37.42093348503113
Epoch: 17, Steps: 266 | Train Loss: 0.1933571 Vali Loss: 0.1241688 Test Loss: 0.1704096
EarlyStopping counter: 8 out of 20
Updating learning rate to 4.08004801022336e-05
	iters: 100, epoch: 18 | loss: 0.1854625
	speed: 0.7554s/iter; left time: 16601.8831s
	iters: 200, epoch: 18 | loss: 0.1592504
	speed: 0.1304s/iter; left time: 2852.8273s
Epoch: 18 cost time: 35.6209454536438
Epoch: 18, Steps: 266 | Train Loss: 0.1904298 Vali Loss: 0.1243913 Test Loss: 0.1675684
EarlyStopping counter: 9 out of 20
Updating learning rate to 4.4497445486028815e-05
	iters: 100, epoch: 19 | loss: 0.1894241
	speed: 0.6973s/iter; left time: 15140.5148s
	iters: 200, epoch: 19 | loss: 0.1717504
	speed: 0.1302s/iter; left time: 2814.0710s
Epoch: 19 cost time: 36.078388929367065
Epoch: 19, Steps: 266 | Train Loss: 0.1876995 Vali Loss: 0.1272769 Test Loss: 0.1708629
EarlyStopping counter: 10 out of 20
Updating learning rate to 4.8240675304698384e-05
	iters: 100, epoch: 20 | loss: 0.2216654
	speed: 0.7396s/iter; left time: 15861.2332s
	iters: 200, epoch: 20 | loss: 0.1911554
	speed: 0.1323s/iter; left time: 2823.2415s
Epoch: 20 cost time: 35.88584280014038
Epoch: 20, Steps: 266 | Train Loss: 0.1849775 Vali Loss: 0.1266176 Test Loss: 0.1719647
EarlyStopping counter: 11 out of 20
Updating learning rate to 5.2007086965261054e-05
	iters: 100, epoch: 21 | loss: 0.1649449
	speed: 0.7342s/iter; left time: 15550.2344s
	iters: 200, epoch: 21 | loss: 0.1686966
	speed: 0.1375s/iter; left time: 2898.2210s
Epoch: 21 cost time: 37.43560814857483
Epoch: 21, Steps: 266 | Train Loss: 0.1827928 Vali Loss: 0.1283288 Test Loss: 0.1708639
EarlyStopping counter: 12 out of 20
Updating learning rate to 5.5773454924116216e-05
	iters: 100, epoch: 22 | loss: 0.2483468
	speed: 0.6615s/iter; left time: 13835.3255s
	iters: 200, epoch: 22 | loss: 0.1865582
	speed: 0.1116s/iter; left time: 2322.6247s
Epoch: 22 cost time: 31.104028940200806
Epoch: 22, Steps: 266 | Train Loss: 0.1804283 Vali Loss: 0.1284120 Test Loss: 0.1714475
EarlyStopping counter: 13 out of 20
Updating learning rate to 5.95165539071495e-05
	iters: 100, epoch: 23 | loss: 0.1764398
	speed: 0.6474s/iter; left time: 13368.9723s
	iters: 200, epoch: 23 | loss: 0.1831128
	speed: 0.1268s/iter; left time: 2605.2103s
Epoch: 23 cost time: 34.54393529891968
Epoch: 23, Steps: 266 | Train Loss: 0.1783768 Vali Loss: 0.1279215 Test Loss: 0.1722629
EarlyStopping counter: 14 out of 20
Updating learning rate to 6.321330212817643e-05
	iters: 100, epoch: 24 | loss: 0.1551952
	speed: 0.6487s/iter; left time: 13222.7456s
	iters: 200, epoch: 24 | loss: 0.1853004
	speed: 0.1182s/iter; left time: 2396.7964s
Epoch: 24 cost time: 32.264225244522095
Epoch: 24, Steps: 266 | Train Loss: 0.1760963 Vali Loss: 0.1273073 Test Loss: 0.1776118
EarlyStopping counter: 15 out of 20
Updating learning rate to 6.684090362256924e-05
	iters: 100, epoch: 25 | loss: 0.2410393
	speed: 0.6399s/iter; left time: 12871.9088s
	iters: 200, epoch: 25 | loss: 0.1671600
	speed: 0.1160s/iter; left time: 2322.2025s
Epoch: 25 cost time: 31.865540027618408
Epoch: 25, Steps: 266 | Train Loss: 0.1737648 Vali Loss: 0.1290697 Test Loss: 0.1774108
EarlyStopping counter: 16 out of 20
Updating learning rate to 7.037698881836747e-05
	iters: 100, epoch: 26 | loss: 0.1749182
	speed: 0.6506s/iter; left time: 12915.8896s
	iters: 200, epoch: 26 | loss: 0.1443003
	speed: 0.1226s/iter; left time: 2422.2613s
Epoch: 26 cost time: 31.92016100883484
Epoch: 26, Steps: 266 | Train Loss: 0.1714494 Vali Loss: 0.1273315 Test Loss: 0.1775802
EarlyStopping counter: 17 out of 20
Updating learning rate to 7.379975247804219e-05
	iters: 100, epoch: 27 | loss: 0.1531929
	speed: 0.6860s/iter; left time: 13435.7258s
	iters: 200, epoch: 27 | loss: 0.1423861
	speed: 0.1321s/iter; left time: 2574.9044s
Epoch: 27 cost time: 36.03493046760559
Epoch: 27, Steps: 266 | Train Loss: 0.1694055 Vali Loss: 0.1263904 Test Loss: 0.1750228
EarlyStopping counter: 18 out of 20
Updating learning rate to 7.70880881602968e-05
	iters: 100, epoch: 28 | loss: 0.1541161
	speed: 0.7070s/iter; left time: 13659.0925s
	iters: 200, epoch: 28 | loss: 0.1819152
	speed: 0.1337s/iter; left time: 2569.0442s
Epoch: 28 cost time: 36.350305795669556
Epoch: 28, Steps: 266 | Train Loss: 0.1674049 Vali Loss: 0.1291215 Test Loss: 0.1769841
EarlyStopping counter: 19 out of 20
Updating learning rate to 8.02217183727475e-05
	iters: 100, epoch: 29 | loss: 0.1697256
	speed: 0.6407s/iter; left time: 12207.9438s
	iters: 200, epoch: 29 | loss: 0.1364498
	speed: 0.1328s/iter; left time: 2516.8700s
Epoch: 29 cost time: 34.522791385650635
Epoch: 29, Steps: 266 | Train Loss: 0.1656062 Vali Loss: 0.1265785 Test Loss: 0.1794164
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : 336_96_PatchTST_ETTm2_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.16389016807079315, mae:0.25422370433807373, rse:0.3282257318496704
