Args in experiment:
Namespace(is_training=1, train_only=False, model_id='DLinear_electricity_336_192', model='DLinear', data='custom', root_path='./dataset/', data_path='electricity.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=192, individual=False, embed_type=0, enc_in=321, dec_in=321, c_out=321, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DLinear_electricity_336_192_DLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17885
val 2441
test 5069
	iters: 100, epoch: 1 | loss: 0.3199148
	speed: 0.0888s/iter; left time: 1480.5962s
	iters: 200, epoch: 1 | loss: 0.2665874
	speed: 0.0652s/iter; left time: 1079.8030s
	iters: 300, epoch: 1 | loss: 0.2586839
	speed: 0.0601s/iter; left time: 989.8613s
	iters: 400, epoch: 1 | loss: 0.2313490
	speed: 0.0590s/iter; left time: 966.6038s
	iters: 500, epoch: 1 | loss: 0.2114204
	speed: 0.0583s/iter; left time: 949.1898s
Epoch: 1 cost time: 36.61576008796692
Epoch: 1, Steps: 559 | Train Loss: 0.3022889 Vali Loss: 0.1830256 Test Loss: 0.2092952
Validation loss decreased (inf --> 0.183026).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1905873
	speed: 0.4475s/iter; left time: 7210.6209s
	iters: 200, epoch: 2 | loss: 0.1977302
	speed: 0.0715s/iter; left time: 1144.7707s
	iters: 300, epoch: 2 | loss: 0.1786458
	speed: 0.0724s/iter; left time: 1151.3446s
	iters: 400, epoch: 2 | loss: 0.1925575
	speed: 0.0700s/iter; left time: 1107.1462s
	iters: 500, epoch: 2 | loss: 0.1819908
	speed: 0.0686s/iter; left time: 1078.2763s
Epoch: 2 cost time: 40.914175033569336
Epoch: 2, Steps: 559 | Train Loss: 0.1936836 Vali Loss: 0.1587205 Test Loss: 0.1834233
Validation loss decreased (0.183026 --> 0.158720).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1864236
	speed: 0.4713s/iter; left time: 7329.5598s
	iters: 200, epoch: 3 | loss: 0.1920826
	speed: 0.0575s/iter; left time: 888.2690s
	iters: 300, epoch: 3 | loss: 0.1916047
	speed: 0.0590s/iter; left time: 906.4302s
	iters: 400, epoch: 3 | loss: 0.1981772
	speed: 0.0588s/iter; left time: 897.1280s
	iters: 500, epoch: 3 | loss: 0.1680413
	speed: 0.0572s/iter; left time: 867.2303s
Epoch: 3 cost time: 34.18735122680664
Epoch: 3, Steps: 559 | Train Loss: 0.1795345 Vali Loss: 0.1520614 Test Loss: 0.1764979
Validation loss decreased (0.158720 --> 0.152061).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1760406
	speed: 0.3874s/iter; left time: 5808.9853s
	iters: 200, epoch: 4 | loss: 0.1625350
	speed: 0.0582s/iter; left time: 866.9643s
	iters: 300, epoch: 4 | loss: 0.1820188
	speed: 0.0595s/iter; left time: 879.9015s
	iters: 400, epoch: 4 | loss: 0.1765157
	speed: 0.0605s/iter; left time: 888.3235s
	iters: 500, epoch: 4 | loss: 0.1639254
	speed: 0.0594s/iter; left time: 866.8916s
Epoch: 4 cost time: 34.49084186553955
Epoch: 4, Steps: 559 | Train Loss: 0.1749634 Vali Loss: 0.1495697 Test Loss: 0.1739092
Validation loss decreased (0.152061 --> 0.149570).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1753014
	speed: 0.4217s/iter; left time: 6086.9154s
	iters: 200, epoch: 5 | loss: 0.1602248
	speed: 0.0582s/iter; left time: 834.2207s
	iters: 300, epoch: 5 | loss: 0.1974916
	speed: 0.0587s/iter; left time: 835.3507s
	iters: 400, epoch: 5 | loss: 0.1538205
	speed: 0.0592s/iter; left time: 837.0253s
	iters: 500, epoch: 5 | loss: 0.1589986
	speed: 0.0596s/iter; left time: 836.5938s
Epoch: 5 cost time: 34.344964265823364
Epoch: 5, Steps: 559 | Train Loss: 0.1729008 Vali Loss: 0.1480961 Test Loss: 0.1725658
Validation loss decreased (0.149570 --> 0.148096).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1782881
	speed: 0.4233s/iter; left time: 5874.3423s
	iters: 200, epoch: 6 | loss: 0.1577193
	speed: 0.0595s/iter; left time: 819.6469s
	iters: 300, epoch: 6 | loss: 0.1670995
	speed: 0.0562s/iter; left time: 768.8345s
	iters: 400, epoch: 6 | loss: 0.1785834
	speed: 0.0562s/iter; left time: 762.8147s
	iters: 500, epoch: 6 | loss: 0.1794520
	speed: 0.0542s/iter; left time: 730.4204s
Epoch: 6 cost time: 33.35407876968384
Epoch: 6, Steps: 559 | Train Loss: 0.1718688 Vali Loss: 0.1475057 Test Loss: 0.1717633
Validation loss decreased (0.148096 --> 0.147506).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1515102
	speed: 0.4240s/iter; left time: 5646.0708s
	iters: 200, epoch: 7 | loss: 0.1710817
	speed: 0.0593s/iter; left time: 783.9109s
	iters: 300, epoch: 7 | loss: 0.1785630
	speed: 0.0619s/iter; left time: 811.4519s
	iters: 400, epoch: 7 | loss: 0.1672581
	speed: 0.0630s/iter; left time: 819.6119s
	iters: 500, epoch: 7 | loss: 0.1707081
	speed: 0.0640s/iter; left time: 826.2486s
Epoch: 7 cost time: 36.20650386810303
Epoch: 7, Steps: 559 | Train Loss: 0.1713304 Vali Loss: 0.1472143 Test Loss: 0.1714067
Validation loss decreased (0.147506 --> 0.147214).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1635418
	speed: 0.4938s/iter; left time: 6299.8152s
	iters: 200, epoch: 8 | loss: 0.1641380
	speed: 0.0657s/iter; left time: 832.0473s
	iters: 300, epoch: 8 | loss: 0.1680952
	speed: 0.0646s/iter; left time: 811.4771s
	iters: 400, epoch: 8 | loss: 0.1489948
	speed: 0.0693s/iter; left time: 863.4621s
	iters: 500, epoch: 8 | loss: 0.1775381
	speed: 0.0673s/iter; left time: 832.1200s
Epoch: 8 cost time: 38.985835790634155
Epoch: 8, Steps: 559 | Train Loss: 0.1710447 Vali Loss: 0.1469011 Test Loss: 0.1711971
Validation loss decreased (0.147214 --> 0.146901).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1640953
	speed: 0.4434s/iter; left time: 5409.4980s
	iters: 200, epoch: 9 | loss: 0.1529205
	speed: 0.0662s/iter; left time: 801.4258s
	iters: 300, epoch: 9 | loss: 0.1855018
	speed: 0.0642s/iter; left time: 770.6463s
	iters: 400, epoch: 9 | loss: 0.1752357
	speed: 0.0643s/iter; left time: 765.5850s
	iters: 500, epoch: 9 | loss: 0.1647245
	speed: 0.0657s/iter; left time: 775.4588s
Epoch: 9 cost time: 37.61644101142883
Epoch: 9, Steps: 559 | Train Loss: 0.1708883 Vali Loss: 0.1468358 Test Loss: 0.1711011
Validation loss decreased (0.146901 --> 0.146836).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1806374
	speed: 0.4232s/iter; left time: 4926.1515s
	iters: 200, epoch: 10 | loss: 0.1682044
	speed: 0.0558s/iter; left time: 643.8588s
	iters: 300, epoch: 10 | loss: 0.1701529
	speed: 0.0528s/iter; left time: 604.2093s
	iters: 400, epoch: 10 | loss: 0.1745205
	speed: 0.0539s/iter; left time: 611.3565s
	iters: 500, epoch: 10 | loss: 0.1732214
	speed: 0.0536s/iter; left time: 602.1791s
Epoch: 10 cost time: 31.63174605369568
Epoch: 10, Steps: 559 | Train Loss: 0.1708100 Vali Loss: 0.1469235 Test Loss: 0.1710561
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1597463
	speed: 0.3595s/iter; left time: 3983.9398s
	iters: 200, epoch: 11 | loss: 0.1916334
	speed: 0.0584s/iter; left time: 641.5488s
	iters: 300, epoch: 11 | loss: 0.1874719
	speed: 0.0607s/iter; left time: 660.5171s
	iters: 400, epoch: 11 | loss: 0.1759901
	speed: 0.0606s/iter; left time: 653.1184s
	iters: 500, epoch: 11 | loss: 0.1739501
	speed: 0.0614s/iter; left time: 655.8924s
Epoch: 11 cost time: 34.742635011672974
Epoch: 11, Steps: 559 | Train Loss: 0.1707712 Vali Loss: 0.1467847 Test Loss: 0.1710289
Validation loss decreased (0.146836 --> 0.146785).  Saving model ...
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1665256
	speed: 0.4480s/iter; left time: 4713.6523s
	iters: 200, epoch: 12 | loss: 0.1736681
	speed: 0.0642s/iter; left time: 669.5493s
	iters: 300, epoch: 12 | loss: 0.1867832
	speed: 0.0647s/iter; left time: 668.0341s
	iters: 400, epoch: 12 | loss: 0.1734980
	speed: 0.0662s/iter; left time: 677.0575s
	iters: 500, epoch: 12 | loss: 0.1726983
	speed: 0.0623s/iter; left time: 630.4738s
Epoch: 12 cost time: 37.51744365692139
Epoch: 12, Steps: 559 | Train Loss: 0.1707543 Vali Loss: 0.1467821 Test Loss: 0.1710144
Validation loss decreased (0.146785 --> 0.146782).  Saving model ...
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.1603985
	speed: 0.4478s/iter; left time: 4461.0870s
	iters: 200, epoch: 13 | loss: 0.1952545
	speed: 0.0604s/iter; left time: 595.9795s
	iters: 300, epoch: 13 | loss: 0.1543984
	speed: 0.0627s/iter; left time: 612.5274s
	iters: 400, epoch: 13 | loss: 0.1575419
	speed: 0.0592s/iter; left time: 571.6704s
	iters: 500, epoch: 13 | loss: 0.1971212
	speed: 0.0584s/iter; left time: 558.2552s
Epoch: 13 cost time: 34.87975311279297
Epoch: 13, Steps: 559 | Train Loss: 0.1707399 Vali Loss: 0.1468082 Test Loss: 0.1710073
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.1701040
	speed: 0.3714s/iter; left time: 3492.2484s
	iters: 200, epoch: 14 | loss: 0.1692399
	speed: 0.0526s/iter; left time: 489.3833s
	iters: 300, epoch: 14 | loss: 0.1625263
	speed: 0.0551s/iter; left time: 506.7381s
	iters: 400, epoch: 14 | loss: 0.1700824
	speed: 0.0549s/iter; left time: 500.1011s
	iters: 500, epoch: 14 | loss: 0.1781623
	speed: 0.0514s/iter; left time: 463.0692s
Epoch: 14 cost time: 31.446772575378418
Epoch: 14, Steps: 559 | Train Loss: 0.1707328 Vali Loss: 0.1469336 Test Loss: 0.1710038
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.220703125e-08
	iters: 100, epoch: 15 | loss: 0.1869701
	speed: 0.4523s/iter; left time: 4000.2269s
	iters: 200, epoch: 15 | loss: 0.1709121
	speed: 0.0717s/iter; left time: 627.4309s
	iters: 300, epoch: 15 | loss: 0.1628012
	speed: 0.0716s/iter; left time: 618.9846s
	iters: 400, epoch: 15 | loss: 0.1794812
	speed: 0.0706s/iter; left time: 603.3633s
	iters: 500, epoch: 15 | loss: 0.1818280
	speed: 0.0689s/iter; left time: 582.0527s
Epoch: 15 cost time: 40.114569664001465
Epoch: 15, Steps: 559 | Train Loss: 0.1707311 Vali Loss: 0.1466624 Test Loss: 0.1710021
Validation loss decreased (0.146782 --> 0.146662).  Saving model ...
Updating learning rate to 6.103515625e-09
	iters: 100, epoch: 16 | loss: 0.1808026
	speed: 0.4502s/iter; left time: 3730.2823s
	iters: 200, epoch: 16 | loss: 0.1683059
	speed: 0.0637s/iter; left time: 521.6969s
	iters: 300, epoch: 16 | loss: 0.1590783
	speed: 0.0642s/iter; left time: 519.4292s
	iters: 400, epoch: 16 | loss: 0.1701421
	speed: 0.0732s/iter; left time: 584.8293s
	iters: 500, epoch: 16 | loss: 0.1636082
	speed: 0.0712s/iter; left time: 561.4868s
Epoch: 16 cost time: 39.346694469451904
Epoch: 16, Steps: 559 | Train Loss: 0.1707314 Vali Loss: 0.1467259 Test Loss: 0.1710012
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.0517578125e-09
	iters: 100, epoch: 17 | loss: 0.1669371
	speed: 0.4642s/iter; left time: 3587.2214s
	iters: 200, epoch: 17 | loss: 0.1814094
	speed: 0.0611s/iter; left time: 465.7024s
	iters: 300, epoch: 17 | loss: 0.1588931
	speed: 0.0607s/iter; left time: 456.8726s
	iters: 400, epoch: 17 | loss: 0.1848392
	speed: 0.0597s/iter; left time: 443.6486s
	iters: 500, epoch: 17 | loss: 0.1852251
	speed: 0.0588s/iter; left time: 430.6177s
Epoch: 17 cost time: 35.42685389518738
Epoch: 17, Steps: 559 | Train Loss: 0.1707284 Vali Loss: 0.1467931 Test Loss: 0.1710010
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.52587890625e-09
	iters: 100, epoch: 18 | loss: 0.1640845
	speed: 0.4229s/iter; left time: 3031.4616s
	iters: 200, epoch: 18 | loss: 0.1878409
	speed: 0.0615s/iter; left time: 434.4884s
	iters: 300, epoch: 18 | loss: 0.1856740
	speed: 0.0650s/iter; left time: 453.1868s
	iters: 400, epoch: 18 | loss: 0.1612659
	speed: 0.0638s/iter; left time: 438.0253s
	iters: 500, epoch: 18 | loss: 0.1567034
	speed: 0.0646s/iter; left time: 437.1793s
Epoch: 18 cost time: 37.06631422042847
Epoch: 18, Steps: 559 | Train Loss: 0.1707316 Vali Loss: 0.1469042 Test Loss: 0.1710009
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : DLinear_electricity_336_192_DLinear_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5069
mse:0.1698760986328125, mae:0.2731160819530487
