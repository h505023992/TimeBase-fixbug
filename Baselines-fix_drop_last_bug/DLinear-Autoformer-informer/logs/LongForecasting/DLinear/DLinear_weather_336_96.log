Args in experiment:
Namespace(is_training=1, train_only=False, model_id='DLinear_weather_336_96', model='DLinear', data='custom', root_path='./dataset/', data_path='weather.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, individual=False, embed_type=0, enc_in=21, dec_in=21, c_out=21, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DLinear_weather_336_96_DLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.5060937
	speed: 0.0402s/iter; left time: 1370.2774s
	iters: 200, epoch: 1 | loss: 0.5213353
	speed: 0.0214s/iter; left time: 727.9275s
	iters: 300, epoch: 1 | loss: 0.3467326
	speed: 0.0217s/iter; left time: 734.2737s
	iters: 400, epoch: 1 | loss: 0.3657112
	speed: 0.0210s/iter; left time: 711.3453s
	iters: 500, epoch: 1 | loss: 0.5118848
	speed: 0.0215s/iter; left time: 722.9164s
	iters: 600, epoch: 1 | loss: 1.2652475
	speed: 0.0227s/iter; left time: 761.8124s
	iters: 700, epoch: 1 | loss: 0.7462632
	speed: 0.0225s/iter; left time: 755.3312s
	iters: 800, epoch: 1 | loss: 0.4192847
	speed: 0.0200s/iter; left time: 669.6773s
	iters: 900, epoch: 1 | loss: 1.3854060
	speed: 0.0220s/iter; left time: 733.2035s
	iters: 1000, epoch: 1 | loss: 1.2644114
	speed: 0.0219s/iter; left time: 727.2545s
	iters: 1100, epoch: 1 | loss: 0.4000213
	speed: 0.0233s/iter; left time: 770.9285s
Epoch: 1 cost time: 26.766386032104492
Epoch: 1, Steps: 1140 | Train Loss: 0.5302903 Vali Loss: 0.4413881 Test Loss: 0.1810692
Validation loss decreased (inf --> 0.441388).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4714339
	speed: 0.2308s/iter; left time: 7607.3484s
	iters: 200, epoch: 2 | loss: 0.6335492
	speed: 0.0233s/iter; left time: 764.5911s
	iters: 300, epoch: 2 | loss: 1.2836032
	speed: 0.0239s/iter; left time: 783.8635s
	iters: 400, epoch: 2 | loss: 0.3744248
	speed: 0.0221s/iter; left time: 722.8895s
	iters: 500, epoch: 2 | loss: 0.2999069
	speed: 0.0222s/iter; left time: 723.5921s
	iters: 600, epoch: 2 | loss: 1.3966901
	speed: 0.0225s/iter; left time: 730.2799s
	iters: 700, epoch: 2 | loss: 0.4146201
	speed: 0.0212s/iter; left time: 685.4833s
	iters: 800, epoch: 2 | loss: 1.1609783
	speed: 0.0199s/iter; left time: 642.7311s
	iters: 900, epoch: 2 | loss: 0.3472725
	speed: 0.0208s/iter; left time: 667.9558s
	iters: 1000, epoch: 2 | loss: 0.3002764
	speed: 0.0197s/iter; left time: 631.0354s
	iters: 1100, epoch: 2 | loss: 0.3813936
	speed: 0.0215s/iter; left time: 687.6485s
Epoch: 2 cost time: 25.560967683792114
Epoch: 2, Steps: 1140 | Train Loss: 0.4708591 Vali Loss: 0.4304238 Test Loss: 0.1766789
Validation loss decreased (0.441388 --> 0.430424).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 1.4351447
	speed: 0.2212s/iter; left time: 7039.6712s
	iters: 200, epoch: 3 | loss: 0.7332262
	speed: 0.0265s/iter; left time: 840.3839s
	iters: 300, epoch: 3 | loss: 0.4009566
	speed: 0.0258s/iter; left time: 816.1748s
	iters: 400, epoch: 3 | loss: 1.2488248
	speed: 0.0246s/iter; left time: 775.2365s
	iters: 500, epoch: 3 | loss: 0.3987482
	speed: 0.0273s/iter; left time: 857.1867s
	iters: 600, epoch: 3 | loss: 0.4465708
	speed: 0.0261s/iter; left time: 817.0664s
	iters: 700, epoch: 3 | loss: 1.2717874
	speed: 0.0322s/iter; left time: 1003.7594s
	iters: 800, epoch: 3 | loss: 0.3334693
	speed: 0.0304s/iter; left time: 945.4476s
	iters: 900, epoch: 3 | loss: 1.2507265
	speed: 0.0291s/iter; left time: 902.5629s
	iters: 1000, epoch: 3 | loss: 0.3000230
	speed: 0.0308s/iter; left time: 951.6438s
	iters: 1100, epoch: 3 | loss: 1.4205139
	speed: 0.0289s/iter; left time: 890.3241s
Epoch: 3 cost time: 32.57842206954956
Epoch: 3, Steps: 1140 | Train Loss: 0.4628274 Vali Loss: 0.4303053 Test Loss: 0.1763983
Validation loss decreased (0.430424 --> 0.430305).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3461544
	speed: 0.3463s/iter; left time: 10624.4293s
	iters: 200, epoch: 4 | loss: 0.3591311
	speed: 0.0315s/iter; left time: 963.7324s
	iters: 300, epoch: 4 | loss: 0.3186882
	speed: 0.0313s/iter; left time: 954.1946s
	iters: 400, epoch: 4 | loss: 0.3573930
	speed: 0.0268s/iter; left time: 812.7376s
	iters: 500, epoch: 4 | loss: 0.5288848
	speed: 0.0312s/iter; left time: 943.8862s
	iters: 600, epoch: 4 | loss: 0.3315392
	speed: 0.0313s/iter; left time: 945.1669s
	iters: 700, epoch: 4 | loss: 1.2764001
	speed: 0.0318s/iter; left time: 956.6750s
	iters: 800, epoch: 4 | loss: 0.3623713
	speed: 0.0307s/iter; left time: 921.3393s
	iters: 900, epoch: 4 | loss: 0.3530191
	speed: 0.0293s/iter; left time: 874.8914s
	iters: 1000, epoch: 4 | loss: 0.4096623
	speed: 0.0288s/iter; left time: 857.2966s
	iters: 1100, epoch: 4 | loss: 0.5214106
	speed: 0.0303s/iter; left time: 900.7056s
Epoch: 4 cost time: 35.31541323661804
Epoch: 4, Steps: 1140 | Train Loss: 0.4599223 Vali Loss: 0.4284749 Test Loss: 0.1764722
Validation loss decreased (0.430305 --> 0.428475).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.6167109
	speed: 0.3155s/iter; left time: 9319.4248s
	iters: 200, epoch: 5 | loss: 0.3026373
	speed: 0.0277s/iter; left time: 815.8038s
	iters: 300, epoch: 5 | loss: 0.2926111
	speed: 0.0312s/iter; left time: 915.8571s
	iters: 400, epoch: 5 | loss: 0.2642868
	speed: 0.0291s/iter; left time: 852.2761s
	iters: 500, epoch: 5 | loss: 0.2850108
	speed: 0.0248s/iter; left time: 721.9245s
	iters: 600, epoch: 5 | loss: 0.3897022
	speed: 0.0204s/iter; left time: 591.8370s
	iters: 700, epoch: 5 | loss: 0.5246308
	speed: 0.0222s/iter; left time: 641.8474s
	iters: 800, epoch: 5 | loss: 0.4110612
	speed: 0.0212s/iter; left time: 610.5919s
	iters: 900, epoch: 5 | loss: 0.2467559
	speed: 0.0228s/iter; left time: 656.5405s
	iters: 1000, epoch: 5 | loss: 0.3278229
	speed: 0.0213s/iter; left time: 610.0766s
	iters: 1100, epoch: 5 | loss: 0.3301439
	speed: 0.0219s/iter; left time: 624.5591s
Epoch: 5 cost time: 28.320709466934204
Epoch: 5, Steps: 1140 | Train Loss: 0.4587290 Vali Loss: 0.4286278 Test Loss: 0.1752205
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4693735
	speed: 0.2265s/iter; left time: 6434.0157s
	iters: 200, epoch: 6 | loss: 0.3620685
	speed: 0.0219s/iter; left time: 619.3383s
	iters: 300, epoch: 6 | loss: 0.2840980
	speed: 0.0216s/iter; left time: 608.0022s
	iters: 400, epoch: 6 | loss: 0.3112893
	speed: 0.0189s/iter; left time: 531.3840s
	iters: 500, epoch: 6 | loss: 0.5355679
	speed: 0.0251s/iter; left time: 703.9442s
	iters: 600, epoch: 6 | loss: 0.4160801
	speed: 0.0214s/iter; left time: 596.6085s
	iters: 700, epoch: 6 | loss: 0.3563577
	speed: 0.0220s/iter; left time: 611.6269s
	iters: 800, epoch: 6 | loss: 0.5919837
	speed: 0.0210s/iter; left time: 581.6092s
	iters: 900, epoch: 6 | loss: 0.2669205
	speed: 0.0209s/iter; left time: 575.8404s
	iters: 1000, epoch: 6 | loss: 0.3076655
	speed: 0.0196s/iter; left time: 539.6666s
	iters: 1100, epoch: 6 | loss: 0.3355023
	speed: 0.0221s/iter; left time: 605.6785s
Epoch: 6 cost time: 24.90648865699768
Epoch: 6, Steps: 1140 | Train Loss: 0.4582693 Vali Loss: 0.4279292 Test Loss: 0.1755911
Validation loss decreased (0.428475 --> 0.427929).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.5001708
	speed: 0.2464s/iter; left time: 6716.2525s
	iters: 200, epoch: 7 | loss: 0.3433461
	speed: 0.0244s/iter; left time: 661.5077s
	iters: 300, epoch: 7 | loss: 0.3340246
	speed: 0.0233s/iter; left time: 629.7730s
	iters: 400, epoch: 7 | loss: 0.3969350
	speed: 0.0262s/iter; left time: 706.9185s
	iters: 500, epoch: 7 | loss: 0.4175212
	speed: 0.0266s/iter; left time: 714.4602s
	iters: 600, epoch: 7 | loss: 0.5324413
	speed: 0.0270s/iter; left time: 722.8563s
	iters: 700, epoch: 7 | loss: 0.2266470
	speed: 0.0275s/iter; left time: 733.0305s
	iters: 800, epoch: 7 | loss: 0.5338405
	speed: 0.0272s/iter; left time: 721.2592s
	iters: 900, epoch: 7 | loss: 0.3305454
	speed: 0.0286s/iter; left time: 756.2000s
	iters: 1000, epoch: 7 | loss: 0.2998676
	speed: 0.0276s/iter; left time: 727.9067s
	iters: 1100, epoch: 7 | loss: 0.4387313
	speed: 0.0282s/iter; left time: 741.3491s
Epoch: 7 cost time: 30.954001665115356
Epoch: 7, Steps: 1140 | Train Loss: 0.4579534 Vali Loss: 0.4284246 Test Loss: 0.1752142
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3755136
	speed: 0.2177s/iter; left time: 5686.2847s
	iters: 200, epoch: 8 | loss: 0.3527638
	speed: 0.0215s/iter; left time: 558.4801s
	iters: 300, epoch: 8 | loss: 0.5570977
	speed: 0.0249s/iter; left time: 645.2593s
	iters: 400, epoch: 8 | loss: 1.4946189
	speed: 0.0245s/iter; left time: 632.0912s
	iters: 500, epoch: 8 | loss: 0.5507399
	speed: 0.0217s/iter; left time: 556.8688s
	iters: 600, epoch: 8 | loss: 0.6000334
	speed: 0.0244s/iter; left time: 624.3832s
	iters: 700, epoch: 8 | loss: 0.3024465
	speed: 0.0218s/iter; left time: 556.2817s
	iters: 800, epoch: 8 | loss: 0.4954618
	speed: 0.0206s/iter; left time: 523.1806s
	iters: 900, epoch: 8 | loss: 0.4049783
	speed: 0.0269s/iter; left time: 681.2589s
	iters: 1000, epoch: 8 | loss: 0.3358402
	speed: 0.0258s/iter; left time: 650.1926s
	iters: 1100, epoch: 8 | loss: 0.4138687
	speed: 0.0257s/iter; left time: 646.1647s
Epoch: 8 cost time: 27.74502992630005
Epoch: 8, Steps: 1140 | Train Loss: 0.4577038 Vali Loss: 0.4278318 Test Loss: 0.1754594
Validation loss decreased (0.427929 --> 0.427832).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3659747
	speed: 0.2817s/iter; left time: 7036.1524s
	iters: 200, epoch: 9 | loss: 0.2878504
	speed: 0.0251s/iter; left time: 625.0192s
	iters: 300, epoch: 9 | loss: 0.5269492
	speed: 0.0265s/iter; left time: 657.7405s
	iters: 400, epoch: 9 | loss: 0.3076447
	speed: 0.0254s/iter; left time: 626.1622s
	iters: 500, epoch: 9 | loss: 0.3716968
	speed: 0.0251s/iter; left time: 617.6430s
	iters: 600, epoch: 9 | loss: 0.3774419
	speed: 0.0251s/iter; left time: 613.4242s
	iters: 700, epoch: 9 | loss: 0.4495350
	speed: 0.0249s/iter; left time: 606.2663s
	iters: 800, epoch: 9 | loss: 0.4300926
	speed: 0.0222s/iter; left time: 539.9634s
	iters: 900, epoch: 9 | loss: 0.6401944
	speed: 0.0291s/iter; left time: 704.3823s
	iters: 1000, epoch: 9 | loss: 0.3081874
	speed: 0.0326s/iter; left time: 784.5982s
	iters: 1100, epoch: 9 | loss: 0.2141908
	speed: 0.0359s/iter; left time: 861.6289s
Epoch: 9 cost time: 31.920856714248657
Epoch: 9, Steps: 1140 | Train Loss: 0.4575935 Vali Loss: 0.4280815 Test Loss: 0.1752564
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.4208480
	speed: 0.4050s/iter; left time: 9656.2417s
	iters: 200, epoch: 10 | loss: 0.3917173
	speed: 0.0407s/iter; left time: 965.2260s
	iters: 300, epoch: 10 | loss: 0.3545093
	speed: 0.0402s/iter; left time: 950.3976s
	iters: 400, epoch: 10 | loss: 0.5305523
	speed: 0.0386s/iter; left time: 908.7606s
	iters: 500, epoch: 10 | loss: 0.5616171
	speed: 0.0370s/iter; left time: 868.3260s
	iters: 600, epoch: 10 | loss: 0.5385779
	speed: 0.0381s/iter; left time: 890.1249s
	iters: 700, epoch: 10 | loss: 0.3225676
	speed: 0.0388s/iter; left time: 902.6739s
	iters: 800, epoch: 10 | loss: 0.4646038
	speed: 0.0377s/iter; left time: 873.3473s
	iters: 900, epoch: 10 | loss: 0.4047899
	speed: 0.0398s/iter; left time: 916.1309s
	iters: 1000, epoch: 10 | loss: 0.3268312
	speed: 0.0381s/iter; left time: 873.8621s
	iters: 1100, epoch: 10 | loss: 0.3410972
	speed: 0.0395s/iter; left time: 901.8851s
Epoch: 10 cost time: 45.044960021972656
Epoch: 10, Steps: 1140 | Train Loss: 0.4575191 Vali Loss: 0.4280237 Test Loss: 0.1753054
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 1.2469707
	speed: 0.4615s/iter; left time: 10477.4044s
	iters: 200, epoch: 11 | loss: 1.3327502
	speed: 0.0421s/iter; left time: 951.4334s
	iters: 300, epoch: 11 | loss: 0.3009503
	speed: 0.0392s/iter; left time: 881.2835s
	iters: 400, epoch: 11 | loss: 0.3005692
	speed: 0.0404s/iter; left time: 905.6139s
	iters: 500, epoch: 11 | loss: 0.3439636
	speed: 0.0401s/iter; left time: 893.9255s
	iters: 600, epoch: 11 | loss: 0.2839051
	speed: 0.0356s/iter; left time: 790.6260s
	iters: 700, epoch: 11 | loss: 0.4009044
	speed: 0.0351s/iter; left time: 776.0481s
	iters: 800, epoch: 11 | loss: 0.3715785
	speed: 0.0357s/iter; left time: 784.9531s
	iters: 900, epoch: 11 | loss: 0.4133161
	speed: 0.0371s/iter; left time: 812.5585s
	iters: 1000, epoch: 11 | loss: 0.3667368
	speed: 0.0382s/iter; left time: 833.2274s
	iters: 1100, epoch: 11 | loss: 1.7016293
	speed: 0.0365s/iter; left time: 791.0361s
Epoch: 11 cost time: 44.22062635421753
Epoch: 11, Steps: 1140 | Train Loss: 0.4575326 Vali Loss: 0.4274732 Test Loss: 0.1753156
Validation loss decreased (0.427832 --> 0.427473).  Saving model ...
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.3300997
	speed: 0.3923s/iter; left time: 8459.3650s
	iters: 200, epoch: 12 | loss: 0.2919686
	speed: 0.0318s/iter; left time: 681.9209s
	iters: 300, epoch: 12 | loss: 0.3230564
	speed: 0.0328s/iter; left time: 700.0867s
	iters: 400, epoch: 12 | loss: 0.3696139
	speed: 0.0337s/iter; left time: 717.4463s
	iters: 500, epoch: 12 | loss: 0.4541376
	speed: 0.0325s/iter; left time: 688.2786s
	iters: 600, epoch: 12 | loss: 0.5916623
	speed: 0.0338s/iter; left time: 712.6290s
	iters: 700, epoch: 12 | loss: 0.3137599
	speed: 0.0306s/iter; left time: 640.9820s
	iters: 800, epoch: 12 | loss: 0.5183731
	speed: 0.0308s/iter; left time: 642.6918s
	iters: 900, epoch: 12 | loss: 1.2266914
	speed: 0.0373s/iter; left time: 774.6125s
	iters: 1000, epoch: 12 | loss: 0.2983178
	speed: 0.0361s/iter; left time: 745.4130s
	iters: 1100, epoch: 12 | loss: 0.4851641
	speed: 0.0351s/iter; left time: 722.0749s
Epoch: 12 cost time: 39.076173067092896
Epoch: 12, Steps: 1140 | Train Loss: 0.4575618 Vali Loss: 0.4280366 Test Loss: 0.1753213
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 1.3000019
	speed: 0.4494s/iter; left time: 9177.2619s
	iters: 200, epoch: 13 | loss: 0.3109176
	speed: 0.0349s/iter; left time: 709.7076s
	iters: 300, epoch: 13 | loss: 1.3055518
	speed: 0.0354s/iter; left time: 715.3789s
	iters: 400, epoch: 13 | loss: 0.4750624
	speed: 0.0349s/iter; left time: 702.6820s
	iters: 500, epoch: 13 | loss: 0.3816230
	speed: 0.0333s/iter; left time: 665.8368s
	iters: 600, epoch: 13 | loss: 0.4547953
	speed: 0.0325s/iter; left time: 647.2619s
	iters: 700, epoch: 13 | loss: 0.3903876
	speed: 0.0341s/iter; left time: 676.3214s
	iters: 800, epoch: 13 | loss: 0.2975452
	speed: 0.0342s/iter; left time: 673.9045s
	iters: 900, epoch: 13 | loss: 0.3231729
	speed: 0.0339s/iter; left time: 665.8647s
	iters: 1000, epoch: 13 | loss: 0.6320058
	speed: 0.0346s/iter; left time: 675.7365s
	iters: 1100, epoch: 13 | loss: 0.2974013
	speed: 0.0338s/iter; left time: 656.2863s
Epoch: 13 cost time: 39.78354787826538
Epoch: 13, Steps: 1140 | Train Loss: 0.4575391 Vali Loss: 0.4279779 Test Loss: 0.1753221
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.2924434
	speed: 0.4135s/iter; left time: 7973.4561s
	iters: 200, epoch: 14 | loss: 0.2191943
	speed: 0.0364s/iter; left time: 698.2828s
	iters: 300, epoch: 14 | loss: 0.2907628
	speed: 0.0377s/iter; left time: 718.5532s
	iters: 400, epoch: 14 | loss: 0.3880272
	speed: 0.0385s/iter; left time: 730.9094s
	iters: 500, epoch: 14 | loss: 0.4953354
	speed: 0.0386s/iter; left time: 728.4877s
	iters: 600, epoch: 14 | loss: 0.2457236
	speed: 0.0379s/iter; left time: 711.0725s
	iters: 700, epoch: 14 | loss: 0.2868178
	speed: 0.0375s/iter; left time: 700.3346s
	iters: 800, epoch: 14 | loss: 0.5912511
	speed: 0.0407s/iter; left time: 755.6307s
	iters: 900, epoch: 14 | loss: 0.3110905
	speed: 0.0406s/iter; left time: 750.6354s
	iters: 1000, epoch: 14 | loss: 0.4305497
	speed: 0.0379s/iter; left time: 696.9334s
	iters: 1100, epoch: 14 | loss: 0.2470388
	speed: 0.0356s/iter; left time: 649.9738s
Epoch: 14 cost time: 43.86349940299988
Epoch: 14, Steps: 1140 | Train Loss: 0.4574718 Vali Loss: 0.4275370 Test Loss: 0.1753237
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : DLinear_weather_336_96_DLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
mse:0.17556056380271912, mae:0.2361902892589569
