True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           traffic_192_192     Model:              TimesNet            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/          
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            192                 Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         8                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_traffic_192_192_TimesNet_custom_ftM_sl192_ll48_pl192_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11897
val 1565
test 3317
	iters: 100, epoch: 1 | loss: 0.7006950
	speed: 0.2658s/iter; left time: 11838.1619s
	iters: 200, epoch: 1 | loss: 0.5481424
	speed: 0.1819s/iter; left time: 8083.8279s
	iters: 300, epoch: 1 | loss: 0.5084223
	speed: 0.1769s/iter; left time: 7843.2451s
	iters: 400, epoch: 1 | loss: 0.4608486
	speed: 0.1736s/iter; left time: 7682.2066s
	iters: 500, epoch: 1 | loss: 0.4559193
	speed: 0.1725s/iter; left time: 7613.4977s
	iters: 600, epoch: 1 | loss: 0.4286495
	speed: 0.1774s/iter; left time: 7814.1056s
	iters: 700, epoch: 1 | loss: 0.3540363
	speed: 0.1745s/iter; left time: 7666.8159s
	iters: 800, epoch: 1 | loss: 0.3311507
	speed: 0.1740s/iter; left time: 7628.9489s
	iters: 900, epoch: 1 | loss: 0.3028309
	speed: 0.1772s/iter; left time: 7752.1311s
	iters: 1000, epoch: 1 | loss: 0.2680934
	speed: 0.1817s/iter; left time: 7930.9775s
	iters: 1100, epoch: 1 | loss: 0.3161353
	speed: 0.1834s/iter; left time: 7984.0359s
	iters: 1200, epoch: 1 | loss: 0.2896556
	speed: 0.1821s/iter; left time: 7908.7638s
	iters: 1300, epoch: 1 | loss: 0.2993464
	speed: 0.1797s/iter; left time: 7787.3331s
	iters: 1400, epoch: 1 | loss: 0.2501588
	speed: 0.1880s/iter; left time: 8129.8077s
Epoch: 1 cost time: 275.2567045688629
Epoch: 1, Steps: 1488 | Train Loss: 0.4138305 Vali Loss: 0.4817632 Test Loss: 0.6358271
Validation loss decreased (inf --> 0.481763).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2437178
	speed: 1.4647s/iter; left time: 63060.9818s
	iters: 200, epoch: 2 | loss: 0.2639662
	speed: 0.1897s/iter; left time: 8148.2225s
	iters: 300, epoch: 2 | loss: 0.2557878
	speed: 0.1863s/iter; left time: 7982.9428s
	iters: 400, epoch: 2 | loss: 0.2357051
	speed: 0.2034s/iter; left time: 8695.6266s
	iters: 500, epoch: 2 | loss: 0.2559945
	speed: 0.1814s/iter; left time: 7738.8885s
	iters: 600, epoch: 2 | loss: 0.2445214
	speed: 0.1832s/iter; left time: 7795.3179s
	iters: 700, epoch: 2 | loss: 0.2718507
	speed: 0.1835s/iter; left time: 7789.5192s
	iters: 800, epoch: 2 | loss: 0.2450212
	speed: 0.1853s/iter; left time: 7846.1106s
	iters: 900, epoch: 2 | loss: 0.2555987
	speed: 0.1906s/iter; left time: 8051.9789s
	iters: 1000, epoch: 2 | loss: 0.2278340
	speed: 0.1918s/iter; left time: 8086.6025s
	iters: 1100, epoch: 2 | loss: 0.2493549
	speed: 0.1872s/iter; left time: 7870.7432s
	iters: 1200, epoch: 2 | loss: 0.2354086
	speed: 0.1804s/iter; left time: 7566.7325s
	iters: 1300, epoch: 2 | loss: 0.2268707
	speed: 0.1787s/iter; left time: 7480.6897s
	iters: 1400, epoch: 2 | loss: 0.2208795
	speed: 0.1859s/iter; left time: 7761.7565s
Epoch: 2 cost time: 279.33443427085876
Epoch: 2, Steps: 1488 | Train Loss: 0.2503940 Vali Loss: 0.4925762 Test Loss: 0.6373063
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2129269
	speed: 1.4304s/iter; left time: 59454.1507s
	iters: 200, epoch: 3 | loss: 0.2209173
	speed: 0.1871s/iter; left time: 7759.6532s
	iters: 300, epoch: 3 | loss: 0.2153039
	speed: 0.1970s/iter; left time: 8147.8957s
	iters: 400, epoch: 3 | loss: 0.2265617
	speed: 0.1915s/iter; left time: 7902.1025s
	iters: 500, epoch: 3 | loss: 0.2393055
	speed: 0.1817s/iter; left time: 7479.3532s
	iters: 600, epoch: 3 | loss: 0.2353123
	speed: 0.1781s/iter; left time: 7313.1681s
	iters: 700, epoch: 3 | loss: 0.2251924
	speed: 0.1819s/iter; left time: 7452.0823s
	iters: 800, epoch: 3 | loss: 0.2354814
	speed: 0.1813s/iter; left time: 7410.3777s
	iters: 900, epoch: 3 | loss: 0.2077432
	speed: 0.1853s/iter; left time: 7555.6833s
	iters: 1000, epoch: 3 | loss: 0.2131235
	speed: 0.1756s/iter; left time: 7139.0953s
	iters: 1100, epoch: 3 | loss: 0.2152807
	speed: 0.1771s/iter; left time: 7185.1427s
	iters: 1200, epoch: 3 | loss: 0.2244840
	speed: 0.1756s/iter; left time: 7107.2225s
	iters: 1300, epoch: 3 | loss: 0.2038755
	speed: 0.1760s/iter; left time: 7105.2698s
	iters: 1400, epoch: 3 | loss: 0.2233600
	speed: 0.1715s/iter; left time: 6905.1039s
Epoch: 3 cost time: 272.04983258247375
Epoch: 3, Steps: 1488 | Train Loss: 0.2288993 Vali Loss: 0.4592162 Test Loss: 0.6193241
Validation loss decreased (0.481763 --> 0.459216).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2478497
	speed: 1.4223s/iter; left time: 57002.9760s
	iters: 200, epoch: 4 | loss: 0.2236993
	speed: 0.1883s/iter; left time: 7529.3227s
	iters: 300, epoch: 4 | loss: 0.2044896
	speed: 0.1894s/iter; left time: 7553.3102s
	iters: 400, epoch: 4 | loss: 0.2434367
	speed: 0.1733s/iter; left time: 6893.0503s
	iters: 500, epoch: 4 | loss: 0.2133672
	speed: 0.1737s/iter; left time: 6893.7735s
	iters: 600, epoch: 4 | loss: 0.2101593
	speed: 0.1753s/iter; left time: 6936.2250s
	iters: 700, epoch: 4 | loss: 0.2387591
	speed: 0.1735s/iter; left time: 6848.3754s
	iters: 800, epoch: 4 | loss: 0.2455757
	speed: 0.1704s/iter; left time: 6710.6093s
	iters: 900, epoch: 4 | loss: 0.2224713
	speed: 0.1661s/iter; left time: 6523.3471s
	iters: 1000, epoch: 4 | loss: 0.2061450
	speed: 0.1688s/iter; left time: 6613.3475s
	iters: 1100, epoch: 4 | loss: 0.2123969
	speed: 0.1720s/iter; left time: 6720.8657s
	iters: 1200, epoch: 4 | loss: 0.2135765
	speed: 0.1720s/iter; left time: 6704.5679s
	iters: 1300, epoch: 4 | loss: 0.2055758
	speed: 0.1715s/iter; left time: 6666.9584s
	iters: 1400, epoch: 4 | loss: 0.2128131
	speed: 0.1719s/iter; left time: 6664.9679s
Epoch: 4 cost time: 263.04122376441956
Epoch: 4, Steps: 1488 | Train Loss: 0.2220116 Vali Loss: 0.4525331 Test Loss: 0.6184281
Validation loss decreased (0.459216 --> 0.452533).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2150085
	speed: 1.3643s/iter; left time: 52645.7419s
	iters: 200, epoch: 5 | loss: 0.2628959
	speed: 0.1780s/iter; left time: 6850.1186s
	iters: 300, epoch: 5 | loss: 0.2234550
	speed: 0.1796s/iter; left time: 6896.0635s
	iters: 400, epoch: 5 | loss: 0.2116821
	speed: 0.1806s/iter; left time: 6913.4737s
	iters: 500, epoch: 5 | loss: 0.1986474
	speed: 0.1637s/iter; left time: 6250.5994s
	iters: 600, epoch: 5 | loss: 0.2168210
	speed: 0.1573s/iter; left time: 5991.7105s
	iters: 700, epoch: 5 | loss: 0.2331443
	speed: 0.1647s/iter; left time: 6257.1774s
	iters: 800, epoch: 5 | loss: 0.2328674
	speed: 0.1684s/iter; left time: 6380.7294s
	iters: 900, epoch: 5 | loss: 0.2458320
	speed: 0.1690s/iter; left time: 6384.5008s
	iters: 1000, epoch: 5 | loss: 0.2083815
	speed: 0.1674s/iter; left time: 6308.3528s
	iters: 1100, epoch: 5 | loss: 0.2190528
	speed: 0.1678s/iter; left time: 6308.0258s
	iters: 1200, epoch: 5 | loss: 0.2163043
	speed: 0.1803s/iter; left time: 6759.7339s
	iters: 1300, epoch: 5 | loss: 0.2117101
	speed: 0.1802s/iter; left time: 6738.4998s
	iters: 1400, epoch: 5 | loss: 0.2161299
	speed: 0.1823s/iter; left time: 6799.5117s
Epoch: 5 cost time: 259.7608292102814
Epoch: 5, Steps: 1488 | Train Loss: 0.2186490 Vali Loss: 0.4541012 Test Loss: 0.6222362
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2293371
	speed: 1.3705s/iter; left time: 50846.2691s
	iters: 200, epoch: 6 | loss: 0.2085986
	speed: 0.1617s/iter; left time: 5983.2338s
	iters: 300, epoch: 6 | loss: 0.2260096
	speed: 0.1649s/iter; left time: 6083.9271s
	iters: 400, epoch: 6 | loss: 0.2033245
	speed: 0.1650s/iter; left time: 6072.6664s
	iters: 500, epoch: 6 | loss: 0.2085600
	speed: 0.1645s/iter; left time: 6037.5054s
	iters: 600, epoch: 6 | loss: 0.2233843
	speed: 0.1629s/iter; left time: 5963.8761s
	iters: 700, epoch: 6 | loss: 0.2169777
	speed: 0.1665s/iter; left time: 6075.9158s
	iters: 800, epoch: 6 | loss: 0.2323100
	speed: 0.1640s/iter; left time: 5971.5341s
	iters: 900, epoch: 6 | loss: 0.2116517
	speed: 0.1663s/iter; left time: 6038.0265s
	iters: 1000, epoch: 6 | loss: 0.2118139
	speed: 0.1655s/iter; left time: 5989.8879s
	iters: 1100, epoch: 6 | loss: 0.2317315
	speed: 0.1577s/iter; left time: 5691.4777s
	iters: 1200, epoch: 6 | loss: 0.2041359
	speed: 0.1588s/iter; left time: 5716.6565s
	iters: 1300, epoch: 6 | loss: 0.2312935
	speed: 0.1633s/iter; left time: 5862.7686s
	iters: 1400, epoch: 6 | loss: 0.1986484
	speed: 0.1629s/iter; left time: 5832.9947s
Epoch: 6 cost time: 244.89661073684692
Epoch: 6, Steps: 1488 | Train Loss: 0.2171188 Vali Loss: 0.4533510 Test Loss: 0.6201079
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2082610
	speed: 1.2813s/iter; left time: 45629.8689s
	iters: 200, epoch: 7 | loss: 0.1996480
	speed: 0.1606s/iter; left time: 5701.9586s
	iters: 300, epoch: 7 | loss: 0.2148973
	speed: 0.1608s/iter; left time: 5692.9395s
	iters: 400, epoch: 7 | loss: 0.2134680
	speed: 0.1655s/iter; left time: 5845.4892s
	iters: 500, epoch: 7 | loss: 0.1999542
	speed: 0.1690s/iter; left time: 5952.5330s
	iters: 600, epoch: 7 | loss: 0.2122643
	speed: 0.1753s/iter; left time: 6155.2253s
	iters: 700, epoch: 7 | loss: 0.2014449
	speed: 0.1771s/iter; left time: 6201.3575s
	iters: 800, epoch: 7 | loss: 0.2024071
	speed: 0.1705s/iter; left time: 5952.7605s
	iters: 900, epoch: 7 | loss: 0.2246342
	speed: 0.1676s/iter; left time: 5835.9009s
	iters: 1000, epoch: 7 | loss: 0.2153393
	speed: 0.1699s/iter; left time: 5896.2870s
	iters: 1100, epoch: 7 | loss: 0.2169017
	speed: 0.1666s/iter; left time: 5766.8640s
	iters: 1200, epoch: 7 | loss: 0.1968076
	speed: 0.1653s/iter; left time: 5705.3273s
	iters: 1300, epoch: 7 | loss: 0.2234562
	speed: 0.1696s/iter; left time: 5834.7546s
	iters: 1400, epoch: 7 | loss: 0.2159842
	speed: 0.1676s/iter; left time: 5751.8843s
Epoch: 7 cost time: 251.8769714832306
Epoch: 7, Steps: 1488 | Train Loss: 0.2161840 Vali Loss: 0.4513190 Test Loss: 0.6207223
Validation loss decreased (0.452533 --> 0.451319).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2259193
	speed: 1.2952s/iter; left time: 44198.5700s
	iters: 200, epoch: 8 | loss: 0.2174161
	speed: 0.1656s/iter; left time: 5633.2211s
	iters: 300, epoch: 8 | loss: 0.2180384
	speed: 0.1641s/iter; left time: 5567.0521s
	iters: 400, epoch: 8 | loss: 0.2055203
	speed: 0.1719s/iter; left time: 5814.6673s
	iters: 500, epoch: 8 | loss: 0.2393192
	speed: 0.1801s/iter; left time: 6073.2581s
	iters: 600, epoch: 8 | loss: 0.2164392
	speed: 0.1689s/iter; left time: 5680.0148s
	iters: 700, epoch: 8 | loss: 0.1996619
	speed: 0.1654s/iter; left time: 5546.3096s
	iters: 800, epoch: 8 | loss: 0.2118461
	speed: 0.1705s/iter; left time: 5697.9340s
	iters: 900, epoch: 8 | loss: 0.2035833
	speed: 0.1758s/iter; left time: 5857.5550s
	iters: 1000, epoch: 8 | loss: 0.2052691
	speed: 0.1675s/iter; left time: 5564.2080s
	iters: 1100, epoch: 8 | loss: 0.2136723
	speed: 0.1672s/iter; left time: 5537.6768s
	iters: 1200, epoch: 8 | loss: 0.2233216
	speed: 0.1710s/iter; left time: 5648.8252s
	iters: 1300, epoch: 8 | loss: 0.2237144
	speed: 0.1767s/iter; left time: 5818.8232s
	iters: 1400, epoch: 8 | loss: 0.2226809
	speed: 0.1728s/iter; left time: 5672.4743s
Epoch: 8 cost time: 255.95167875289917
Epoch: 8, Steps: 1488 | Train Loss: 0.2157153 Vali Loss: 0.4525655 Test Loss: 0.6209003
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2089029
	speed: 1.4249s/iter; left time: 46505.9082s
	iters: 200, epoch: 9 | loss: 0.2444869
	speed: 0.1604s/iter; left time: 5219.7625s
	iters: 300, epoch: 9 | loss: 0.2052334
	speed: 0.1605s/iter; left time: 5205.5625s
	iters: 400, epoch: 9 | loss: 0.2013967
	speed: 0.1617s/iter; left time: 5228.2275s
	iters: 500, epoch: 9 | loss: 0.2115583
	speed: 0.1607s/iter; left time: 5181.9233s
	iters: 600, epoch: 9 | loss: 0.2015315
	speed: 0.1600s/iter; left time: 5140.7767s
	iters: 700, epoch: 9 | loss: 0.2125520
	speed: 0.1596s/iter; left time: 5112.5707s
	iters: 800, epoch: 9 | loss: 0.2307186
	speed: 0.1599s/iter; left time: 5108.2710s
	iters: 900, epoch: 9 | loss: 0.2365730
	speed: 0.1630s/iter; left time: 5189.6460s
	iters: 1000, epoch: 9 | loss: 0.2356460
	speed: 0.1610s/iter; left time: 5110.1048s
	iters: 1100, epoch: 9 | loss: 0.2494191
	speed: 0.1584s/iter; left time: 5012.1694s
	iters: 1200, epoch: 9 | loss: 0.1993037
	speed: 0.1587s/iter; left time: 5004.9069s
	iters: 1300, epoch: 9 | loss: 0.2042739
	speed: 0.1588s/iter; left time: 4991.3696s
	iters: 1400, epoch: 9 | loss: 0.2001557
	speed: 0.1613s/iter; left time: 5053.8140s
Epoch: 9 cost time: 241.2388846874237
Epoch: 9, Steps: 1488 | Train Loss: 0.2155071 Vali Loss: 0.4517721 Test Loss: 0.6214771
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2279245
	speed: 1.3744s/iter; left time: 42812.4089s
	iters: 200, epoch: 10 | loss: 0.2087339
	speed: 0.1684s/iter; left time: 5228.7748s
	iters: 300, epoch: 10 | loss: 0.2406126
	speed: 0.1698s/iter; left time: 5256.5335s
	iters: 400, epoch: 10 | loss: 0.2154896
	speed: 0.1656s/iter; left time: 5107.9225s
	iters: 500, epoch: 10 | loss: 0.2068152
	speed: 0.1598s/iter; left time: 4914.4958s
	iters: 600, epoch: 10 | loss: 0.2214110
	speed: 0.1645s/iter; left time: 5042.5928s
	iters: 700, epoch: 10 | loss: 0.1967677
	speed: 0.1640s/iter; left time: 5008.8419s
	iters: 800, epoch: 10 | loss: 0.2080383
	speed: 0.1667s/iter; left time: 5074.8362s
	iters: 900, epoch: 10 | loss: 0.2119851
	speed: 0.1682s/iter; left time: 5105.8211s
	iters: 1000, epoch: 10 | loss: 0.2056267
	speed: 0.1616s/iter; left time: 4887.8793s
	iters: 1100, epoch: 10 | loss: 0.2030415
	speed: 0.1638s/iter; left time: 4937.0731s
	iters: 1200, epoch: 10 | loss: 0.2238071
	speed: 0.1629s/iter; left time: 4896.0319s
	iters: 1300, epoch: 10 | loss: 0.2146112
	speed: 0.1635s/iter; left time: 4895.9419s
	iters: 1400, epoch: 10 | loss: 0.2146941
	speed: 0.1598s/iter; left time: 4770.0979s
Epoch: 10 cost time: 246.98828148841858
Epoch: 10, Steps: 1488 | Train Loss: 0.2154104 Vali Loss: 0.4516543 Test Loss: 0.6210930
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_traffic_192_192_TimesNet_custom_ftM_sl192_ll48_pl192_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3317
test shape: (3317, 192, 862) (3317, 192, 862)
test shape: (3317, 192, 862) (3317, 192, 862)
mse:0.6207070350646973, mae:0.33640187978744507, dtw:not calculated
