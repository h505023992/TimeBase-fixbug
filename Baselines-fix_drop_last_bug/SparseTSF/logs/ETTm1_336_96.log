Args in experiment:
Namespace(is_training=1, model_id='ETTm1_336_96', model='SparseTSF', data='ETTm1', root_path='./dataset/', data_path='ETTm1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, period_len=4, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=256, patience=5, learning_rate=0.02, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=2, use_multi_gpu=0, devices='0,1', test_flop=False)
Use GPU: cuda:2
>>>>>>>start training : ETTm1_336_96_SparseTSF_ETTm1_ftM_sl336_pl96_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.3346235
	speed: 0.1311s/iter; left time: 510.0716s
Epoch: 1 cost time: 15.645546674728394
Epoch: 1, Steps: 133 | Train Loss: 0.4039570 Vali Loss: 0.4520644 Test Loss: 0.3537819
Validation loss decreased (inf --> 0.452064).  Saving model ...
Updating learning rate to 0.02
	iters: 100, epoch: 2 | loss: 0.3035372
	speed: 0.2753s/iter; left time: 1034.4837s
Epoch: 2 cost time: 11.630223274230957
Epoch: 2, Steps: 133 | Train Loss: 0.2887984 Vali Loss: 0.4042338 Test Loss: 0.3090706
Validation loss decreased (0.452064 --> 0.404234).  Saving model ...
Updating learning rate to 0.02
	iters: 100, epoch: 3 | loss: 0.2901139
	speed: 0.2695s/iter; left time: 976.8501s
Epoch: 3 cost time: 11.223814725875854
Epoch: 3, Steps: 133 | Train Loss: 0.2800252 Vali Loss: 0.4033603 Test Loss: 0.3117039
Validation loss decreased (0.404234 --> 0.403360).  Saving model ...
Updating learning rate to 0.02
	iters: 100, epoch: 4 | loss: 0.2633819
	speed: 0.2436s/iter; left time: 850.4783s
Epoch: 4 cost time: 9.982295751571655
Epoch: 4, Steps: 133 | Train Loss: 0.2791172 Vali Loss: 0.3947101 Test Loss: 0.3089026
Validation loss decreased (0.403360 --> 0.394710).  Saving model ...
Updating learning rate to 0.016
	iters: 100, epoch: 5 | loss: 0.2752624
	speed: 0.2416s/iter; left time: 811.6454s
Epoch: 5 cost time: 10.395087718963623
Epoch: 5, Steps: 133 | Train Loss: 0.2778068 Vali Loss: 0.4008600 Test Loss: 0.3073554
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.012800000000000002
	iters: 100, epoch: 6 | loss: 0.2856917
	speed: 0.2433s/iter; left time: 784.8117s
Epoch: 6 cost time: 10.371661901473999
Epoch: 6, Steps: 133 | Train Loss: 0.2768144 Vali Loss: 0.4064777 Test Loss: 0.3040021
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.010240000000000003
	iters: 100, epoch: 7 | loss: 0.2539246
	speed: 0.2547s/iter; left time: 787.8925s
Epoch: 7 cost time: 10.352125883102417
Epoch: 7, Steps: 133 | Train Loss: 0.2762767 Vali Loss: 0.3924732 Test Loss: 0.3046803
Validation loss decreased (0.394710 --> 0.392473).  Saving model ...
Updating learning rate to 0.008192000000000001
	iters: 100, epoch: 8 | loss: 0.2745037
	speed: 0.2040s/iter; left time: 603.8672s
Epoch: 8 cost time: 8.208976030349731
Epoch: 8, Steps: 133 | Train Loss: 0.2757864 Vali Loss: 0.3960043 Test Loss: 0.3037454
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0065536000000000014
	iters: 100, epoch: 9 | loss: 0.2673626
	speed: 0.2296s/iter; left time: 648.9648s
Epoch: 9 cost time: 9.733917474746704
Epoch: 9, Steps: 133 | Train Loss: 0.2755344 Vali Loss: 0.3925258 Test Loss: 0.3056900
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.005242880000000002
	iters: 100, epoch: 10 | loss: 0.2947909
	speed: 0.2445s/iter; left time: 658.7546s
Epoch: 10 cost time: 10.082921028137207
Epoch: 10, Steps: 133 | Train Loss: 0.2754960 Vali Loss: 0.3971720 Test Loss: 0.3054760
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.004194304000000002
	iters: 100, epoch: 11 | loss: 0.2798826
	speed: 0.2621s/iter; left time: 671.3024s
Epoch: 11 cost time: 12.297781944274902
Epoch: 11, Steps: 133 | Train Loss: 0.2753545 Vali Loss: 0.3935590 Test Loss: 0.3054210
EarlyStopping counter: 4 out of 5
Updating learning rate to 0.003355443200000002
	iters: 100, epoch: 12 | loss: 0.2605698
	speed: 0.2779s/iter; left time: 674.7318s
Epoch: 12 cost time: 11.27311396598816
Epoch: 12, Steps: 133 | Train Loss: 0.2751643 Vali Loss: 0.3935564 Test Loss: 0.3042502
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm1_336_96_SparseTSF_ETTm1_ftM_sl336_pl96_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.30578896403312683, mae:0.3471541702747345, rse:0.5261902213096619
