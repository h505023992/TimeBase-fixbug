Args in experiment:
Namespace(is_training=1, model_id='traffic_96_720', model='SparseTSF', data='custom', root_path='./dataset/', data_path='traffic.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=720, period_len=24, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=862, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=128, patience=5, learning_rate=0.03, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=2, use_multi_gpu=0, devices='0,1', test_flop=False)
Use GPU: cuda:2
>>>>>>>start training : traffic_96_720_SparseTSF_custom_ftM_sl96_pl720_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11465
val 1037
test 2789
Epoch: 1 cost time: 41.98106050491333
Epoch: 1, Steps: 89 | Train Loss: 1.0198775 Vali Loss: 1.0555068 Test Loss: 1.2773757
Validation loss decreased (inf --> 1.055507).  Saving model ...
Updating learning rate to 0.03
Epoch: 2 cost time: 40.151437759399414
Epoch: 2, Steps: 89 | Train Loss: 0.4967663 Vali Loss: 0.5802413 Test Loss: 0.6957300
Validation loss decreased (1.055507 --> 0.580241).  Saving model ...
Updating learning rate to 0.03
Epoch: 3 cost time: 38.54858613014221
Epoch: 3, Steps: 89 | Train Loss: 0.4178929 Vali Loss: 0.5576784 Test Loss: 0.6662037
Validation loss decreased (0.580241 --> 0.557678).  Saving model ...
Updating learning rate to 0.03
Epoch: 4 cost time: 38.29665994644165
Epoch: 4, Steps: 89 | Train Loss: 0.4100336 Vali Loss: 0.5551685 Test Loss: 0.6611804
Validation loss decreased (0.557678 --> 0.555169).  Saving model ...
Updating learning rate to 0.024
Epoch: 5 cost time: 38.03395938873291
Epoch: 5, Steps: 89 | Train Loss: 0.4084125 Vali Loss: 0.5544407 Test Loss: 0.6606524
Validation loss decreased (0.555169 --> 0.554441).  Saving model ...
Updating learning rate to 0.019200000000000002
Epoch: 6 cost time: 37.40927267074585
Epoch: 6, Steps: 89 | Train Loss: 0.4076238 Vali Loss: 0.5529500 Test Loss: 0.6584828
Validation loss decreased (0.554441 --> 0.552950).  Saving model ...
Updating learning rate to 0.015360000000000004
Epoch: 7 cost time: 35.600727558135986
Epoch: 7, Steps: 89 | Train Loss: 0.4073514 Vali Loss: 0.5521468 Test Loss: 0.6564602
Validation loss decreased (0.552950 --> 0.552147).  Saving model ...
Updating learning rate to 0.012288000000000002
Epoch: 8 cost time: 37.46530103683472
Epoch: 8, Steps: 89 | Train Loss: 0.4074272 Vali Loss: 0.5536808 Test Loss: 0.6588502
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.009830400000000001
Epoch: 9 cost time: 37.712135553359985
Epoch: 9, Steps: 89 | Train Loss: 0.4070981 Vali Loss: 0.5525770 Test Loss: 0.6555862
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.007864320000000003
Epoch: 10 cost time: 37.586447954177856
Epoch: 10, Steps: 89 | Train Loss: 0.4070787 Vali Loss: 0.5524106 Test Loss: 0.6571184
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.006291456000000002
Epoch: 11 cost time: 37.263418436050415
Epoch: 11, Steps: 89 | Train Loss: 0.4070247 Vali Loss: 0.5525664 Test Loss: 0.6552609
EarlyStopping counter: 4 out of 5
Updating learning rate to 0.005033164800000003
Epoch: 12 cost time: 36.897250175476074
Epoch: 12, Steps: 89 | Train Loss: 0.4070012 Vali Loss: 0.5519278 Test Loss: 0.6558772
Validation loss decreased (0.552147 --> 0.551928).  Saving model ...
Updating learning rate to 0.004026531840000002
Epoch: 13 cost time: 37.208510637283325
Epoch: 13, Steps: 89 | Train Loss: 0.4069060 Vali Loss: 0.5529681 Test Loss: 0.6559591
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0032212254720000015
Epoch: 14 cost time: 38.1358916759491
Epoch: 14, Steps: 89 | Train Loss: 0.4069416 Vali Loss: 0.5515264 Test Loss: 0.6564630
Validation loss decreased (0.551928 --> 0.551526).  Saving model ...
Updating learning rate to 0.0025769803776000016
Epoch: 15 cost time: 37.217217683792114
Epoch: 15, Steps: 89 | Train Loss: 0.4067252 Vali Loss: 0.5517380 Test Loss: 0.6560659
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.002061584302080001
Epoch: 16 cost time: 38.22465252876282
Epoch: 16, Steps: 89 | Train Loss: 0.4069189 Vali Loss: 0.5517547 Test Loss: 0.6568015
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.001649267441664001
Epoch: 17 cost time: 38.7440230846405
Epoch: 17, Steps: 89 | Train Loss: 0.4069443 Vali Loss: 0.5519664 Test Loss: 0.6560495
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.001319413953331201
Epoch: 18 cost time: 39.77070641517639
Epoch: 18, Steps: 89 | Train Loss: 0.4069050 Vali Loss: 0.5517359 Test Loss: 0.6560021
EarlyStopping counter: 4 out of 5
Updating learning rate to 0.0010555311626649609
Epoch: 19 cost time: 38.32464385032654
Epoch: 19, Steps: 89 | Train Loss: 0.4066906 Vali Loss: 0.5523264 Test Loss: 0.6558945
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : traffic_96_720_SparseTSF_custom_ftM_sl96_pl720_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
mse:0.6551716923713684, mae:0.38857710361480713, rse:0.6618786454200745
