Args in experiment:
Namespace(is_training=1, model_id='ETTh1_96_720', model='LightTimeBaseTST', data='ETTh1', root_path='./dataset/', data_path='ETTh1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=720, period_len=24, basis_num=6, use_period_norm=0, use_orthogonal=1, orthogonal_weight=0.08, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=7, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=512, patience=5, learning_rate=0.05, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=6, use_multi_gpu=0, devices='0,1', test_flop=False)
Use GPU: cuda:6
240
>>>>>>>start training : ETTh1_96_720_LightTimeBaseTST_ETTh1_ftM_sl96_pl720_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7825
val 2161
test 2161
Epoch: 1 cost time: 1.978792428970337
Epoch: 1, Steps: 16 | Train Loss: 0.8304739 Vali Loss: 1.9836767 Test Loss: 0.7747357
Validation loss decreased (inf --> 1.983677).  Saving model ...
Updating learning rate to 0.05
Epoch: 2 cost time: 1.2426846027374268
Epoch: 2, Steps: 16 | Train Loss: 0.8115035 Vali Loss: 1.9330332 Test Loss: 0.7120341
Validation loss decreased (1.983677 --> 1.933033).  Saving model ...
Updating learning rate to 0.05
Epoch: 3 cost time: 1.1990952491760254
Epoch: 3, Steps: 16 | Train Loss: 0.7264198 Vali Loss: 1.8072774 Test Loss: 0.6524898
Validation loss decreased (1.933033 --> 1.807277).  Saving model ...
Updating learning rate to 0.05
Epoch: 4 cost time: 1.2583675384521484
Epoch: 4, Steps: 16 | Train Loss: 0.7043860 Vali Loss: 1.7132137 Test Loss: 0.5619251
Validation loss decreased (1.807277 --> 1.713214).  Saving model ...
Updating learning rate to 0.04000000000000001
Epoch: 5 cost time: 1.1966373920440674
Epoch: 5, Steps: 16 | Train Loss: 0.6483281 Vali Loss: 1.6458969 Test Loss: 0.5348362
Validation loss decreased (1.713214 --> 1.645897).  Saving model ...
Updating learning rate to 0.03200000000000001
Epoch: 6 cost time: 1.2651872634887695
Epoch: 6, Steps: 16 | Train Loss: 0.6332966 Vali Loss: 1.6222245 Test Loss: 0.5169014
Validation loss decreased (1.645897 --> 1.622224).  Saving model ...
Updating learning rate to 0.025600000000000008
Epoch: 7 cost time: 1.2385056018829346
Epoch: 7, Steps: 16 | Train Loss: 0.6258408 Vali Loss: 1.6254021 Test Loss: 0.5038804
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.020480000000000005
Epoch: 8 cost time: 1.1505193710327148
Epoch: 8, Steps: 16 | Train Loss: 0.6248403 Vali Loss: 1.6302977 Test Loss: 0.5046730
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.016384000000000006
Epoch: 9 cost time: 1.1971189975738525
Epoch: 9, Steps: 16 | Train Loss: 0.6213227 Vali Loss: 1.6087265 Test Loss: 0.5008308
Validation loss decreased (1.622224 --> 1.608727).  Saving model ...
Updating learning rate to 0.013107200000000006
Epoch: 10 cost time: 1.2314574718475342
Epoch: 10, Steps: 16 | Train Loss: 0.6167207 Vali Loss: 1.6157452 Test Loss: 0.4955947
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.010485760000000004
Epoch: 11 cost time: 1.183375358581543
Epoch: 11, Steps: 16 | Train Loss: 0.6145620 Vali Loss: 1.5793622 Test Loss: 0.4928426
Validation loss decreased (1.608727 --> 1.579362).  Saving model ...
Updating learning rate to 0.008388608000000004
Epoch: 12 cost time: 1.1915838718414307
Epoch: 12, Steps: 16 | Train Loss: 0.6121276 Vali Loss: 1.5873787 Test Loss: 0.4937111
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.006710886400000004
Epoch: 13 cost time: 1.2095441818237305
Epoch: 13, Steps: 16 | Train Loss: 0.6148736 Vali Loss: 1.5990766 Test Loss: 0.4919761
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.005368709120000003
Epoch: 14 cost time: 1.3219859600067139
Epoch: 14, Steps: 16 | Train Loss: 0.6127556 Vali Loss: 1.5789185 Test Loss: 0.4921615
Validation loss decreased (1.579362 --> 1.578918).  Saving model ...
Updating learning rate to 0.0042949672960000025
Epoch: 15 cost time: 1.2019426822662354
Epoch: 15, Steps: 16 | Train Loss: 0.6113470 Vali Loss: 1.6005732 Test Loss: 0.4926226
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0034359738368000023
Epoch: 16 cost time: 1.2736618518829346
Epoch: 16, Steps: 16 | Train Loss: 0.6142184 Vali Loss: 1.5975459 Test Loss: 0.4920092
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.002748779069440002
Epoch: 17 cost time: 0.979377269744873
Epoch: 17, Steps: 16 | Train Loss: 0.6113887 Vali Loss: 1.5761607 Test Loss: 0.4921486
Validation loss decreased (1.578918 --> 1.576161).  Saving model ...
Updating learning rate to 0.002199023255552002
Epoch: 18 cost time: 1.0607538223266602
Epoch: 18, Steps: 16 | Train Loss: 0.6122091 Vali Loss: 1.5725098 Test Loss: 0.4924734
Validation loss decreased (1.576161 --> 1.572510).  Saving model ...
Updating learning rate to 0.0017592186044416017
Epoch: 19 cost time: 1.119462251663208
Epoch: 19, Steps: 16 | Train Loss: 0.6127488 Vali Loss: 1.5927862 Test Loss: 0.4922611
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0014073748835532812
Epoch: 20 cost time: 1.059319019317627
Epoch: 20, Steps: 16 | Train Loss: 0.6119518 Vali Loss: 1.5629015 Test Loss: 0.4922429
Validation loss decreased (1.572510 --> 1.562901).  Saving model ...
Updating learning rate to 0.0011258999068426252
Epoch: 21 cost time: 1.0840177536010742
Epoch: 21, Steps: 16 | Train Loss: 0.6153252 Vali Loss: 1.5842956 Test Loss: 0.4923452
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0009007199254741002
Epoch: 22 cost time: 0.9904298782348633
Epoch: 22, Steps: 16 | Train Loss: 0.6102416 Vali Loss: 1.6106300 Test Loss: 0.4922461
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.0007205759403792802
Epoch: 23 cost time: 1.080343246459961
Epoch: 23, Steps: 16 | Train Loss: 0.6111558 Vali Loss: 1.5739567 Test Loss: 0.4921567
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.0005764607523034242
Epoch: 24 cost time: 0.961536169052124
Epoch: 24, Steps: 16 | Train Loss: 0.6127540 Vali Loss: 1.5771935 Test Loss: 0.4922578
EarlyStopping counter: 4 out of 5
Updating learning rate to 0.00046116860184273935
Epoch: 25 cost time: 0.951153039932251
Epoch: 25, Steps: 16 | Train Loss: 0.6140510 Vali Loss: 1.5644089 Test Loss: 0.4922188
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTh1_96_720_LightTimeBaseTST_ETTh1_ftM_sl96_pl720_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.46753180027008057, mae:0.46109017729759216, rse:0.6545721888542175
