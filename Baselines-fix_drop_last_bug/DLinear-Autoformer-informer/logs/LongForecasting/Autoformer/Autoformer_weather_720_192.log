Args in experiment:
Namespace(is_training=1, train_only=False, model_id='weather_720_192', model='Autoformer', data='custom', root_path='./dataset/', data_path='weather.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=192, individual=False, embed_type=0, enc_in=21, dec_in=21, c_out=21, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : weather_720_192_Autoformer_custom_ftM_sl720_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35976
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 1.1424462
	speed: 0.2895s/iter; left time: 9740.8419s
	iters: 200, epoch: 1 | loss: 1.1815220
	speed: 0.2547s/iter; left time: 8544.4975s
	iters: 300, epoch: 1 | loss: 0.5549080
	speed: 0.2525s/iter; left time: 8446.6374s
	iters: 400, epoch: 1 | loss: 0.6422254
	speed: 0.2564s/iter; left time: 8549.7493s
	iters: 500, epoch: 1 | loss: 0.4747838
	speed: 0.2586s/iter; left time: 8599.9574s
	iters: 600, epoch: 1 | loss: 0.4302398
	speed: 0.2573s/iter; left time: 8529.5400s
	iters: 700, epoch: 1 | loss: 0.5094197
	speed: 0.2581s/iter; left time: 8529.2908s
	iters: 800, epoch: 1 | loss: 0.4273618
	speed: 0.2588s/iter; left time: 8528.1189s
	iters: 900, epoch: 1 | loss: 0.3922888
	speed: 0.2543s/iter; left time: 8353.7877s
	iters: 1000, epoch: 1 | loss: 0.5404331
	speed: 0.2535s/iter; left time: 8301.3895s
	iters: 1100, epoch: 1 | loss: 0.4398464
	speed: 0.2534s/iter; left time: 8273.7287s
Epoch: 1 cost time: 291.1372730731964
Epoch: 1, Steps: 1125 | Train Loss: 0.6005854 Vali Loss: 0.7054353 Test Loss: 0.3889117
Validation loss decreased (inf --> 0.705435).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4946580
	speed: 1.2718s/iter; left time: 41367.1698s
	iters: 200, epoch: 2 | loss: 0.5066538
	speed: 0.2588s/iter; left time: 8391.1020s
	iters: 300, epoch: 2 | loss: 0.4795564
	speed: 0.2534s/iter; left time: 8191.2724s
	iters: 400, epoch: 2 | loss: 0.4566818
	speed: 0.2522s/iter; left time: 8128.8764s
	iters: 500, epoch: 2 | loss: 0.4684799
	speed: 0.2562s/iter; left time: 8231.0583s
	iters: 600, epoch: 2 | loss: 0.5296568
	speed: 0.2542s/iter; left time: 8141.5889s
	iters: 700, epoch: 2 | loss: 1.0057070
	speed: 0.2571s/iter; left time: 8208.8838s
	iters: 800, epoch: 2 | loss: 0.6505101
	speed: 0.2551s/iter; left time: 8117.2270s
	iters: 900, epoch: 2 | loss: 0.5143709
	speed: 0.2599s/iter; left time: 8245.6593s
	iters: 1000, epoch: 2 | loss: 0.6468678
	speed: 0.2600s/iter; left time: 8222.8597s
	iters: 1100, epoch: 2 | loss: 0.4381761
	speed: 0.2548s/iter; left time: 8034.0329s
Epoch: 2 cost time: 288.97678995132446
Epoch: 2, Steps: 1125 | Train Loss: 0.5332495 Vali Loss: 0.7325728 Test Loss: 0.4137067
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3746161
	speed: 1.2456s/iter; left time: 39111.7143s
	iters: 200, epoch: 3 | loss: 0.3325376
	speed: 0.2567s/iter; left time: 8035.9390s
	iters: 300, epoch: 3 | loss: 0.6626690
	speed: 0.2602s/iter; left time: 8118.5890s
	iters: 400, epoch: 3 | loss: 0.3047771
	speed: 0.2584s/iter; left time: 8036.5535s
	iters: 500, epoch: 3 | loss: 0.3450979
	speed: 0.2569s/iter; left time: 7965.5108s
	iters: 600, epoch: 3 | loss: 0.3893463
	speed: 0.2543s/iter; left time: 7857.5585s
	iters: 700, epoch: 3 | loss: 0.3403392
	speed: 0.2541s/iter; left time: 7826.5681s
	iters: 800, epoch: 3 | loss: 0.3647675
	speed: 0.2599s/iter; left time: 7979.6168s
	iters: 900, epoch: 3 | loss: 0.3541453
	speed: 0.2552s/iter; left time: 7808.0468s
	iters: 1000, epoch: 3 | loss: 0.5280097
	speed: 0.2493s/iter; left time: 7603.7854s
	iters: 1100, epoch: 3 | loss: 0.3397547
	speed: 0.2552s/iter; left time: 7759.7271s
Epoch: 3 cost time: 289.02433490753174
Epoch: 3, Steps: 1125 | Train Loss: 0.4922774 Vali Loss: 0.7277203 Test Loss: 0.3981724
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3601745
	speed: 1.2669s/iter; left time: 38357.8248s
	iters: 200, epoch: 4 | loss: 0.4025667
	speed: 0.2543s/iter; left time: 7674.0998s
	iters: 300, epoch: 4 | loss: 0.3931123
	speed: 0.2565s/iter; left time: 7715.5546s
	iters: 400, epoch: 4 | loss: 0.3227060
	speed: 0.2554s/iter; left time: 7656.1312s
	iters: 500, epoch: 4 | loss: 0.3611337
	speed: 0.2526s/iter; left time: 7545.8849s
	iters: 600, epoch: 4 | loss: 0.5093207
	speed: 0.2546s/iter; left time: 7581.6264s
	iters: 700, epoch: 4 | loss: 0.3140125
	speed: 0.2538s/iter; left time: 7531.4616s
	iters: 800, epoch: 4 | loss: 0.3874371
	speed: 0.2572s/iter; left time: 7606.0904s
	iters: 900, epoch: 4 | loss: 0.2900178
	speed: 0.2559s/iter; left time: 7543.5451s
	iters: 1000, epoch: 4 | loss: 0.3781936
	speed: 0.2549s/iter; left time: 7488.0082s
	iters: 1100, epoch: 4 | loss: 0.4393098
	speed: 0.2543s/iter; left time: 7445.1096s
Epoch: 4 cost time: 287.9844045639038
Epoch: 4, Steps: 1125 | Train Loss: 0.4675399 Vali Loss: 0.7186291 Test Loss: 0.3990606
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_720_192_Autoformer_custom_ftM_sl720_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
mse:0.3893243968486786, mae:0.4232572019100189
