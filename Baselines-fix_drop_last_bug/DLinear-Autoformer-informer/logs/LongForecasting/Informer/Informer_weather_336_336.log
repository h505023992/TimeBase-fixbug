Args in experiment:
Namespace(is_training=1, train_only=False, model_id='Informer_weather_336_336', model='Informer', data='custom', root_path='./dataset/', data_path='weather.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=336, individual=False, embed_type=0, enc_in=21, dec_in=21, c_out=21, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : Informer_weather_336_336_Informer_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36216
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.4096800
	speed: 0.4161s/iter; left time: 14089.8348s
	iters: 200, epoch: 1 | loss: 0.4104383
	speed: 0.3624s/iter; left time: 12233.3444s
	iters: 300, epoch: 1 | loss: 0.3053211
	speed: 0.3533s/iter; left time: 11891.3073s
	iters: 400, epoch: 1 | loss: 0.3975578
	speed: 0.3609s/iter; left time: 12113.6027s
	iters: 500, epoch: 1 | loss: 0.4566877
	speed: 0.3652s/iter; left time: 12219.8035s
	iters: 600, epoch: 1 | loss: 0.6197360
	speed: 0.3945s/iter; left time: 13159.2965s
	iters: 700, epoch: 1 | loss: 0.3663435
	speed: 0.3905s/iter; left time: 12987.3564s
	iters: 800, epoch: 1 | loss: 0.3158365
	speed: 0.3838s/iter; left time: 12727.1233s
	iters: 900, epoch: 1 | loss: 0.3090290
	speed: 0.3798s/iter; left time: 12555.3152s
	iters: 1000, epoch: 1 | loss: 0.3351811
	speed: 0.3722s/iter; left time: 12269.1604s
	iters: 1100, epoch: 1 | loss: 0.4025291
	speed: 0.3777s/iter; left time: 12410.8133s
Epoch: 1 cost time: 427.20625138282776
Epoch: 1, Steps: 1132 | Train Loss: 0.4648636 Vali Loss: 0.6588775 Test Loss: 0.6226466
Validation loss decreased (inf --> 0.658877).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3289195
	speed: 1.4613s/iter; left time: 47825.6068s
	iters: 200, epoch: 2 | loss: 0.3556134
	speed: 0.3703s/iter; left time: 12084.0126s
	iters: 300, epoch: 2 | loss: 0.2706521
	speed: 0.3678s/iter; left time: 11965.0302s
	iters: 400, epoch: 2 | loss: 0.2476769
	speed: 0.3861s/iter; left time: 12522.1992s
	iters: 500, epoch: 2 | loss: 0.2606924
	speed: 0.3998s/iter; left time: 12925.4970s
	iters: 600, epoch: 2 | loss: 0.1983680
	speed: 0.3930s/iter; left time: 12665.8190s
	iters: 700, epoch: 2 | loss: 0.2955232
	speed: 0.3760s/iter; left time: 12079.5144s
	iters: 800, epoch: 2 | loss: 0.3243041
	speed: 0.3687s/iter; left time: 11809.3092s
	iters: 900, epoch: 2 | loss: 0.2345413
	speed: 0.3658s/iter; left time: 11678.0956s
	iters: 1000, epoch: 2 | loss: 0.2447424
	speed: 0.3693s/iter; left time: 11752.8645s
	iters: 1100, epoch: 2 | loss: 0.2261816
	speed: 0.3559s/iter; left time: 11291.4690s
Epoch: 2 cost time: 423.1815197467804
Epoch: 2, Steps: 1132 | Train Loss: 0.3476504 Vali Loss: 0.6852890 Test Loss: 0.6319993
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2511116
	speed: 1.5019s/iter; left time: 47455.4475s
	iters: 200, epoch: 3 | loss: 0.5179364
	speed: 0.3687s/iter; left time: 11613.0654s
	iters: 300, epoch: 3 | loss: 0.5976245
	speed: 0.3640s/iter; left time: 11429.6872s
	iters: 400, epoch: 3 | loss: 0.2001381
	speed: 0.3752s/iter; left time: 11743.6083s
	iters: 500, epoch: 3 | loss: 0.2797958
	speed: 0.3800s/iter; left time: 11853.5132s
	iters: 600, epoch: 3 | loss: 0.2171244
	speed: 0.3737s/iter; left time: 11622.0159s
	iters: 700, epoch: 3 | loss: 0.1708667
	speed: 0.3634s/iter; left time: 11263.9100s
	iters: 800, epoch: 3 | loss: 0.2458221
	speed: 0.3645s/iter; left time: 11261.1485s
	iters: 900, epoch: 3 | loss: 0.2274552
	speed: 0.3622s/iter; left time: 11154.6796s
	iters: 1000, epoch: 3 | loss: 0.1811047
	speed: 0.3728s/iter; left time: 11444.7810s
	iters: 1100, epoch: 3 | loss: 0.2019236
	speed: 0.3671s/iter; left time: 11231.2556s
Epoch: 3 cost time: 420.11178183555603
Epoch: 3, Steps: 1132 | Train Loss: 0.2808014 Vali Loss: 0.7245899 Test Loss: 0.6549184
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1874586
	speed: 1.5103s/iter; left time: 46010.6171s
	iters: 200, epoch: 4 | loss: 0.1658839
	speed: 0.3663s/iter; left time: 11121.8470s
	iters: 300, epoch: 4 | loss: 0.2410425
	speed: 0.3703s/iter; left time: 11208.4349s
	iters: 400, epoch: 4 | loss: 0.2753348
	speed: 0.3564s/iter; left time: 10751.7704s
	iters: 500, epoch: 4 | loss: 0.2156162
	speed: 0.3675s/iter; left time: 11048.2136s
	iters: 600, epoch: 4 | loss: 0.1843467
	speed: 0.3755s/iter; left time: 11251.1618s
	iters: 700, epoch: 4 | loss: 0.1769367
	speed: 0.3574s/iter; left time: 10675.1868s
	iters: 800, epoch: 4 | loss: 0.1780128
	speed: 0.3665s/iter; left time: 10907.6550s
	iters: 900, epoch: 4 | loss: 0.1506472
	speed: 0.3577s/iter; left time: 10611.8406s
	iters: 1000, epoch: 4 | loss: 0.2001270
	speed: 0.3679s/iter; left time: 10876.8752s
	iters: 1100, epoch: 4 | loss: 0.1887687
	speed: 0.3806s/iter; left time: 11214.4829s
Epoch: 4 cost time: 418.3020832538605
Epoch: 4, Steps: 1132 | Train Loss: 0.2543255 Vali Loss: 0.7036409 Test Loss: 0.6357395
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Informer_weather_336_336_Informer_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
mse:0.6225979924201965, mae:0.556291937828064
