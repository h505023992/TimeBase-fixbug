Args in experiment:
Namespace(is_training=1, train_only=False, model_id='Informer_weather_96_192', model='Informer', data='custom', root_path='./dataset/', data_path='weather.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=192, individual=False, embed_type=0, enc_in=21, dec_in=21, c_out=21, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : Informer_weather_96_192_Informer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36600
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.5856471
	speed: 0.3846s/iter; left time: 13161.2982s
	iters: 200, epoch: 1 | loss: 0.3337475
	speed: 0.3413s/iter; left time: 11643.9932s
	iters: 300, epoch: 1 | loss: 0.3333524
	speed: 0.3388s/iter; left time: 11524.8750s
	iters: 400, epoch: 1 | loss: 0.4366701
	speed: 0.3242s/iter; left time: 10995.9590s
	iters: 500, epoch: 1 | loss: 0.2882217
	speed: 0.3014s/iter; left time: 10194.7718s
	iters: 600, epoch: 1 | loss: 0.3981592
	speed: 0.3188s/iter; left time: 10749.5617s
	iters: 700, epoch: 1 | loss: 0.2287269
	speed: 0.3275s/iter; left time: 11011.2883s
	iters: 800, epoch: 1 | loss: 0.3673504
	speed: 0.3067s/iter; left time: 10280.5649s
	iters: 900, epoch: 1 | loss: 0.2650458
	speed: 0.3038s/iter; left time: 10154.3187s
	iters: 1000, epoch: 1 | loss: 0.2296761
	speed: 0.3117s/iter; left time: 10385.9338s
	iters: 1100, epoch: 1 | loss: 0.2884359
	speed: 0.2997s/iter; left time: 9956.0981s
Epoch: 1 cost time: 369.2525722980499
Epoch: 1, Steps: 1144 | Train Loss: 0.4407365 Vali Loss: 0.5847517 Test Loss: 0.7116050
Validation loss decreased (inf --> 0.584752).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4030913
	speed: 1.5777s/iter; left time: 52185.4521s
	iters: 200, epoch: 2 | loss: 0.2736558
	speed: 0.3183s/iter; left time: 10497.4016s
	iters: 300, epoch: 2 | loss: 0.2616837
	speed: 0.3292s/iter; left time: 10822.6356s
	iters: 400, epoch: 2 | loss: 0.2940591
	speed: 0.3393s/iter; left time: 11122.4163s
	iters: 500, epoch: 2 | loss: 0.2138829
	speed: 0.3147s/iter; left time: 10282.6662s
	iters: 600, epoch: 2 | loss: 0.2291723
	speed: 0.3013s/iter; left time: 9816.4084s
	iters: 700, epoch: 2 | loss: 0.2519427
	speed: 0.3272s/iter; left time: 10625.1943s
	iters: 800, epoch: 2 | loss: 0.3025559
	speed: 0.3234s/iter; left time: 10471.9731s
	iters: 900, epoch: 2 | loss: 0.3633330
	speed: 0.2948s/iter; left time: 9516.3791s
	iters: 1000, epoch: 2 | loss: 0.2722158
	speed: 0.3428s/iter; left time: 11031.5066s
	iters: 1100, epoch: 2 | loss: 0.2529773
	speed: 0.3337s/iter; left time: 10705.4947s
Epoch: 2 cost time: 369.71357131004333
Epoch: 2, Steps: 1144 | Train Loss: 0.3470624 Vali Loss: 0.5791582 Test Loss: 0.5221013
Validation loss decreased (0.584752 --> 0.579158).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2762515
	speed: 1.6666s/iter; left time: 53219.2964s
	iters: 200, epoch: 3 | loss: 0.2094648
	speed: 0.3118s/iter; left time: 9924.0000s
	iters: 300, epoch: 3 | loss: 0.2370676
	speed: 0.3302s/iter; left time: 10479.8022s
	iters: 400, epoch: 3 | loss: 0.6065606
	speed: 0.3251s/iter; left time: 10283.6625s
	iters: 500, epoch: 3 | loss: 0.1870295
	speed: 0.3204s/iter; left time: 10104.6953s
	iters: 600, epoch: 3 | loss: 0.1695046
	speed: 0.3310s/iter; left time: 10403.5072s
	iters: 700, epoch: 3 | loss: 0.1807400
	speed: 0.3112s/iter; left time: 9752.0205s
	iters: 800, epoch: 3 | loss: 0.1722671
	speed: 0.3396s/iter; left time: 10605.4773s
	iters: 900, epoch: 3 | loss: 0.2331538
	speed: 0.3438s/iter; left time: 10703.8666s
	iters: 1000, epoch: 3 | loss: 0.2062597
	speed: 0.3379s/iter; left time: 10484.7772s
	iters: 1100, epoch: 3 | loss: 0.2441502
	speed: 0.3046s/iter; left time: 9421.7421s
Epoch: 3 cost time: 374.88096141815186
Epoch: 3, Steps: 1144 | Train Loss: 0.2817318 Vali Loss: 0.5902820 Test Loss: 0.4807398
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1528972
	speed: 1.6634s/iter; left time: 51214.7225s
	iters: 200, epoch: 4 | loss: 0.2414062
	speed: 0.3206s/iter; left time: 9837.7569s
	iters: 300, epoch: 4 | loss: 0.1731221
	speed: 0.3177s/iter; left time: 9717.2442s
	iters: 400, epoch: 4 | loss: 0.1805721
	speed: 0.3297s/iter; left time: 10050.8654s
	iters: 500, epoch: 4 | loss: 0.1794958
	speed: 0.3192s/iter; left time: 9699.5655s
	iters: 600, epoch: 4 | loss: 0.1934401
	speed: 0.3270s/iter; left time: 9903.3395s
	iters: 700, epoch: 4 | loss: 0.1439930
	speed: 0.3284s/iter; left time: 9913.6429s
	iters: 800, epoch: 4 | loss: 0.1973394
	speed: 0.3004s/iter; left time: 9038.0435s
	iters: 900, epoch: 4 | loss: 0.2619280
	speed: 0.3270s/iter; left time: 9806.3913s
	iters: 1000, epoch: 4 | loss: 0.1879475
	speed: 0.3053s/iter; left time: 9123.6918s
	iters: 1100, epoch: 4 | loss: 0.2103913
	speed: 0.3375s/iter; left time: 10052.3215s
Epoch: 4 cost time: 369.4420201778412
Epoch: 4, Steps: 1144 | Train Loss: 0.2541176 Vali Loss: 0.5713605 Test Loss: 0.4850903
Validation loss decreased (0.579158 --> 0.571361).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1428275
	speed: 1.7301s/iter; left time: 51289.5170s
	iters: 200, epoch: 5 | loss: 0.4907723
	speed: 0.3208s/iter; left time: 9477.3807s
	iters: 300, epoch: 5 | loss: 0.1274482
	speed: 0.3150s/iter; left time: 9276.1966s
	iters: 400, epoch: 5 | loss: 0.4970978
	speed: 0.3127s/iter; left time: 9177.2771s
	iters: 500, epoch: 5 | loss: 0.2101036
	speed: 0.3142s/iter; left time: 9187.3341s
	iters: 600, epoch: 5 | loss: 0.1450234
	speed: 0.3264s/iter; left time: 9511.7155s
	iters: 700, epoch: 5 | loss: 0.1705327
	speed: 0.3130s/iter; left time: 9091.2251s
	iters: 800, epoch: 5 | loss: 0.4805613
	speed: 0.3220s/iter; left time: 9320.6397s
	iters: 900, epoch: 5 | loss: 0.1598805
	speed: 0.2998s/iter; left time: 8647.2757s
	iters: 1000, epoch: 5 | loss: 0.5931277
	speed: 0.3100s/iter; left time: 8911.0766s
	iters: 1100, epoch: 5 | loss: 0.1381227
	speed: 0.3356s/iter; left time: 9611.9528s
Epoch: 5 cost time: 362.95006823539734
Epoch: 5, Steps: 1144 | Train Loss: 0.2414250 Vali Loss: 0.5747484 Test Loss: 0.4959583
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1390570
	speed: 1.6484s/iter; left time: 46980.4156s
	iters: 200, epoch: 6 | loss: 0.1487682
	speed: 0.3250s/iter; left time: 9230.3023s
	iters: 300, epoch: 6 | loss: 0.2741499
	speed: 0.3070s/iter; left time: 8688.3635s
	iters: 400, epoch: 6 | loss: 0.1457075
	speed: 0.3124s/iter; left time: 8811.3761s
	iters: 500, epoch: 6 | loss: 0.1733937
	speed: 0.3007s/iter; left time: 8448.8825s
	iters: 600, epoch: 6 | loss: 0.2142073
	speed: 0.3315s/iter; left time: 9283.1128s
	iters: 700, epoch: 6 | loss: 0.2362549
	speed: 0.3121s/iter; left time: 8707.3904s
	iters: 800, epoch: 6 | loss: 0.1830621
	speed: 0.3290s/iter; left time: 9146.2173s
	iters: 900, epoch: 6 | loss: 0.1532277
	speed: 0.3159s/iter; left time: 8751.8443s
	iters: 1000, epoch: 6 | loss: 0.2552786
	speed: 0.3434s/iter; left time: 9477.3266s
	iters: 1100, epoch: 6 | loss: 0.2059085
	speed: 0.3438s/iter; left time: 9454.9407s
Epoch: 6 cost time: 371.71576285362244
Epoch: 6, Steps: 1144 | Train Loss: 0.2353420 Vali Loss: 0.5687702 Test Loss: 0.4821500
Validation loss decreased (0.571361 --> 0.568770).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2058169
	speed: 1.5657s/iter; left time: 42833.1555s
	iters: 200, epoch: 7 | loss: 0.1224834
	speed: 0.3151s/iter; left time: 8589.5913s
	iters: 300, epoch: 7 | loss: 0.1557980
	speed: 0.3004s/iter; left time: 8158.6430s
	iters: 400, epoch: 7 | loss: 0.1621819
	speed: 0.3176s/iter; left time: 8594.2206s
	iters: 500, epoch: 7 | loss: 0.4562780
	speed: 0.3274s/iter; left time: 8825.1080s
	iters: 600, epoch: 7 | loss: 0.1802499
	speed: 0.3073s/iter; left time: 8252.7695s
	iters: 700, epoch: 7 | loss: 0.4613592
	speed: 0.3066s/iter; left time: 8202.6550s
	iters: 800, epoch: 7 | loss: 0.2063055
	speed: 0.3138s/iter; left time: 8364.5631s
	iters: 900, epoch: 7 | loss: 0.1874993
	speed: 0.3145s/iter; left time: 8351.9876s
	iters: 1000, epoch: 7 | loss: 0.1382929
	speed: 0.3084s/iter; left time: 8158.2119s
	iters: 1100, epoch: 7 | loss: 0.1884199
	speed: 0.3097s/iter; left time: 8163.7543s
Epoch: 7 cost time: 357.0206084251404
Epoch: 7, Steps: 1144 | Train Loss: 0.2320339 Vali Loss: 0.5744017 Test Loss: 0.4902061
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1358964
	speed: 1.6087s/iter; left time: 42169.9653s
	iters: 200, epoch: 8 | loss: 0.2523591
	speed: 0.3052s/iter; left time: 7969.0249s
	iters: 300, epoch: 8 | loss: 0.1673633
	speed: 0.2946s/iter; left time: 7664.1925s
	iters: 400, epoch: 8 | loss: 0.1522695
	speed: 0.3098s/iter; left time: 8027.2739s
	iters: 500, epoch: 8 | loss: 0.1729041
	speed: 0.3220s/iter; left time: 8312.4684s
	iters: 600, epoch: 8 | loss: 0.2019898
	speed: 0.3308s/iter; left time: 8506.9274s
	iters: 700, epoch: 8 | loss: 0.4943061
	speed: 0.3275s/iter; left time: 8387.1970s
	iters: 800, epoch: 8 | loss: 0.1810472
	speed: 0.3010s/iter; left time: 7679.4874s
	iters: 900, epoch: 8 | loss: 0.4806417
	speed: 0.3286s/iter; left time: 8350.6904s
	iters: 1000, epoch: 8 | loss: 0.4240519
	speed: 0.3232s/iter; left time: 8180.5511s
	iters: 1100, epoch: 8 | loss: 0.1832990
	speed: 0.3219s/iter; left time: 8115.7419s
Epoch: 8 cost time: 365.4138331413269
Epoch: 8, Steps: 1144 | Train Loss: 0.2305292 Vali Loss: 0.5727313 Test Loss: 0.4865798
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1611368
	speed: 1.5547s/iter; left time: 38975.5493s
	iters: 200, epoch: 9 | loss: 0.4559727
	speed: 0.3217s/iter; left time: 8033.5685s
	iters: 300, epoch: 9 | loss: 0.1989476
	speed: 0.3108s/iter; left time: 7728.6538s
	iters: 400, epoch: 9 | loss: 0.1713539
	speed: 0.3128s/iter; left time: 7747.8261s
	iters: 500, epoch: 9 | loss: 0.1905982
	speed: 0.3101s/iter; left time: 7649.5699s
	iters: 600, epoch: 9 | loss: 0.2005647
	speed: 0.3043s/iter; left time: 7477.4856s
	iters: 700, epoch: 9 | loss: 0.2211506
	speed: 0.3239s/iter; left time: 7926.2608s
	iters: 800, epoch: 9 | loss: 0.5015329
	speed: 0.3096s/iter; left time: 7544.2638s
	iters: 900, epoch: 9 | loss: 0.2140240
	speed: 0.3126s/iter; left time: 7587.3499s
	iters: 1000, epoch: 9 | loss: 0.1403882
	speed: 0.3223s/iter; left time: 7789.7226s
	iters: 1100, epoch: 9 | loss: 0.1727055
	speed: 0.3024s/iter; left time: 7277.4094s
Epoch: 9 cost time: 359.5059304237366
Epoch: 9, Steps: 1144 | Train Loss: 0.2296938 Vali Loss: 0.5719199 Test Loss: 0.4879871
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Informer_weather_96_192_Informer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
mse:0.4822527766227722, mae:0.47409623861312866
