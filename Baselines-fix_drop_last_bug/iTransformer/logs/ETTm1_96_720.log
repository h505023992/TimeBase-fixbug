Args in experiment:
Namespace(is_training=1, model_id='ETTm1_96_720', model='iTransformer', data='ETTm1', root_path='./dataset/', data_path='ETTm1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=720, enc_in=7, dec_in=7, c_out=7, d_model=128, n_heads=8, e_layers=2, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='MSE', lradj='type1', use_amp=False, use_gpu=True, gpu=2, use_multi_gpu=False, devices='0,1,2,3', exp_name='MTSF', channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv', efficient_training=False, use_norm=True, partial_start_index=0)
Use GPU: cuda:2
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.dropout.Dropout'>.
[INFO] Register count_convNd() for <class 'torch.nn.modules.conv.Conv1d'>.
[INFO] Register count_normalization() for <class 'torch.nn.modules.normalization.LayerNorm'>.
MACs: 3947008.0
Params: 304720.0
3.95M MACs
>>>>>>>start training : ETTm1_96_720_iTransformer_ETTm1_M_ft96_sl48_ll720_pl128_dm8_nh2_el1_dl128_df1_fctimeF_ebTrue_dtExp_projection_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.5465878
	speed: 0.0459s/iter; left time: 478.8756s
	iters: 200, epoch: 1 | loss: 0.5330957
	speed: 0.0279s/iter; left time: 288.2804s
	iters: 300, epoch: 1 | loss: 0.5399656
	speed: 0.0271s/iter; left time: 277.6967s
	iters: 400, epoch: 1 | loss: 0.4224794
	speed: 0.0298s/iter; left time: 302.0315s
	iters: 500, epoch: 1 | loss: 0.4939291
	speed: 0.0296s/iter; left time: 296.9335s
	iters: 600, epoch: 1 | loss: 0.4661053
	speed: 0.0293s/iter; left time: 291.5326s
	iters: 700, epoch: 1 | loss: 0.4573082
	speed: 0.0293s/iter; left time: 288.7034s
	iters: 800, epoch: 1 | loss: 0.5102769
	speed: 0.0286s/iter; left time: 278.7942s
	iters: 900, epoch: 1 | loss: 0.3951057
	speed: 0.0295s/iter; left time: 284.6699s
	iters: 1000, epoch: 1 | loss: 0.4501030
	speed: 0.0308s/iter; left time: 294.0359s
Max Memory (MB): 16.318359375
Epoch: 1 cost time: 32.408154249191284
Epoch: 1, Steps: 1054 | Train Loss: 0.5116748 Vali Loss: 0.9864646 Test Loss: 0.4936621
Validation loss decreased (inf --> 0.986465).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4789780
	speed: 1.1995s/iter; left time: 11260.1420s
	iters: 200, epoch: 2 | loss: 0.5402190
	speed: 0.0341s/iter; left time: 316.4019s
	iters: 300, epoch: 2 | loss: 0.5049962
	speed: 0.0321s/iter; left time: 295.3614s
	iters: 400, epoch: 2 | loss: 0.4481992
	speed: 0.0335s/iter; left time: 304.6435s
	iters: 500, epoch: 2 | loss: 0.4293721
	speed: 0.0322s/iter; left time: 289.1754s
	iters: 600, epoch: 2 | loss: 0.4969322
	speed: 0.0332s/iter; left time: 294.7836s
	iters: 700, epoch: 2 | loss: 0.4644968
	speed: 0.0321s/iter; left time: 282.3419s
	iters: 800, epoch: 2 | loss: 0.6436744
	speed: 0.0337s/iter; left time: 292.6139s
	iters: 900, epoch: 2 | loss: 0.4788955
	speed: 0.0325s/iter; left time: 278.7604s
	iters: 1000, epoch: 2 | loss: 0.4734049
	speed: 0.0325s/iter; left time: 276.1714s
Max Memory (MB): 16.318359375
Epoch: 2 cost time: 35.84290432929993
Epoch: 2, Steps: 1054 | Train Loss: 0.4686971 Vali Loss: 0.9754956 Test Loss: 0.4878201
Validation loss decreased (0.986465 --> 0.975496).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4075420
	speed: 1.1794s/iter; left time: 9827.7252s
	iters: 200, epoch: 3 | loss: 0.4117304
	speed: 0.0281s/iter; left time: 231.1546s
	iters: 300, epoch: 3 | loss: 0.5203088
	speed: 0.0281s/iter; left time: 228.3739s
	iters: 400, epoch: 3 | loss: 0.4817285
	speed: 0.0279s/iter; left time: 224.1511s
	iters: 500, epoch: 3 | loss: 0.4670317
	speed: 0.0268s/iter; left time: 212.7680s
	iters: 600, epoch: 3 | loss: 0.4206380
	speed: 0.0286s/iter; left time: 224.2318s
	iters: 700, epoch: 3 | loss: 0.4387530
	speed: 0.0292s/iter; left time: 225.7295s
	iters: 800, epoch: 3 | loss: 0.4790452
	speed: 0.0299s/iter; left time: 228.4546s
	iters: 900, epoch: 3 | loss: 0.4203895
	speed: 0.0295s/iter; left time: 222.4764s
	iters: 1000, epoch: 3 | loss: 0.4342196
	speed: 0.0282s/iter; left time: 209.9472s
Max Memory (MB): 16.318359375
Epoch: 3 cost time: 30.867530584335327
Epoch: 3, Steps: 1054 | Train Loss: 0.4595622 Vali Loss: 0.9733953 Test Loss: 0.4874296
Validation loss decreased (0.975496 --> 0.973395).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4727625
	speed: 1.2189s/iter; left time: 8872.1111s
	iters: 200, epoch: 4 | loss: 0.5041863
	speed: 0.0348s/iter; left time: 250.0366s
	iters: 300, epoch: 4 | loss: 0.4673123
	speed: 0.0353s/iter; left time: 249.7539s
	iters: 400, epoch: 4 | loss: 0.4413612
	speed: 0.0351s/iter; left time: 244.9672s
	iters: 500, epoch: 4 | loss: 0.3940308
	speed: 0.0326s/iter; left time: 224.3610s
	iters: 600, epoch: 4 | loss: 0.5265741
	speed: 0.0328s/iter; left time: 222.0512s
	iters: 700, epoch: 4 | loss: 0.4281244
	speed: 0.0334s/iter; left time: 222.8120s
	iters: 800, epoch: 4 | loss: 0.5104409
	speed: 0.0320s/iter; left time: 210.6844s
	iters: 900, epoch: 4 | loss: 0.4663555
	speed: 0.0340s/iter; left time: 220.5024s
	iters: 1000, epoch: 4 | loss: 0.4387326
	speed: 0.0351s/iter; left time: 223.9206s
Max Memory (MB): 16.318359375
Epoch: 4 cost time: 36.81652331352234
Epoch: 4, Steps: 1054 | Train Loss: 0.4558083 Vali Loss: 0.9725373 Test Loss: 0.4879906
Validation loss decreased (0.973395 --> 0.972537).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5173088
	speed: 1.2630s/iter; left time: 7862.1087s
	iters: 200, epoch: 5 | loss: 0.3499563
	speed: 0.0321s/iter; left time: 196.3233s
	iters: 300, epoch: 5 | loss: 0.4824011
	speed: 0.0331s/iter; left time: 199.6207s
	iters: 400, epoch: 5 | loss: 0.3967080
	speed: 0.0320s/iter; left time: 189.6521s
	iters: 500, epoch: 5 | loss: 0.4487436
	speed: 0.0346s/iter; left time: 201.7376s
	iters: 600, epoch: 5 | loss: 0.4378968
	speed: 0.0321s/iter; left time: 183.6463s
	iters: 700, epoch: 5 | loss: 0.3846669
	speed: 0.0289s/iter; left time: 162.4368s
	iters: 800, epoch: 5 | loss: 0.4334757
	speed: 0.0287s/iter; left time: 158.6331s
	iters: 900, epoch: 5 | loss: 0.4749871
	speed: 0.0283s/iter; left time: 153.5915s
	iters: 1000, epoch: 5 | loss: 0.5104280
	speed: 0.0296s/iter; left time: 157.6991s
Max Memory (MB): 16.318359375
Epoch: 5 cost time: 33.52095580101013
Epoch: 5, Steps: 1054 | Train Loss: 0.4544765 Vali Loss: 0.9707770 Test Loss: 0.4871174
Validation loss decreased (0.972537 --> 0.970777).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4345825
	speed: 1.1219s/iter; left time: 5801.1653s
	iters: 200, epoch: 6 | loss: 0.4944535
	speed: 0.0293s/iter; left time: 148.3711s
	iters: 300, epoch: 6 | loss: 0.4491933
	speed: 0.0292s/iter; left time: 144.9286s
	iters: 400, epoch: 6 | loss: 0.4328676
	speed: 0.0310s/iter; left time: 151.0254s
	iters: 500, epoch: 6 | loss: 0.4187948
	speed: 0.0296s/iter; left time: 141.3512s
	iters: 600, epoch: 6 | loss: 0.4880829
	speed: 0.0291s/iter; left time: 136.0928s
	iters: 700, epoch: 6 | loss: 0.4981493
	speed: 0.0307s/iter; left time: 140.2631s
	iters: 800, epoch: 6 | loss: 0.4259943
	speed: 0.0290s/iter; left time: 129.7020s
	iters: 900, epoch: 6 | loss: 0.4795249
	speed: 0.0302s/iter; left time: 132.0487s
	iters: 1000, epoch: 6 | loss: 0.4429255
	speed: 0.0303s/iter; left time: 129.6047s
Max Memory (MB): 16.318359375
Epoch: 6 cost time: 32.2091703414917
Epoch: 6, Steps: 1054 | Train Loss: 0.4535266 Vali Loss: 0.9716826 Test Loss: 0.4872847
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3908529
	speed: 1.1809s/iter; left time: 4861.8216s
	iters: 200, epoch: 7 | loss: 0.4051855
	speed: 0.0313s/iter; left time: 125.9213s
	iters: 300, epoch: 7 | loss: 0.3838749
	speed: 0.0299s/iter; left time: 117.0758s
	iters: 400, epoch: 7 | loss: 0.3814194
	speed: 0.0287s/iter; left time: 109.4215s
	iters: 500, epoch: 7 | loss: 0.5264621
	speed: 0.0275s/iter; left time: 102.3794s
	iters: 600, epoch: 7 | loss: 0.3717990
	speed: 0.0279s/iter; left time: 100.7377s
	iters: 700, epoch: 7 | loss: 0.4256634
	speed: 0.0283s/iter; left time: 99.4464s
	iters: 800, epoch: 7 | loss: 0.4392627
	speed: 0.0295s/iter; left time: 100.8423s
	iters: 900, epoch: 7 | loss: 0.5452113
	speed: 0.0292s/iter; left time: 96.8200s
	iters: 1000, epoch: 7 | loss: 0.4516968
	speed: 0.0281s/iter; left time: 90.4546s
Max Memory (MB): 16.318359375
Epoch: 7 cost time: 31.431781768798828
Epoch: 7, Steps: 1054 | Train Loss: 0.4529795 Vali Loss: 0.9707323 Test Loss: 0.4874537
Validation loss decreased (0.970777 --> 0.970732).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3527095
	speed: 1.1496s/iter; left time: 3521.1787s
	iters: 200, epoch: 8 | loss: 0.4445072
	speed: 0.0315s/iter; left time: 93.4362s
	iters: 300, epoch: 8 | loss: 0.3940993
	speed: 0.0313s/iter; left time: 89.5624s
	iters: 400, epoch: 8 | loss: 0.3729471
	speed: 0.0321s/iter; left time: 88.7428s
	iters: 500, epoch: 8 | loss: 0.4297655
	speed: 0.0339s/iter; left time: 90.2698s
	iters: 600, epoch: 8 | loss: 0.4063431
	speed: 0.0326s/iter; left time: 83.4260s
	iters: 700, epoch: 8 | loss: 0.4197526
	speed: 0.0319s/iter; left time: 78.6835s
	iters: 800, epoch: 8 | loss: 0.5004179
	speed: 0.0337s/iter; left time: 79.5653s
	iters: 900, epoch: 8 | loss: 0.5535176
	speed: 0.0329s/iter; left time: 74.4611s
	iters: 1000, epoch: 8 | loss: 0.4058310
	speed: 0.0324s/iter; left time: 70.0759s
Max Memory (MB): 16.318359375
Epoch: 8 cost time: 35.1868462562561
Epoch: 8, Steps: 1054 | Train Loss: 0.4529394 Vali Loss: 0.9710057 Test Loss: 0.4875065
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.4919427
	speed: 1.1469s/iter; left time: 2304.0536s
	iters: 200, epoch: 9 | loss: 0.3679489
	speed: 0.0287s/iter; left time: 54.7705s
	iters: 300, epoch: 9 | loss: 0.4726988
	speed: 0.0282s/iter; left time: 51.0691s
	iters: 400, epoch: 9 | loss: 0.4914015
	speed: 0.0268s/iter; left time: 45.8237s
	iters: 500, epoch: 9 | loss: 0.4731512
	speed: 0.0277s/iter; left time: 44.6127s
	iters: 600, epoch: 9 | loss: 0.4389755
	speed: 0.0282s/iter; left time: 42.5517s
	iters: 700, epoch: 9 | loss: 0.4535447
	speed: 0.0276s/iter; left time: 38.8308s
	iters: 800, epoch: 9 | loss: 0.4872016
	speed: 0.0287s/iter; left time: 37.6228s
	iters: 900, epoch: 9 | loss: 0.4898627
	speed: 0.0282s/iter; left time: 34.0980s
	iters: 1000, epoch: 9 | loss: 0.4492940
	speed: 0.0283s/iter; left time: 31.4001s
Max Memory (MB): 16.318359375
Epoch: 9 cost time: 30.503889322280884
Epoch: 9, Steps: 1054 | Train Loss: 0.4529303 Vali Loss: 0.9709607 Test Loss: 0.4874057
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.5069774
	speed: 1.1339s/iter; left time: 1082.9087s
	iters: 200, epoch: 10 | loss: 0.3966210
	speed: 0.0283s/iter; left time: 24.1605s
	iters: 300, epoch: 10 | loss: 0.4076068
	speed: 0.0284s/iter; left time: 21.4077s
	iters: 400, epoch: 10 | loss: 0.5116362
	speed: 0.0297s/iter; left time: 19.4790s
	iters: 500, epoch: 10 | loss: 0.4754974
	speed: 0.0289s/iter; left time: 16.0584s
	iters: 600, epoch: 10 | loss: 0.4909724
	speed: 0.0291s/iter; left time: 13.2215s
	iters: 700, epoch: 10 | loss: 0.3505194
	speed: 0.0290s/iter; left time: 10.3124s
	iters: 800, epoch: 10 | loss: 0.4921986
	speed: 0.0292s/iter; left time: 7.4559s
	iters: 900, epoch: 10 | loss: 0.4596282
	speed: 0.0296s/iter; left time: 4.5838s
	iters: 1000, epoch: 10 | loss: 0.4970146
	speed: 0.0297s/iter; left time: 1.6317s
Max Memory (MB): 16.318359375
Epoch: 10 cost time: 31.579157829284668
Epoch: 10, Steps: 1054 | Train Loss: 0.4528877 Vali Loss: 0.9715674 Test Loss: 0.4873792
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm1_96_720_iTransformer_ETTm1_M_ft96_sl48_ll720_pl128_dm8_nh2_el1_dl128_df1_fctimeF_ebTrue_dtExp_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
test shape: (10801, 1, 720, 7) (10801, 1, 720, 7)
test shape: (10801, 720, 7) (10801, 720, 7)
mse:0.4874546527862549, mae:0.456920862197876
