Args in experiment:
Namespace(is_training=1, train_only=False, model_id='Autoformer_electricity_192_720', model='Autoformer', data='custom', root_path='./dataset/', data_path='electricity.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=192, label_len=48, pred_len=720, individual=False, embed_type=0, enc_in=321, dec_in=321, c_out=321, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : Autoformer_electricity_192_720_Autoformer_custom_ftM_sl192_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17501
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.3524476
	speed: 0.2827s/iter; left time: 4610.4299s
	iters: 200, epoch: 1 | loss: 0.3140470
	speed: 0.2506s/iter; left time: 4062.2097s
	iters: 300, epoch: 1 | loss: 0.2926414
	speed: 0.2520s/iter; left time: 4060.6951s
	iters: 400, epoch: 1 | loss: 0.2702445
	speed: 0.2628s/iter; left time: 4208.1502s
	iters: 500, epoch: 1 | loss: 0.2486988
	speed: 0.2594s/iter; left time: 4126.8880s
Epoch: 1 cost time: 142.89028906822205
Epoch: 1, Steps: 547 | Train Loss: 0.3326830 Vali Loss: 0.2487679 Test Loss: 0.3240917
Validation loss decreased (inf --> 0.248768).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2308426
	speed: 0.8936s/iter; left time: 14086.6716s
	iters: 200, epoch: 2 | loss: 0.2201598
	speed: 0.2569s/iter; left time: 4024.0920s
	iters: 300, epoch: 2 | loss: 0.2177541
	speed: 0.2536s/iter; left time: 3946.8553s
	iters: 400, epoch: 2 | loss: 0.1867182
	speed: 0.2509s/iter; left time: 3879.7124s
	iters: 500, epoch: 2 | loss: 0.1866675
	speed: 0.2579s/iter; left time: 3961.6549s
Epoch: 2 cost time: 141.55601978302002
Epoch: 2, Steps: 547 | Train Loss: 0.2077891 Vali Loss: 0.2110706 Test Loss: 0.2543138
Validation loss decreased (0.248768 --> 0.211071).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1856804
	speed: 0.9642s/iter; left time: 14672.7615s
	iters: 200, epoch: 3 | loss: 0.1782910
	speed: 0.2599s/iter; left time: 3929.1496s
	iters: 300, epoch: 3 | loss: 0.1749986
	speed: 0.2619s/iter; left time: 3933.2732s
	iters: 400, epoch: 3 | loss: 0.1801971
	speed: 0.2637s/iter; left time: 3933.1123s
	iters: 500, epoch: 3 | loss: 0.1722440
	speed: 0.2555s/iter; left time: 3785.2720s
Epoch: 3 cost time: 144.00455713272095
Epoch: 3, Steps: 547 | Train Loss: 0.1783896 Vali Loss: 0.2108739 Test Loss: 0.2684360
Validation loss decreased (0.211071 --> 0.210874).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1775893
	speed: 1.0354s/iter; left time: 15189.5281s
	iters: 200, epoch: 4 | loss: 0.1633020
	speed: 0.2502s/iter; left time: 3645.9186s
	iters: 300, epoch: 4 | loss: 0.1753317
	speed: 0.2568s/iter; left time: 3715.4205s
	iters: 400, epoch: 4 | loss: 0.1759039
	speed: 0.2601s/iter; left time: 3736.9734s
	iters: 500, epoch: 4 | loss: 0.1707210
	speed: 0.2595s/iter; left time: 3702.6352s
Epoch: 4 cost time: 143.98466444015503
Epoch: 4, Steps: 547 | Train Loss: 0.1686687 Vali Loss: 0.2091557 Test Loss: 0.2465220
Validation loss decreased (0.210874 --> 0.209156).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1643965
	speed: 0.9986s/iter; left time: 14102.7820s
	iters: 200, epoch: 5 | loss: 0.1563028
	speed: 0.2600s/iter; left time: 3646.3543s
	iters: 300, epoch: 5 | loss: 0.1621641
	speed: 0.2562s/iter; left time: 3566.7420s
	iters: 400, epoch: 5 | loss: 0.1661952
	speed: 0.2649s/iter; left time: 3661.4099s
	iters: 500, epoch: 5 | loss: 0.1609640
	speed: 0.2665s/iter; left time: 3656.8276s
Epoch: 5 cost time: 147.47495651245117
Epoch: 5, Steps: 547 | Train Loss: 0.1635978 Vali Loss: 0.2096097 Test Loss: 0.2439038
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1571613
	speed: 1.1190s/iter; left time: 15191.3132s
	iters: 200, epoch: 6 | loss: 0.1572156
	speed: 0.2755s/iter; left time: 3713.1344s
	iters: 300, epoch: 6 | loss: 0.1661556
	speed: 0.2698s/iter; left time: 3608.4580s
	iters: 400, epoch: 6 | loss: 0.1583522
	speed: 0.2738s/iter; left time: 3635.2279s
	iters: 500, epoch: 6 | loss: 0.1641773
	speed: 0.2650s/iter; left time: 3491.3245s
Epoch: 6 cost time: 149.9818332195282
Epoch: 6, Steps: 547 | Train Loss: 0.1609672 Vali Loss: 0.2115973 Test Loss: 0.2434076
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1603402
	speed: 1.0447s/iter; left time: 13611.8383s
	iters: 200, epoch: 7 | loss: 0.1623642
	speed: 0.2611s/iter; left time: 3375.3579s
	iters: 300, epoch: 7 | loss: 0.1560325
	speed: 0.2612s/iter; left time: 3351.3155s
	iters: 400, epoch: 7 | loss: 0.1583118
	speed: 0.2569s/iter; left time: 3270.4704s
	iters: 500, epoch: 7 | loss: 0.1571359
	speed: 0.2560s/iter; left time: 3232.7110s
Epoch: 7 cost time: 144.97385358810425
Epoch: 7, Steps: 547 | Train Loss: 0.1596515 Vali Loss: 0.2111541 Test Loss: 0.2455249
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Autoformer_electricity_192_720_Autoformer_custom_ftM_sl192_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
mse:0.2464349865913391, mae:0.35431116819381714
