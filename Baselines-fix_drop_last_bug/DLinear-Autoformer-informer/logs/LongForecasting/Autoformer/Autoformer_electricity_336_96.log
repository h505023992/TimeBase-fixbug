Args in experiment:
Namespace(is_training=1, train_only=False, model_id='Autoformer_electricity_336_96', model='Autoformer', data='custom', root_path='./dataset/', data_path='electricity.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, individual=False, embed_type=0, enc_in=321, dec_in=321, c_out=321, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : Autoformer_electricity_336_96_Autoformer_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17981
val 2537
test 5165
	iters: 100, epoch: 1 | loss: 0.2519653
	speed: 0.2380s/iter; left time: 3989.3467s
	iters: 200, epoch: 1 | loss: 0.2114958
	speed: 0.2249s/iter; left time: 3747.6750s
	iters: 300, epoch: 1 | loss: 0.2203276
	speed: 0.2256s/iter; left time: 3735.7924s
	iters: 400, epoch: 1 | loss: 0.1783297
	speed: 0.2244s/iter; left time: 3693.2982s
	iters: 500, epoch: 1 | loss: 0.1918322
	speed: 0.2247s/iter; left time: 3677.0994s
Epoch: 1 cost time: 127.86105346679688
Epoch: 1, Steps: 562 | Train Loss: 0.2239388 Vali Loss: 0.1707327 Test Loss: 0.2042720
Validation loss decreased (inf --> 0.170733).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1725598
	speed: 0.9110s/iter; left time: 14756.5594s
	iters: 200, epoch: 2 | loss: 0.1426842
	speed: 0.2304s/iter; left time: 3708.5149s
	iters: 300, epoch: 2 | loss: 0.1502446
	speed: 0.2252s/iter; left time: 3603.2279s
	iters: 400, epoch: 2 | loss: 0.1241867
	speed: 0.2229s/iter; left time: 3543.5147s
	iters: 500, epoch: 2 | loss: 0.1266630
	speed: 0.2235s/iter; left time: 3531.5480s
Epoch: 2 cost time: 127.4298346042633
Epoch: 2, Steps: 562 | Train Loss: 0.1424337 Vali Loss: 0.1635705 Test Loss: 0.1996266
Validation loss decreased (0.170733 --> 0.163570).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1174223
	speed: 0.8726s/iter; left time: 13644.3628s
	iters: 200, epoch: 3 | loss: 0.1144900
	speed: 0.2214s/iter; left time: 3440.1757s
	iters: 300, epoch: 3 | loss: 0.1196186
	speed: 0.2198s/iter; left time: 3393.7126s
	iters: 400, epoch: 3 | loss: 0.1161608
	speed: 0.2161s/iter; left time: 3314.8980s
	iters: 500, epoch: 3 | loss: 0.1203352
	speed: 0.2164s/iter; left time: 3297.0250s
Epoch: 3 cost time: 124.31149458885193
Epoch: 3, Steps: 562 | Train Loss: 0.1185785 Vali Loss: 0.1672194 Test Loss: 0.2031192
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1104816
	speed: 0.8417s/iter; left time: 12689.0129s
	iters: 200, epoch: 4 | loss: 0.1121638
	speed: 0.2216s/iter; left time: 3318.7409s
	iters: 300, epoch: 4 | loss: 0.1079637
	speed: 0.2251s/iter; left time: 3348.6081s
	iters: 400, epoch: 4 | loss: 0.1090206
	speed: 0.2230s/iter; left time: 3294.4907s
	iters: 500, epoch: 4 | loss: 0.1048181
	speed: 0.2213s/iter; left time: 3247.6041s
Epoch: 4 cost time: 126.19610977172852
Epoch: 4, Steps: 562 | Train Loss: 0.1103584 Vali Loss: 0.1756924 Test Loss: 0.2039654
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1075092
	speed: 0.9081s/iter; left time: 13178.5866s
	iters: 200, epoch: 5 | loss: 0.1113602
	speed: 0.2184s/iter; left time: 3147.7157s
	iters: 300, epoch: 5 | loss: 0.1094129
	speed: 0.2213s/iter; left time: 3167.9476s
	iters: 400, epoch: 5 | loss: 0.1089169
	speed: 0.2227s/iter; left time: 3165.6779s
	iters: 500, epoch: 5 | loss: 0.1079702
	speed: 0.2220s/iter; left time: 3133.4408s
Epoch: 5 cost time: 125.5690770149231
Epoch: 5, Steps: 562 | Train Loss: 0.1065133 Vali Loss: 0.1781356 Test Loss: 0.2068493
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Autoformer_electricity_336_96_Autoformer_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
mse:0.19943758845329285, mae:0.31295549869537354
