Args in experiment:
Namespace(is_training=1, model_id='ETTm1_720_96', model='FITS', data='ETTm1', root_path='./dataset/', data_path='ETTm1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=96, individual=False, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, ab=2, hidden_size=1, kernel=5, groups=1, levels=3, stacks=1, num_workers=10, itr=1, train_epochs=30, batch_size=128, patience=5, learning_rate=0.0005, des='Exp', loss='mse', lradj='type3', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False, aug_method='NA', aug_rate=0.5, in_batch_augmentation=False, in_dataset_augmentation=False, data_size=1, aug_data_size=1, seed=0, testset_div=2, test_time_train=False, train_mode=2, cut_freq=196, base_T=24, H_order=6)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_720_96_FITS_ETTm1_ftM_sl720_ll48_pl96_H6_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=196, out_features=222, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  38986752.0
params:  43734.0
Trainable parameters:  43734
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3459021
	speed: 0.0685s/iter; left time: 533.6835s
	iters: 200, epoch: 1 | loss: 0.2445262
	speed: 0.0616s/iter; left time: 473.6941s
Epoch: 1 cost time: 16.89929461479187
Epoch: 1, Steps: 263 | Train Loss: 0.3436843 Vali Loss: 0.6439333 Test Loss: 0.4707280
Validation loss decreased (inf --> 0.643933).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2007858
	speed: 0.2962s/iter; left time: 2229.6398s
	iters: 200, epoch: 2 | loss: 0.1654516
	speed: 0.0625s/iter; left time: 464.4195s
Epoch: 2 cost time: 17.92904257774353
Epoch: 2, Steps: 263 | Train Loss: 0.1908141 Vali Loss: 0.6110393 Test Loss: 0.4593749
Validation loss decreased (0.643933 --> 0.611039).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.1500145
	speed: 0.2996s/iter; left time: 2176.4093s
	iters: 200, epoch: 3 | loss: 0.1298872
	speed: 0.0727s/iter; left time: 520.9708s
Epoch: 3 cost time: 19.810035228729248
Epoch: 3, Steps: 263 | Train Loss: 0.1369941 Vali Loss: 0.5728517 Test Loss: 0.4393980
Validation loss decreased (0.611039 --> 0.572852).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1090918
	speed: 0.3059s/iter; left time: 2141.9522s
	iters: 200, epoch: 4 | loss: 0.0959122
	speed: 0.0744s/iter; left time: 513.6994s
Epoch: 4 cost time: 17.92167830467224
Epoch: 4, Steps: 263 | Train Loss: 0.1050437 Vali Loss: 0.5442238 Test Loss: 0.4232008
Validation loss decreased (0.572852 --> 0.544224).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.0856792
	speed: 0.2566s/iter; left time: 1729.0870s
	iters: 200, epoch: 5 | loss: 0.0820738
	speed: 0.0664s/iter; left time: 440.9580s
Epoch: 5 cost time: 17.860379695892334
Epoch: 5, Steps: 263 | Train Loss: 0.0844258 Vali Loss: 0.5164035 Test Loss: 0.4064084
Validation loss decreased (0.544224 --> 0.516403).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.0732558
	speed: 0.2751s/iter; left time: 1781.4566s
	iters: 200, epoch: 6 | loss: 0.0716640
	speed: 0.0753s/iter; left time: 480.1697s
Epoch: 6 cost time: 18.057629585266113
Epoch: 6, Steps: 263 | Train Loss: 0.0708102 Vali Loss: 0.4970629 Test Loss: 0.3931441
Validation loss decreased (0.516403 --> 0.497063).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.0575091
	speed: 0.2922s/iter; left time: 1815.2071s
	iters: 200, epoch: 7 | loss: 0.0599164
	speed: 0.0652s/iter; left time: 398.6189s
Epoch: 7 cost time: 19.0116605758667
Epoch: 7, Steps: 263 | Train Loss: 0.0616518 Vali Loss: 0.4836692 Test Loss: 0.3826949
Validation loss decreased (0.497063 --> 0.483669).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.0624097
	speed: 0.2919s/iter; left time: 1736.7695s
	iters: 200, epoch: 8 | loss: 0.0511599
	speed: 0.0665s/iter; left time: 388.8764s
Epoch: 8 cost time: 17.868406772613525
Epoch: 8, Steps: 263 | Train Loss: 0.0554099 Vali Loss: 0.4692901 Test Loss: 0.3735071
Validation loss decreased (0.483669 --> 0.469290).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.0492128
	speed: 0.2974s/iter; left time: 1691.0996s
	iters: 200, epoch: 9 | loss: 0.0504996
	speed: 0.0575s/iter; left time: 321.0272s
Epoch: 9 cost time: 15.841744661331177
Epoch: 9, Steps: 263 | Train Loss: 0.0510957 Vali Loss: 0.4626912 Test Loss: 0.3664131
Validation loss decreased (0.469290 --> 0.462691).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.0503368
	speed: 0.2801s/iter; left time: 1519.4029s
	iters: 200, epoch: 10 | loss: 0.0458675
	speed: 0.0555s/iter; left time: 295.2446s
Epoch: 10 cost time: 16.472006797790527
Epoch: 10, Steps: 263 | Train Loss: 0.0480669 Vali Loss: 0.4559951 Test Loss: 0.3589741
Validation loss decreased (0.462691 --> 0.455995).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.0529878
	speed: 0.2696s/iter; left time: 1391.5070s
	iters: 200, epoch: 11 | loss: 0.0447884
	speed: 0.0538s/iter; left time: 272.2208s
Epoch: 11 cost time: 15.79459810256958
Epoch: 11, Steps: 263 | Train Loss: 0.0459506 Vali Loss: 0.4470669 Test Loss: 0.3535043
Validation loss decreased (0.455995 --> 0.447067).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.0412971
	speed: 0.2890s/iter; left time: 1415.5580s
	iters: 200, epoch: 12 | loss: 0.0427807
	speed: 0.0630s/iter; left time: 302.4951s
Epoch: 12 cost time: 17.420719861984253
Epoch: 12, Steps: 263 | Train Loss: 0.0444225 Vali Loss: 0.4422576 Test Loss: 0.3480842
Validation loss decreased (0.447067 --> 0.442258).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.0438309
	speed: 0.3008s/iter; left time: 1394.2986s
	iters: 200, epoch: 13 | loss: 0.0416492
	speed: 0.0650s/iter; left time: 294.7616s
Epoch: 13 cost time: 16.94606637954712
Epoch: 13, Steps: 263 | Train Loss: 0.0433239 Vali Loss: 0.4347997 Test Loss: 0.3440163
Validation loss decreased (0.442258 --> 0.434800).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.0427569
	speed: 0.2666s/iter; left time: 1165.5601s
	iters: 200, epoch: 14 | loss: 0.0418785
	speed: 0.0626s/iter; left time: 267.4291s
Epoch: 14 cost time: 15.739839315414429
Epoch: 14, Steps: 263 | Train Loss: 0.0425192 Vali Loss: 0.4338431 Test Loss: 0.3389793
Validation loss decreased (0.434800 --> 0.433843).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.0396148
	speed: 0.2632s/iter; left time: 1081.5599s
	iters: 200, epoch: 15 | loss: 0.0456415
	speed: 0.0542s/iter; left time: 217.2686s
Epoch: 15 cost time: 15.363090991973877
Epoch: 15, Steps: 263 | Train Loss: 0.0419484 Vali Loss: 0.4279016 Test Loss: 0.3362771
Validation loss decreased (0.433843 --> 0.427902).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.0406811
	speed: 0.3183s/iter; left time: 1224.0453s
	iters: 200, epoch: 16 | loss: 0.0394865
	speed: 0.0703s/iter; left time: 263.4069s
Epoch: 16 cost time: 19.388838052749634
Epoch: 16, Steps: 263 | Train Loss: 0.0415041 Vali Loss: 0.4273395 Test Loss: 0.3342623
Validation loss decreased (0.427902 --> 0.427340).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.0389261
	speed: 0.2861s/iter; left time: 1025.1073s
	iters: 200, epoch: 17 | loss: 0.0403842
	speed: 0.0554s/iter; left time: 192.8015s
Epoch: 17 cost time: 15.956931829452515
Epoch: 17, Steps: 263 | Train Loss: 0.0411669 Vali Loss: 0.4263717 Test Loss: 0.3311228
Validation loss decreased (0.427340 --> 0.426372).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.0407370
	speed: 0.2669s/iter; left time: 886.2465s
	iters: 200, epoch: 18 | loss: 0.0431135
	speed: 0.0734s/iter; left time: 236.2605s
Epoch: 18 cost time: 18.172029972076416
Epoch: 18, Steps: 263 | Train Loss: 0.0409241 Vali Loss: 0.4236416 Test Loss: 0.3300017
Validation loss decreased (0.426372 --> 0.423642).  Saving model ...
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.0412850
	speed: 0.2730s/iter; left time: 834.4374s
	iters: 200, epoch: 19 | loss: 0.0417493
	speed: 0.0652s/iter; left time: 192.6695s
Epoch: 19 cost time: 17.575289011001587
Epoch: 19, Steps: 263 | Train Loss: 0.0407444 Vali Loss: 0.4224536 Test Loss: 0.3266503
Validation loss decreased (0.423642 --> 0.422454).  Saving model ...
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.0430964
	speed: 0.2892s/iter; left time: 807.9683s
	iters: 200, epoch: 20 | loss: 0.0363512
	speed: 0.0724s/iter; left time: 194.9879s
Epoch: 20 cost time: 17.9925639629364
Epoch: 20, Steps: 263 | Train Loss: 0.0405839 Vali Loss: 0.4203268 Test Loss: 0.3253153
Validation loss decreased (0.422454 --> 0.420327).  Saving model ...
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.0399168
	speed: 0.2365s/iter; left time: 598.7075s
	iters: 200, epoch: 21 | loss: 0.0371580
	speed: 0.0631s/iter; left time: 153.4052s
Epoch: 21 cost time: 14.835206031799316
Epoch: 21, Steps: 263 | Train Loss: 0.0404929 Vali Loss: 0.4210034 Test Loss: 0.3249557
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.0379986
	speed: 0.2370s/iter; left time: 537.6191s
	iters: 200, epoch: 22 | loss: 0.0426375
	speed: 0.0508s/iter; left time: 110.1271s
Epoch: 22 cost time: 14.195216417312622
Epoch: 22, Steps: 263 | Train Loss: 0.0404129 Vali Loss: 0.4191466 Test Loss: 0.3237246
Validation loss decreased (0.420327 --> 0.419147).  Saving model ...
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.0368105
	speed: 0.2194s/iter; left time: 439.9028s
	iters: 200, epoch: 23 | loss: 0.0392522
	speed: 0.0532s/iter; left time: 101.3966s
Epoch: 23 cost time: 14.280941009521484
Epoch: 23, Steps: 263 | Train Loss: 0.0403428 Vali Loss: 0.4201066 Test Loss: 0.3225454
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.0389472
	speed: 0.2744s/iter; left time: 478.0080s
	iters: 200, epoch: 24 | loss: 0.0400807
	speed: 0.0738s/iter; left time: 121.1743s
Epoch: 24 cost time: 19.03889513015747
Epoch: 24, Steps: 263 | Train Loss: 0.0403242 Vali Loss: 0.4165596 Test Loss: 0.3220561
Validation loss decreased (0.419147 --> 0.416560).  Saving model ...
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.0419499
	speed: 0.3065s/iter; left time: 453.2989s
	iters: 200, epoch: 25 | loss: 0.0412871
	speed: 0.0653s/iter; left time: 90.0311s
Epoch: 25 cost time: 17.665737867355347
Epoch: 25, Steps: 263 | Train Loss: 0.0402915 Vali Loss: 0.4182933 Test Loss: 0.3211071
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.0399282
	speed: 0.2752s/iter; left time: 334.6286s
	iters: 200, epoch: 26 | loss: 0.0426239
	speed: 0.0688s/iter; left time: 76.7377s
Epoch: 26 cost time: 17.977999448776245
Epoch: 26, Steps: 263 | Train Loss: 0.0402682 Vali Loss: 0.4181883 Test Loss: 0.3207855
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.0376531
	speed: 0.2769s/iter; left time: 263.9222s
	iters: 200, epoch: 27 | loss: 0.0392485
	speed: 0.0665s/iter; left time: 56.7549s
Epoch: 27 cost time: 17.922619819641113
Epoch: 27, Steps: 263 | Train Loss: 0.0402664 Vali Loss: 0.4171263 Test Loss: 0.3206887
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.0433619
	speed: 0.3105s/iter; left time: 214.2154s
	iters: 200, epoch: 28 | loss: 0.0404039
	speed: 0.0677s/iter; left time: 39.9448s
Epoch: 28 cost time: 18.30023193359375
Epoch: 28, Steps: 263 | Train Loss: 0.0402445 Vali Loss: 0.4180788 Test Loss: 0.3206445
EarlyStopping counter: 4 out of 5
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.0436921
	speed: 0.2776s/iter; left time: 118.5352s
	iters: 200, epoch: 29 | loss: 0.0408044
	speed: 0.0557s/iter; left time: 18.2193s
Epoch: 29 cost time: 15.61281132698059
Epoch: 29, Steps: 263 | Train Loss: 0.0402490 Vali Loss: 0.4173759 Test Loss: 0.3200674
EarlyStopping counter: 5 out of 5
Early stopping
train 33745
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=196, out_features=222, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  38986752.0
params:  43734.0
Trainable parameters:  43734
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2763388
	speed: 0.0699s/iter; left time: 544.9224s
	iters: 200, epoch: 1 | loss: 0.2549461
	speed: 0.0609s/iter; left time: 468.3839s
Epoch: 1 cost time: 17.052114963531494
Epoch: 1, Steps: 263 | Train Loss: 0.2662439 Vali Loss: 0.4016969 Test Loss: 0.3147055
Validation loss decreased (inf --> 0.401697).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2589304
	speed: 0.2739s/iter; left time: 2061.9553s
	iters: 200, epoch: 2 | loss: 0.3017674
	speed: 0.0683s/iter; left time: 507.1963s
Epoch: 2 cost time: 17.85108780860901
Epoch: 2, Steps: 263 | Train Loss: 0.2633895 Vali Loss: 0.3939933 Test Loss: 0.3138498
Validation loss decreased (0.401697 --> 0.393993).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2621928
	speed: 0.3141s/iter; left time: 2245.5168s
	iters: 200, epoch: 3 | loss: 0.2412611
	speed: 0.0742s/iter; left time: 531.4434s
Epoch: 3 cost time: 19.469600915908813
Epoch: 3, Steps: 263 | Train Loss: 0.2625032 Vali Loss: 0.3922471 Test Loss: 0.3139265
Validation loss decreased (0.393993 --> 0.392247).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2358130
	speed: 0.2894s/iter; left time: 2026.1558s
	iters: 200, epoch: 4 | loss: 0.2468143
	speed: 0.0630s/iter; left time: 434.5092s
Epoch: 4 cost time: 17.047497272491455
Epoch: 4, Steps: 263 | Train Loss: 0.2621256 Vali Loss: 0.3957705 Test Loss: 0.3133771
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2734088
	speed: 0.2694s/iter; left time: 1815.4702s
	iters: 200, epoch: 5 | loss: 0.2739438
	speed: 0.0606s/iter; left time: 402.4508s
Epoch: 5 cost time: 18.116145372390747
Epoch: 5, Steps: 263 | Train Loss: 0.2618016 Vali Loss: 0.3948518 Test Loss: 0.3129759
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2925273
	speed: 0.2791s/iter; left time: 1807.1403s
	iters: 200, epoch: 6 | loss: 0.2348115
	speed: 0.0737s/iter; left time: 469.7568s
Epoch: 6 cost time: 19.43246626853943
Epoch: 6, Steps: 263 | Train Loss: 0.2615278 Vali Loss: 0.3973201 Test Loss: 0.3122609
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2856283
	speed: 0.3146s/iter; left time: 1923.4499s
	iters: 200, epoch: 7 | loss: 0.2378129
	speed: 0.0681s/iter; left time: 416.4481s
Epoch: 7 cost time: 18.278438329696655
Epoch: 7, Steps: 263 | Train Loss: 0.2614034 Vali Loss: 0.3923545 Test Loss: 0.3129656
EarlyStopping counter: 4 out of 5
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2661738
	speed: 0.2727s/iter; left time: 1622.8262s
	iters: 200, epoch: 8 | loss: 0.2532804
	speed: 0.0575s/iter; left time: 336.1690s
Epoch: 8 cost time: 17.09480094909668
Epoch: 8, Steps: 263 | Train Loss: 0.2612401 Vali Loss: 0.3955478 Test Loss: 0.3129229
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm1_720_96_FITS_ETTm1_ftM_sl720_ll48_pl96_H6_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.31269208512306213, mae:0.35749075293540955, rse:0.5303066372871399, corr:[0.5449792  0.5564025  0.55934906 0.56410253 0.566746   0.5664795
 0.56764555 0.5691893  0.56889015 0.5690171  0.5704789  0.57075846
 0.5698645  0.5698297  0.5701284  0.5696226  0.56877965 0.5674494
 0.56538254 0.5635667  0.56248146 0.56095254 0.5587833  0.557594
 0.55714864 0.55590725 0.5537738  0.5528568  0.5533582  0.55340904
 0.55286217 0.55295765 0.55349064 0.5539534  0.5542706  0.5545765
 0.554364   0.5544825  0.5552789  0.5553844  0.5545233  0.55383384
 0.553715   0.5534075  0.55313176 0.5538963  0.5548563  0.5545807
 0.55358887 0.5534619  0.5542263  0.55489993 0.554824   0.55377614
 0.55292547 0.5532425  0.5538046  0.5533206  0.55279523 0.5530166
 0.5530659  0.5520329  0.55124867 0.55173975 0.55237263 0.5520653
 0.5516392  0.5515768  0.55101335 0.5500342  0.549928   0.5504087
 0.55022794 0.5494635  0.5490631  0.54880464 0.5484565  0.5485864
 0.54906577 0.5488166  0.54771197 0.54684    0.5466273  0.5460081
 0.54535997 0.54552406 0.5458364  0.5451931  0.54454273 0.5448028
 0.5446006  0.5442566  0.5461587  0.54879814 0.54915935 0.54948175]
