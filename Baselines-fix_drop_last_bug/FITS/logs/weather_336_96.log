Args in experiment:
Namespace(is_training=1, model_id='weather_336_96', model='FITS', data='custom', root_path='./dataset/', data_path='weather.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, individual=False, embed_type=0, enc_in=21, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, ab=2, hidden_size=1, kernel=5, groups=1, levels=3, stacks=1, num_workers=10, itr=1, train_epochs=30, batch_size=128, patience=3, learning_rate=0.0005, des='Exp', loss='mse', lradj='type3', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False, aug_method='NA', aug_rate=0.5, in_batch_augmentation=False, in_dataset_augmentation=False, data_size=1, aug_data_size=1, seed=0, testset_div=2, test_time_train=False, train_mode=2, cut_freq=46, base_T=144, H_order=12)
Use GPU: cuda:0
>>>>>>>start training : weather_336_96_FITS_custom_ftM_sl336_ll48_pl96_H12_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 5175
test 10444
Model(
  (freq_upsampler): Linear(in_features=46, out_features=59, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  7295232.0
params:  2773.0
Trainable parameters:  2773
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.6129048
	speed: 0.1014s/iter; left time: 853.8477s
	iters: 200, epoch: 1 | loss: 0.3387837
	speed: 0.0869s/iter; left time: 722.7546s
Epoch: 1 cost time: 26.726579904556274
Epoch: 1, Steps: 284 | Train Loss: 0.4852157 Vali Loss: 0.5191117 Test Loss: 0.2156218
Validation loss decreased (inf --> 0.519112).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2475497
	speed: 0.3412s/iter; left time: 2776.2348s
	iters: 200, epoch: 2 | loss: 0.2418915
	speed: 0.0791s/iter; left time: 635.8120s
Epoch: 2 cost time: 24.078691482543945
Epoch: 2, Steps: 284 | Train Loss: 0.2996240 Vali Loss: 0.4812756 Test Loss: 0.2013116
Validation loss decreased (0.519112 --> 0.481276).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2536677
	speed: 0.3049s/iter; left time: 2394.7359s
	iters: 200, epoch: 3 | loss: 0.1766364
	speed: 0.0760s/iter; left time: 588.8710s
Epoch: 3 cost time: 23.423103094100952
Epoch: 3, Steps: 284 | Train Loss: 0.2357558 Vali Loss: 0.4729627 Test Loss: 0.1952560
Validation loss decreased (0.481276 --> 0.472963).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2243892
	speed: 0.3082s/iter; left time: 2332.4538s
	iters: 200, epoch: 4 | loss: 0.2301861
	speed: 0.0685s/iter; left time: 511.4758s
Epoch: 4 cost time: 21.420332431793213
Epoch: 4, Steps: 284 | Train Loss: 0.2069192 Vali Loss: 0.4632260 Test Loss: 0.1901769
Validation loss decreased (0.472963 --> 0.463226).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.1980969
	speed: 0.3030s/iter; left time: 2207.1597s
	iters: 200, epoch: 5 | loss: 0.2136738
	speed: 0.0790s/iter; left time: 567.4228s
Epoch: 5 cost time: 23.53476858139038
Epoch: 5, Steps: 284 | Train Loss: 0.1918583 Vali Loss: 0.4570795 Test Loss: 0.1865357
Validation loss decreased (0.463226 --> 0.457079).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1440595
	speed: 0.3182s/iter; left time: 2228.0478s
	iters: 200, epoch: 6 | loss: 0.3044465
	speed: 0.0755s/iter; left time: 521.2515s
Epoch: 6 cost time: 24.041131258010864
Epoch: 6, Steps: 284 | Train Loss: 0.1835057 Vali Loss: 0.4540734 Test Loss: 0.1838745
Validation loss decreased (0.457079 --> 0.454073).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.1218768
	speed: 0.3218s/iter; left time: 2161.4841s
	iters: 200, epoch: 7 | loss: 0.1462363
	speed: 0.0824s/iter; left time: 545.0662s
Epoch: 7 cost time: 24.97326922416687
Epoch: 7, Steps: 284 | Train Loss: 0.1790287 Vali Loss: 0.4543706 Test Loss: 0.1820316
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2370605
	speed: 0.3339s/iter; left time: 2148.1708s
	iters: 200, epoch: 8 | loss: 0.1641056
	speed: 0.0902s/iter; left time: 571.0997s
Epoch: 8 cost time: 26.314939737319946
Epoch: 8, Steps: 284 | Train Loss: 0.1764798 Vali Loss: 0.4524234 Test Loss: 0.1814541
Validation loss decreased (0.454073 --> 0.452423).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1714184
	speed: 0.3144s/iter; left time: 1933.4161s
	iters: 200, epoch: 9 | loss: 0.2244556
	speed: 0.0780s/iter; left time: 471.5785s
Epoch: 9 cost time: 22.614805698394775
Epoch: 9, Steps: 284 | Train Loss: 0.1754131 Vali Loss: 0.4549969 Test Loss: 0.1808772
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1540035
	speed: 0.2924s/iter; left time: 1714.8173s
	iters: 200, epoch: 10 | loss: 0.1894880
	speed: 0.0723s/iter; left time: 416.8049s
Epoch: 10 cost time: 21.869364738464355
Epoch: 10, Steps: 284 | Train Loss: 0.1747012 Vali Loss: 0.4551434 Test Loss: 0.1804209
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.3092985
	speed: 0.2875s/iter; left time: 1604.7137s
	iters: 200, epoch: 11 | loss: 0.1509116
	speed: 0.0663s/iter; left time: 363.1997s
Epoch: 11 cost time: 19.865231037139893
Epoch: 11, Steps: 284 | Train Loss: 0.1741947 Vali Loss: 0.4538394 Test Loss: 0.1801407
EarlyStopping counter: 3 out of 3
Early stopping
train 36456
val 5175
test 10444
Model(
  (freq_upsampler): Linear(in_features=46, out_features=59, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  7295232.0
params:  2773.0
Trainable parameters:  2773
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.6092149
	speed: 0.0836s/iter; left time: 703.8385s
	iters: 200, epoch: 1 | loss: 0.3527701
	speed: 0.0716s/iter; left time: 595.5643s
Epoch: 1 cost time: 21.195757389068604
Epoch: 1, Steps: 284 | Train Loss: 0.4669067 Vali Loss: 0.4445104 Test Loss: 0.1775951
Validation loss decreased (inf --> 0.444510).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.5201442
	speed: 0.2921s/iter; left time: 2377.0672s
	iters: 200, epoch: 2 | loss: 0.3208087
	speed: 0.0758s/iter; left time: 609.5515s
Epoch: 2 cost time: 22.66091012954712
Epoch: 2, Steps: 284 | Train Loss: 0.4634260 Vali Loss: 0.4415812 Test Loss: 0.1762138
Validation loss decreased (0.444510 --> 0.441581).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.3928109
	speed: 0.3216s/iter; left time: 2525.4473s
	iters: 200, epoch: 3 | loss: 0.4110620
	speed: 0.0892s/iter; left time: 691.7401s
Epoch: 3 cost time: 26.081663608551025
Epoch: 3, Steps: 284 | Train Loss: 0.4608095 Vali Loss: 0.4439154 Test Loss: 0.1761870
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.3962696
	speed: 0.3173s/iter; left time: 2402.0129s
	iters: 200, epoch: 4 | loss: 0.3745122
	speed: 0.0830s/iter; left time: 619.8101s
Epoch: 4 cost time: 22.628593683242798
Epoch: 4, Steps: 284 | Train Loss: 0.4623046 Vali Loss: 0.4414372 Test Loss: 0.1755017
Validation loss decreased (0.441581 --> 0.441437).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.3260196
	speed: 0.3016s/iter; left time: 2197.5131s
	iters: 200, epoch: 5 | loss: 0.3848462
	speed: 0.0864s/iter; left time: 621.0186s
Epoch: 5 cost time: 25.309837341308594
Epoch: 5, Steps: 284 | Train Loss: 0.4618524 Vali Loss: 0.4415583 Test Loss: 0.1756514
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.4838778
	speed: 0.3242s/iter; left time: 2269.5247s
	iters: 200, epoch: 6 | loss: 0.3455842
	speed: 0.0898s/iter; left time: 619.6317s
Epoch: 6 cost time: 25.466228246688843
Epoch: 6, Steps: 284 | Train Loss: 0.4609422 Vali Loss: 0.4423661 Test Loss: 0.1753865
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.3983194
	speed: 0.3277s/iter; left time: 2201.0438s
	iters: 200, epoch: 7 | loss: 0.5167200
	speed: 0.0820s/iter; left time: 542.3140s
Epoch: 7 cost time: 24.925655603408813
Epoch: 7, Steps: 284 | Train Loss: 0.4614381 Vali Loss: 0.4435964 Test Loss: 0.1756212
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_336_96_FITS_custom_ftM_sl336_ll48_pl96_H12_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
mse:0.17603828012943268, mae:0.22778865694999695, rse:0.5529116988182068, corr:[0.48250595 0.48638433 0.4863344  0.48491904 0.48369682 0.48308143
 0.4827305  0.48219112 0.48124278 0.48016754 0.47938028 0.47902212
 0.47881243 0.4784392  0.4776688  0.4767268  0.47576347 0.47487935
 0.4743354  0.47389117 0.4733665  0.4726715  0.47188792 0.47104338
 0.47031245 0.4695586  0.4687168  0.46759087 0.466357   0.46508232
 0.46400982 0.46311596 0.46236986 0.46156898 0.46074992 0.45980963
 0.45891687 0.4580886  0.45741156 0.4567144  0.45596182 0.4552824
 0.4545599  0.4538365  0.45312962 0.45246473 0.45184234 0.45130706
 0.45057645 0.44976172 0.44897944 0.44828653 0.44783324 0.44747835
 0.44715685 0.44662467 0.44600493 0.4453538  0.4448159  0.4444512
 0.44432357 0.44426033 0.44407332 0.44378528 0.44343227 0.44318187
 0.44280487 0.4425789  0.44240195 0.44227898 0.44214362 0.4419865
 0.4416924  0.44132373 0.44083607 0.440327   0.43973452 0.43926308
 0.43895426 0.4387894  0.43885025 0.4390119  0.43913698 0.43908703
 0.43899325 0.43870562 0.43863067 0.4385626  0.43860683 0.43861067
 0.4384752  0.4381203  0.4378006  0.43769005 0.43760577 0.43659818]
