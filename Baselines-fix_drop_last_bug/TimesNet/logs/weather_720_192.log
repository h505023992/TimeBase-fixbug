True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_720_192     Model:              TimesNet            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/          
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            720                 Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_weather_720_192_TimesNet_custom_ftM_sl720_ll48_pl192_dm32_nh8_el2_dl1_df32_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35976
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.8308997
	speed: 0.4758s/iter; left time: 16012.3805s
	iters: 200, epoch: 1 | loss: 0.4523570
	speed: 0.4340s/iter; left time: 14560.3079s
	iters: 300, epoch: 1 | loss: 0.3980726
	speed: 0.3606s/iter; left time: 12062.2184s
	iters: 400, epoch: 1 | loss: 0.3201433
	speed: 0.3339s/iter; left time: 11136.2938s
	iters: 500, epoch: 1 | loss: 0.3757558
	speed: 0.3415s/iter; left time: 11354.0551s
	iters: 600, epoch: 1 | loss: 0.3855633
	speed: 0.3654s/iter; left time: 12113.7150s
	iters: 700, epoch: 1 | loss: 0.4278228
	speed: 0.3682s/iter; left time: 12167.9783s
	iters: 800, epoch: 1 | loss: 0.7706488
	speed: 0.3410s/iter; left time: 11237.6956s
	iters: 900, epoch: 1 | loss: 0.7833571
	speed: 0.3070s/iter; left time: 10086.3667s
	iters: 1000, epoch: 1 | loss: 0.3279744
	speed: 0.3273s/iter; left time: 10719.3495s
	iters: 1100, epoch: 1 | loss: 0.2979982
	speed: 0.3091s/iter; left time: 10091.4889s
Epoch: 1 cost time: 404.4704225063324
Epoch: 1, Steps: 1125 | Train Loss: 0.4687347 Vali Loss: 0.4682627 Test Loss: 0.2192037
Validation loss decreased (inf --> 0.468263).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4573538
	speed: 1.4524s/iter; left time: 47240.4745s
	iters: 200, epoch: 2 | loss: 0.4282384
	speed: 0.3044s/iter; left time: 9869.3022s
	iters: 300, epoch: 2 | loss: 0.8899551
	speed: 0.2879s/iter; left time: 9305.6436s
	iters: 400, epoch: 2 | loss: 0.7729232
	speed: 0.2843s/iter; left time: 9161.8444s
	iters: 500, epoch: 2 | loss: 0.4149961
	speed: 0.2877s/iter; left time: 9242.2016s
	iters: 600, epoch: 2 | loss: 0.2972707
	speed: 0.2803s/iter; left time: 8976.3258s
	iters: 700, epoch: 2 | loss: 0.6818504
	speed: 0.2878s/iter; left time: 9189.3933s
	iters: 800, epoch: 2 | loss: 0.2419429
	speed: 0.2864s/iter; left time: 9115.2949s
	iters: 900, epoch: 2 | loss: 0.2341278
	speed: 0.3009s/iter; left time: 9545.1504s
	iters: 1000, epoch: 2 | loss: 0.2720906
	speed: 0.3002s/iter; left time: 9495.0169s
	iters: 1100, epoch: 2 | loss: 0.3637470
	speed: 0.2939s/iter; left time: 9265.1766s
Epoch: 2 cost time: 331.842698097229
Epoch: 2, Steps: 1125 | Train Loss: 0.3794575 Vali Loss: 0.5247932 Test Loss: 0.2530152
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2706919
	speed: 1.3185s/iter; left time: 41401.3297s
	iters: 200, epoch: 3 | loss: 0.2989202
	speed: 0.2935s/iter; left time: 9185.7802s
	iters: 300, epoch: 3 | loss: 0.3021159
	speed: 0.3034s/iter; left time: 9466.8606s
	iters: 400, epoch: 3 | loss: 0.2452657
	speed: 0.3055s/iter; left time: 9502.6975s
	iters: 500, epoch: 3 | loss: 0.3271403
	speed: 0.2962s/iter; left time: 9183.3254s
	iters: 600, epoch: 3 | loss: 0.2459144
	speed: 0.2860s/iter; left time: 8839.0837s
	iters: 700, epoch: 3 | loss: 0.2172586
	speed: 0.2809s/iter; left time: 8651.0077s
	iters: 800, epoch: 3 | loss: 0.1840929
	speed: 0.2880s/iter; left time: 8842.9804s
	iters: 900, epoch: 3 | loss: 0.2207700
	speed: 0.3130s/iter; left time: 9578.6509s
	iters: 1000, epoch: 3 | loss: 0.1731480
	speed: 0.3128s/iter; left time: 9542.0973s
	iters: 1100, epoch: 3 | loss: 0.2725822
	speed: 0.3239s/iter; left time: 9847.8937s
Epoch: 3 cost time: 339.83526062965393
Epoch: 3, Steps: 1125 | Train Loss: 0.3339722 Vali Loss: 0.5186001 Test Loss: 0.2619589
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2583455
	speed: 1.3281s/iter; left time: 40210.0547s
	iters: 200, epoch: 4 | loss: 0.2192769
	speed: 0.3118s/iter; left time: 9409.7132s
	iters: 300, epoch: 4 | loss: 0.1881625
	speed: 0.3102s/iter; left time: 9329.7552s
	iters: 400, epoch: 4 | loss: 0.6737566
	speed: 0.2997s/iter; left time: 8983.9373s
	iters: 500, epoch: 4 | loss: 0.3189230
	speed: 0.3262s/iter; left time: 9745.3320s
	iters: 600, epoch: 4 | loss: 0.2796830
	speed: 0.3067s/iter; left time: 9132.7851s
	iters: 700, epoch: 4 | loss: 0.2127917
	speed: 0.3115s/iter; left time: 9244.2985s
	iters: 800, epoch: 4 | loss: 0.6643172
	speed: 0.2967s/iter; left time: 8773.8023s
	iters: 900, epoch: 4 | loss: 0.1970785
	speed: 0.2937s/iter; left time: 8657.9679s
	iters: 1000, epoch: 4 | loss: 0.1793442
	speed: 0.2963s/iter; left time: 8703.0411s
	iters: 1100, epoch: 4 | loss: 0.2773096
	speed: 0.2864s/iter; left time: 8383.3690s
Epoch: 4 cost time: 344.0410280227661
Epoch: 4, Steps: 1125 | Train Loss: 0.3165074 Vali Loss: 0.5269524 Test Loss: 0.2726893
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_weather_720_192_TimesNet_custom_ftM_sl720_ll48_pl192_dm32_nh8_el2_dl1_df32_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
test shape: (10348, 192, 21) (10348, 192, 21)
test shape: (10348, 192, 21) (10348, 192, 21)
mse:0.2193952053785324, mae:0.27000176906585693, dtw:not calculated
