True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           traffic_336_96      Model:              TimesNet            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/          
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            336                 Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         8                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_traffic_336_96_TimesNet_custom_ftM_sl336_ll48_pl96_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11849
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.7538682
	speed: 0.2503s/iter; left time: 11103.0876s
	iters: 200, epoch: 1 | loss: 0.5005705
	speed: 0.1871s/iter; left time: 8279.3242s
	iters: 300, epoch: 1 | loss: 0.4199915
	speed: 0.1908s/iter; left time: 8426.4898s
	iters: 400, epoch: 1 | loss: 0.3747575
	speed: 0.1887s/iter; left time: 8313.0011s
	iters: 500, epoch: 1 | loss: 0.3405532
	speed: 0.1915s/iter; left time: 8418.3090s
	iters: 600, epoch: 1 | loss: 0.3525869
	speed: 0.1977s/iter; left time: 8672.8513s
	iters: 700, epoch: 1 | loss: 0.2841131
	speed: 0.2000s/iter; left time: 8752.8374s
	iters: 800, epoch: 1 | loss: 0.2695969
	speed: 0.1955s/iter; left time: 8535.9949s
	iters: 900, epoch: 1 | loss: 0.2802921
	speed: 0.1937s/iter; left time: 8436.0998s
	iters: 1000, epoch: 1 | loss: 0.2458282
	speed: 0.1866s/iter; left time: 8110.4163s
	iters: 1100, epoch: 1 | loss: 0.2534223
	speed: 0.1912s/iter; left time: 8291.2109s
	iters: 1200, epoch: 1 | loss: 0.2449116
	speed: 0.1970s/iter; left time: 8523.7871s
	iters: 1300, epoch: 1 | loss: 0.2614262
	speed: 0.1834s/iter; left time: 7916.0366s
	iters: 1400, epoch: 1 | loss: 0.2296137
	speed: 0.1808s/iter; left time: 7783.5508s
Epoch: 1 cost time: 288.3909115791321
Epoch: 1, Steps: 1482 | Train Loss: 0.3804428 Vali Loss: 0.4662678 Test Loss: 0.6159647
Validation loss decreased (inf --> 0.466268).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2330221
	speed: 1.4163s/iter; left time: 60730.8075s
	iters: 200, epoch: 2 | loss: 0.2028051
	speed: 0.1847s/iter; left time: 7900.0712s
	iters: 300, epoch: 2 | loss: 0.2167547
	speed: 0.1831s/iter; left time: 7816.2187s
	iters: 400, epoch: 2 | loss: 0.2610510
	speed: 0.1839s/iter; left time: 7828.5118s
	iters: 500, epoch: 2 | loss: 0.2516310
	speed: 0.1823s/iter; left time: 7742.4913s
	iters: 600, epoch: 2 | loss: 0.2413584
	speed: 0.1835s/iter; left time: 7774.7922s
	iters: 700, epoch: 2 | loss: 0.2448207
	speed: 0.1863s/iter; left time: 7875.4601s
	iters: 800, epoch: 2 | loss: 0.2705914
	speed: 0.1908s/iter; left time: 8045.8095s
	iters: 900, epoch: 2 | loss: 0.2490193
	speed: 0.1984s/iter; left time: 8349.7909s
	iters: 1000, epoch: 2 | loss: 0.2360968
	speed: 0.2043s/iter; left time: 8575.4467s
	iters: 1100, epoch: 2 | loss: 0.2358447
	speed: 0.2114s/iter; left time: 8852.2205s
	iters: 1200, epoch: 2 | loss: 0.2269290
	speed: 0.2009s/iter; left time: 8393.1670s
	iters: 1300, epoch: 2 | loss: 0.2546325
	speed: 0.2038s/iter; left time: 8494.6041s
	iters: 1400, epoch: 2 | loss: 0.2135867
	speed: 0.2045s/iter; left time: 8502.4527s
Epoch: 2 cost time: 288.4183886051178
Epoch: 2, Steps: 1482 | Train Loss: 0.2458273 Vali Loss: 0.4685178 Test Loss: 0.6155062
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2394312
	speed: 1.3699s/iter; left time: 56709.2768s
	iters: 200, epoch: 3 | loss: 0.2444196
	speed: 0.1903s/iter; left time: 7858.7812s
	iters: 300, epoch: 3 | loss: 0.2210044
	speed: 0.1878s/iter; left time: 7735.9282s
	iters: 400, epoch: 3 | loss: 0.2636034
	speed: 0.1875s/iter; left time: 7704.3926s
	iters: 500, epoch: 3 | loss: 0.2165511
	speed: 0.1885s/iter; left time: 7729.2405s
	iters: 600, epoch: 3 | loss: 0.2465692
	speed: 0.1776s/iter; left time: 7263.8559s
	iters: 700, epoch: 3 | loss: 0.2013424
	speed: 0.1855s/iter; left time: 7567.5273s
	iters: 800, epoch: 3 | loss: 0.2240635
	speed: 0.1909s/iter; left time: 7769.3608s
	iters: 900, epoch: 3 | loss: 0.2174935
	speed: 0.1922s/iter; left time: 7803.6543s
	iters: 1000, epoch: 3 | loss: 0.2322576
	speed: 0.1949s/iter; left time: 7893.6351s
	iters: 1100, epoch: 3 | loss: 0.2379830
	speed: 0.1941s/iter; left time: 7841.5378s
	iters: 1200, epoch: 3 | loss: 0.2072679
	speed: 0.1889s/iter; left time: 7612.1037s
	iters: 1300, epoch: 3 | loss: 0.2172921
	speed: 0.1996s/iter; left time: 8025.2064s
	iters: 1400, epoch: 3 | loss: 0.2596884
	speed: 0.2017s/iter; left time: 8088.7785s
Epoch: 3 cost time: 283.7984893321991
Epoch: 3, Steps: 1482 | Train Loss: 0.2271875 Vali Loss: 0.4768686 Test Loss: 0.6109789
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2170931
	speed: 1.3513s/iter; left time: 53935.7517s
	iters: 200, epoch: 4 | loss: 0.2174060
	speed: 0.1845s/iter; left time: 7347.8006s
	iters: 300, epoch: 4 | loss: 0.2233666
	speed: 0.1909s/iter; left time: 7583.4014s
	iters: 400, epoch: 4 | loss: 0.2330884
	speed: 0.1831s/iter; left time: 7253.3615s
	iters: 500, epoch: 4 | loss: 0.2439378
	speed: 0.1861s/iter; left time: 7352.8285s
	iters: 600, epoch: 4 | loss: 0.2180943
	speed: 0.1827s/iter; left time: 7200.6829s
	iters: 700, epoch: 4 | loss: 0.2328167
	speed: 0.1852s/iter; left time: 7280.3692s
	iters: 800, epoch: 4 | loss: 0.1903514
	speed: 0.1856s/iter; left time: 7280.2380s
	iters: 900, epoch: 4 | loss: 0.1841976
	speed: 0.1884s/iter; left time: 7369.2232s
	iters: 1000, epoch: 4 | loss: 0.2093519
	speed: 0.1888s/iter; left time: 7364.7476s
	iters: 1100, epoch: 4 | loss: 0.2090622
	speed: 0.1895s/iter; left time: 7374.9617s
	iters: 1200, epoch: 4 | loss: 0.2346984
	speed: 0.1939s/iter; left time: 7526.2417s
	iters: 1300, epoch: 4 | loss: 0.2160821
	speed: 0.1873s/iter; left time: 7249.9889s
	iters: 1400, epoch: 4 | loss: 0.2177177
	speed: 0.1858s/iter; left time: 7173.4267s
Epoch: 4 cost time: 278.21728110313416
Epoch: 4, Steps: 1482 | Train Loss: 0.2179077 Vali Loss: 0.4736123 Test Loss: 0.6133323
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_traffic_336_96_TimesNet_custom_ftM_sl336_ll48_pl96_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
test shape: (3413, 96, 862) (3413, 96, 862)
test shape: (3413, 96, 862) (3413, 96, 862)
mse:0.616036593914032, mae:0.3432730436325073, dtw:not calculated
