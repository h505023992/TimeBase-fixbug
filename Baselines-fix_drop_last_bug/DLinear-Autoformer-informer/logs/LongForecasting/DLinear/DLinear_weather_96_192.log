Args in experiment:
Namespace(is_training=1, train_only=False, model_id='DLinear_weather_96_192', model='DLinear', data='custom', root_path='./dataset/', data_path='weather.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=192, individual=False, embed_type=0, enc_in=21, dec_in=21, c_out=21, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DLinear_weather_96_192_DLinear_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36600
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.8143185
	speed: 0.0547s/iter; left time: 1873.3439s
	iters: 200, epoch: 1 | loss: 0.7659233
	speed: 0.0307s/iter; left time: 1045.8472s
	iters: 300, epoch: 1 | loss: 0.4449537
	speed: 0.0346s/iter; left time: 1178.4101s
	iters: 400, epoch: 1 | loss: 0.7180342
	speed: 0.0339s/iter; left time: 1148.6982s
	iters: 500, epoch: 1 | loss: 0.4903631
	speed: 0.0322s/iter; left time: 1089.8374s
	iters: 600, epoch: 1 | loss: 0.5122724
	speed: 0.0331s/iter; left time: 1117.0157s
	iters: 700, epoch: 1 | loss: 0.5298011
	speed: 0.0315s/iter; left time: 1059.7325s
	iters: 800, epoch: 1 | loss: 0.5596254
	speed: 0.0327s/iter; left time: 1097.7831s
	iters: 900, epoch: 1 | loss: 0.5853701
	speed: 0.0327s/iter; left time: 1092.2544s
	iters: 1000, epoch: 1 | loss: 0.5925097
	speed: 0.0296s/iter; left time: 985.4994s
	iters: 1100, epoch: 1 | loss: 0.4066671
	speed: 0.0347s/iter; left time: 1151.6309s
Epoch: 1 cost time: 39.80020451545715
Epoch: 1, Steps: 1144 | Train Loss: 0.6729257 Vali Loss: 0.5460908 Test Loss: 0.2479476
Validation loss decreased (inf --> 0.546091).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 1.0286452
	speed: 0.3789s/iter; left time: 12532.4282s
	iters: 200, epoch: 2 | loss: 0.5260018
	speed: 0.0278s/iter; left time: 918.3146s
	iters: 300, epoch: 2 | loss: 0.6337146
	speed: 0.0256s/iter; left time: 842.6289s
	iters: 400, epoch: 2 | loss: 0.8432789
	speed: 0.0217s/iter; left time: 712.3497s
	iters: 500, epoch: 2 | loss: 0.3546209
	speed: 0.0209s/iter; left time: 683.3516s
	iters: 600, epoch: 2 | loss: 0.5035426
	speed: 0.0197s/iter; left time: 643.2370s
	iters: 700, epoch: 2 | loss: 0.6741604
	speed: 0.0214s/iter; left time: 693.5183s
	iters: 800, epoch: 2 | loss: 0.4070195
	speed: 0.0207s/iter; left time: 668.9023s
	iters: 900, epoch: 2 | loss: 0.4373376
	speed: 0.0200s/iter; left time: 644.7737s
	iters: 1000, epoch: 2 | loss: 0.5326129
	speed: 0.0207s/iter; left time: 665.1981s
	iters: 1100, epoch: 2 | loss: 0.5907071
	speed: 0.0206s/iter; left time: 659.7303s
Epoch: 2 cost time: 26.119548082351685
Epoch: 2, Steps: 1144 | Train Loss: 0.5765435 Vali Loss: 0.5313369 Test Loss: 0.2435083
Validation loss decreased (0.546091 --> 0.531337).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4450975
	speed: 0.2605s/iter; left time: 8318.6077s
	iters: 200, epoch: 3 | loss: 1.2700598
	speed: 0.0206s/iter; left time: 656.6667s
	iters: 300, epoch: 3 | loss: 0.5422076
	speed: 0.0214s/iter; left time: 680.4217s
	iters: 400, epoch: 3 | loss: 0.4801726
	speed: 0.0207s/iter; left time: 653.2672s
	iters: 500, epoch: 3 | loss: 0.3817624
	speed: 0.0203s/iter; left time: 638.8892s
	iters: 600, epoch: 3 | loss: 0.4531225
	speed: 0.0206s/iter; left time: 647.5801s
	iters: 700, epoch: 3 | loss: 0.7398457
	speed: 0.0213s/iter; left time: 667.0626s
	iters: 800, epoch: 3 | loss: 0.4052540
	speed: 0.0204s/iter; left time: 636.4117s
	iters: 900, epoch: 3 | loss: 0.5167154
	speed: 0.0210s/iter; left time: 652.6748s
	iters: 1000, epoch: 3 | loss: 0.7597319
	speed: 0.0213s/iter; left time: 660.7331s
	iters: 1100, epoch: 3 | loss: 0.5915104
	speed: 0.0212s/iter; left time: 657.1699s
Epoch: 3 cost time: 24.72850799560547
Epoch: 3, Steps: 1144 | Train Loss: 0.5664898 Vali Loss: 0.5283844 Test Loss: 0.2398891
Validation loss decreased (0.531337 --> 0.528384).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4334027
	speed: 0.1603s/iter; left time: 4935.8323s
	iters: 200, epoch: 4 | loss: 0.4592190
	speed: 0.0173s/iter; left time: 529.4328s
	iters: 300, epoch: 4 | loss: 0.4432535
	speed: 0.0162s/iter; left time: 494.7429s
	iters: 400, epoch: 4 | loss: 0.7589983
	speed: 0.0160s/iter; left time: 487.0057s
	iters: 500, epoch: 4 | loss: 0.4581749
	speed: 0.0169s/iter; left time: 514.3474s
	iters: 600, epoch: 4 | loss: 0.5078700
	speed: 0.0175s/iter; left time: 529.6257s
	iters: 700, epoch: 4 | loss: 0.3590773
	speed: 0.0187s/iter; left time: 565.2266s
	iters: 800, epoch: 4 | loss: 0.4841007
	speed: 0.0206s/iter; left time: 620.6991s
	iters: 900, epoch: 4 | loss: 0.4364718
	speed: 0.0204s/iter; left time: 610.5267s
	iters: 1000, epoch: 4 | loss: 0.8858871
	speed: 0.0209s/iter; left time: 624.9883s
	iters: 1100, epoch: 4 | loss: 0.4909388
	speed: 0.0204s/iter; left time: 606.7907s
Epoch: 4 cost time: 21.75398588180542
Epoch: 4, Steps: 1144 | Train Loss: 0.5631834 Vali Loss: 0.5274660 Test Loss: 0.2395001
Validation loss decreased (0.528384 --> 0.527466).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4745442
	speed: 0.2229s/iter; left time: 6608.3349s
	iters: 200, epoch: 5 | loss: 0.5213030
	speed: 0.0203s/iter; left time: 600.2628s
	iters: 300, epoch: 5 | loss: 0.4258082
	speed: 0.0203s/iter; left time: 598.8683s
	iters: 400, epoch: 5 | loss: 0.9273379
	speed: 0.0205s/iter; left time: 601.4098s
	iters: 500, epoch: 5 | loss: 0.4177682
	speed: 0.0211s/iter; left time: 616.6875s
	iters: 600, epoch: 5 | loss: 0.3594070
	speed: 0.0232s/iter; left time: 675.7962s
	iters: 700, epoch: 5 | loss: 0.3922443
	speed: 0.0213s/iter; left time: 617.3002s
	iters: 800, epoch: 5 | loss: 0.5423847
	speed: 0.0159s/iter; left time: 459.1606s
	iters: 900, epoch: 5 | loss: 0.4029148
	speed: 0.0174s/iter; left time: 502.7941s
	iters: 1000, epoch: 5 | loss: 0.8907367
	speed: 0.0168s/iter; left time: 482.2858s
	iters: 1100, epoch: 5 | loss: 0.4646234
	speed: 0.0198s/iter; left time: 566.4512s
Epoch: 5 cost time: 23.56187868118286
Epoch: 5, Steps: 1144 | Train Loss: 0.5617187 Vali Loss: 0.5266486 Test Loss: 0.2402571
Validation loss decreased (0.527466 --> 0.526649).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 1.0594248
	speed: 0.2300s/iter; left time: 6554.5185s
	iters: 200, epoch: 6 | loss: 0.6593595
	speed: 0.0198s/iter; left time: 563.4284s
	iters: 300, epoch: 6 | loss: 1.0111279
	speed: 0.0215s/iter; left time: 607.5825s
	iters: 400, epoch: 6 | loss: 0.4534375
	speed: 0.0192s/iter; left time: 540.7135s
	iters: 500, epoch: 6 | loss: 0.5343571
	speed: 0.0200s/iter; left time: 561.8451s
	iters: 600, epoch: 6 | loss: 0.5754213
	speed: 0.0197s/iter; left time: 552.8890s
	iters: 700, epoch: 6 | loss: 0.4353394
	speed: 0.0196s/iter; left time: 546.1205s
	iters: 800, epoch: 6 | loss: 0.5108898
	speed: 0.0203s/iter; left time: 563.0559s
	iters: 900, epoch: 6 | loss: 0.4959571
	speed: 0.0194s/iter; left time: 537.8567s
	iters: 1000, epoch: 6 | loss: 0.4952300
	speed: 0.0189s/iter; left time: 521.5671s
	iters: 1100, epoch: 6 | loss: 0.4443677
	speed: 0.0225s/iter; left time: 618.1400s
Epoch: 6 cost time: 23.946693420410156
Epoch: 6, Steps: 1144 | Train Loss: 0.5611668 Vali Loss: 0.5265658 Test Loss: 0.2390307
Validation loss decreased (0.526649 --> 0.526566).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4531459
	speed: 0.2758s/iter; left time: 7543.9989s
	iters: 200, epoch: 7 | loss: 0.3147292
	speed: 0.0166s/iter; left time: 451.2639s
	iters: 300, epoch: 7 | loss: 0.4157415
	speed: 0.0210s/iter; left time: 570.6774s
	iters: 400, epoch: 7 | loss: 0.4041691
	speed: 0.0229s/iter; left time: 620.8019s
	iters: 500, epoch: 7 | loss: 0.4825457
	speed: 0.0220s/iter; left time: 593.4046s
	iters: 600, epoch: 7 | loss: 0.4672250
	speed: 0.0212s/iter; left time: 568.4141s
	iters: 700, epoch: 7 | loss: 0.7951867
	speed: 0.0255s/iter; left time: 681.9047s
	iters: 800, epoch: 7 | loss: 0.4733081
	speed: 0.0239s/iter; left time: 635.8380s
	iters: 900, epoch: 7 | loss: 0.5134984
	speed: 0.0233s/iter; left time: 619.5764s
	iters: 1000, epoch: 7 | loss: 0.4140095
	speed: 0.0206s/iter; left time: 544.1045s
	iters: 1100, epoch: 7 | loss: 0.5122956
	speed: 0.0195s/iter; left time: 514.2045s
Epoch: 7 cost time: 25.61764121055603
Epoch: 7, Steps: 1144 | Train Loss: 0.5608455 Vali Loss: 0.5263743 Test Loss: 0.2391226
Validation loss decreased (0.526566 --> 0.526374).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.6145029
	speed: 0.2163s/iter; left time: 5669.8496s
	iters: 200, epoch: 8 | loss: 0.4325539
	speed: 0.0211s/iter; left time: 551.3738s
	iters: 300, epoch: 8 | loss: 0.4520482
	speed: 0.0228s/iter; left time: 594.3331s
	iters: 400, epoch: 8 | loss: 0.3971727
	speed: 0.0184s/iter; left time: 476.9076s
	iters: 500, epoch: 8 | loss: 0.3863227
	speed: 0.0191s/iter; left time: 494.0492s
	iters: 600, epoch: 8 | loss: 0.3792058
	speed: 0.0237s/iter; left time: 609.4109s
	iters: 700, epoch: 8 | loss: 0.6715270
	speed: 0.0225s/iter; left time: 577.3783s
	iters: 800, epoch: 8 | loss: 0.7778752
	speed: 0.0239s/iter; left time: 610.4435s
	iters: 900, epoch: 8 | loss: 0.3939347
	speed: 0.0227s/iter; left time: 576.9399s
	iters: 1000, epoch: 8 | loss: 0.3547199
	speed: 0.0220s/iter; left time: 556.6671s
	iters: 1100, epoch: 8 | loss: 0.5937375
	speed: 0.0196s/iter; left time: 492.9410s
Epoch: 8 cost time: 25.27793002128601
Epoch: 8, Steps: 1144 | Train Loss: 0.5605318 Vali Loss: 0.5266351 Test Loss: 0.2389229
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.5890684
	speed: 0.1936s/iter; left time: 4852.7932s
	iters: 200, epoch: 9 | loss: 0.5033548
	speed: 0.0153s/iter; left time: 381.4109s
	iters: 300, epoch: 9 | loss: 0.3687968
	speed: 0.0140s/iter; left time: 348.6795s
	iters: 400, epoch: 9 | loss: 0.5495457
	speed: 0.0145s/iter; left time: 358.0716s
	iters: 500, epoch: 9 | loss: 0.4835947
	speed: 0.0136s/iter; left time: 335.6928s
	iters: 600, epoch: 9 | loss: 0.5123567
	speed: 0.0146s/iter; left time: 358.2572s
	iters: 700, epoch: 9 | loss: 0.9864833
	speed: 0.0138s/iter; left time: 337.0037s
	iters: 800, epoch: 9 | loss: 0.4583315
	speed: 0.0146s/iter; left time: 354.6274s
	iters: 900, epoch: 9 | loss: 0.4102719
	speed: 0.0137s/iter; left time: 333.2650s
	iters: 1000, epoch: 9 | loss: 0.4886236
	speed: 0.0137s/iter; left time: 329.9455s
	iters: 1100, epoch: 9 | loss: 0.4355214
	speed: 0.0140s/iter; left time: 336.4895s
Epoch: 9 cost time: 17.138920545578003
Epoch: 9, Steps: 1144 | Train Loss: 0.5604539 Vali Loss: 0.5269824 Test Loss: 0.2389333
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.9918430
	speed: 0.1306s/iter; left time: 3124.5644s
	iters: 200, epoch: 10 | loss: 0.4354789
	speed: 0.0144s/iter; left time: 342.4805s
	iters: 300, epoch: 10 | loss: 0.5576740
	speed: 0.0140s/iter; left time: 331.2367s
	iters: 400, epoch: 10 | loss: 0.4191332
	speed: 0.0137s/iter; left time: 324.3474s
	iters: 500, epoch: 10 | loss: 0.6398960
	speed: 0.0136s/iter; left time: 320.5788s
	iters: 600, epoch: 10 | loss: 0.8082682
	speed: 0.0139s/iter; left time: 324.8830s
	iters: 700, epoch: 10 | loss: 0.6990052
	speed: 0.0136s/iter; left time: 316.6829s
	iters: 800, epoch: 10 | loss: 0.5091277
	speed: 0.0139s/iter; left time: 323.7845s
	iters: 900, epoch: 10 | loss: 0.4757103
	speed: 0.0142s/iter; left time: 328.3151s
	iters: 1000, epoch: 10 | loss: 0.4538870
	speed: 0.0135s/iter; left time: 311.6594s
	iters: 1100, epoch: 10 | loss: 0.8696225
	speed: 0.0138s/iter; left time: 316.1648s
Epoch: 10 cost time: 16.636390447616577
Epoch: 10, Steps: 1144 | Train Loss: 0.5604552 Vali Loss: 0.5266500 Test Loss: 0.2389109
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : DLinear_weather_96_192_DLinear_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
mse:0.23936769366264343, mae:0.29672113060951233
