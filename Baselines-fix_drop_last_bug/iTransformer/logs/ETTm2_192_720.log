Args in experiment:
Namespace(is_training=1, model_id='ETTm2_192_720', model='iTransformer', data='ETTm2', root_path='./dataset/', data_path='ETTm2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=192, label_len=48, pred_len=720, enc_in=7, dec_in=7, c_out=7, d_model=128, n_heads=8, e_layers=2, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='MSE', lradj='type1', use_amp=False, use_gpu=True, gpu=2, use_multi_gpu=False, devices='0,1,2,3', exp_name='MTSF', channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv', efficient_training=False, use_norm=True, partial_start_index=0)
Use GPU: cuda:2
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.dropout.Dropout'>.
[INFO] Register count_convNd() for <class 'torch.nn.modules.conv.Conv1d'>.
[INFO] Register count_normalization() for <class 'torch.nn.modules.normalization.LayerNorm'>.
MACs: 4106752.0
Params: 317008.0
4.11M MACs
>>>>>>>start training : ETTm2_192_720_iTransformer_ETTm2_M_ft192_sl48_ll720_pl128_dm8_nh2_el1_dl128_df1_fctimeF_ebTrue_dtExp_projection_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33649
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 1.2575299
	speed: 0.1286s/iter; left time: 1338.7972s
	iters: 200, epoch: 1 | loss: 0.3409868
	speed: 0.1011s/iter; left time: 1041.9307s
	iters: 300, epoch: 1 | loss: 0.3394982
	speed: 0.0952s/iter; left time: 972.1862s
	iters: 400, epoch: 1 | loss: 0.4079535
	speed: 0.0990s/iter; left time: 1000.7779s
	iters: 500, epoch: 1 | loss: 1.0592268
	speed: 0.0926s/iter; left time: 927.2109s
	iters: 600, epoch: 1 | loss: 0.4075532
	speed: 0.0977s/iter; left time: 968.3388s
	iters: 700, epoch: 1 | loss: 0.4632448
	speed: 0.0991s/iter; left time: 971.9719s
	iters: 800, epoch: 1 | loss: 0.5368897
	speed: 0.0907s/iter; left time: 881.2533s
	iters: 900, epoch: 1 | loss: 0.3665524
	speed: 0.0912s/iter; left time: 876.9627s
	iters: 1000, epoch: 1 | loss: 0.5937838
	speed: 0.0961s/iter; left time: 914.2354s
Max Memory (MB): 16.845703125
Epoch: 1 cost time: 104.86414861679077
Epoch: 1, Steps: 1051 | Train Loss: 0.5623950 Vali Loss: 0.2886350 Test Loss: 0.3892293
Validation loss decreased (inf --> 0.288635).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5812524
	speed: 2.5294s/iter; left time: 23675.5411s
	iters: 200, epoch: 2 | loss: 0.3328667
	speed: 0.0969s/iter; left time: 897.5356s
	iters: 300, epoch: 2 | loss: 0.3562817
	speed: 0.0910s/iter; left time: 833.6109s
	iters: 400, epoch: 2 | loss: 0.3584875
	speed: 0.0914s/iter; left time: 827.6439s
	iters: 500, epoch: 2 | loss: 0.2407075
	speed: 0.0861s/iter; left time: 771.5205s
	iters: 600, epoch: 2 | loss: 0.5833390
	speed: 0.0905s/iter; left time: 802.1674s
	iters: 700, epoch: 2 | loss: 0.2219057
	speed: 0.0867s/iter; left time: 759.6137s
	iters: 800, epoch: 2 | loss: 0.3654411
	speed: 0.0797s/iter; left time: 689.8617s
	iters: 900, epoch: 2 | loss: 0.9731496
	speed: 0.0751s/iter; left time: 643.1436s
	iters: 1000, epoch: 2 | loss: 0.2221081
	speed: 0.0734s/iter; left time: 620.6880s
Max Memory (MB): 16.845703125
Epoch: 2 cost time: 91.77022075653076
Epoch: 2, Steps: 1051 | Train Loss: 0.4960302 Vali Loss: 0.2992746 Test Loss: 0.3955916
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.8089356
	speed: 2.1562s/iter; left time: 17915.7588s
	iters: 200, epoch: 3 | loss: 0.6862208
	speed: 0.0921s/iter; left time: 756.0891s
	iters: 300, epoch: 3 | loss: 0.3715683
	speed: 0.0898s/iter; left time: 728.3352s
	iters: 400, epoch: 3 | loss: 0.6513580
	speed: 0.0881s/iter; left time: 705.5908s
	iters: 500, epoch: 3 | loss: 0.5461007
	speed: 0.0889s/iter; left time: 703.2180s
	iters: 600, epoch: 3 | loss: 0.5626127
	speed: 0.0950s/iter; left time: 741.9342s
	iters: 700, epoch: 3 | loss: 0.4357218
	speed: 0.0923s/iter; left time: 711.9030s
	iters: 800, epoch: 3 | loss: 0.6020100
	speed: 0.0943s/iter; left time: 717.5752s
	iters: 900, epoch: 3 | loss: 0.3652807
	speed: 0.0860s/iter; left time: 645.4853s
	iters: 1000, epoch: 3 | loss: 0.2986708
	speed: 0.0857s/iter; left time: 635.0770s
Max Memory (MB): 16.845703125
Epoch: 3 cost time: 96.13831543922424
Epoch: 3, Steps: 1051 | Train Loss: 0.4712968 Vali Loss: 0.3023624 Test Loss: 0.3981269
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3372994
	speed: 2.3252s/iter; left time: 16876.0005s
	iters: 200, epoch: 4 | loss: 0.3607076
	speed: 0.0855s/iter; left time: 612.0268s
	iters: 300, epoch: 4 | loss: 0.6892363
	speed: 0.0815s/iter; left time: 575.3499s
	iters: 400, epoch: 4 | loss: 0.3340239
	speed: 0.0824s/iter; left time: 573.5549s
	iters: 500, epoch: 4 | loss: 0.6322960
	speed: 0.0798s/iter; left time: 547.2499s
	iters: 600, epoch: 4 | loss: 0.4127258
	speed: 0.0774s/iter; left time: 523.3496s
	iters: 700, epoch: 4 | loss: 0.7178517
	speed: 0.0652s/iter; left time: 433.9601s
	iters: 800, epoch: 4 | loss: 0.5105571
	speed: 0.0595s/iter; left time: 390.0522s
	iters: 900, epoch: 4 | loss: 0.5251716
	speed: 0.0687s/iter; left time: 443.8489s
	iters: 1000, epoch: 4 | loss: 0.4779002
	speed: 0.0627s/iter; left time: 398.7625s
Max Memory (MB): 16.845703125
Epoch: 4 cost time: 79.88754153251648
Epoch: 4, Steps: 1051 | Train Loss: 0.4621322 Vali Loss: 0.3018168 Test Loss: 0.3980390
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm2_192_720_iTransformer_ETTm2_M_ft192_sl48_ll720_pl128_dm8_nh2_el1_dl128_df1_fctimeF_ebTrue_dtExp_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
test shape: (10801, 1, 720, 7) (10801, 1, 720, 7)
test shape: (10801, 720, 7) (10801, 720, 7)
mse:0.38922953605651855, mae:0.39753472805023193
