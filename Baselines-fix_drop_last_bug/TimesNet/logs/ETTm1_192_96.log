True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm1_192_96        Model:              TimesNet            

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/          
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            192                 Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm1_192_96_TimesNet_ETTm1_ftM_sl192_ll48_pl96_dm16_nh8_el2_dl1_df32_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34273
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.3395135
	speed: 0.2111s/iter; left time: 6769.6792s
	iters: 200, epoch: 1 | loss: 0.3289536
	speed: 0.1775s/iter; left time: 5674.0884s
	iters: 300, epoch: 1 | loss: 0.3024279
	speed: 0.1784s/iter; left time: 5682.5652s
	iters: 400, epoch: 1 | loss: 0.2475374
	speed: 0.1827s/iter; left time: 5803.9275s
	iters: 500, epoch: 1 | loss: 0.2600102
	speed: 0.1801s/iter; left time: 5701.6133s
	iters: 600, epoch: 1 | loss: 0.2297673
	speed: 0.1784s/iter; left time: 5629.5946s
	iters: 700, epoch: 1 | loss: 0.2528151
	speed: 0.1782s/iter; left time: 5605.4429s
	iters: 800, epoch: 1 | loss: 0.2810998
	speed: 0.1764s/iter; left time: 5531.2660s
	iters: 900, epoch: 1 | loss: 0.2406445
	speed: 0.1786s/iter; left time: 5582.5415s
	iters: 1000, epoch: 1 | loss: 0.2589062
	speed: 0.1783s/iter; left time: 5555.8009s
Epoch: 1 cost time: 194.9209222793579
Epoch: 1, Steps: 1072 | Train Loss: 0.3074579 Vali Loss: 0.4052652 Test Loss: 0.3433065
Validation loss decreased (inf --> 0.405265).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2382936
	speed: 0.8724s/iter; left time: 27035.9082s
	iters: 200, epoch: 2 | loss: 0.2601453
	speed: 0.1768s/iter; left time: 5459.7861s
	iters: 300, epoch: 2 | loss: 0.2050794
	speed: 0.1790s/iter; left time: 5511.5173s
	iters: 400, epoch: 2 | loss: 0.1995590
	speed: 0.1739s/iter; left time: 5336.1305s
	iters: 500, epoch: 2 | loss: 0.2222386
	speed: 0.1740s/iter; left time: 5321.8202s
	iters: 600, epoch: 2 | loss: 0.2790343
	speed: 0.1753s/iter; left time: 5344.3531s
	iters: 700, epoch: 2 | loss: 0.2583549
	speed: 0.1748s/iter; left time: 5311.8048s
	iters: 800, epoch: 2 | loss: 0.2812868
	speed: 0.1717s/iter; left time: 5199.1629s
	iters: 900, epoch: 2 | loss: 0.1832357
	speed: 0.1689s/iter; left time: 5099.9513s
	iters: 1000, epoch: 2 | loss: 0.2491070
	speed: 0.1720s/iter; left time: 5174.8869s
Epoch: 2 cost time: 187.50001978874207
Epoch: 2, Steps: 1072 | Train Loss: 0.2372749 Vali Loss: 0.3968283 Test Loss: 0.3418399
Validation loss decreased (0.405265 --> 0.396828).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2207975
	speed: 0.8708s/iter; left time: 26052.2204s
	iters: 200, epoch: 3 | loss: 0.2160802
	speed: 0.1742s/iter; left time: 5194.6296s
	iters: 300, epoch: 3 | loss: 0.1682562
	speed: 0.1735s/iter; left time: 5155.9547s
	iters: 400, epoch: 3 | loss: 0.1925192
	speed: 0.1751s/iter; left time: 5187.2783s
	iters: 500, epoch: 3 | loss: 0.2058255
	speed: 0.1738s/iter; left time: 5130.5929s
	iters: 600, epoch: 3 | loss: 0.2063471
	speed: 0.1735s/iter; left time: 5104.7844s
	iters: 700, epoch: 3 | loss: 0.2548299
	speed: 0.1725s/iter; left time: 5055.8059s
	iters: 800, epoch: 3 | loss: 0.1765504
	speed: 0.1738s/iter; left time: 5078.2783s
	iters: 900, epoch: 3 | loss: 0.1833187
	speed: 0.1733s/iter; left time: 5046.1644s
	iters: 1000, epoch: 3 | loss: 0.2131768
	speed: 0.1781s/iter; left time: 5167.3508s
Epoch: 3 cost time: 187.90981602668762
Epoch: 3, Steps: 1072 | Train Loss: 0.2118633 Vali Loss: 0.4211242 Test Loss: 0.3568708
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2028610
	speed: 0.8348s/iter; left time: 24078.8625s
	iters: 200, epoch: 4 | loss: 0.2102924
	speed: 0.1703s/iter; left time: 4894.9051s
	iters: 300, epoch: 4 | loss: 0.1939304
	speed: 0.1711s/iter; left time: 4900.7853s
	iters: 400, epoch: 4 | loss: 0.2023409
	speed: 0.1703s/iter; left time: 4859.8323s
	iters: 500, epoch: 4 | loss: 0.1853230
	speed: 0.1726s/iter; left time: 4909.4334s
	iters: 600, epoch: 4 | loss: 0.1954539
	speed: 0.1725s/iter; left time: 4889.0551s
	iters: 700, epoch: 4 | loss: 0.1975470
	speed: 0.1752s/iter; left time: 4947.5172s
	iters: 800, epoch: 4 | loss: 0.1904665
	speed: 0.1722s/iter; left time: 4847.6311s
	iters: 900, epoch: 4 | loss: 0.2530843
	speed: 0.1742s/iter; left time: 4886.1537s
	iters: 1000, epoch: 4 | loss: 0.1982721
	speed: 0.1722s/iter; left time: 4812.1126s
Epoch: 4 cost time: 185.43080163002014
Epoch: 4, Steps: 1072 | Train Loss: 0.2001479 Vali Loss: 0.4176193 Test Loss: 0.3645063
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1427124
	speed: 0.8553s/iter; left time: 23754.6985s
	iters: 200, epoch: 5 | loss: 0.2245112
	speed: 0.1729s/iter; left time: 4786.0249s
	iters: 300, epoch: 5 | loss: 0.2020229
	speed: 0.1728s/iter; left time: 4764.5400s
	iters: 400, epoch: 5 | loss: 0.2273694
	speed: 0.1718s/iter; left time: 4718.8973s
	iters: 500, epoch: 5 | loss: 0.1667801
	speed: 0.1710s/iter; left time: 4680.8646s
	iters: 600, epoch: 5 | loss: 0.1912839
	speed: 0.1733s/iter; left time: 4725.9676s
	iters: 700, epoch: 5 | loss: 0.1835683
	speed: 0.1722s/iter; left time: 4679.6207s
	iters: 800, epoch: 5 | loss: 0.2058663
	speed: 0.1729s/iter; left time: 4680.5802s
	iters: 900, epoch: 5 | loss: 0.1914074
	speed: 0.1702s/iter; left time: 4590.1143s
	iters: 1000, epoch: 5 | loss: 0.1540667
	speed: 0.1706s/iter; left time: 4584.0093s
Epoch: 5 cost time: 185.64427280426025
Epoch: 5, Steps: 1072 | Train Loss: 0.1942804 Vali Loss: 0.4198053 Test Loss: 0.3645229
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm1_192_96_TimesNet_ETTm1_ftM_sl192_ll48_pl96_dm16_nh8_el2_dl1_df32_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
test shape: (11425, 96, 7) (11425, 96, 7)
test shape: (11425, 96, 7) (11425, 96, 7)
mse:0.3421624004840851, mae:0.3852485418319702, dtw:not calculated
