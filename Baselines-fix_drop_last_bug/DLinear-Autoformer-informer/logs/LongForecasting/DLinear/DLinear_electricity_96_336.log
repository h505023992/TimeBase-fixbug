Args in experiment:
Namespace(is_training=1, train_only=False, model_id='DLinear_electricity_96_336', model='DLinear', data='custom', root_path='./dataset/', data_path='electricity.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=336, individual=False, embed_type=0, enc_in=321, dec_in=321, c_out=321, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DLinear_electricity_96_336_DLinear_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17981
val 2297
test 4925
	iters: 100, epoch: 1 | loss: 0.6489714
	speed: 0.0558s/iter; left time: 934.4737s
	iters: 200, epoch: 1 | loss: 0.4692597
	speed: 0.0349s/iter; left time: 582.1660s
	iters: 300, epoch: 1 | loss: 0.3522712
	speed: 0.0406s/iter; left time: 672.1344s
	iters: 400, epoch: 1 | loss: 0.3077460
	speed: 0.0411s/iter; left time: 676.9890s
	iters: 500, epoch: 1 | loss: 0.3159918
	speed: 0.0470s/iter; left time: 769.2847s
Epoch: 1 cost time: 24.83524465560913
Epoch: 1, Steps: 562 | Train Loss: 0.4939728 Vali Loss: 0.2684613 Test Loss: 0.2963181
Validation loss decreased (inf --> 0.268461).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2936539
	speed: 0.3169s/iter; left time: 5133.5513s
	iters: 200, epoch: 2 | loss: 0.2707522
	speed: 0.0407s/iter; left time: 654.4362s
	iters: 300, epoch: 2 | loss: 0.2595730
	speed: 0.0429s/iter; left time: 686.0120s
	iters: 400, epoch: 2 | loss: 0.2708901
	speed: 0.0423s/iter; left time: 672.5753s
	iters: 500, epoch: 2 | loss: 0.2562155
	speed: 0.0416s/iter; left time: 657.2813s
Epoch: 2 cost time: 24.855270624160767
Epoch: 2, Steps: 562 | Train Loss: 0.2773934 Vali Loss: 0.2309007 Test Loss: 0.2578118
Validation loss decreased (0.268461 --> 0.230901).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2531343
	speed: 0.2622s/iter; left time: 4099.6148s
	iters: 200, epoch: 3 | loss: 0.2618684
	speed: 0.0425s/iter; left time: 660.5928s
	iters: 300, epoch: 3 | loss: 0.2459289
	speed: 0.0393s/iter; left time: 606.6938s
	iters: 400, epoch: 3 | loss: 0.2552728
	speed: 0.0435s/iter; left time: 667.9211s
	iters: 500, epoch: 3 | loss: 0.2340438
	speed: 0.0440s/iter; left time: 670.7830s
Epoch: 3 cost time: 25.438544988632202
Epoch: 3, Steps: 562 | Train Loss: 0.2558954 Vali Loss: 0.2206721 Test Loss: 0.2472048
Validation loss decreased (0.230901 --> 0.220672).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2621018
	speed: 0.2972s/iter; left time: 4479.7642s
	iters: 200, epoch: 4 | loss: 0.2584679
	speed: 0.0362s/iter; left time: 541.3544s
	iters: 300, epoch: 4 | loss: 0.2535501
	speed: 0.0368s/iter; left time: 547.1625s
	iters: 400, epoch: 4 | loss: 0.2340884
	speed: 0.0347s/iter; left time: 511.9624s
	iters: 500, epoch: 4 | loss: 0.2504723
	speed: 0.0370s/iter; left time: 543.4655s
Epoch: 4 cost time: 22.16390299797058
Epoch: 4, Steps: 562 | Train Loss: 0.2484857 Vali Loss: 0.2162396 Test Loss: 0.2426382
Validation loss decreased (0.220672 --> 0.216240).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2345214
	speed: 0.3146s/iter; left time: 4566.3388s
	iters: 200, epoch: 5 | loss: 0.2522100
	speed: 0.0461s/iter; left time: 665.1111s
	iters: 300, epoch: 5 | loss: 0.2272213
	speed: 0.0385s/iter; left time: 551.2792s
	iters: 400, epoch: 5 | loss: 0.2577786
	speed: 0.0364s/iter; left time: 517.7438s
	iters: 500, epoch: 5 | loss: 0.2595578
	speed: 0.0373s/iter; left time: 526.8606s
Epoch: 5 cost time: 24.038235664367676
Epoch: 5, Steps: 562 | Train Loss: 0.2449957 Vali Loss: 0.2139401 Test Loss: 0.2402083
Validation loss decreased (0.216240 --> 0.213940).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2269387
	speed: 0.2529s/iter; left time: 3528.2053s
	iters: 200, epoch: 6 | loss: 0.2342761
	speed: 0.0374s/iter; left time: 517.7475s
	iters: 300, epoch: 6 | loss: 0.2440648
	speed: 0.0435s/iter; left time: 597.9496s
	iters: 400, epoch: 6 | loss: 0.2318356
	speed: 0.0435s/iter; left time: 593.6110s
	iters: 500, epoch: 6 | loss: 0.2225885
	speed: 0.0471s/iter; left time: 638.2327s
Epoch: 6 cost time: 24.698001384735107
Epoch: 6, Steps: 562 | Train Loss: 0.2431848 Vali Loss: 0.2127301 Test Loss: 0.2389694
Validation loss decreased (0.213940 --> 0.212730).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2441495
	speed: 0.3541s/iter; left time: 4741.6466s
	iters: 200, epoch: 7 | loss: 0.2504909
	speed: 0.0424s/iter; left time: 563.7105s
	iters: 300, epoch: 7 | loss: 0.2348025
	speed: 0.0415s/iter; left time: 547.9456s
	iters: 400, epoch: 7 | loss: 0.2503338
	speed: 0.0403s/iter; left time: 527.0781s
	iters: 500, epoch: 7 | loss: 0.2301119
	speed: 0.0414s/iter; left time: 538.0951s
Epoch: 7 cost time: 25.966686725616455
Epoch: 7, Steps: 562 | Train Loss: 0.2422141 Vali Loss: 0.2120758 Test Loss: 0.2382800
Validation loss decreased (0.212730 --> 0.212076).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2241560
	speed: 0.3502s/iter; left time: 4491.4907s
	iters: 200, epoch: 8 | loss: 0.2531468
	speed: 0.0481s/iter; left time: 611.7353s
	iters: 300, epoch: 8 | loss: 0.2199270
	speed: 0.0514s/iter; left time: 649.5136s
	iters: 400, epoch: 8 | loss: 0.2548847
	speed: 0.0419s/iter; left time: 524.8272s
	iters: 500, epoch: 8 | loss: 0.2347003
	speed: 0.0422s/iter; left time: 524.8098s
Epoch: 8 cost time: 26.9442355632782
Epoch: 8, Steps: 562 | Train Loss: 0.2416931 Vali Loss: 0.2117391 Test Loss: 0.2379076
Validation loss decreased (0.212076 --> 0.211739).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2405752
	speed: 0.2977s/iter; left time: 3651.6289s
	iters: 200, epoch: 9 | loss: 0.2178122
	speed: 0.0423s/iter; left time: 514.1206s
	iters: 300, epoch: 9 | loss: 0.2305448
	speed: 0.0474s/iter; left time: 572.4194s
	iters: 400, epoch: 9 | loss: 0.2296145
	speed: 0.0472s/iter; left time: 564.5645s
	iters: 500, epoch: 9 | loss: 0.2513604
	speed: 0.0451s/iter; left time: 535.4252s
Epoch: 9 cost time: 26.426687955856323
Epoch: 9, Steps: 562 | Train Loss: 0.2414141 Vali Loss: 0.2115317 Test Loss: 0.2377133
Validation loss decreased (0.211739 --> 0.211532).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2269860
	speed: 0.3197s/iter; left time: 3741.6752s
	iters: 200, epoch: 10 | loss: 0.2257984
	speed: 0.0385s/iter; left time: 446.7455s
	iters: 300, epoch: 10 | loss: 0.2390512
	speed: 0.0376s/iter; left time: 432.3575s
	iters: 400, epoch: 10 | loss: 0.2429768
	speed: 0.0365s/iter; left time: 415.6876s
	iters: 500, epoch: 10 | loss: 0.2402575
	speed: 0.0373s/iter; left time: 421.7256s
Epoch: 10 cost time: 22.92571711540222
Epoch: 10, Steps: 562 | Train Loss: 0.2412577 Vali Loss: 0.2114649 Test Loss: 0.2376095
Validation loss decreased (0.211532 --> 0.211465).  Saving model ...
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.2362004
	speed: 0.3084s/iter; left time: 3435.3501s
	iters: 200, epoch: 11 | loss: 0.2478859
	speed: 0.0451s/iter; left time: 497.9011s
	iters: 300, epoch: 11 | loss: 0.2232778
	speed: 0.0463s/iter; left time: 506.4491s
	iters: 400, epoch: 11 | loss: 0.2186730
	speed: 0.0395s/iter; left time: 428.7499s
	iters: 500, epoch: 11 | loss: 0.2222393
	speed: 0.0384s/iter; left time: 411.9691s
Epoch: 11 cost time: 25.2186062335968
Epoch: 11, Steps: 562 | Train Loss: 0.2411883 Vali Loss: 0.2114128 Test Loss: 0.2375563
Validation loss decreased (0.211465 --> 0.211413).  Saving model ...
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.2380963
	speed: 0.2373s/iter; left time: 2510.4020s
	iters: 200, epoch: 12 | loss: 0.2199277
	speed: 0.0369s/iter; left time: 387.1135s
	iters: 300, epoch: 12 | loss: 0.2258924
	speed: 0.0368s/iter; left time: 382.3423s
	iters: 400, epoch: 12 | loss: 0.2505651
	speed: 0.0351s/iter; left time: 361.2171s
	iters: 500, epoch: 12 | loss: 0.2216406
	speed: 0.0366s/iter; left time: 372.4022s
Epoch: 12 cost time: 22.387935161590576
Epoch: 12, Steps: 562 | Train Loss: 0.2411386 Vali Loss: 0.2113865 Test Loss: 0.2375291
Validation loss decreased (0.211413 --> 0.211387).  Saving model ...
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.2456986
	speed: 0.3323s/iter; left time: 3328.4350s
	iters: 200, epoch: 13 | loss: 0.2691411
	speed: 0.0490s/iter; left time: 486.2152s
	iters: 300, epoch: 13 | loss: 0.2368422
	speed: 0.0485s/iter; left time: 476.1477s
	iters: 400, epoch: 13 | loss: 0.2478985
	speed: 0.0520s/iter; left time: 504.8421s
	iters: 500, epoch: 13 | loss: 0.2473099
	speed: 0.0460s/iter; left time: 442.0499s
Epoch: 13 cost time: 28.792300701141357
Epoch: 13, Steps: 562 | Train Loss: 0.2411257 Vali Loss: 0.2113886 Test Loss: 0.2375149
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.2391029
	speed: 0.3258s/iter; left time: 3080.0351s
	iters: 200, epoch: 14 | loss: 0.2392423
	speed: 0.0417s/iter; left time: 390.5480s
	iters: 300, epoch: 14 | loss: 0.2642222
	speed: 0.0389s/iter; left time: 360.0327s
	iters: 400, epoch: 14 | loss: 0.2221333
	speed: 0.0407s/iter; left time: 372.7196s
	iters: 500, epoch: 14 | loss: 0.2386414
	speed: 0.0413s/iter; left time: 373.6826s
Epoch: 14 cost time: 24.367347717285156
Epoch: 14, Steps: 562 | Train Loss: 0.2411138 Vali Loss: 0.2113665 Test Loss: 0.2375079
Validation loss decreased (0.211387 --> 0.211367).  Saving model ...
Updating learning rate to 1.220703125e-08
	iters: 100, epoch: 15 | loss: 0.2311934
	speed: 0.2762s/iter; left time: 2456.5814s
	iters: 200, epoch: 15 | loss: 0.2385854
	speed: 0.0383s/iter; left time: 336.6788s
	iters: 300, epoch: 15 | loss: 0.2209773
	speed: 0.0377s/iter; left time: 327.3045s
	iters: 400, epoch: 15 | loss: 0.2282133
	speed: 0.0387s/iter; left time: 332.3697s
	iters: 500, epoch: 15 | loss: 0.2176239
	speed: 0.0366s/iter; left time: 310.4717s
Epoch: 15 cost time: 22.68558979034424
Epoch: 15, Steps: 562 | Train Loss: 0.2411063 Vali Loss: 0.2113479 Test Loss: 0.2375044
Validation loss decreased (0.211367 --> 0.211348).  Saving model ...
Updating learning rate to 6.103515625e-09
	iters: 100, epoch: 16 | loss: 0.2324973
	speed: 0.3217s/iter; left time: 2679.9152s
	iters: 200, epoch: 16 | loss: 0.2683173
	speed: 0.0440s/iter; left time: 362.1240s
	iters: 300, epoch: 16 | loss: 0.2193362
	speed: 0.0475s/iter; left time: 386.5490s
	iters: 400, epoch: 16 | loss: 0.2381534
	speed: 0.0489s/iter; left time: 392.9694s
	iters: 500, epoch: 16 | loss: 0.2371778
	speed: 0.0474s/iter; left time: 375.8957s
Epoch: 16 cost time: 27.659790992736816
Epoch: 16, Steps: 562 | Train Loss: 0.2411024 Vali Loss: 0.2113534 Test Loss: 0.2375029
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.0517578125e-09
	iters: 100, epoch: 17 | loss: 0.2297096
	speed: 0.3047s/iter; left time: 2367.0378s
	iters: 200, epoch: 17 | loss: 0.2681657
	speed: 0.0357s/iter; left time: 273.5403s
	iters: 300, epoch: 17 | loss: 0.2556161
	speed: 0.0367s/iter; left time: 278.1293s
	iters: 400, epoch: 17 | loss: 0.2458732
	speed: 0.0368s/iter; left time: 274.4860s
	iters: 500, epoch: 17 | loss: 0.2261426
	speed: 0.0350s/iter; left time: 258.0156s
Epoch: 17 cost time: 21.79724621772766
Epoch: 17, Steps: 562 | Train Loss: 0.2411029 Vali Loss: 0.2113868 Test Loss: 0.2375024
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.52587890625e-09
	iters: 100, epoch: 18 | loss: 0.2243180
	speed: 0.2533s/iter; left time: 1825.2437s
	iters: 200, epoch: 18 | loss: 0.2322056
	speed: 0.0366s/iter; left time: 259.9891s
	iters: 300, epoch: 18 | loss: 0.2436177
	speed: 0.0371s/iter; left time: 259.6694s
	iters: 400, epoch: 18 | loss: 0.2172529
	speed: 0.0371s/iter; left time: 255.9584s
	iters: 500, epoch: 18 | loss: 0.2551206
	speed: 0.0366s/iter; left time: 249.2199s
Epoch: 18 cost time: 22.09695291519165
Epoch: 18, Steps: 562 | Train Loss: 0.2411077 Vali Loss: 0.2113577 Test Loss: 0.2375022
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : DLinear_electricity_96_336_DLinear_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4925
mse:0.23741456866264343, mae:0.33326661586761475
