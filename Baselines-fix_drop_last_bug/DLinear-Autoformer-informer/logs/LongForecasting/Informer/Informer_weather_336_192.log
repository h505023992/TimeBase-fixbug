Args in experiment:
Namespace(is_training=1, train_only=False, model_id='Informer_weather_336_192', model='Informer', data='custom', root_path='./dataset/', data_path='weather.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=192, individual=False, embed_type=0, enc_in=21, dec_in=21, c_out=21, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : Informer_weather_336_192_Informer_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36360
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.6163372
	speed: 0.3928s/iter; left time: 13359.2460s
	iters: 200, epoch: 1 | loss: 0.4997021
	speed: 0.3491s/iter; left time: 11837.2007s
	iters: 300, epoch: 1 | loss: 0.3066007
	speed: 0.3650s/iter; left time: 12340.3851s
	iters: 400, epoch: 1 | loss: 0.3066933
	speed: 0.3731s/iter; left time: 12577.1203s
	iters: 500, epoch: 1 | loss: 0.3018636
	speed: 0.3407s/iter; left time: 11452.3508s
	iters: 600, epoch: 1 | loss: 0.3933743
	speed: 0.3464s/iter; left time: 11607.0860s
	iters: 700, epoch: 1 | loss: 0.3314851
	speed: 0.3334s/iter; left time: 11140.7788s
	iters: 800, epoch: 1 | loss: 0.3276367
	speed: 0.3596s/iter; left time: 11979.7535s
	iters: 900, epoch: 1 | loss: 0.2943863
	speed: 0.3553s/iter; left time: 11799.0709s
	iters: 1000, epoch: 1 | loss: 0.4591115
	speed: 0.3434s/iter; left time: 11368.9491s
	iters: 1100, epoch: 1 | loss: 0.3883176
	speed: 0.3499s/iter; left time: 11549.1074s
Epoch: 1 cost time: 403.81894516944885
Epoch: 1, Steps: 1137 | Train Loss: 0.4371518 Vali Loss: 0.6106010 Test Loss: 0.5365618
Validation loss decreased (inf --> 0.610601).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2430460
	speed: 1.5592s/iter; left time: 51256.4338s
	iters: 200, epoch: 2 | loss: 0.1762411
	speed: 0.3646s/iter; left time: 11950.3853s
	iters: 300, epoch: 2 | loss: 0.2960956
	speed: 0.3785s/iter; left time: 12367.3251s
	iters: 400, epoch: 2 | loss: 0.6151914
	speed: 0.3499s/iter; left time: 11396.5295s
	iters: 500, epoch: 2 | loss: 0.2844191
	speed: 0.3398s/iter; left time: 11034.8256s
	iters: 600, epoch: 2 | loss: 0.7358289
	speed: 0.3392s/iter; left time: 10980.1686s
	iters: 700, epoch: 2 | loss: 0.1821829
	speed: 0.3383s/iter; left time: 10918.7379s
	iters: 800, epoch: 2 | loss: 0.2078262
	speed: 0.3374s/iter; left time: 10854.7401s
	iters: 900, epoch: 2 | loss: 0.2323875
	speed: 0.3393s/iter; left time: 10883.1158s
	iters: 1000, epoch: 2 | loss: 0.2309032
	speed: 0.3426s/iter; left time: 10953.6206s
	iters: 1100, epoch: 2 | loss: 0.2943000
	speed: 0.3449s/iter; left time: 10993.7375s
Epoch: 2 cost time: 396.46396231651306
Epoch: 2, Steps: 1137 | Train Loss: 0.3288164 Vali Loss: 0.6128458 Test Loss: 0.5265278
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1638789
	speed: 1.5588s/iter; left time: 49470.4682s
	iters: 200, epoch: 3 | loss: 0.1748839
	speed: 0.3646s/iter; left time: 11536.3258s
	iters: 300, epoch: 3 | loss: 0.5310206
	speed: 0.3774s/iter; left time: 11901.1596s
	iters: 400, epoch: 3 | loss: 0.2065400
	speed: 0.3647s/iter; left time: 11465.3572s
	iters: 500, epoch: 3 | loss: 0.1860628
	speed: 0.3565s/iter; left time: 11172.6066s
	iters: 600, epoch: 3 | loss: 0.6032462
	speed: 0.3355s/iter; left time: 10479.6390s
	iters: 700, epoch: 3 | loss: 0.1705889
	speed: 0.3325s/iter; left time: 10352.7123s
	iters: 800, epoch: 3 | loss: 0.1778666
	speed: 0.3441s/iter; left time: 10680.4777s
	iters: 900, epoch: 3 | loss: 0.1608986
	speed: 0.3548s/iter; left time: 10977.0336s
	iters: 1000, epoch: 3 | loss: 0.4971406
	speed: 0.3615s/iter; left time: 11147.0974s
	iters: 1100, epoch: 3 | loss: 0.1716338
	speed: 0.3597s/iter; left time: 11057.2821s
Epoch: 3 cost time: 403.6711232662201
Epoch: 3, Steps: 1137 | Train Loss: 0.2654145 Vali Loss: 0.6051660 Test Loss: 0.5512051
Validation loss decreased (0.610601 --> 0.605166).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1901254
	speed: 1.6051s/iter; left time: 49117.3922s
	iters: 200, epoch: 4 | loss: 0.3202876
	speed: 0.3532s/iter; left time: 10771.9985s
	iters: 300, epoch: 4 | loss: 0.1185103
	speed: 0.3695s/iter; left time: 11231.8762s
	iters: 400, epoch: 4 | loss: 0.2900517
	speed: 0.3286s/iter; left time: 9956.8620s
	iters: 500, epoch: 4 | loss: 0.2481442
	speed: 0.3352s/iter; left time: 10121.6678s
	iters: 600, epoch: 4 | loss: 0.1886884
	speed: 0.3463s/iter; left time: 10424.0334s
	iters: 700, epoch: 4 | loss: 0.1804920
	speed: 0.3611s/iter; left time: 10832.4843s
	iters: 800, epoch: 4 | loss: 0.5151613
	speed: 0.3705s/iter; left time: 11078.7597s
	iters: 900, epoch: 4 | loss: 0.1366361
	speed: 0.3879s/iter; left time: 11559.2706s
	iters: 1000, epoch: 4 | loss: 0.1317241
	speed: 0.3402s/iter; left time: 10103.2231s
	iters: 1100, epoch: 4 | loss: 0.1537455
	speed: 0.3270s/iter; left time: 9679.0942s
Epoch: 4 cost time: 401.4809923171997
Epoch: 4, Steps: 1137 | Train Loss: 0.2411429 Vali Loss: 0.5952531 Test Loss: 0.4879683
Validation loss decreased (0.605166 --> 0.595253).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2127788
	speed: 1.5844s/iter; left time: 46680.1905s
	iters: 200, epoch: 5 | loss: 0.1590646
	speed: 0.3245s/iter; left time: 9528.3447s
	iters: 300, epoch: 5 | loss: 0.1535359
	speed: 0.3325s/iter; left time: 9730.9193s
	iters: 400, epoch: 5 | loss: 0.1333509
	speed: 0.3562s/iter; left time: 10386.9394s
	iters: 500, epoch: 5 | loss: 0.7844040
	speed: 0.3687s/iter; left time: 10715.9981s
	iters: 600, epoch: 5 | loss: 0.1852552
	speed: 0.3752s/iter; left time: 10867.6231s
	iters: 700, epoch: 5 | loss: 0.2538319
	speed: 0.3418s/iter; left time: 9865.3991s
	iters: 800, epoch: 5 | loss: 0.2400880
	speed: 0.3269s/iter; left time: 9403.9759s
	iters: 900, epoch: 5 | loss: 0.2013085
	speed: 0.3347s/iter; left time: 9594.1541s
	iters: 1000, epoch: 5 | loss: 0.1417317
	speed: 0.3495s/iter; left time: 9981.8424s
	iters: 1100, epoch: 5 | loss: 0.1223969
	speed: 0.3674s/iter; left time: 10457.4714s
Epoch: 5 cost time: 397.93605613708496
Epoch: 5, Steps: 1137 | Train Loss: 0.2304180 Vali Loss: 0.6087774 Test Loss: 0.5185656
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2075986
	speed: 1.5694s/iter; left time: 44453.6359s
	iters: 200, epoch: 6 | loss: 0.1975220
	speed: 0.3593s/iter; left time: 10142.8671s
	iters: 300, epoch: 6 | loss: 0.1841445
	speed: 0.3565s/iter; left time: 10026.9768s
	iters: 400, epoch: 6 | loss: 0.1359813
	speed: 0.3428s/iter; left time: 9608.3637s
	iters: 500, epoch: 6 | loss: 0.1951171
	speed: 0.3307s/iter; left time: 9234.5146s
	iters: 600, epoch: 6 | loss: 0.4638881
	speed: 0.3331s/iter; left time: 9267.7014s
	iters: 700, epoch: 6 | loss: 0.7691231
	speed: 0.3317s/iter; left time: 9198.0405s
	iters: 800, epoch: 6 | loss: 0.1537097
	speed: 0.3236s/iter; left time: 8938.7152s
	iters: 900, epoch: 6 | loss: 0.1239516
	speed: 0.3208s/iter; left time: 8829.3423s
	iters: 1000, epoch: 6 | loss: 0.2487496
	speed: 0.3130s/iter; left time: 8583.7208s
	iters: 1100, epoch: 6 | loss: 0.1373650
	speed: 0.3181s/iter; left time: 8693.2312s
Epoch: 6 cost time: 382.26267099380493
Epoch: 6, Steps: 1137 | Train Loss: 0.2253589 Vali Loss: 0.6001726 Test Loss: 0.5215675
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1588543
	speed: 1.5312s/iter; left time: 41632.0638s
	iters: 200, epoch: 7 | loss: 0.1354736
	speed: 0.3239s/iter; left time: 8773.7578s
	iters: 300, epoch: 7 | loss: 0.0957323
	speed: 0.3510s/iter; left time: 9474.2455s
	iters: 400, epoch: 7 | loss: 0.1815316
	speed: 0.3553s/iter; left time: 9553.3807s
	iters: 500, epoch: 7 | loss: 0.1357138
	speed: 0.3560s/iter; left time: 9536.7763s
	iters: 600, epoch: 7 | loss: 0.1560875
	speed: 0.3388s/iter; left time: 9042.3287s
	iters: 700, epoch: 7 | loss: 0.1132140
	speed: 0.3268s/iter; left time: 8690.2547s
	iters: 800, epoch: 7 | loss: 0.1736895
	speed: 0.3269s/iter; left time: 8658.6041s
	iters: 900, epoch: 7 | loss: 0.1660247
	speed: 0.3489s/iter; left time: 9206.8705s
	iters: 1000, epoch: 7 | loss: 0.7310798
	speed: 0.3516s/iter; left time: 9243.8299s
	iters: 1100, epoch: 7 | loss: 0.1555125
	speed: 0.3512s/iter; left time: 9197.8034s
Epoch: 7 cost time: 390.64760732650757
Epoch: 7, Steps: 1137 | Train Loss: 0.2226556 Vali Loss: 0.6026511 Test Loss: 0.5269783
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Informer_weather_336_192_Informer_custom_ftM_sl336_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
mse:0.4879715144634247, mae:0.47299835085868835
