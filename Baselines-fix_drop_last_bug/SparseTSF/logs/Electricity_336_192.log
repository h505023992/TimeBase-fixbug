Args in experiment:
Namespace(is_training=1, model_id='Electricity_336_192', model='SparseTSF', data='custom', root_path='./dataset/', data_path='electricity.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=192, period_len=24, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=321, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=128, patience=5, learning_rate=0.02, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=2, use_multi_gpu=0, devices='0,1', test_flop=False)
Use GPU: cuda:2
>>>>>>>start training : Electricity_336_192_SparseTSF_custom_ftM_sl336_pl192_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17885
val 2441
test 5069
	iters: 100, epoch: 1 | loss: 0.2672899
	speed: 0.1869s/iter; left time: 760.7519s
Epoch: 1 cost time: 23.937397480010986
Epoch: 1, Steps: 139 | Train Loss: 0.4485205 Vali Loss: 0.2211143 Test Loss: 0.2483144
Validation loss decreased (inf --> 0.221114).  Saving model ...
Updating learning rate to 0.02
	iters: 100, epoch: 2 | loss: 0.1608703
	speed: 0.3575s/iter; left time: 1405.8857s
Epoch: 2 cost time: 21.404680967330933
Epoch: 2, Steps: 139 | Train Loss: 0.1917797 Vali Loss: 0.1384583 Test Loss: 0.1655220
Validation loss decreased (0.221114 --> 0.138458).  Saving model ...
Updating learning rate to 0.02
	iters: 100, epoch: 3 | loss: 0.1673778
	speed: 0.3873s/iter; left time: 1468.9998s
Epoch: 3 cost time: 21.70413613319397
Epoch: 3, Steps: 139 | Train Loss: 0.1625062 Vali Loss: 0.1356253 Test Loss: 0.1619863
Validation loss decreased (0.138458 --> 0.135625).  Saving model ...
Updating learning rate to 0.02
	iters: 100, epoch: 4 | loss: 0.1559500
	speed: 0.3894s/iter; left time: 1422.8700s
Epoch: 4 cost time: 21.52690553665161
Epoch: 4, Steps: 139 | Train Loss: 0.1611121 Vali Loss: 0.1353044 Test Loss: 0.1615441
Validation loss decreased (0.135625 --> 0.135304).  Saving model ...
Updating learning rate to 0.016
	iters: 100, epoch: 5 | loss: 0.1537214
	speed: 0.3642s/iter; left time: 1280.0939s
Epoch: 5 cost time: 19.528651475906372
Epoch: 5, Steps: 139 | Train Loss: 0.1608719 Vali Loss: 0.1353926 Test Loss: 0.1613435
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.012800000000000002
	iters: 100, epoch: 6 | loss: 0.1502495
	speed: 0.3859s/iter; left time: 1302.8093s
Epoch: 6 cost time: 21.36988139152527
Epoch: 6, Steps: 139 | Train Loss: 0.1607774 Vali Loss: 0.1351739 Test Loss: 0.1616818
Validation loss decreased (0.135304 --> 0.135174).  Saving model ...
Updating learning rate to 0.010240000000000003
	iters: 100, epoch: 7 | loss: 0.1537024
	speed: 0.3998s/iter; left time: 1294.1577s
Epoch: 7 cost time: 22.205540418624878
Epoch: 7, Steps: 139 | Train Loss: 0.1607305 Vali Loss: 0.1352319 Test Loss: 0.1613418
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.008192000000000001
	iters: 100, epoch: 8 | loss: 0.1558138
	speed: 0.3995s/iter; left time: 1237.5580s
Epoch: 8 cost time: 20.988980531692505
Epoch: 8, Steps: 139 | Train Loss: 0.1607617 Vali Loss: 0.1351864 Test Loss: 0.1613079
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.0065536000000000014
	iters: 100, epoch: 9 | loss: 0.1512763
	speed: 0.3739s/iter; left time: 1106.4620s
Epoch: 9 cost time: 20.28564190864563
Epoch: 9, Steps: 139 | Train Loss: 0.1607270 Vali Loss: 0.1351380 Test Loss: 0.1612702
Validation loss decreased (0.135174 --> 0.135138).  Saving model ...
Updating learning rate to 0.005242880000000002
	iters: 100, epoch: 10 | loss: 0.1722733
	speed: 0.3715s/iter; left time: 1047.7447s
Epoch: 10 cost time: 21.01355767250061
Epoch: 10, Steps: 139 | Train Loss: 0.1607238 Vali Loss: 0.1352707 Test Loss: 0.1612797
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.004194304000000002
	iters: 100, epoch: 11 | loss: 0.1505747
	speed: 0.3753s/iter; left time: 1006.0901s
Epoch: 11 cost time: 20.991252660751343
Epoch: 11, Steps: 139 | Train Loss: 0.1607468 Vali Loss: 0.1353418 Test Loss: 0.1612664
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.003355443200000002
	iters: 100, epoch: 12 | loss: 0.1605551
	speed: 0.3841s/iter; left time: 976.3965s
Epoch: 12 cost time: 21.77553915977478
Epoch: 12, Steps: 139 | Train Loss: 0.1607616 Vali Loss: 0.1351081 Test Loss: 0.1614087
Validation loss decreased (0.135138 --> 0.135108).  Saving model ...
Updating learning rate to 0.002684354560000001
	iters: 100, epoch: 13 | loss: 0.1620547
	speed: 0.3805s/iter; left time: 914.3312s
Epoch: 13 cost time: 20.969336986541748
Epoch: 13, Steps: 139 | Train Loss: 0.1606908 Vali Loss: 0.1352130 Test Loss: 0.1611940
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0021474836480000013
	iters: 100, epoch: 14 | loss: 0.1568008
	speed: 0.3829s/iter; left time: 866.8727s
Epoch: 14 cost time: 20.99138879776001
Epoch: 14, Steps: 139 | Train Loss: 0.1607009 Vali Loss: 0.1351371 Test Loss: 0.1612686
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.0017179869184000011
	iters: 100, epoch: 15 | loss: 0.1535684
	speed: 0.3787s/iter; left time: 804.8066s
Epoch: 15 cost time: 21.20881175994873
Epoch: 15, Steps: 139 | Train Loss: 0.1606729 Vali Loss: 0.1351425 Test Loss: 0.1612038
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.0013743895347200009
	iters: 100, epoch: 16 | loss: 0.1594491
	speed: 0.3810s/iter; left time: 756.6086s
Epoch: 16 cost time: 20.826545000076294
Epoch: 16, Steps: 139 | Train Loss: 0.1606931 Vali Loss: 0.1351869 Test Loss: 0.1612268
EarlyStopping counter: 4 out of 5
Updating learning rate to 0.0010995116277760007
	iters: 100, epoch: 17 | loss: 0.1617998
	speed: 0.3655s/iter; left time: 675.1165s
Epoch: 17 cost time: 20.71732521057129
Epoch: 17, Steps: 139 | Train Loss: 0.1607002 Vali Loss: 0.1351022 Test Loss: 0.1612280
Validation loss decreased (0.135108 --> 0.135102).  Saving model ...
Updating learning rate to 0.0008796093022208007
	iters: 100, epoch: 18 | loss: 0.1648560
	speed: 0.3784s/iter; left time: 646.3333s
Epoch: 18 cost time: 21.05811858177185
Epoch: 18, Steps: 139 | Train Loss: 0.1606427 Vali Loss: 0.1352157 Test Loss: 0.1612087
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0007036874417766406
	iters: 100, epoch: 19 | loss: 0.1642214
	speed: 0.3887s/iter; left time: 609.9258s
Epoch: 19 cost time: 21.50568675994873
Epoch: 19, Steps: 139 | Train Loss: 0.1607269 Vali Loss: 0.1351555 Test Loss: 0.1612663
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.0005629499534213125
	iters: 100, epoch: 20 | loss: 0.1652170
	speed: 0.3879s/iter; left time: 554.7105s
Epoch: 20 cost time: 21.41346287727356
Epoch: 20, Steps: 139 | Train Loss: 0.1606437 Vali Loss: 0.1352744 Test Loss: 0.1612097
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.0004503599627370501
	iters: 100, epoch: 21 | loss: 0.1527877
	speed: 0.3938s/iter; left time: 508.4513s
Epoch: 21 cost time: 21.740379810333252
Epoch: 21, Steps: 139 | Train Loss: 0.1605923 Vali Loss: 0.1351430 Test Loss: 0.1612292
EarlyStopping counter: 4 out of 5
Updating learning rate to 0.00036028797018964004
	iters: 100, epoch: 22 | loss: 0.1676124
	speed: 0.3843s/iter; left time: 442.6755s
Epoch: 22 cost time: 21.113067865371704
Epoch: 22, Steps: 139 | Train Loss: 0.1606655 Vali Loss: 0.1352287 Test Loss: 0.1612167
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : Electricity_336_192_SparseTSF_custom_ftM_sl336_pl192_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5069
mse:0.15841183066368103, mae:0.25140443444252014, rse:0.3957274258136749
