Args in experiment:
Namespace(is_training=1, model_id='ETTm1_720_96', model='SparseTSF', data='ETTm1', root_path='./dataset/', data_path='ETTm1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=96, period_len=4, basis_num=6, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=7, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=256, patience=5, learning_rate=0.02, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use GPU: cuda:0
model的参数数量: 4325
[INFO] Register count_convNd() for <class 'torch.nn.modules.conv.Conv1d'>.
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
MACs: 146160.0
Params: 4325.0
146160.0 MACs
>>>>>>>start training : ETTm1_720_96_SparseTSF_ETTm1_ftM_sl720_pl96_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.3095559
	speed: 0.0469s/iter; left time: 179.7643s
Max Memory (MB): 112.3515625
Epoch: 1 cost time: 5.928457260131836
Epoch: 1, Steps: 131 | Train Loss: 0.3602804 Vali Loss: 0.4467449 Test Loss: 0.3498124
Validation loss decreased (inf --> 0.446745).  Saving model ...
Updating learning rate to 0.02
	iters: 100, epoch: 2 | loss: 0.2803887
	speed: 0.1308s/iter; left time: 483.8367s
Max Memory (MB): 112.3515625
Epoch: 2 cost time: 6.502186298370361
Epoch: 2, Steps: 131 | Train Loss: 0.2769978 Vali Loss: 0.4236839 Test Loss: 0.3240745
Validation loss decreased (0.446745 --> 0.423684).  Saving model ...
Updating learning rate to 0.02
	iters: 100, epoch: 3 | loss: 0.2716357
	speed: 0.1239s/iter; left time: 442.2350s
Max Memory (MB): 112.3515625
Epoch: 3 cost time: 6.394587993621826
Epoch: 3, Steps: 131 | Train Loss: 0.2697118 Vali Loss: 0.4115107 Test Loss: 0.3172468
Validation loss decreased (0.423684 --> 0.411511).  Saving model ...
Updating learning rate to 0.02
	iters: 100, epoch: 4 | loss: 0.2866526
	speed: 0.1259s/iter; left time: 432.7503s
Max Memory (MB): 112.3515625
Epoch: 4 cost time: 6.2099926471710205
Epoch: 4, Steps: 131 | Train Loss: 0.2683395 Vali Loss: 0.4099538 Test Loss: 0.3139930
Validation loss decreased (0.411511 --> 0.409954).  Saving model ...
Updating learning rate to 0.016
	iters: 100, epoch: 5 | loss: 0.2559772
	speed: 0.1094s/iter; left time: 361.7932s
Max Memory (MB): 112.3515625
Epoch: 5 cost time: 4.676990270614624
Epoch: 5, Steps: 131 | Train Loss: 0.2658925 Vali Loss: 0.3978524 Test Loss: 0.3159224
Validation loss decreased (0.409954 --> 0.397852).  Saving model ...
Updating learning rate to 0.012800000000000002
	iters: 100, epoch: 6 | loss: 0.2554442
	speed: 0.1017s/iter; left time: 322.9322s
Max Memory (MB): 112.3515625
Epoch: 6 cost time: 4.6537299156188965
Epoch: 6, Steps: 131 | Train Loss: 0.2660513 Vali Loss: 0.4006547 Test Loss: 0.3165272
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.010240000000000003
	iters: 100, epoch: 7 | loss: 0.2563558
	speed: 0.1143s/iter; left time: 348.0521s
Max Memory (MB): 112.3515625
Epoch: 7 cost time: 6.19822359085083
Epoch: 7, Steps: 131 | Train Loss: 0.2649194 Vali Loss: 0.4056599 Test Loss: 0.3122559
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.008192000000000001
	iters: 100, epoch: 8 | loss: 0.2467555
	speed: 0.1113s/iter; left time: 324.2939s
Max Memory (MB): 112.3515625
Epoch: 8 cost time: 4.876275539398193
Epoch: 8, Steps: 131 | Train Loss: 0.2641709 Vali Loss: 0.3990807 Test Loss: 0.3120686
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.0065536000000000014
	iters: 100, epoch: 9 | loss: 0.2633601
	speed: 0.1018s/iter; left time: 283.2069s
Max Memory (MB): 112.3515625
Epoch: 9 cost time: 4.86908221244812
Epoch: 9, Steps: 131 | Train Loss: 0.2640811 Vali Loss: 0.3973372 Test Loss: 0.3114493
Validation loss decreased (0.397852 --> 0.397337).  Saving model ...
Updating learning rate to 0.005242880000000002
	iters: 100, epoch: 10 | loss: 0.2506547
	speed: 0.0993s/iter; left time: 263.2796s
Max Memory (MB): 112.3515625
Epoch: 10 cost time: 4.774409770965576
Epoch: 10, Steps: 131 | Train Loss: 0.2636333 Vali Loss: 0.3996055 Test Loss: 0.3126414
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.004194304000000002
	iters: 100, epoch: 11 | loss: 0.2634884
	speed: 0.1318s/iter; left time: 332.2693s
Max Memory (MB): 112.3515625
Epoch: 11 cost time: 5.955356121063232
Epoch: 11, Steps: 131 | Train Loss: 0.2636375 Vali Loss: 0.4050512 Test Loss: 0.3111313
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.003355443200000002
	iters: 100, epoch: 12 | loss: 0.2818554
	speed: 0.1273s/iter; left time: 304.1610s
Max Memory (MB): 112.3515625
Epoch: 12 cost time: 5.797518253326416
Epoch: 12, Steps: 131 | Train Loss: 0.2634307 Vali Loss: 0.3980055 Test Loss: 0.3112751
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.002684354560000001
	iters: 100, epoch: 13 | loss: 0.2701722
	speed: 0.1075s/iter; left time: 242.8645s
Max Memory (MB): 112.3515625
Epoch: 13 cost time: 4.701885223388672
Epoch: 13, Steps: 131 | Train Loss: 0.2632837 Vali Loss: 0.4009391 Test Loss: 0.3113187
EarlyStopping counter: 4 out of 5
Updating learning rate to 0.0021474836480000013
	iters: 100, epoch: 14 | loss: 0.2482887
	speed: 0.0929s/iter; left time: 197.6492s
Max Memory (MB): 112.3515625
Epoch: 14 cost time: 4.4500627517700195
Epoch: 14, Steps: 131 | Train Loss: 0.2632462 Vali Loss: 0.3983932 Test Loss: 0.3113716
EarlyStopping counter: 5 out of 5
Early stopping
Final Max Memory (MB): 112.3515625
>>>>>>>testing : ETTm1_720_96_SparseTSF_ETTm1_ftM_sl720_pl96_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.3114490807056427, mae:0.3538302481174469, rse:0.5299410820007324
