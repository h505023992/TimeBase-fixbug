Args in experiment:
Namespace(is_training=1, model_id='Electricity_336_96', model='SparseTSF', data='custom', root_path='./dataset/', data_path='electricity.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, period_len=24, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=321, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=128, patience=5, learning_rate=0.02, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=2, use_multi_gpu=0, devices='0,1', test_flop=False)
Use GPU: cuda:2
>>>>>>>start training : Electricity_336_96_SparseTSF_custom_ftM_sl336_pl96_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17981
val 2537
test 5165
	iters: 100, epoch: 1 | loss: 0.2707638
	speed: 0.1647s/iter; left time: 675.6079s
Epoch: 1 cost time: 21.009352207183838
Epoch: 1, Steps: 140 | Train Loss: 0.4523375 Vali Loss: 0.2087863 Test Loss: 0.2326525
Validation loss decreased (inf --> 0.208786).  Saving model ...
Updating learning rate to 0.02
	iters: 100, epoch: 2 | loss: 0.1523158
	speed: 0.2976s/iter; left time: 1178.7110s
Epoch: 2 cost time: 17.59832239151001
Epoch: 2, Steps: 140 | Train Loss: 0.1806277 Vali Loss: 0.1291392 Test Loss: 0.1523929
Validation loss decreased (0.208786 --> 0.129139).  Saving model ...
Updating learning rate to 0.02
	iters: 100, epoch: 3 | loss: 0.1497719
	speed: 0.3042s/iter; left time: 1162.4266s
Epoch: 3 cost time: 17.31047821044922
Epoch: 3, Steps: 140 | Train Loss: 0.1494391 Vali Loss: 0.1255001 Test Loss: 0.1478161
Validation loss decreased (0.129139 --> 0.125500).  Saving model ...
Updating learning rate to 0.02
	iters: 100, epoch: 4 | loss: 0.1627917
	speed: 0.3073s/iter; left time: 1131.0088s
Epoch: 4 cost time: 17.79134511947632
Epoch: 4, Steps: 140 | Train Loss: 0.1477735 Vali Loss: 0.1257226 Test Loss: 0.1475036
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.016
	iters: 100, epoch: 5 | loss: 0.1503467
	speed: 0.3110s/iter; left time: 1101.1117s
Epoch: 5 cost time: 17.879730224609375
Epoch: 5, Steps: 140 | Train Loss: 0.1476881 Vali Loss: 0.1255069 Test Loss: 0.1487026
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.012800000000000002
	iters: 100, epoch: 6 | loss: 0.1464403
	speed: 0.3091s/iter; left time: 1051.2447s
Epoch: 6 cost time: 17.430299758911133
Epoch: 6, Steps: 140 | Train Loss: 0.1474294 Vali Loss: 0.1250268 Test Loss: 0.1475102
Validation loss decreased (0.125500 --> 0.125027).  Saving model ...
Updating learning rate to 0.010240000000000003
	iters: 100, epoch: 7 | loss: 0.1371765
	speed: 0.3070s/iter; left time: 1001.1509s
Epoch: 7 cost time: 17.47783899307251
Epoch: 7, Steps: 140 | Train Loss: 0.1474415 Vali Loss: 0.1248692 Test Loss: 0.1476659
Validation loss decreased (0.125027 --> 0.124869).  Saving model ...
Updating learning rate to 0.008192000000000001
	iters: 100, epoch: 8 | loss: 0.1559600
	speed: 0.3126s/iter; left time: 975.7748s
Epoch: 8 cost time: 18.231615781784058
Epoch: 8, Steps: 140 | Train Loss: 0.1475494 Vali Loss: 0.1246583 Test Loss: 0.1472134
Validation loss decreased (0.124869 --> 0.124658).  Saving model ...
Updating learning rate to 0.0065536000000000014
	iters: 100, epoch: 9 | loss: 0.1491256
	speed: 0.3148s/iter; left time: 938.4766s
Epoch: 9 cost time: 17.831405639648438
Epoch: 9, Steps: 140 | Train Loss: 0.1474762 Vali Loss: 0.1246721 Test Loss: 0.1474492
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005242880000000002
	iters: 100, epoch: 10 | loss: 0.1637725
	speed: 0.3162s/iter; left time: 898.2390s
Epoch: 10 cost time: 18.028810501098633
Epoch: 10, Steps: 140 | Train Loss: 0.1474788 Vali Loss: 0.1250115 Test Loss: 0.1472023
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.004194304000000002
	iters: 100, epoch: 11 | loss: 0.1646715
	speed: 0.3131s/iter; left time: 845.7185s
Epoch: 11 cost time: 17.50229787826538
Epoch: 11, Steps: 140 | Train Loss: 0.1474144 Vali Loss: 0.1249813 Test Loss: 0.1471921
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.003355443200000002
	iters: 100, epoch: 12 | loss: 0.1535054
	speed: 0.3031s/iter; left time: 776.2249s
Epoch: 12 cost time: 17.2532000541687
Epoch: 12, Steps: 140 | Train Loss: 0.1473852 Vali Loss: 0.1250466 Test Loss: 0.1473051
EarlyStopping counter: 4 out of 5
Updating learning rate to 0.002684354560000001
	iters: 100, epoch: 13 | loss: 0.1414321
	speed: 0.3014s/iter; left time: 729.6015s
Epoch: 13 cost time: 17.297646045684814
Epoch: 13, Steps: 140 | Train Loss: 0.1473703 Vali Loss: 0.1249997 Test Loss: 0.1475482
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : Electricity_336_96_SparseTSF_custom_ftM_sl336_pl96_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
mse:0.14671605825424194, mae:0.24099066853523254, rse:0.38069984316825867
