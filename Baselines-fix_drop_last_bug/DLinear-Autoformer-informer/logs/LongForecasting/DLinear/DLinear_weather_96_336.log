Args in experiment:
Namespace(is_training=1, train_only=False, model_id='DLinear_weather_96_336', model='DLinear', data='custom', root_path='./dataset/', data_path='weather.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=336, individual=False, embed_type=0, enc_in=21, dec_in=21, c_out=21, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DLinear_weather_96_336_DLinear_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.9052304
	speed: 0.0415s/iter; left time: 1415.8258s
	iters: 200, epoch: 1 | loss: 0.7019181
	speed: 0.0176s/iter; left time: 597.1164s
	iters: 300, epoch: 1 | loss: 0.6314827
	speed: 0.0174s/iter; left time: 589.1598s
	iters: 400, epoch: 1 | loss: 0.5910876
	speed: 0.0178s/iter; left time: 602.8157s
	iters: 500, epoch: 1 | loss: 0.7274144
	speed: 0.0180s/iter; left time: 606.0702s
	iters: 600, epoch: 1 | loss: 1.0582720
	speed: 0.0180s/iter; left time: 603.9887s
	iters: 700, epoch: 1 | loss: 0.5492199
	speed: 0.0180s/iter; left time: 604.0946s
	iters: 800, epoch: 1 | loss: 0.7644548
	speed: 0.0186s/iter; left time: 622.5285s
	iters: 900, epoch: 1 | loss: 0.5207714
	speed: 0.0169s/iter; left time: 561.8396s
	iters: 1000, epoch: 1 | loss: 0.7157406
	speed: 0.0173s/iter; left time: 574.2005s
	iters: 1100, epoch: 1 | loss: 0.4843345
	speed: 0.0173s/iter; left time: 573.6956s
Epoch: 1 cost time: 22.567832469940186
Epoch: 1, Steps: 1140 | Train Loss: 0.7101044 Vali Loss: 0.6067886 Test Loss: 0.2907229
Validation loss decreased (inf --> 0.606789).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5933455
	speed: 0.1456s/iter; left time: 4798.1470s
	iters: 200, epoch: 2 | loss: 0.5197730
	speed: 0.0174s/iter; left time: 572.0451s
	iters: 300, epoch: 2 | loss: 0.5138915
	speed: 0.0179s/iter; left time: 586.9968s
	iters: 400, epoch: 2 | loss: 0.5573045
	speed: 0.0172s/iter; left time: 561.3983s
	iters: 500, epoch: 2 | loss: 1.0051243
	speed: 0.0181s/iter; left time: 590.4460s
	iters: 600, epoch: 2 | loss: 0.6342430
	speed: 0.0168s/iter; left time: 544.9324s
	iters: 700, epoch: 2 | loss: 0.6039523
	speed: 0.0186s/iter; left time: 601.3956s
	iters: 800, epoch: 2 | loss: 0.5873457
	speed: 0.0177s/iter; left time: 570.6624s
	iters: 900, epoch: 2 | loss: 0.5638444
	speed: 0.0182s/iter; left time: 584.0293s
	iters: 1000, epoch: 2 | loss: 0.4922596
	speed: 0.0193s/iter; left time: 618.1117s
	iters: 1100, epoch: 2 | loss: 0.8281249
	speed: 0.0191s/iter; left time: 609.7660s
Epoch: 2 cost time: 21.236891269683838
Epoch: 2, Steps: 1140 | Train Loss: 0.6279298 Vali Loss: 0.5916007 Test Loss: 0.2873732
Validation loss decreased (0.606789 --> 0.591601).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7445970
	speed: 0.1667s/iter; left time: 5305.2405s
	iters: 200, epoch: 3 | loss: 0.7334965
	speed: 0.0191s/iter; left time: 606.0672s
	iters: 300, epoch: 3 | loss: 0.5969601
	speed: 0.0174s/iter; left time: 550.2751s
	iters: 400, epoch: 3 | loss: 0.6101250
	speed: 0.0185s/iter; left time: 584.2930s
	iters: 500, epoch: 3 | loss: 0.4494165
	speed: 0.0173s/iter; left time: 544.9449s
	iters: 600, epoch: 3 | loss: 0.5918921
	speed: 0.0162s/iter; left time: 508.1859s
	iters: 700, epoch: 3 | loss: 0.4725836
	speed: 0.0158s/iter; left time: 493.4175s
	iters: 800, epoch: 3 | loss: 0.4973212
	speed: 0.0167s/iter; left time: 519.0562s
	iters: 900, epoch: 3 | loss: 0.4699306
	speed: 0.0149s/iter; left time: 463.3971s
	iters: 1000, epoch: 3 | loss: 0.4725390
	speed: 0.0158s/iter; left time: 487.5221s
	iters: 1100, epoch: 3 | loss: 0.4890033
	speed: 0.0157s/iter; left time: 483.2638s
Epoch: 3 cost time: 20.033260107040405
Epoch: 3, Steps: 1140 | Train Loss: 0.6187829 Vali Loss: 0.5873901 Test Loss: 0.2848826
Validation loss decreased (0.591601 --> 0.587390).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4614714
	speed: 0.1667s/iter; left time: 5115.6440s
	iters: 200, epoch: 4 | loss: 0.8280554
	speed: 0.0181s/iter; left time: 552.9014s
	iters: 300, epoch: 4 | loss: 0.7522146
	speed: 0.0196s/iter; left time: 597.5034s
	iters: 400, epoch: 4 | loss: 0.4480309
	speed: 0.0192s/iter; left time: 583.7191s
	iters: 500, epoch: 4 | loss: 0.7841649
	speed: 0.0193s/iter; left time: 583.7251s
	iters: 600, epoch: 4 | loss: 0.5269460
	speed: 0.0198s/iter; left time: 598.5288s
	iters: 700, epoch: 4 | loss: 0.8294259
	speed: 0.0191s/iter; left time: 575.9408s
	iters: 800, epoch: 4 | loss: 0.5131438
	speed: 0.0186s/iter; left time: 557.6329s
	iters: 900, epoch: 4 | loss: 0.8072527
	speed: 0.0198s/iter; left time: 591.6969s
	iters: 1000, epoch: 4 | loss: 0.5926425
	speed: 0.0218s/iter; left time: 650.0852s
	iters: 1100, epoch: 4 | loss: 0.4453070
	speed: 0.0243s/iter; left time: 722.5542s
Epoch: 4 cost time: 23.267282962799072
Epoch: 4, Steps: 1140 | Train Loss: 0.6157073 Vali Loss: 0.5879700 Test Loss: 0.2844003
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.7341050
	speed: 0.1291s/iter; left time: 3812.5591s
	iters: 200, epoch: 5 | loss: 0.6059691
	speed: 0.0152s/iter; left time: 446.8838s
	iters: 300, epoch: 5 | loss: 0.7682382
	speed: 0.0158s/iter; left time: 462.8369s
	iters: 400, epoch: 5 | loss: 0.5097687
	speed: 0.0156s/iter; left time: 456.2398s
	iters: 500, epoch: 5 | loss: 0.5230041
	speed: 0.0168s/iter; left time: 488.5169s
	iters: 600, epoch: 5 | loss: 0.4863035
	speed: 0.0154s/iter; left time: 447.4547s
	iters: 700, epoch: 5 | loss: 0.4312421
	speed: 0.0150s/iter; left time: 435.3024s
	iters: 800, epoch: 5 | loss: 0.4986348
	speed: 0.0155s/iter; left time: 447.3048s
	iters: 900, epoch: 5 | loss: 0.7924030
	speed: 0.0153s/iter; left time: 440.8180s
	iters: 1000, epoch: 5 | loss: 0.5281017
	speed: 0.0140s/iter; left time: 400.8039s
	iters: 1100, epoch: 5 | loss: 0.4732451
	speed: 0.0159s/iter; left time: 454.8708s
Epoch: 5 cost time: 18.233879804611206
Epoch: 5, Steps: 1140 | Train Loss: 0.6151542 Vali Loss: 0.5887482 Test Loss: 0.2850012
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4869897
	speed: 0.1265s/iter; left time: 3593.5977s
	iters: 200, epoch: 6 | loss: 0.4197196
	speed: 0.0148s/iter; left time: 417.4615s
	iters: 300, epoch: 6 | loss: 0.5537671
	speed: 0.0151s/iter; left time: 424.6343s
	iters: 400, epoch: 6 | loss: 0.8877591
	speed: 0.0165s/iter; left time: 463.9494s
	iters: 500, epoch: 6 | loss: 0.5083341
	speed: 0.0159s/iter; left time: 444.0129s
	iters: 600, epoch: 6 | loss: 0.5871355
	speed: 0.0161s/iter; left time: 448.2015s
	iters: 700, epoch: 6 | loss: 0.8177284
	speed: 0.0165s/iter; left time: 458.4951s
	iters: 800, epoch: 6 | loss: 0.8903764
	speed: 0.0150s/iter; left time: 416.6389s
	iters: 900, epoch: 6 | loss: 0.7891685
	speed: 0.0150s/iter; left time: 412.8186s
	iters: 1000, epoch: 6 | loss: 0.8446202
	speed: 0.0151s/iter; left time: 416.4011s
	iters: 1100, epoch: 6 | loss: 0.5025567
	speed: 0.0157s/iter; left time: 429.7505s
Epoch: 6 cost time: 18.449752807617188
Epoch: 6, Steps: 1140 | Train Loss: 0.6138668 Vali Loss: 0.5868953 Test Loss: 0.2847485
Validation loss decreased (0.587390 --> 0.586895).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.5620722
	speed: 0.1361s/iter; left time: 3710.1731s
	iters: 200, epoch: 7 | loss: 0.4612473
	speed: 0.0164s/iter; left time: 446.5252s
	iters: 300, epoch: 7 | loss: 0.8792582
	speed: 0.0165s/iter; left time: 445.5837s
	iters: 400, epoch: 7 | loss: 0.6013147
	speed: 0.0163s/iter; left time: 439.2486s
	iters: 500, epoch: 7 | loss: 0.5834281
	speed: 0.0155s/iter; left time: 415.2138s
	iters: 600, epoch: 7 | loss: 0.6698928
	speed: 0.0156s/iter; left time: 416.6267s
	iters: 700, epoch: 7 | loss: 0.6127267
	speed: 0.0160s/iter; left time: 427.1365s
	iters: 800, epoch: 7 | loss: 0.6878936
	speed: 0.0150s/iter; left time: 399.1720s
	iters: 900, epoch: 7 | loss: 0.6066826
	speed: 0.0170s/iter; left time: 450.2723s
	iters: 1000, epoch: 7 | loss: 0.4640865
	speed: 0.0161s/iter; left time: 424.7964s
	iters: 1100, epoch: 7 | loss: 0.4420615
	speed: 0.0150s/iter; left time: 393.5639s
Epoch: 7 cost time: 18.993969202041626
Epoch: 7, Steps: 1140 | Train Loss: 0.6134264 Vali Loss: 0.5861629 Test Loss: 0.2845566
Validation loss decreased (0.586895 --> 0.586163).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.8066396
	speed: 0.1612s/iter; left time: 4211.6378s
	iters: 200, epoch: 8 | loss: 0.4753824
	speed: 0.0275s/iter; left time: 714.8180s
	iters: 300, epoch: 8 | loss: 0.5835689
	speed: 0.0292s/iter; left time: 756.0402s
	iters: 400, epoch: 8 | loss: 0.5563858
	speed: 0.0335s/iter; left time: 865.7541s
	iters: 500, epoch: 8 | loss: 0.4071754
	speed: 0.0325s/iter; left time: 836.8473s
	iters: 600, epoch: 8 | loss: 0.4431797
	speed: 0.0317s/iter; left time: 812.7737s
	iters: 700, epoch: 8 | loss: 0.8139272
	speed: 0.0326s/iter; left time: 833.0968s
	iters: 800, epoch: 8 | loss: 0.5625163
	speed: 0.0320s/iter; left time: 812.9121s
	iters: 900, epoch: 8 | loss: 0.6476269
	speed: 0.0335s/iter; left time: 849.3802s
	iters: 1000, epoch: 8 | loss: 0.7586000
	speed: 0.0294s/iter; left time: 740.4221s
	iters: 1100, epoch: 8 | loss: 0.5130383
	speed: 0.0317s/iter; left time: 796.1912s
Epoch: 8 cost time: 36.060550689697266
Epoch: 8, Steps: 1140 | Train Loss: 0.6134232 Vali Loss: 0.5874506 Test Loss: 0.2845753
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.5927528
	speed: 0.3225s/iter; left time: 8057.4723s
	iters: 200, epoch: 9 | loss: 0.6036816
	speed: 0.0277s/iter; left time: 687.9865s
	iters: 300, epoch: 9 | loss: 0.4311509
	speed: 0.0269s/iter; left time: 666.0852s
	iters: 400, epoch: 9 | loss: 0.5130091
	speed: 0.0252s/iter; left time: 621.6546s
	iters: 500, epoch: 9 | loss: 0.4429009
	speed: 0.0230s/iter; left time: 565.9550s
	iters: 600, epoch: 9 | loss: 0.7702147
	speed: 0.0178s/iter; left time: 435.5436s
	iters: 700, epoch: 9 | loss: 0.4912706
	speed: 0.0158s/iter; left time: 385.7953s
	iters: 800, epoch: 9 | loss: 0.9019898
	speed: 0.0161s/iter; left time: 390.6725s
	iters: 900, epoch: 9 | loss: 0.6041609
	speed: 0.0189s/iter; left time: 456.5845s
	iters: 1000, epoch: 9 | loss: 0.6128521
	speed: 0.0152s/iter; left time: 366.2944s
	iters: 1100, epoch: 9 | loss: 0.4840715
	speed: 0.0154s/iter; left time: 368.6502s
Epoch: 9 cost time: 24.704911947250366
Epoch: 9, Steps: 1140 | Train Loss: 0.6132906 Vali Loss: 0.5874839 Test Loss: 0.2845934
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.5325177
	speed: 0.1426s/iter; left time: 3400.7026s
	iters: 200, epoch: 10 | loss: 0.7641681
	speed: 0.0163s/iter; left time: 387.2650s
	iters: 300, epoch: 10 | loss: 0.4523120
	speed: 0.0173s/iter; left time: 408.8407s
	iters: 400, epoch: 10 | loss: 0.5558771
	speed: 0.0175s/iter; left time: 412.1224s
	iters: 500, epoch: 10 | loss: 0.7659968
	speed: 0.0189s/iter; left time: 443.9457s
	iters: 600, epoch: 10 | loss: 0.5013150
	speed: 0.0173s/iter; left time: 402.9313s
	iters: 700, epoch: 10 | loss: 0.6116891
	speed: 0.0185s/iter; left time: 430.0828s
	iters: 800, epoch: 10 | loss: 0.5049119
	speed: 0.0173s/iter; left time: 400.7840s
	iters: 900, epoch: 10 | loss: 1.2908906
	speed: 0.0182s/iter; left time: 420.0854s
	iters: 1000, epoch: 10 | loss: 0.8357568
	speed: 0.0182s/iter; left time: 417.7431s
	iters: 1100, epoch: 10 | loss: 0.7454618
	speed: 0.0195s/iter; left time: 444.6588s
Epoch: 10 cost time: 20.90621829032898
Epoch: 10, Steps: 1140 | Train Loss: 0.6131470 Vali Loss: 0.5857084 Test Loss: 0.2845909
Validation loss decreased (0.586163 --> 0.585708).  Saving model ...
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.4391673
	speed: 0.1789s/iter; left time: 4060.5856s
	iters: 200, epoch: 11 | loss: 0.4779941
	speed: 0.0186s/iter; left time: 419.9304s
	iters: 300, epoch: 11 | loss: 0.4380428
	speed: 0.0183s/iter; left time: 411.3922s
	iters: 400, epoch: 11 | loss: 0.6311464
	speed: 0.0180s/iter; left time: 403.7034s
	iters: 500, epoch: 11 | loss: 0.6665279
	speed: 0.0193s/iter; left time: 429.5086s
	iters: 600, epoch: 11 | loss: 0.5195958
	speed: 0.0183s/iter; left time: 406.0866s
	iters: 700, epoch: 11 | loss: 0.6611809
	speed: 0.0181s/iter; left time: 400.7994s
	iters: 800, epoch: 11 | loss: 0.9713739
	speed: 0.0208s/iter; left time: 457.4144s
	iters: 900, epoch: 11 | loss: 0.9617705
	speed: 0.0214s/iter; left time: 468.0666s
	iters: 1000, epoch: 11 | loss: 0.5286971
	speed: 0.0235s/iter; left time: 513.1641s
	iters: 1100, epoch: 11 | loss: 0.7381657
	speed: 0.0236s/iter; left time: 511.7730s
Epoch: 11 cost time: 23.59907817840576
Epoch: 11, Steps: 1140 | Train Loss: 0.6138154 Vali Loss: 0.5852250 Test Loss: 0.2845911
Validation loss decreased (0.585708 --> 0.585225).  Saving model ...
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.4582188
	speed: 0.2457s/iter; left time: 5296.7257s
	iters: 200, epoch: 12 | loss: 0.7355651
	speed: 0.0255s/iter; left time: 548.1497s
	iters: 300, epoch: 12 | loss: 0.4428387
	speed: 0.0305s/iter; left time: 652.4009s
	iters: 400, epoch: 12 | loss: 0.4831448
	speed: 0.0204s/iter; left time: 433.2580s
	iters: 500, epoch: 12 | loss: 0.4777173
	speed: 0.0179s/iter; left time: 378.9333s
	iters: 600, epoch: 12 | loss: 0.7832661
	speed: 0.0174s/iter; left time: 366.1736s
	iters: 700, epoch: 12 | loss: 0.7616598
	speed: 0.0182s/iter; left time: 381.2075s
	iters: 800, epoch: 12 | loss: 0.5791317
	speed: 0.0182s/iter; left time: 379.0369s
	iters: 900, epoch: 12 | loss: 0.4188877
	speed: 0.0180s/iter; left time: 373.8003s
	iters: 1000, epoch: 12 | loss: 0.7678315
	speed: 0.0175s/iter; left time: 360.6598s
	iters: 1100, epoch: 12 | loss: 0.7504160
	speed: 0.0184s/iter; left time: 378.9255s
Epoch: 12 cost time: 24.18252158164978
Epoch: 12, Steps: 1140 | Train Loss: 0.6135636 Vali Loss: 0.5887133 Test Loss: 0.2845900
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 1.0157877
	speed: 0.1597s/iter; left time: 3260.5862s
	iters: 200, epoch: 13 | loss: 0.5613719
	speed: 0.0163s/iter; left time: 331.1531s
	iters: 300, epoch: 13 | loss: 0.6855600
	speed: 0.0158s/iter; left time: 319.9319s
	iters: 400, epoch: 13 | loss: 0.6608476
	speed: 0.0170s/iter; left time: 342.0580s
	iters: 500, epoch: 13 | loss: 0.7514058
	speed: 0.0164s/iter; left time: 328.5275s
	iters: 600, epoch: 13 | loss: 0.5214616
	speed: 0.0162s/iter; left time: 321.8305s
	iters: 700, epoch: 13 | loss: 0.4570737
	speed: 0.0168s/iter; left time: 333.1495s
	iters: 800, epoch: 13 | loss: 0.5539290
	speed: 0.0159s/iter; left time: 314.3682s
	iters: 900, epoch: 13 | loss: 0.7721657
	speed: 0.0158s/iter; left time: 309.5625s
	iters: 1000, epoch: 13 | loss: 0.9711961
	speed: 0.0158s/iter; left time: 309.2392s
	iters: 1100, epoch: 13 | loss: 0.5315267
	speed: 0.0153s/iter; left time: 297.4298s
Epoch: 13 cost time: 19.250617265701294
Epoch: 13, Steps: 1140 | Train Loss: 0.6131644 Vali Loss: 0.5859182 Test Loss: 0.2845905
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.5383598
	speed: 0.1433s/iter; left time: 2762.3162s
	iters: 200, epoch: 14 | loss: 0.7642298
	speed: 0.0169s/iter; left time: 323.7701s
	iters: 300, epoch: 14 | loss: 0.6823533
	speed: 0.0152s/iter; left time: 289.7172s
	iters: 400, epoch: 14 | loss: 0.4661460
	speed: 0.0156s/iter; left time: 296.2564s
	iters: 500, epoch: 14 | loss: 0.7329668
	speed: 0.0157s/iter; left time: 295.9655s
	iters: 600, epoch: 14 | loss: 0.5444701
	speed: 0.0158s/iter; left time: 297.4818s
	iters: 700, epoch: 14 | loss: 0.4910471
	speed: 0.0180s/iter; left time: 335.7842s
	iters: 800, epoch: 14 | loss: 0.5528011
	speed: 0.0223s/iter; left time: 415.0489s
	iters: 900, epoch: 14 | loss: 0.4839312
	speed: 0.0224s/iter; left time: 414.2285s
	iters: 1000, epoch: 14 | loss: 0.5254977
	speed: 0.0212s/iter; left time: 389.3538s
	iters: 1100, epoch: 14 | loss: 0.4505090
	speed: 0.0201s/iter; left time: 367.3366s
Epoch: 14 cost time: 21.63697648048401
Epoch: 14, Steps: 1140 | Train Loss: 0.6130371 Vali Loss: 0.5872681 Test Loss: 0.2845906
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : DLinear_weather_96_336_DLinear_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
mse:0.28463712334632874, mae:0.33350270986557007
