Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=128, d_layers=1, d_model=16, data='ETTh2', data_path='ETTh2.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.3, e_layers=3, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.3, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='type3', model='PatchTST', model_id='336_336', moving_avg=25, n_heads=4, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=100, pct_start=0.3, pred_len=336, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : 336_336_PatchTST_ETTh2_ftM_sl336_ll48_pl336_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7969
val 2545
test 2545
Epoch: 1 cost time: 13.875761032104492
Epoch: 1, Steps: 62 | Train Loss: 0.8135327 Vali Loss: 0.5028641 Test Loss: 0.4313775
Validation loss decreased (inf --> 0.502864).  Saving model ...
Updating learning rate to 0.0001
Epoch: 2 cost time: 12.161554336547852
Epoch: 2, Steps: 62 | Train Loss: 0.7464899 Vali Loss: 0.4145908 Test Loss: 0.3978500
Validation loss decreased (0.502864 --> 0.414591).  Saving model ...
Updating learning rate to 0.0001
Epoch: 3 cost time: 12.521214485168457
Epoch: 3, Steps: 62 | Train Loss: 0.6830319 Vali Loss: 0.3928555 Test Loss: 0.3855972
Validation loss decreased (0.414591 --> 0.392856).  Saving model ...
Updating learning rate to 0.0001
Epoch: 4 cost time: 11.829681396484375
Epoch: 4, Steps: 62 | Train Loss: 0.6565816 Vali Loss: 0.3823568 Test Loss: 0.3771264
Validation loss decreased (0.392856 --> 0.382357).  Saving model ...
Updating learning rate to 9e-05
Epoch: 5 cost time: 11.948436975479126
Epoch: 5, Steps: 62 | Train Loss: 0.6428554 Vali Loss: 0.3761419 Test Loss: 0.3743799
Validation loss decreased (0.382357 --> 0.376142).  Saving model ...
Updating learning rate to 8.1e-05
Epoch: 6 cost time: 11.553390741348267
Epoch: 6, Steps: 62 | Train Loss: 0.6313644 Vali Loss: 0.3696502 Test Loss: 0.3725690
Validation loss decreased (0.376142 --> 0.369650).  Saving model ...
Updating learning rate to 7.290000000000001e-05
Epoch: 7 cost time: 11.877818822860718
Epoch: 7, Steps: 62 | Train Loss: 0.6273269 Vali Loss: 0.3693032 Test Loss: 0.3709511
Validation loss decreased (0.369650 --> 0.369303).  Saving model ...
Updating learning rate to 6.561e-05
Epoch: 8 cost time: 12.254064321517944
Epoch: 8, Steps: 62 | Train Loss: 0.6235413 Vali Loss: 0.3670632 Test Loss: 0.3679307
Validation loss decreased (0.369303 --> 0.367063).  Saving model ...
Updating learning rate to 5.904900000000001e-05
Epoch: 9 cost time: 13.505949020385742
Epoch: 9, Steps: 62 | Train Loss: 0.6177549 Vali Loss: 0.3677740 Test Loss: 0.3684749
EarlyStopping counter: 1 out of 100
Updating learning rate to 5.3144100000000005e-05
Epoch: 10 cost time: 13.603029251098633
Epoch: 10, Steps: 62 | Train Loss: 0.6136851 Vali Loss: 0.3662764 Test Loss: 0.3675296
Validation loss decreased (0.367063 --> 0.366276).  Saving model ...
Updating learning rate to 4.782969000000001e-05
Epoch: 11 cost time: 12.96134352684021
Epoch: 11, Steps: 62 | Train Loss: 0.6112935 Vali Loss: 0.3673327 Test Loss: 0.3672717
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
Epoch: 12 cost time: 14.093916177749634
Epoch: 12, Steps: 62 | Train Loss: 0.6086727 Vali Loss: 0.3680777 Test Loss: 0.3662178
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.874204890000001e-05
Epoch: 13 cost time: 14.976684808731079
Epoch: 13, Steps: 62 | Train Loss: 0.6055896 Vali Loss: 0.3656331 Test Loss: 0.3670081
Validation loss decreased (0.366276 --> 0.365633).  Saving model ...
Updating learning rate to 3.486784401000001e-05
Epoch: 14 cost time: 13.56645131111145
Epoch: 14, Steps: 62 | Train Loss: 0.6030597 Vali Loss: 0.3662585 Test Loss: 0.3671291
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.138105960900001e-05
Epoch: 15 cost time: 13.744720458984375
Epoch: 15, Steps: 62 | Train Loss: 0.6003101 Vali Loss: 0.3687111 Test Loss: 0.3675832
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.824295364810001e-05
Epoch: 16 cost time: 12.553510665893555
Epoch: 16, Steps: 62 | Train Loss: 0.5989826 Vali Loss: 0.3690414 Test Loss: 0.3677012
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.541865828329001e-05
Epoch: 17 cost time: 13.407989263534546
Epoch: 17, Steps: 62 | Train Loss: 0.5988583 Vali Loss: 0.3705517 Test Loss: 0.3677559
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.287679245496101e-05
Epoch: 18 cost time: 14.921555280685425
Epoch: 18, Steps: 62 | Train Loss: 0.5959453 Vali Loss: 0.3677808 Test Loss: 0.3689063
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.0589113209464907e-05
Epoch: 19 cost time: 13.441596508026123
Epoch: 19, Steps: 62 | Train Loss: 0.5958546 Vali Loss: 0.3683391 Test Loss: 0.3687348
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.8530201888518416e-05
Epoch: 20 cost time: 12.496930360794067
Epoch: 20, Steps: 62 | Train Loss: 0.5947333 Vali Loss: 0.3665836 Test Loss: 0.3691191
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.6677181699666577e-05
Epoch: 21 cost time: 12.42829418182373
Epoch: 21, Steps: 62 | Train Loss: 0.5924327 Vali Loss: 0.3683372 Test Loss: 0.3693492
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.5009463529699919e-05
Epoch: 22 cost time: 10.882298469543457
Epoch: 22, Steps: 62 | Train Loss: 0.5927720 Vali Loss: 0.3649007 Test Loss: 0.3694221
Validation loss decreased (0.365633 --> 0.364901).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
Epoch: 23 cost time: 11.340697765350342
Epoch: 23, Steps: 62 | Train Loss: 0.5934376 Vali Loss: 0.3644561 Test Loss: 0.3699520
Validation loss decreased (0.364901 --> 0.364456).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
Epoch: 24 cost time: 12.071601867675781
Epoch: 24, Steps: 62 | Train Loss: 0.5928092 Vali Loss: 0.3670526 Test Loss: 0.3700694
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0941898913151242e-05
Epoch: 25 cost time: 13.627086400985718
Epoch: 25, Steps: 62 | Train Loss: 0.5902357 Vali Loss: 0.3666069 Test Loss: 0.3701465
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.847709021836118e-06
Epoch: 26 cost time: 12.923014163970947
Epoch: 26, Steps: 62 | Train Loss: 0.5915471 Vali Loss: 0.3659095 Test Loss: 0.3705339
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.862938119652508e-06
Epoch: 27 cost time: 13.042672872543335
Epoch: 27, Steps: 62 | Train Loss: 0.5907599 Vali Loss: 0.3661277 Test Loss: 0.3706146
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.976644307687255e-06
Epoch: 28 cost time: 12.99061107635498
Epoch: 28, Steps: 62 | Train Loss: 0.5924049 Vali Loss: 0.3662914 Test Loss: 0.3708071
EarlyStopping counter: 5 out of 100
Updating learning rate to 7.178979876918531e-06
Epoch: 29 cost time: 12.05160403251648
Epoch: 29, Steps: 62 | Train Loss: 0.5906800 Vali Loss: 0.3662836 Test Loss: 0.3709057
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.4610818892266776e-06
Epoch: 30 cost time: 13.114030361175537
Epoch: 30, Steps: 62 | Train Loss: 0.5899121 Vali Loss: 0.3654875 Test Loss: 0.3709882
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.8149737003040096e-06
Epoch: 31 cost time: 13.109965085983276
Epoch: 31, Steps: 62 | Train Loss: 0.5900700 Vali Loss: 0.3644004 Test Loss: 0.3711557
Validation loss decreased (0.364456 --> 0.364400).  Saving model ...
Updating learning rate to 5.23347633027361e-06
Epoch: 32 cost time: 13.225676536560059
Epoch: 32, Steps: 62 | Train Loss: 0.5894697 Vali Loss: 0.3647398 Test Loss: 0.3709870
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
Epoch: 33 cost time: 13.097732782363892
Epoch: 33, Steps: 62 | Train Loss: 0.5889479 Vali Loss: 0.3654073 Test Loss: 0.3714108
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
Epoch: 34 cost time: 13.6978280544281
Epoch: 34, Steps: 62 | Train Loss: 0.5895248 Vali Loss: 0.3632770 Test Loss: 0.3712252
Validation loss decreased (0.364400 --> 0.363277).  Saving model ...
Updating learning rate to 3.815204244769462e-06
Epoch: 35 cost time: 12.682311773300171
Epoch: 35, Steps: 62 | Train Loss: 0.5884714 Vali Loss: 0.3662106 Test Loss: 0.3715433
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.4336838202925152e-06
Epoch: 36 cost time: 12.944746255874634
Epoch: 36, Steps: 62 | Train Loss: 0.5882321 Vali Loss: 0.3656386 Test Loss: 0.3715035
EarlyStopping counter: 2 out of 100
Updating learning rate to 3.090315438263264e-06
Epoch: 37 cost time: 12.57918119430542
Epoch: 37, Steps: 62 | Train Loss: 0.5891669 Vali Loss: 0.3653409 Test Loss: 0.3717759
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.7812838944369375e-06
Epoch: 38 cost time: 13.380093812942505
Epoch: 38, Steps: 62 | Train Loss: 0.5884153 Vali Loss: 0.3657491 Test Loss: 0.3715760
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.503155504993244e-06
Epoch: 39 cost time: 13.461213827133179
Epoch: 39, Steps: 62 | Train Loss: 0.5882013 Vali Loss: 0.3670281 Test Loss: 0.3712402
EarlyStopping counter: 5 out of 100
Updating learning rate to 2.2528399544939195e-06
Epoch: 40 cost time: 13.918797016143799
Epoch: 40, Steps: 62 | Train Loss: 0.5882589 Vali Loss: 0.3666487 Test Loss: 0.3718147
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.0275559590445276e-06
Epoch: 41 cost time: 11.910061836242676
Epoch: 41, Steps: 62 | Train Loss: 0.5887066 Vali Loss: 0.3672547 Test Loss: 0.3719133
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.8248003631400751e-06
Epoch: 42 cost time: 13.503420352935791
Epoch: 42, Steps: 62 | Train Loss: 0.5879753 Vali Loss: 0.3667370 Test Loss: 0.3720237
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.6423203268260676e-06
Epoch: 43 cost time: 12.951268672943115
Epoch: 43, Steps: 62 | Train Loss: 0.5883460 Vali Loss: 0.3653286 Test Loss: 0.3719339
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.4780882941434609e-06
Epoch: 44 cost time: 14.681889772415161
Epoch: 44, Steps: 62 | Train Loss: 0.5891623 Vali Loss: 0.3654921 Test Loss: 0.3718703
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.3302794647291146e-06
Epoch: 45 cost time: 14.205045700073242
Epoch: 45, Steps: 62 | Train Loss: 0.5895417 Vali Loss: 0.3660039 Test Loss: 0.3721802
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.1972515182562034e-06
Epoch: 46 cost time: 14.09802794456482
Epoch: 46, Steps: 62 | Train Loss: 0.5890171 Vali Loss: 0.3634199 Test Loss: 0.3720349
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.077526366430583e-06
Epoch: 47 cost time: 14.486557245254517
Epoch: 47, Steps: 62 | Train Loss: 0.5886037 Vali Loss: 0.3626887 Test Loss: 0.3721030
Validation loss decreased (0.363277 --> 0.362689).  Saving model ...
Updating learning rate to 9.697737297875248e-07
Epoch: 48 cost time: 12.650158882141113
Epoch: 48, Steps: 62 | Train Loss: 0.5883385 Vali Loss: 0.3651434 Test Loss: 0.3717477
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.727963568087723e-07
Epoch: 49 cost time: 12.616252422332764
Epoch: 49, Steps: 62 | Train Loss: 0.5882833 Vali Loss: 0.3677237 Test Loss: 0.3717834
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.855167211278951e-07
Epoch: 50 cost time: 13.189080715179443
Epoch: 50, Steps: 62 | Train Loss: 0.5879195 Vali Loss: 0.3639570 Test Loss: 0.3716854
EarlyStopping counter: 3 out of 100
Updating learning rate to 7.069650490151056e-07
Epoch: 51 cost time: 13.073756456375122
Epoch: 51, Steps: 62 | Train Loss: 0.5862290 Vali Loss: 0.3659081 Test Loss: 0.3719724
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.36268544113595e-07
Epoch: 52 cost time: 13.617302656173706
Epoch: 52, Steps: 62 | Train Loss: 0.5885362 Vali Loss: 0.3649214 Test Loss: 0.3720149
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.726416897022355e-07
Epoch: 53 cost time: 13.791093349456787
Epoch: 53, Steps: 62 | Train Loss: 0.5874848 Vali Loss: 0.3643233 Test Loss: 0.3721555
EarlyStopping counter: 6 out of 100
Updating learning rate to 5.15377520732012e-07
Epoch: 54 cost time: 13.058846712112427
Epoch: 54, Steps: 62 | Train Loss: 0.5870787 Vali Loss: 0.3652112 Test Loss: 0.3719792
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.6383976865881085e-07
Epoch: 55 cost time: 13.144143104553223
Epoch: 55, Steps: 62 | Train Loss: 0.5881972 Vali Loss: 0.3666624 Test Loss: 0.3720227
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.174557917929298e-07
Epoch: 56 cost time: 13.171982765197754
Epoch: 56, Steps: 62 | Train Loss: 0.5875557 Vali Loss: 0.3651717 Test Loss: 0.3723250
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.7571021261363677e-07
Epoch: 57 cost time: 12.923770904541016
Epoch: 57, Steps: 62 | Train Loss: 0.5870438 Vali Loss: 0.3619111 Test Loss: 0.3719574
Validation loss decreased (0.362689 --> 0.361911).  Saving model ...
Updating learning rate to 3.381391913522731e-07
Epoch: 58 cost time: 13.797855854034424
Epoch: 58, Steps: 62 | Train Loss: 0.5875507 Vali Loss: 0.3634100 Test Loss: 0.3722245
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.043252722170458e-07
Epoch: 59 cost time: 12.803406715393066
Epoch: 59, Steps: 62 | Train Loss: 0.5886339 Vali Loss: 0.3657904 Test Loss: 0.3720480
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.7389274499534124e-07
Epoch: 60 cost time: 12.783563375473022
Epoch: 60, Steps: 62 | Train Loss: 0.5880453 Vali Loss: 0.3634175 Test Loss: 0.3719721
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.465034704958071e-07
Epoch: 61 cost time: 11.735846519470215
Epoch: 61, Steps: 62 | Train Loss: 0.5881757 Vali Loss: 0.3662392 Test Loss: 0.3719784
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.218531234462264e-07
Epoch: 62 cost time: 12.545250654220581
Epoch: 62, Steps: 62 | Train Loss: 0.5880619 Vali Loss: 0.3655263 Test Loss: 0.3723428
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.9966781110160376e-07
Epoch: 63 cost time: 13.504456758499146
Epoch: 63, Steps: 62 | Train Loss: 0.5869407 Vali Loss: 0.3632007 Test Loss: 0.3720759
EarlyStopping counter: 6 out of 100
Updating learning rate to 1.797010299914434e-07
Epoch: 64 cost time: 13.343076467514038
Epoch: 64, Steps: 62 | Train Loss: 0.5880431 Vali Loss: 0.3640368 Test Loss: 0.3719091
EarlyStopping counter: 7 out of 100
Updating learning rate to 1.6173092699229907e-07
Epoch: 65 cost time: 14.189555406570435
Epoch: 65, Steps: 62 | Train Loss: 0.5887940 Vali Loss: 0.3650600 Test Loss: 0.3720968
EarlyStopping counter: 8 out of 100
Updating learning rate to 1.4555783429306916e-07
Epoch: 66 cost time: 13.200503587722778
Epoch: 66, Steps: 62 | Train Loss: 0.5864463 Vali Loss: 0.3656839 Test Loss: 0.3720031
EarlyStopping counter: 9 out of 100
Updating learning rate to 1.3100205086376224e-07
Epoch: 67 cost time: 12.183794736862183
Epoch: 67, Steps: 62 | Train Loss: 0.5881907 Vali Loss: 0.3654473 Test Loss: 0.3722825
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.1790184577738603e-07
Epoch: 68 cost time: 12.984663963317871
Epoch: 68, Steps: 62 | Train Loss: 0.5885317 Vali Loss: 0.3650252 Test Loss: 0.3721840
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.0611166119964742e-07
Epoch: 69 cost time: 13.498384714126587
Epoch: 69, Steps: 62 | Train Loss: 0.5882876 Vali Loss: 0.3675657 Test Loss: 0.3720943
EarlyStopping counter: 12 out of 100
Updating learning rate to 9.550049507968268e-08
Epoch: 70 cost time: 12.625511407852173
Epoch: 70, Steps: 62 | Train Loss: 0.5879845 Vali Loss: 0.3655128 Test Loss: 0.3721493
EarlyStopping counter: 13 out of 100
Updating learning rate to 8.595044557171442e-08
Epoch: 71 cost time: 13.19754147529602
Epoch: 71, Steps: 62 | Train Loss: 0.5884625 Vali Loss: 0.3644238 Test Loss: 0.3722862
EarlyStopping counter: 14 out of 100
Updating learning rate to 7.735540101454298e-08
Epoch: 72 cost time: 13.973456144332886
Epoch: 72, Steps: 62 | Train Loss: 0.5889627 Vali Loss: 0.3651095 Test Loss: 0.3719915
EarlyStopping counter: 15 out of 100
Updating learning rate to 6.961986091308869e-08
Epoch: 73 cost time: 15.686176300048828
Epoch: 73, Steps: 62 | Train Loss: 0.5880264 Vali Loss: 0.3663042 Test Loss: 0.3718612
EarlyStopping counter: 16 out of 100
Updating learning rate to 6.265787482177981e-08
Epoch: 74 cost time: 16.59652018547058
Epoch: 74, Steps: 62 | Train Loss: 0.5883026 Vali Loss: 0.3636855 Test Loss: 0.3722793
EarlyStopping counter: 17 out of 100
Updating learning rate to 5.639208733960184e-08
Epoch: 75 cost time: 16.54606294631958
Epoch: 75, Steps: 62 | Train Loss: 0.5874169 Vali Loss: 0.3651873 Test Loss: 0.3718878
EarlyStopping counter: 18 out of 100
Updating learning rate to 5.075287860564165e-08
Epoch: 76 cost time: 15.160878419876099
Epoch: 76, Steps: 62 | Train Loss: 0.5884009 Vali Loss: 0.3645440 Test Loss: 0.3722976
EarlyStopping counter: 19 out of 100
Updating learning rate to 4.567759074507749e-08
Epoch: 77 cost time: 12.950736045837402
Epoch: 77, Steps: 62 | Train Loss: 0.5861321 Vali Loss: 0.3638475 Test Loss: 0.3720623
EarlyStopping counter: 20 out of 100
Updating learning rate to 4.1109831670569744e-08
Epoch: 78 cost time: 13.070197343826294
Epoch: 78, Steps: 62 | Train Loss: 0.5880547 Vali Loss: 0.3661390 Test Loss: 0.3721306
EarlyStopping counter: 21 out of 100
Updating learning rate to 3.6998848503512764e-08
Epoch: 79 cost time: 12.82810640335083
Epoch: 79, Steps: 62 | Train Loss: 0.5876415 Vali Loss: 0.3644485 Test Loss: 0.3722025
EarlyStopping counter: 22 out of 100
Updating learning rate to 3.3298963653161496e-08
Epoch: 80 cost time: 12.238330602645874
Epoch: 80, Steps: 62 | Train Loss: 0.5887695 Vali Loss: 0.3641412 Test Loss: 0.3721320
EarlyStopping counter: 23 out of 100
Updating learning rate to 2.996906728784534e-08
Epoch: 81 cost time: 13.305893182754517
Epoch: 81, Steps: 62 | Train Loss: 0.5878032 Vali Loss: 0.3651176 Test Loss: 0.3722352
EarlyStopping counter: 24 out of 100
Updating learning rate to 2.697216055906081e-08
Epoch: 82 cost time: 13.158206224441528
Epoch: 82, Steps: 62 | Train Loss: 0.5885826 Vali Loss: 0.3652814 Test Loss: 0.3722591
EarlyStopping counter: 25 out of 100
Updating learning rate to 2.427494450315473e-08
Epoch: 83 cost time: 11.921233892440796
Epoch: 83, Steps: 62 | Train Loss: 0.5870864 Vali Loss: 0.3658549 Test Loss: 0.3718938
EarlyStopping counter: 26 out of 100
Updating learning rate to 2.1847450052839257e-08
Epoch: 84 cost time: 11.38368558883667
Epoch: 84, Steps: 62 | Train Loss: 0.5889601 Vali Loss: 0.3644198 Test Loss: 0.3721704
EarlyStopping counter: 27 out of 100
Updating learning rate to 1.9662705047555332e-08
Epoch: 85 cost time: 10.640568494796753
Epoch: 85, Steps: 62 | Train Loss: 0.5884783 Vali Loss: 0.3648540 Test Loss: 0.3721409
EarlyStopping counter: 28 out of 100
Updating learning rate to 1.7696434542799797e-08
Epoch: 86 cost time: 13.188969850540161
Epoch: 86, Steps: 62 | Train Loss: 0.5881429 Vali Loss: 0.3641221 Test Loss: 0.3722498
EarlyStopping counter: 29 out of 100
Updating learning rate to 1.5926791088519817e-08
Epoch: 87 cost time: 13.87212061882019
Epoch: 87, Steps: 62 | Train Loss: 0.5884549 Vali Loss: 0.3652954 Test Loss: 0.3722600
EarlyStopping counter: 30 out of 100
Updating learning rate to 1.4334111979667836e-08
Epoch: 88 cost time: 12.42747950553894
Epoch: 88, Steps: 62 | Train Loss: 0.5890961 Vali Loss: 0.3660037 Test Loss: 0.3722618
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.2900700781701054e-08
Epoch: 89 cost time: 12.092650413513184
Epoch: 89, Steps: 62 | Train Loss: 0.5885603 Vali Loss: 0.3615473 Test Loss: 0.3723090
Validation loss decreased (0.361911 --> 0.361547).  Saving model ...
Updating learning rate to 1.161063070353095e-08
Epoch: 90 cost time: 13.823226928710938
Epoch: 90, Steps: 62 | Train Loss: 0.5872244 Vali Loss: 0.3634784 Test Loss: 0.3722553
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.0449567633177854e-08
Epoch: 91 cost time: 13.900354146957397
Epoch: 91, Steps: 62 | Train Loss: 0.5887351 Vali Loss: 0.3661510 Test Loss: 0.3721356
EarlyStopping counter: 2 out of 100
Updating learning rate to 9.404610869860069e-09
Epoch: 92 cost time: 14.06679105758667
Epoch: 92, Steps: 62 | Train Loss: 0.5890565 Vali Loss: 0.3646219 Test Loss: 0.3720636
EarlyStopping counter: 3 out of 100
Updating learning rate to 8.464149782874063e-09
Epoch: 93 cost time: 16.33092951774597
Epoch: 93, Steps: 62 | Train Loss: 0.5885020 Vali Loss: 0.3641534 Test Loss: 0.3722052
EarlyStopping counter: 4 out of 100
Updating learning rate to 7.617734804586658e-09
Epoch: 94 cost time: 14.976700782775879
Epoch: 94, Steps: 62 | Train Loss: 0.5861334 Vali Loss: 0.3654148 Test Loss: 0.3721165
EarlyStopping counter: 5 out of 100
Updating learning rate to 6.855961324127991e-09
Epoch: 95 cost time: 14.079080581665039
Epoch: 95, Steps: 62 | Train Loss: 0.5860273 Vali Loss: 0.3653199 Test Loss: 0.3719864
EarlyStopping counter: 6 out of 100
Updating learning rate to 6.170365191715193e-09
Epoch: 96 cost time: 13.977563858032227
Epoch: 96, Steps: 62 | Train Loss: 0.5885977 Vali Loss: 0.3659072 Test Loss: 0.3720418
EarlyStopping counter: 7 out of 100
Updating learning rate to 5.5533286725436726e-09
Epoch: 97 cost time: 13.608581066131592
Epoch: 97, Steps: 62 | Train Loss: 0.5887899 Vali Loss: 0.3663682 Test Loss: 0.3720223
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.997995805289306e-09
Epoch: 98 cost time: 14.43659257888794
Epoch: 98, Steps: 62 | Train Loss: 0.5871116 Vali Loss: 0.3626402 Test Loss: 0.3721820
EarlyStopping counter: 9 out of 100
Updating learning rate to 4.498196224760375e-09
Epoch: 99 cost time: 15.053520917892456
Epoch: 99, Steps: 62 | Train Loss: 0.5886153 Vali Loss: 0.3669268 Test Loss: 0.3722136
EarlyStopping counter: 10 out of 100
Updating learning rate to 4.048376602284338e-09
Epoch: 100 cost time: 13.367425441741943
Epoch: 100, Steps: 62 | Train Loss: 0.5877351 Vali Loss: 0.3658807 Test Loss: 0.3722953
EarlyStopping counter: 11 out of 100
Updating learning rate to 3.643538942055904e-09
>>>>>>>testing : 336_336_PatchTST_ETTh2_ftM_sl336_ll48_pl336_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
mse:0.36767369508743286, mae:0.3997150659561157, rse:0.48480916023254395
