Args in experiment:
Namespace(is_training=1, train_only=False, model_id='traffic_720_96', model='DLinear', data='custom', root_path='./dataset/', data_path='traffic.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=96, individual=False, embed_type=0, enc_in=862, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=10, batch_size=16, patience=3, learning_rate=0.001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=7, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:7
>>>>>>>start training : traffic_720_96_DLinear_custom_ftM_sl720_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11465
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.3092998
	speed: 0.0606s/iter; left time: 427.8849s
	iters: 200, epoch: 1 | loss: 0.2607175
	speed: 0.0447s/iter; left time: 311.4923s
	iters: 300, epoch: 1 | loss: 0.2760594
	speed: 0.0447s/iter; left time: 306.4140s
	iters: 400, epoch: 1 | loss: 0.2449654
	speed: 0.0427s/iter; left time: 288.3902s
	iters: 500, epoch: 1 | loss: 0.2430681
	speed: 0.0418s/iter; left time: 278.6677s
	iters: 600, epoch: 1 | loss: 0.2263296
	speed: 0.0419s/iter; left time: 274.9802s
	iters: 700, epoch: 1 | loss: 0.2497521
	speed: 0.0429s/iter; left time: 277.0766s
Epoch: 1 cost time: 32.59999656677246
Epoch: 1, Steps: 716 | Train Loss: 0.2717373 Vali Loss: 0.3422104 Test Loss: 0.4071841
Validation loss decreased (inf --> 0.342210).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.1948104
	speed: 0.2207s/iter; left time: 1400.4826s
	iters: 200, epoch: 2 | loss: 0.2265357
	speed: 0.0429s/iter; left time: 267.6783s
	iters: 300, epoch: 2 | loss: 0.2354875
	speed: 0.0397s/iter; left time: 244.1406s
	iters: 400, epoch: 2 | loss: 0.2130617
	speed: 0.0422s/iter; left time: 255.1409s
	iters: 500, epoch: 2 | loss: 0.2272335
	speed: 0.0432s/iter; left time: 256.7752s
	iters: 600, epoch: 2 | loss: 0.2430668
	speed: 0.0503s/iter; left time: 294.2750s
	iters: 700, epoch: 2 | loss: 0.2573165
	speed: 0.0474s/iter; left time: 272.2123s
Epoch: 2 cost time: 32.237576723098755
Epoch: 2, Steps: 716 | Train Loss: 0.2434573 Vali Loss: 0.3422088 Test Loss: 0.4053257
Validation loss decreased (0.342210 --> 0.342209).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2599196
	speed: 0.2626s/iter; left time: 1478.3832s
	iters: 200, epoch: 3 | loss: 0.1908932
	speed: 0.0472s/iter; left time: 261.2038s
	iters: 300, epoch: 3 | loss: 0.2415373
	speed: 0.0466s/iter; left time: 253.2557s
	iters: 400, epoch: 3 | loss: 0.2648463
	speed: 0.0497s/iter; left time: 264.8784s
	iters: 500, epoch: 3 | loss: 0.2265783
	speed: 0.0451s/iter; left time: 235.7917s
	iters: 600, epoch: 3 | loss: 0.2151252
	speed: 0.0457s/iter; left time: 234.5197s
	iters: 700, epoch: 3 | loss: 0.2749175
	speed: 0.0492s/iter; left time: 247.4719s
Epoch: 3 cost time: 35.11649703979492
Epoch: 3, Steps: 716 | Train Loss: 0.2357534 Vali Loss: 0.3320292 Test Loss: 0.3982661
Validation loss decreased (0.342209 --> 0.332029).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2531992
	speed: 0.2823s/iter; left time: 1386.8238s
	iters: 200, epoch: 4 | loss: 0.2180546
	speed: 0.0455s/iter; left time: 218.7687s
	iters: 300, epoch: 4 | loss: 0.2176170
	speed: 0.0462s/iter; left time: 217.7417s
	iters: 400, epoch: 4 | loss: 0.2550566
	speed: 0.0463s/iter; left time: 213.7571s
	iters: 500, epoch: 4 | loss: 0.2243170
	speed: 0.0496s/iter; left time: 223.9750s
	iters: 600, epoch: 4 | loss: 0.2212203
	speed: 0.0472s/iter; left time: 208.3126s
	iters: 700, epoch: 4 | loss: 0.2480662
	speed: 0.0448s/iter; left time: 193.2224s
Epoch: 4 cost time: 34.85827398300171
Epoch: 4, Steps: 716 | Train Loss: 0.2323727 Vali Loss: 0.3293836 Test Loss: 0.3971815
Validation loss decreased (0.332029 --> 0.329384).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2220830
	speed: 0.2838s/iter; left time: 1191.2065s
	iters: 200, epoch: 5 | loss: 0.2165890
	speed: 0.0487s/iter; left time: 199.6450s
	iters: 300, epoch: 5 | loss: 0.2177107
	speed: 0.0471s/iter; left time: 188.1893s
	iters: 400, epoch: 5 | loss: 0.2294500
	speed: 0.0432s/iter; left time: 168.1869s
	iters: 500, epoch: 5 | loss: 0.2319236
	speed: 0.0475s/iter; left time: 180.2000s
	iters: 600, epoch: 5 | loss: 0.2171891
	speed: 0.0451s/iter; left time: 166.7009s
	iters: 700, epoch: 5 | loss: 0.2373258
	speed: 0.0512s/iter; left time: 184.0861s
Epoch: 5 cost time: 34.96045923233032
Epoch: 5, Steps: 716 | Train Loss: 0.2307530 Vali Loss: 0.3265892 Test Loss: 0.3968415
Validation loss decreased (0.329384 --> 0.326589).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2174737
	speed: 0.2879s/iter; left time: 1002.1903s
	iters: 200, epoch: 6 | loss: 0.2340390
	speed: 0.0483s/iter; left time: 163.3517s
	iters: 300, epoch: 6 | loss: 0.2656411
	speed: 0.0462s/iter; left time: 151.4525s
	iters: 400, epoch: 6 | loss: 0.2316306
	speed: 0.0457s/iter; left time: 145.2599s
	iters: 500, epoch: 6 | loss: 0.2736585
	speed: 0.0457s/iter; left time: 140.9504s
	iters: 600, epoch: 6 | loss: 0.1970835
	speed: 0.0476s/iter; left time: 141.7750s
	iters: 700, epoch: 6 | loss: 0.2366287
	speed: 0.0456s/iter; left time: 131.3931s
Epoch: 6 cost time: 34.78068137168884
Epoch: 6, Steps: 716 | Train Loss: 0.2298942 Vali Loss: 0.3265582 Test Loss: 0.3964104
Validation loss decreased (0.326589 --> 0.326558).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2554807
	speed: 0.3056s/iter; left time: 845.0631s
	iters: 200, epoch: 7 | loss: 0.2646117
	speed: 0.0479s/iter; left time: 127.6363s
	iters: 300, epoch: 7 | loss: 0.2379754
	speed: 0.0489s/iter; left time: 125.4312s
	iters: 400, epoch: 7 | loss: 0.2568404
	speed: 0.0487s/iter; left time: 120.0375s
	iters: 500, epoch: 7 | loss: 0.2209396
	speed: 0.0491s/iter; left time: 116.1232s
	iters: 600, epoch: 7 | loss: 0.2298226
	speed: 0.0476s/iter; left time: 107.7548s
	iters: 700, epoch: 7 | loss: 0.2657114
	speed: 0.0518s/iter; left time: 112.1916s
Epoch: 7 cost time: 36.31391787528992
Epoch: 7, Steps: 716 | Train Loss: 0.2294357 Vali Loss: 0.3252155 Test Loss: 0.3954824
Validation loss decreased (0.326558 --> 0.325215).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2212704
	speed: 0.2963s/iter; left time: 607.1006s
	iters: 200, epoch: 8 | loss: 0.2846138
	speed: 0.0490s/iter; left time: 95.5581s
	iters: 300, epoch: 8 | loss: 0.2347219
	speed: 0.0491s/iter; left time: 90.8432s
	iters: 400, epoch: 8 | loss: 0.2661491
	speed: 0.0482s/iter; left time: 84.2582s
	iters: 500, epoch: 8 | loss: 0.2134970
	speed: 0.0485s/iter; left time: 79.9291s
	iters: 600, epoch: 8 | loss: 0.2245142
	speed: 0.0489s/iter; left time: 75.7163s
	iters: 700, epoch: 8 | loss: 0.2223420
	speed: 0.0479s/iter; left time: 69.3884s
Epoch: 8 cost time: 37.054083585739136
Epoch: 8, Steps: 716 | Train Loss: 0.2291744 Vali Loss: 0.3257583 Test Loss: 0.3952490
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1968533
	speed: 0.3016s/iter; left time: 402.0424s
	iters: 200, epoch: 9 | loss: 0.2109812
	speed: 0.0527s/iter; left time: 65.0007s
	iters: 300, epoch: 9 | loss: 0.1941908
	speed: 0.0469s/iter; left time: 53.1120s
	iters: 400, epoch: 9 | loss: 0.2697996
	speed: 0.0468s/iter; left time: 48.3809s
	iters: 500, epoch: 9 | loss: 0.2522212
	speed: 0.0458s/iter; left time: 42.7000s
	iters: 600, epoch: 9 | loss: 0.2122245
	speed: 0.0475s/iter; left time: 39.5990s
	iters: 700, epoch: 9 | loss: 0.2212758
	speed: 0.0463s/iter; left time: 33.9035s
Epoch: 9 cost time: 35.80658483505249
Epoch: 9, Steps: 716 | Train Loss: 0.2290109 Vali Loss: 0.3254631 Test Loss: 0.3951855
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2351421
	speed: 0.2851s/iter; left time: 175.9137s
	iters: 200, epoch: 10 | loss: 0.2147370
	speed: 0.0492s/iter; left time: 25.4605s
	iters: 300, epoch: 10 | loss: 0.2081985
	speed: 0.0522s/iter; left time: 21.7503s
	iters: 400, epoch: 10 | loss: 0.2378000
	speed: 0.0482s/iter; left time: 15.2846s
	iters: 500, epoch: 10 | loss: 0.2355719
	speed: 0.0453s/iter; left time: 9.8315s
	iters: 600, epoch: 10 | loss: 0.2435330
	speed: 0.0461s/iter; left time: 5.3923s
	iters: 700, epoch: 10 | loss: 0.2217694
	speed: 0.0437s/iter; left time: 0.7433s
Epoch: 10 cost time: 35.47538471221924
Epoch: 10, Steps: 716 | Train Loss: 0.2289430 Vali Loss: 0.3253433 Test Loss: 0.3950605
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : traffic_720_96_DLinear_custom_ftM_sl720_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
mse:0.39559138774871826, mae:0.2716562578678131
