Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='ETTm1', data_path='ETTm1.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='TST', model='PatchTST', model_id='336_336', moving_avg=25, n_heads=16, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.4, pred_len=336, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : 336_336_PatchTST_ETTm1_ftM_sl336_ll48_pl336_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33889
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.4796716
	speed: 0.1160s/iter; left time: 3050.8393s
	iters: 200, epoch: 1 | loss: 0.4357558
	speed: 0.1212s/iter; left time: 3175.8541s
Epoch: 1 cost time: 32.59775352478027
Epoch: 1, Steps: 264 | Train Loss: 0.4979651 Vali Loss: 0.7163582 Test Loss: 0.4306815
Validation loss decreased (inf --> 0.716358).  Saving model ...
Updating learning rate to 4.147995994617984e-06
	iters: 100, epoch: 2 | loss: 0.4089649
	speed: 0.7422s/iter; left time: 19323.8835s
	iters: 200, epoch: 2 | loss: 0.3691985
	speed: 0.1129s/iter; left time: 2927.2269s
Epoch: 2 cost time: 31.25446081161499
Epoch: 2, Steps: 264 | Train Loss: 0.4099723 Vali Loss: 0.6749722 Test Loss: 0.3988936
Validation loss decreased (0.716358 --> 0.674972).  Saving model ...
Updating learning rate to 4.591071361204269e-06
	iters: 100, epoch: 3 | loss: 0.3457307
	speed: 0.7997s/iter; left time: 20609.5798s
	iters: 200, epoch: 3 | loss: 0.3909868
	speed: 0.1503s/iter; left time: 3858.3312s
Epoch: 3 cost time: 40.414592027664185
Epoch: 3, Steps: 264 | Train Loss: 0.3859490 Vali Loss: 0.6630615 Test Loss: 0.3876218
Validation loss decreased (0.674972 --> 0.663061).  Saving model ...
Updating learning rate to 5.3264938756102174e-06
	iters: 100, epoch: 4 | loss: 0.4201545
	speed: 0.7938s/iter; left time: 20250.0674s
	iters: 200, epoch: 4 | loss: 0.3250522
	speed: 0.1253s/iter; left time: 3182.6699s
Epoch: 4 cost time: 32.115028381347656
Epoch: 4, Steps: 264 | Train Loss: 0.3738062 Vali Loss: 0.6558753 Test Loss: 0.3818982
Validation loss decreased (0.663061 --> 0.655875).  Saving model ...
Updating learning rate to 6.349728555065631e-06
	iters: 100, epoch: 5 | loss: 0.3439613
	speed: 0.7225s/iter; left time: 18238.6310s
	iters: 200, epoch: 5 | loss: 0.4013800
	speed: 0.1380s/iter; left time: 3470.3609s
Epoch: 5 cost time: 38.259711265563965
Epoch: 5, Steps: 264 | Train Loss: 0.3673205 Vali Loss: 0.6555474 Test Loss: 0.3783712
Validation loss decreased (0.655875 --> 0.655547).  Saving model ...
Updating learning rate to 7.654465623149092e-06
	iters: 100, epoch: 6 | loss: 0.3835854
	speed: 0.7685s/iter; left time: 19198.2735s
	iters: 200, epoch: 6 | loss: 0.3487676
	speed: 0.1295s/iter; left time: 3222.7406s
Epoch: 6 cost time: 34.93086552619934
Epoch: 6, Steps: 264 | Train Loss: 0.3633143 Vali Loss: 0.6528642 Test Loss: 0.3765015
Validation loss decreased (0.655547 --> 0.652864).  Saving model ...
Updating learning rate to 9.232659419022894e-06
	iters: 100, epoch: 7 | loss: 0.4063764
	speed: 0.7206s/iter; left time: 17809.9046s
	iters: 200, epoch: 7 | loss: 0.3207224
	speed: 0.1390s/iter; left time: 3421.9717s
Epoch: 7 cost time: 39.08202505111694
Epoch: 7, Steps: 264 | Train Loss: 0.3600586 Vali Loss: 0.6545860 Test Loss: 0.3745963
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.1074578010998666e-05
	iters: 100, epoch: 8 | loss: 0.3485026
	speed: 0.7731s/iter; left time: 18903.8595s
	iters: 200, epoch: 8 | loss: 0.3504930
	speed: 0.1408s/iter; left time: 3429.8170s
Epoch: 8 cost time: 38.31457161903381
Epoch: 8, Steps: 264 | Train Loss: 0.3575330 Vali Loss: 0.6481266 Test Loss: 0.3741697
Validation loss decreased (0.652864 --> 0.648127).  Saving model ...
Updating learning rate to 1.3168863208492038e-05
	iters: 100, epoch: 9 | loss: 0.3465376
	speed: 0.7937s/iter; left time: 19199.7014s
	iters: 200, epoch: 9 | loss: 0.3764535
	speed: 0.1446s/iter; left time: 3483.5436s
Epoch: 9 cost time: 38.389092683792114
Epoch: 9, Steps: 264 | Train Loss: 0.3542848 Vali Loss: 0.6493210 Test Loss: 0.3708761
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.5502600602302323e-05
	iters: 100, epoch: 10 | loss: 0.3414573
	speed: 0.7537s/iter; left time: 18031.1380s
	iters: 200, epoch: 10 | loss: 0.3000628
	speed: 0.1498s/iter; left time: 3568.7143s
Epoch: 10 cost time: 41.14543175697327
Epoch: 10, Steps: 264 | Train Loss: 0.3503553 Vali Loss: 0.6489229 Test Loss: 0.3690808
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.8061399201313948e-05
	iters: 100, epoch: 11 | loss: 0.3055249
	speed: 0.8171s/iter; left time: 19333.3403s
	iters: 200, epoch: 11 | loss: 0.3578489
	speed: 0.1365s/iter; left time: 3216.4188s
Epoch: 11 cost time: 36.30945944786072
Epoch: 11, Steps: 264 | Train Loss: 0.3463882 Vali Loss: 0.6473565 Test Loss: 0.3668509
Validation loss decreased (0.648127 --> 0.647357).  Saving model ...
Updating learning rate to 2.08294801745399e-05
	iters: 100, epoch: 12 | loss: 0.3252704
	speed: 0.7435s/iter; left time: 17396.3125s
	iters: 200, epoch: 12 | loss: 0.3624997
	speed: 0.1403s/iter; left time: 3268.7938s
Epoch: 12 cost time: 37.412381649017334
Epoch: 12, Steps: 264 | Train Loss: 0.3422919 Vali Loss: 0.6408278 Test Loss: 0.3668551
Validation loss decreased (0.647357 --> 0.640828).  Saving model ...
Updating learning rate to 2.378977415127951e-05
	iters: 100, epoch: 13 | loss: 0.3141690
	speed: 0.6698s/iter; left time: 15493.5152s
	iters: 200, epoch: 13 | loss: 0.3975268
	speed: 0.1366s/iter; left time: 3145.8167s
Epoch: 13 cost time: 35.78897309303284
Epoch: 13, Steps: 264 | Train Loss: 0.3392765 Vali Loss: 0.6374426 Test Loss: 0.3659725
Validation loss decreased (0.640828 --> 0.637443).  Saving model ...
Updating learning rate to 2.6924026479389104e-05
	iters: 100, epoch: 14 | loss: 0.3116743
	speed: 0.7376s/iter; left time: 16867.2962s
	iters: 200, epoch: 14 | loss: 0.3679873
	speed: 0.1327s/iter; left time: 3020.7006s
Epoch: 14 cost time: 35.51141142845154
Epoch: 14, Steps: 264 | Train Loss: 0.3366565 Vali Loss: 0.6371753 Test Loss: 0.3659522
Validation loss decreased (0.637443 --> 0.637175).  Saving model ...
Updating learning rate to 3.0212909792590238e-05
	iters: 100, epoch: 15 | loss: 0.3525344
	speed: 0.6979s/iter; left time: 15777.0992s
	iters: 200, epoch: 15 | loss: 0.3512817
	speed: 0.1421s/iter; left time: 3198.7563s
Epoch: 15 cost time: 38.02319121360779
Epoch: 15, Steps: 264 | Train Loss: 0.3341126 Vali Loss: 0.6403267 Test Loss: 0.3670626
EarlyStopping counter: 1 out of 20
Updating learning rate to 3.363614319266957e-05
	iters: 100, epoch: 16 | loss: 0.3431541
	speed: 0.7312s/iter; left time: 16336.7298s
	iters: 200, epoch: 16 | loss: 0.3375244
	speed: 0.1367s/iter; left time: 3039.9987s
Epoch: 16 cost time: 36.95584583282471
Epoch: 16, Steps: 264 | Train Loss: 0.3318813 Vali Loss: 0.6383777 Test Loss: 0.3689513
EarlyStopping counter: 2 out of 20
Updating learning rate to 3.7172617311633196e-05
	iters: 100, epoch: 17 | loss: 0.2964935
	speed: 0.6553s/iter; left time: 14466.9537s
	iters: 200, epoch: 17 | loss: 0.3289608
	speed: 0.1241s/iter; left time: 2727.0106s
Epoch: 17 cost time: 33.24537658691406
Epoch: 17, Steps: 264 | Train Loss: 0.3296841 Vali Loss: 0.6354975 Test Loss: 0.3670603
Validation loss decreased (0.637175 --> 0.635497).  Saving model ...
Updating learning rate to 4.0800524482619576e-05
	iters: 100, epoch: 18 | loss: 0.2979174
	speed: 0.6564s/iter; left time: 14318.0654s
	iters: 200, epoch: 18 | loss: 0.3265517
	speed: 0.1249s/iter; left time: 2712.6666s
Epoch: 18 cost time: 34.251537561416626
Epoch: 18, Steps: 264 | Train Loss: 0.3275436 Vali Loss: 0.6371526 Test Loss: 0.3665977
EarlyStopping counter: 1 out of 20
Updating learning rate to 4.449749321687241e-05
	iters: 100, epoch: 19 | loss: 0.3218080
	speed: 0.6421s/iter; left time: 13836.4817s
	iters: 200, epoch: 19 | loss: 0.3823307
	speed: 0.1282s/iter; left time: 2749.8196s
Epoch: 19 cost time: 34.83286714553833
Epoch: 19, Steps: 264 | Train Loss: 0.3254672 Vali Loss: 0.6450491 Test Loss: 0.3666612
EarlyStopping counter: 2 out of 20
Updating learning rate to 4.824072615752094e-05
	iters: 100, epoch: 20 | loss: 0.3113061
	speed: 0.6964s/iter; left time: 14823.6310s
	iters: 200, epoch: 20 | loss: 0.3547272
	speed: 0.1297s/iter; left time: 2748.3338s
Epoch: 20 cost time: 34.578248500823975
Epoch: 20, Steps: 264 | Train Loss: 0.3230768 Vali Loss: 0.6372257 Test Loss: 0.3685274
EarlyStopping counter: 3 out of 20
Updating learning rate to 5.200714065947608e-05
	iters: 100, epoch: 21 | loss: 0.3187912
	speed: 0.5836s/iter; left time: 12268.6132s
	iters: 200, epoch: 21 | loss: 0.3381201
	speed: 0.1221s/iter; left time: 2555.1622s
Epoch: 21 cost time: 33.00557589530945
Epoch: 21, Steps: 264 | Train Loss: 0.3206453 Vali Loss: 0.6401168 Test Loss: 0.3670399
EarlyStopping counter: 4 out of 20
Updating learning rate to 5.577351112855618e-05
	iters: 100, epoch: 22 | loss: 0.3143199
	speed: 0.6475s/iter; left time: 13440.4263s
	iters: 200, epoch: 22 | loss: 0.3493909
	speed: 0.1319s/iter; left time: 2724.8967s
Epoch: 22 cost time: 35.77526497840881
Epoch: 22, Steps: 264 | Train Loss: 0.3182275 Vali Loss: 0.6333268 Test Loss: 0.3661831
Validation loss decreased (0.635497 --> 0.633327).  Saving model ...
Updating learning rate to 5.951661224210828e-05
	iters: 100, epoch: 23 | loss: 0.3106813
	speed: 0.7418s/iter; left time: 15200.6956s
	iters: 200, epoch: 23 | loss: 0.3203400
	speed: 0.1403s/iter; left time: 2861.7535s
Epoch: 23 cost time: 37.16649913787842
Epoch: 23, Steps: 264 | Train Loss: 0.3154967 Vali Loss: 0.6411738 Test Loss: 0.3668409
EarlyStopping counter: 1 out of 20
Updating learning rate to 6.321336216795497e-05
	iters: 100, epoch: 24 | loss: 0.2882440
	speed: 0.7275s/iter; left time: 14716.0202s
	iters: 200, epoch: 24 | loss: 0.3429264
	speed: 0.1337s/iter; left time: 2690.2469s
Epoch: 24 cost time: 36.58830142021179
Epoch: 24, Steps: 264 | Train Loss: 0.3128886 Vali Loss: 0.6413598 Test Loss: 0.3677621
EarlyStopping counter: 2 out of 20
Updating learning rate to 6.684096489850761e-05
	iters: 100, epoch: 25 | loss: 0.3148681
	speed: 0.7231s/iter; left time: 14436.1029s
	iters: 200, epoch: 25 | loss: 0.3218265
	speed: 0.1279s/iter; left time: 2541.0885s
Epoch: 25 cost time: 35.66882348060608
Epoch: 25, Steps: 264 | Train Loss: 0.3096708 Vali Loss: 0.6599599 Test Loss: 0.3667791
EarlyStopping counter: 3 out of 20
Updating learning rate to 7.03770508223417e-05
	iters: 100, epoch: 26 | loss: 0.2807900
	speed: 0.6236s/iter; left time: 12286.3322s
	iters: 200, epoch: 26 | loss: 0.3146060
	speed: 0.0804s/iter; left time: 1576.5275s
Epoch: 26 cost time: 23.934866905212402
Epoch: 26, Steps: 264 | Train Loss: 0.3067328 Vali Loss: 0.6522474 Test Loss: 0.3683718
EarlyStopping counter: 4 out of 20
Updating learning rate to 7.379981466640088e-05
	iters: 100, epoch: 27 | loss: 0.2848196
	speed: 0.5947s/iter; left time: 11559.2389s
	iters: 200, epoch: 27 | loss: 0.3164754
	speed: 0.1349s/iter; left time: 2608.9169s
Epoch: 27 cost time: 36.772605419158936
Epoch: 27, Steps: 264 | Train Loss: 0.3036253 Vali Loss: 0.6523017 Test Loss: 0.3704793
EarlyStopping counter: 5 out of 20
Updating learning rate to 7.708814995820833e-05
	iters: 100, epoch: 28 | loss: 0.2742455
	speed: 0.7366s/iter; left time: 14123.5824s
	iters: 200, epoch: 28 | loss: 0.3143736
	speed: 0.1372s/iter; left time: 2616.5123s
Epoch: 28 cost time: 36.834707736968994
Epoch: 28, Steps: 264 | Train Loss: 0.3004450 Vali Loss: 0.6671228 Test Loss: 0.3751655
EarlyStopping counter: 6 out of 20
Updating learning rate to 8.022177917892456e-05
	iters: 100, epoch: 29 | loss: 0.3153366
	speed: 0.6908s/iter; left time: 13063.1030s
	iters: 200, epoch: 29 | loss: 0.2824383
	speed: 0.1157s/iter; left time: 2176.4619s
Epoch: 29 cost time: 31.956067085266113
Epoch: 29, Steps: 264 | Train Loss: 0.2971628 Vali Loss: 0.6598035 Test Loss: 0.3715693
EarlyStopping counter: 7 out of 20
Updating learning rate to 8.318137880466269e-05
	iters: 100, epoch: 30 | loss: 0.2713281
	speed: 0.6736s/iter; left time: 12560.1059s
	iters: 200, epoch: 30 | loss: 0.2707448
	speed: 0.1304s/iter; left time: 2417.7597s
Epoch: 30 cost time: 35.4931857585907
Epoch: 30, Steps: 264 | Train Loss: 0.2938234 Vali Loss: 0.6694806 Test Loss: 0.3732314
EarlyStopping counter: 8 out of 20
Updating learning rate to 8.594869846499432e-05
	iters: 100, epoch: 31 | loss: 0.2978899
	speed: 0.7193s/iter; left time: 13220.8620s
	iters: 200, epoch: 31 | loss: 0.2929904
	speed: 0.1368s/iter; left time: 2501.0227s
Epoch: 31 cost time: 36.6200647354126
Epoch: 31, Steps: 264 | Train Loss: 0.2903344 Vali Loss: 0.6862679 Test Loss: 0.3764428
EarlyStopping counter: 9 out of 20
Updating learning rate to 8.85066734838546e-05
	iters: 100, epoch: 32 | loss: 0.2844894
	speed: 0.7223s/iter; left time: 13085.3632s
	iters: 200, epoch: 32 | loss: 0.2559555
	speed: 0.1172s/iter; left time: 2111.5180s
Epoch: 32 cost time: 34.25369572639465
Epoch: 32, Steps: 264 | Train Loss: 0.2866113 Vali Loss: 0.6656674 Test Loss: 0.3735259
EarlyStopping counter: 10 out of 20
Updating learning rate to 9.083953010886336e-05
	iters: 100, epoch: 33 | loss: 0.3047484
	speed: 0.6164s/iter; left time: 11005.2312s
	iters: 200, epoch: 33 | loss: 0.2660896
	speed: 0.1178s/iter; left time: 2091.7536s
Epoch: 33 cost time: 32.53340005874634
Epoch: 33, Steps: 264 | Train Loss: 0.2831498 Vali Loss: 0.7015368 Test Loss: 0.3773156
EarlyStopping counter: 11 out of 20
Updating learning rate to 9.29328827801656e-05
	iters: 100, epoch: 34 | loss: 0.2709599
	speed: 0.6643s/iter; left time: 11684.9944s
	iters: 200, epoch: 34 | loss: 0.2960037
	speed: 0.1357s/iter; left time: 2373.6008s
Epoch: 34 cost time: 36.33348608016968
Epoch: 34, Steps: 264 | Train Loss: 0.2800524 Vali Loss: 0.7027232 Test Loss: 0.3814502
EarlyStopping counter: 12 out of 20
Updating learning rate to 9.477382283898318e-05
	iters: 100, epoch: 35 | loss: 0.2714804
	speed: 0.6857s/iter; left time: 11880.4271s
	iters: 200, epoch: 35 | loss: 0.2949334
	speed: 0.1272s/iter; left time: 2190.7520s
Epoch: 35 cost time: 34.93814182281494
Epoch: 35, Steps: 264 | Train Loss: 0.2767927 Vali Loss: 0.6899242 Test Loss: 0.3804453
EarlyStopping counter: 13 out of 20
Updating learning rate to 9.635099812885627e-05
	iters: 100, epoch: 36 | loss: 0.2761900
	speed: 0.5554s/iter; left time: 9476.2042s
	iters: 200, epoch: 36 | loss: 0.2661400
	speed: 0.0934s/iter; left time: 1583.6288s
Epoch: 36 cost time: 27.07504892349243
Epoch: 36, Steps: 264 | Train Loss: 0.2736248 Vali Loss: 0.7008985 Test Loss: 0.3839529
EarlyStopping counter: 14 out of 20
Updating learning rate to 9.765468299871352e-05
	iters: 100, epoch: 37 | loss: 0.2737550
	speed: 0.6459s/iter; left time: 10849.5486s
	iters: 200, epoch: 37 | loss: 0.2530439
	speed: 0.1290s/iter; left time: 2153.9781s
Epoch: 37 cost time: 35.48426795005798
Epoch: 37, Steps: 264 | Train Loss: 0.2707321 Vali Loss: 0.7037205 Test Loss: 0.3856696
EarlyStopping counter: 15 out of 20
Updating learning rate to 9.86768382760973e-05
	iters: 100, epoch: 38 | loss: 0.2626881
	speed: 0.6208s/iter; left time: 10263.2985s
	iters: 200, epoch: 38 | loss: 0.2995590
	speed: 0.1164s/iter; left time: 1912.1650s
Epoch: 38 cost time: 31.204349517822266
Epoch: 38, Steps: 264 | Train Loss: 0.2677914 Vali Loss: 0.6911759 Test Loss: 0.3848893
EarlyStopping counter: 16 out of 20
Updating learning rate to 9.941116084071886e-05
	iters: 100, epoch: 39 | loss: 0.2718666
	speed: 0.6281s/iter; left time: 10218.9911s
	iters: 200, epoch: 39 | loss: 0.2952831
	speed: 0.1268s/iter; left time: 2049.9374s
Epoch: 39 cost time: 34.08472013473511
Epoch: 39, Steps: 264 | Train Loss: 0.2647359 Vali Loss: 0.7016940 Test Loss: 0.3829731
EarlyStopping counter: 17 out of 20
Updating learning rate to 9.985312249264813e-05
	iters: 100, epoch: 40 | loss: 0.2505339
	speed: 0.6409s/iter; left time: 10257.5223s
	iters: 200, epoch: 40 | loss: 0.2576994
	speed: 0.1144s/iter; left time: 1819.3640s
Epoch: 40 cost time: 31.006465435028076
Epoch: 40, Steps: 264 | Train Loss: 0.2617097 Vali Loss: 0.7045471 Test Loss: 0.3858068
EarlyStopping counter: 18 out of 20
Updating learning rate to 9.999999901660576e-05
	iters: 100, epoch: 41 | loss: 0.2608157
	speed: 0.6590s/iter; left time: 10372.7909s
	iters: 200, epoch: 41 | loss: 0.2630880
	speed: 0.1265s/iter; left time: 1979.2979s
Epoch: 41 cost time: 34.74003195762634
Epoch: 41, Steps: 264 | Train Loss: 0.2592047 Vali Loss: 0.7280114 Test Loss: 0.3946519
EarlyStopping counter: 19 out of 20
Updating learning rate to 9.99309570348355e-05
	iters: 100, epoch: 42 | loss: 0.2470656
	speed: 0.7059s/iter; left time: 10925.7826s
	iters: 200, epoch: 42 | loss: 0.2800826
	speed: 0.1343s/iter; left time: 2064.4723s
Epoch: 42 cost time: 36.96947693824768
Epoch: 42, Steps: 264 | Train Loss: 0.2564532 Vali Loss: 0.7022996 Test Loss: 0.3890090
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : 336_336_PatchTST_ETTm1_ftM_sl336_ll48_pl336_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.36574244499206543, mae:0.39189961552619934, rse:0.5754876136779785
