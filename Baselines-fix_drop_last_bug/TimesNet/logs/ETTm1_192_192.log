True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm1_192_96        Model:              TimesNet            

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/          
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            192                 Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm1_192_96_TimesNet_ETTm1_ftM_sl192_ll48_pl192_dm16_nh8_el2_dl1_df32_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34177
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.3819794
	speed: 0.2420s/iter; left time: 7735.5252s
	iters: 200, epoch: 1 | loss: 0.3842017
	speed: 0.2208s/iter; left time: 7036.3491s
	iters: 300, epoch: 1 | loss: 0.3447559
	speed: 0.2224s/iter; left time: 7065.4956s
	iters: 400, epoch: 1 | loss: 0.3387294
	speed: 0.2238s/iter; left time: 7086.8118s
	iters: 500, epoch: 1 | loss: 0.2780595
	speed: 0.2246s/iter; left time: 7091.3266s
	iters: 600, epoch: 1 | loss: 0.3274530
	speed: 0.2249s/iter; left time: 7076.4967s
	iters: 700, epoch: 1 | loss: 0.3305328
	speed: 0.2321s/iter; left time: 7280.9216s
	iters: 800, epoch: 1 | loss: 0.3060143
	speed: 0.2304s/iter; left time: 7205.9652s
	iters: 900, epoch: 1 | loss: 0.3139457
	speed: 0.2291s/iter; left time: 7142.3843s
	iters: 1000, epoch: 1 | loss: 0.2728898
	speed: 0.2314s/iter; left time: 7190.1452s
Epoch: 1 cost time: 244.16400027275085
Epoch: 1, Steps: 1069 | Train Loss: 0.3470559 Vali Loss: 0.5082508 Test Loss: 0.3630252
Validation loss decreased (inf --> 0.508251).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2488009
	speed: 1.0622s/iter; left time: 32823.1726s
	iters: 200, epoch: 2 | loss: 0.2857536
	speed: 0.2316s/iter; left time: 7133.8159s
	iters: 300, epoch: 2 | loss: 0.2630983
	speed: 0.2337s/iter; left time: 7175.5722s
	iters: 400, epoch: 2 | loss: 0.2605154
	speed: 0.2318s/iter; left time: 7092.0805s
	iters: 500, epoch: 2 | loss: 0.3201531
	speed: 0.2312s/iter; left time: 7052.6899s
	iters: 600, epoch: 2 | loss: 0.2535788
	speed: 0.2323s/iter; left time: 7062.6861s
	iters: 700, epoch: 2 | loss: 0.3745011
	speed: 0.2314s/iter; left time: 7010.4293s
	iters: 800, epoch: 2 | loss: 0.2799334
	speed: 0.2324s/iter; left time: 7019.0934s
	iters: 900, epoch: 2 | loss: 0.2407608
	speed: 0.2333s/iter; left time: 7024.1643s
	iters: 1000, epoch: 2 | loss: 0.2781837
	speed: 0.2324s/iter; left time: 6973.5270s
Epoch: 2 cost time: 248.78160905838013
Epoch: 2, Steps: 1069 | Train Loss: 0.2854987 Vali Loss: 0.5034074 Test Loss: 0.3753659
Validation loss decreased (0.508251 --> 0.503407).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2581795
	speed: 1.0942s/iter; left time: 32643.1175s
	iters: 200, epoch: 3 | loss: 0.2842892
	speed: 0.2338s/iter; left time: 6951.3293s
	iters: 300, epoch: 3 | loss: 0.3225197
	speed: 0.2333s/iter; left time: 6912.4339s
	iters: 400, epoch: 3 | loss: 0.2767008
	speed: 0.2355s/iter; left time: 6955.4841s
	iters: 500, epoch: 3 | loss: 0.2494565
	speed: 0.2317s/iter; left time: 6819.8479s
	iters: 600, epoch: 3 | loss: 0.2219389
	speed: 0.2344s/iter; left time: 6876.8193s
	iters: 700, epoch: 3 | loss: 0.2482110
	speed: 0.2307s/iter; left time: 6745.2577s
	iters: 800, epoch: 3 | loss: 0.2535940
	speed: 0.2324s/iter; left time: 6769.4770s
	iters: 900, epoch: 3 | loss: 0.2700665
	speed: 0.2348s/iter; left time: 6815.8594s
	iters: 1000, epoch: 3 | loss: 0.3210848
	speed: 0.2336s/iter; left time: 6757.3292s
Epoch: 3 cost time: 250.21677494049072
Epoch: 3, Steps: 1069 | Train Loss: 0.2677633 Vali Loss: 0.5140371 Test Loss: 0.3830918
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2324756
	speed: 1.1655s/iter; left time: 33524.5726s
	iters: 200, epoch: 4 | loss: 0.3051823
	speed: 0.2285s/iter; left time: 6551.1537s
	iters: 300, epoch: 4 | loss: 0.2377703
	speed: 0.2268s/iter; left time: 6477.6296s
	iters: 400, epoch: 4 | loss: 0.2722950
	speed: 0.2309s/iter; left time: 6571.4214s
	iters: 500, epoch: 4 | loss: 0.2619395
	speed: 0.2242s/iter; left time: 6360.0577s
	iters: 600, epoch: 4 | loss: 0.2989130
	speed: 0.2288s/iter; left time: 6467.6749s
	iters: 700, epoch: 4 | loss: 0.2308227
	speed: 0.2293s/iter; left time: 6458.7113s
	iters: 800, epoch: 4 | loss: 0.2646147
	speed: 0.2293s/iter; left time: 6433.8899s
	iters: 900, epoch: 4 | loss: 0.3413357
	speed: 0.2299s/iter; left time: 6429.6578s
	iters: 1000, epoch: 4 | loss: 0.2589729
	speed: 0.2291s/iter; left time: 6382.8566s
Epoch: 4 cost time: 245.51587295532227
Epoch: 4, Steps: 1069 | Train Loss: 0.2596650 Vali Loss: 0.5181280 Test Loss: 0.3883467
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2737088
	speed: 1.1073s/iter; left time: 30667.2692s
	iters: 200, epoch: 5 | loss: 0.2358227
	speed: 0.2296s/iter; left time: 6335.8709s
	iters: 300, epoch: 5 | loss: 0.2525680
	speed: 0.2280s/iter; left time: 6267.6420s
	iters: 400, epoch: 5 | loss: 0.2272967
	speed: 0.2306s/iter; left time: 6318.3747s
	iters: 500, epoch: 5 | loss: 0.2403277
	speed: 0.2267s/iter; left time: 6189.0502s
	iters: 600, epoch: 5 | loss: 0.2510151
	speed: 0.2270s/iter; left time: 6172.6843s
	iters: 700, epoch: 5 | loss: 0.2563342
	speed: 0.2322s/iter; left time: 6292.2215s
	iters: 800, epoch: 5 | loss: 0.3456427
	speed: 0.2308s/iter; left time: 6230.3745s
	iters: 900, epoch: 5 | loss: 0.2689950
	speed: 0.2314s/iter; left time: 6224.7728s
	iters: 1000, epoch: 5 | loss: 0.2437654
	speed: 0.2314s/iter; left time: 6201.5050s
Epoch: 5 cost time: 246.25917196273804
Epoch: 5, Steps: 1069 | Train Loss: 0.2552792 Vali Loss: 0.5181679 Test Loss: 0.3929320
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm1_192_96_TimesNet_ETTm1_ftM_sl192_ll48_pl192_dm16_nh8_el2_dl1_df32_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
test shape: (11329, 192, 7) (11329, 192, 7)
test shape: (11329, 192, 7) (11329, 192, 7)
mse:0.3745702803134918, mae:0.39483529329299927, dtw:not calculated
