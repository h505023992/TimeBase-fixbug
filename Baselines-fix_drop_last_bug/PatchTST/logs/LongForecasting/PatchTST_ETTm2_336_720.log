Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='ETTm2', data_path='ETTm2.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='TST', model='PatchTST', model_id='336_720', moving_avg=25, n_heads=16, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.4, pred_len=720, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : 336_720_PatchTST_ETTm2_ftM_sl336_ll48_pl720_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33505
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.5366158
	speed: 0.1309s/iter; left time: 3402.4046s
	iters: 200, epoch: 1 | loss: 0.6384279
	speed: 0.1467s/iter; left time: 3799.7292s
Epoch: 1 cost time: 36.46740198135376
Epoch: 1, Steps: 261 | Train Loss: 0.6042467 Vali Loss: 0.2892816 Test Loss: 0.3967308
Validation loss decreased (inf --> 0.289282).  Saving model ...
Updating learning rate to 4.147996316662011e-06
	iters: 100, epoch: 2 | loss: 0.5506893
	speed: 0.8179s/iter; left time: 21053.9567s
	iters: 200, epoch: 2 | loss: 0.4033045
	speed: 0.1232s/iter; left time: 3157.6674s
Epoch: 2 cost time: 33.14482617378235
Epoch: 2, Steps: 261 | Train Loss: 0.5597564 Vali Loss: 0.2796702 Test Loss: 0.3848829
Validation loss decreased (0.289282 --> 0.279670).  Saving model ...
Updating learning rate to 4.591072645408634e-06
	iters: 100, epoch: 3 | loss: 0.4762040
	speed: 0.5251s/iter; left time: 13380.1258s
	iters: 200, epoch: 3 | loss: 0.6279336
	speed: 0.1365s/iter; left time: 3464.3709s
Epoch: 3 cost time: 34.53646898269653
Epoch: 3, Steps: 261 | Train Loss: 0.5476752 Vali Loss: 0.2748810 Test Loss: 0.3781778
Validation loss decreased (0.279670 --> 0.274881).  Saving model ...
Updating learning rate to 5.326496750212602e-06
	iters: 100, epoch: 4 | loss: 0.4911175
	speed: 0.7296s/iter; left time: 18399.1007s
	iters: 200, epoch: 4 | loss: 0.5131074
	speed: 0.1341s/iter; left time: 3368.3036s
Epoch: 4 cost time: 35.59529113769531
Epoch: 4, Steps: 261 | Train Loss: 0.5396524 Vali Loss: 0.2727227 Test Loss: 0.3749843
Validation loss decreased (0.274881 --> 0.272723).  Saving model ...
Updating learning rate to 6.349733628628268e-06
	iters: 100, epoch: 5 | loss: 0.7136896
	speed: 0.7508s/iter; left time: 18738.4004s
	iters: 200, epoch: 5 | loss: 0.5722394
	speed: 0.1306s/iter; left time: 3246.8719s
Epoch: 5 cost time: 35.88087868690491
Epoch: 5, Steps: 261 | Train Loss: 0.5334005 Vali Loss: 0.2710429 Test Loss: 0.3720848
Validation loss decreased (0.272723 --> 0.271043).  Saving model ...
Updating learning rate to 7.654473476944045e-06
	iters: 100, epoch: 6 | loss: 0.5200166
	speed: 0.6926s/iter; left time: 17104.9285s
	iters: 200, epoch: 6 | loss: 0.5590704
	speed: 0.1227s/iter; left time: 3017.2446s
Epoch: 6 cost time: 33.32313585281372
Epoch: 6, Steps: 261 | Train Loss: 0.5286265 Vali Loss: 0.2696384 Test Loss: 0.3713425
Validation loss decreased (0.271043 --> 0.269638).  Saving model ...
Updating learning rate to 9.232670599670218e-06
	iters: 100, epoch: 7 | loss: 0.5676507
	speed: 0.6575s/iter; left time: 16065.1794s
	iters: 200, epoch: 7 | loss: 0.6213701
	speed: 0.1077s/iter; left time: 2621.7074s
Epoch: 7 cost time: 28.99846577644348
Epoch: 7, Steps: 261 | Train Loss: 0.5247315 Vali Loss: 0.2698660 Test Loss: 0.3686122
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.1074593023426382e-05
	iters: 100, epoch: 8 | loss: 0.4369412
	speed: 0.6910s/iter; left time: 16705.1393s
	iters: 200, epoch: 8 | loss: 0.4753963
	speed: 0.1353s/iter; left time: 3258.3941s
Epoch: 8 cost time: 36.628658294677734
Epoch: 8, Steps: 261 | Train Loss: 0.5202765 Vali Loss: 0.2709169 Test Loss: 0.3670022
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.3168882509283648e-05
	iters: 100, epoch: 9 | loss: 0.4424094
	speed: 0.7202s/iter; left time: 17221.1478s
	iters: 200, epoch: 9 | loss: 0.5894741
	speed: 0.1344s/iter; left time: 3201.0600s
Epoch: 9 cost time: 36.4516167640686
Epoch: 9, Steps: 261 | Train Loss: 0.5136971 Vali Loss: 0.2711037 Test Loss: 0.3656923
EarlyStopping counter: 3 out of 20
Updating learning rate to 1.5502624593494887e-05
	iters: 100, epoch: 10 | loss: 0.4558488
	speed: 0.7093s/iter; left time: 16775.4217s
	iters: 200, epoch: 10 | loss: 0.5132352
	speed: 0.1300s/iter; left time: 3062.7089s
Epoch: 10 cost time: 36.07102394104004
Epoch: 10, Steps: 261 | Train Loss: 0.5070122 Vali Loss: 0.2724397 Test Loss: 0.3642941
EarlyStopping counter: 4 out of 20
Updating learning rate to 1.806142822470586e-05
	iters: 100, epoch: 11 | loss: 0.5441909
	speed: 0.7257s/iter; left time: 16974.9571s
	iters: 200, epoch: 11 | loss: 0.5489738
	speed: 0.1374s/iter; left time: 3200.7669s
Epoch: 11 cost time: 36.71928381919861
Epoch: 11, Steps: 261 | Train Loss: 0.4996978 Vali Loss: 0.2745049 Test Loss: 0.3602900
EarlyStopping counter: 5 out of 20
Updating learning rate to 2.0829514506563195e-05
	iters: 100, epoch: 12 | loss: 0.4839340
	speed: 0.7130s/iter; left time: 16492.5662s
	iters: 200, epoch: 12 | loss: 0.6151552
	speed: 0.1398s/iter; left time: 3219.7625s
Epoch: 12 cost time: 36.57374358177185
Epoch: 12, Steps: 261 | Train Loss: 0.4941177 Vali Loss: 0.2763329 Test Loss: 0.3623556
EarlyStopping counter: 6 out of 20
Updating learning rate to 2.3789813998487008e-05
	iters: 100, epoch: 13 | loss: 0.4026642
	speed: 0.7220s/iter; left time: 16512.0759s
	iters: 200, epoch: 13 | loss: 0.4957263
	speed: 0.1405s/iter; left time: 3199.2721s
Epoch: 13 cost time: 37.03352642059326
Epoch: 13, Steps: 261 | Train Loss: 0.4857199 Vali Loss: 0.2820125 Test Loss: 0.3606795
EarlyStopping counter: 7 out of 20
Updating learning rate to 2.6924071974601397e-05
	iters: 100, epoch: 14 | loss: 0.4380470
	speed: 0.7394s/iter; left time: 16716.2997s
	iters: 200, epoch: 14 | loss: 0.7108032
	speed: 0.1355s/iter; left time: 3050.6636s
Epoch: 14 cost time: 37.05152773857117
Epoch: 14, Steps: 261 | Train Loss: 0.4759434 Vali Loss: 0.2808534 Test Loss: 0.3666038
EarlyStopping counter: 8 out of 20
Updating learning rate to 3.0212960991742456e-05
	iters: 100, epoch: 15 | loss: 0.5275351
	speed: 0.7287s/iter; left time: 16284.3457s
	iters: 200, epoch: 15 | loss: 0.5536603
	speed: 0.1413s/iter; left time: 3143.3443s
Epoch: 15 cost time: 37.806989431381226
Epoch: 15, Steps: 261 | Train Loss: 0.4655933 Vali Loss: 0.2867956 Test Loss: 0.3707980
EarlyStopping counter: 9 out of 20
Updating learning rate to 3.363620007239161e-05
	iters: 100, epoch: 16 | loss: 0.4209372
	speed: 0.7163s/iter; left time: 15820.2507s
	iters: 200, epoch: 16 | loss: 0.4913669
	speed: 0.1389s/iter; left time: 3053.9751s
Epoch: 16 cost time: 36.408581018447876
Epoch: 16, Steps: 261 | Train Loss: 0.4564040 Vali Loss: 0.2924627 Test Loss: 0.3789910
EarlyStopping counter: 10 out of 20
Updating learning rate to 3.717267976759092e-05
	iters: 100, epoch: 17 | loss: 0.3285106
	speed: 0.7229s/iter; left time: 15777.1024s
	iters: 200, epoch: 17 | loss: 0.5376172
	speed: 0.1409s/iter; left time: 3060.4399s
Epoch: 17 cost time: 37.5745689868927
Epoch: 17, Steps: 261 | Train Loss: 0.4486330 Vali Loss: 0.2909273 Test Loss: 0.3820159
EarlyStopping counter: 11 out of 20
Updating learning rate to 4.0800592328638756e-05
	iters: 100, epoch: 18 | loss: 0.3987814
	speed: 0.7337s/iter; left time: 15821.8481s
	iters: 200, epoch: 18 | loss: 0.5127977
	speed: 0.1414s/iter; left time: 3034.3227s
Epoch: 18 cost time: 37.53624868392944
Epoch: 18, Steps: 261 | Train Loss: 0.4417128 Vali Loss: 0.2959751 Test Loss: 0.3838186
EarlyStopping counter: 12 out of 20
Updating learning rate to 4.449756618485984e-05
	iters: 100, epoch: 19 | loss: 0.4415447
	speed: 0.7347s/iter; left time: 15652.1900s
	iters: 200, epoch: 19 | loss: 0.4725679
	speed: 0.1382s/iter; left time: 2929.2474s
Epoch: 19 cost time: 37.295355796813965
Epoch: 19, Steps: 261 | Train Loss: 0.4346415 Vali Loss: 0.2989954 Test Loss: 0.3881467
EarlyStopping counter: 13 out of 20
Updating learning rate to 4.824080389819096e-05
	iters: 100, epoch: 20 | loss: 0.4925965
	speed: 0.6887s/iter; left time: 14492.0702s
	iters: 200, epoch: 20 | loss: 0.4006859
	speed: 0.1357s/iter; left time: 2841.8648s
Epoch: 20 cost time: 37.37049984931946
Epoch: 20, Steps: 261 | Train Loss: 0.4289927 Vali Loss: 0.3012871 Test Loss: 0.3954265
EarlyStopping counter: 14 out of 20
Updating learning rate to 5.2007222743883666e-05
	iters: 100, epoch: 21 | loss: 0.4849231
	speed: 0.7535s/iter; left time: 15657.7518s
	iters: 200, epoch: 21 | loss: 0.4267249
	speed: 0.1416s/iter; left time: 2928.4829s
Epoch: 21 cost time: 37.206050634384155
Epoch: 21, Steps: 261 | Train Loss: 0.4218243 Vali Loss: 0.3005345 Test Loss: 0.4002130
EarlyStopping counter: 15 out of 20
Updating learning rate to 5.577359705043091e-05
	iters: 100, epoch: 22 | loss: 0.3688717
	speed: 0.7287s/iter; left time: 14953.0595s
	iters: 200, epoch: 22 | loss: 0.4503333
	speed: 0.1377s/iter; left time: 2812.3267s
Epoch: 22 cost time: 37.50873637199402
Epoch: 22, Steps: 261 | Train Loss: 0.4168705 Vali Loss: 0.3009374 Test Loss: 0.3977880
EarlyStopping counter: 16 out of 20
Updating learning rate to 5.951670142097692e-05
	iters: 100, epoch: 23 | loss: 0.4166033
	speed: 0.7330s/iter; left time: 14849.7142s
	iters: 200, epoch: 23 | loss: 0.4875211
	speed: 0.1365s/iter; left time: 2751.2938s
Epoch: 23 cost time: 37.19689679145813
Epoch: 23, Steps: 261 | Train Loss: 0.4119819 Vali Loss: 0.3030290 Test Loss: 0.3960611
EarlyStopping counter: 17 out of 20
Updating learning rate to 6.321345395303321e-05
	iters: 100, epoch: 24 | loss: 0.3912043
	speed: 0.7190s/iter; left time: 14378.1307s
	iters: 200, epoch: 24 | loss: 0.3553827
	speed: 0.1169s/iter; left time: 2325.7493s
Epoch: 24 cost time: 32.27030277252197
Epoch: 24, Steps: 261 | Train Loss: 0.4057092 Vali Loss: 0.3037189 Test Loss: 0.3952252
EarlyStopping counter: 18 out of 20
Updating learning rate to 6.6841058573335e-05
	iters: 100, epoch: 25 | loss: 0.3194732
	speed: 0.7454s/iter; left time: 14712.3476s
	iters: 200, epoch: 25 | loss: 0.3927727
	speed: 0.1445s/iter; left time: 2837.1179s
Epoch: 25 cost time: 38.94753408432007
Epoch: 25, Steps: 261 | Train Loss: 0.4003769 Vali Loss: 0.3063348 Test Loss: 0.3945197
EarlyStopping counter: 19 out of 20
Updating learning rate to 7.037714561012768e-05
	iters: 100, epoch: 26 | loss: 0.3846930
	speed: 0.7743s/iter; left time: 15080.6916s
	iters: 200, epoch: 26 | loss: 0.4881061
	speed: 0.1390s/iter; left time: 2694.1227s
Epoch: 26 cost time: 37.280346632003784
Epoch: 26, Steps: 261 | Train Loss: 0.3934657 Vali Loss: 0.3021065 Test Loss: 0.4025438
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : 336_720_PatchTST_ETTm2_ftM_sl336_ll48_pl720_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
mse:0.3689269423484802, mae:0.3855065703392029, rse:0.48821890354156494
