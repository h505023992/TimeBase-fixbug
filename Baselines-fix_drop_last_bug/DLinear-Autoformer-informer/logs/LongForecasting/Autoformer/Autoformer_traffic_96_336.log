Args in experiment:
Namespace(is_training=1, train_only=False, model_id='Autoformer_traffic_96_336', model='Autoformer', data='custom', root_path='./dataset/', data_path='traffic.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=336, individual=False, embed_type=0, enc_in=862, dec_in=862, c_out=862, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : Autoformer_traffic_96_336_Autoformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11849
val 1421
test 3173
	iters: 100, epoch: 1 | loss: 0.4649436
	speed: 0.1993s/iter; left time: 2198.0407s
	iters: 200, epoch: 1 | loss: 0.3749311
	speed: 0.1736s/iter; left time: 1897.9752s
	iters: 300, epoch: 1 | loss: 0.3335171
	speed: 0.1743s/iter; left time: 1887.3245s
Epoch: 1 cost time: 66.80938696861267
Epoch: 1, Steps: 371 | Train Loss: 0.4274078 Vali Loss: 0.5142995 Test Loss: 0.6728290
Validation loss decreased (inf --> 0.514300).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3171838
	speed: 0.6083s/iter; left time: 6484.8158s
	iters: 200, epoch: 2 | loss: 0.3210534
	speed: 0.1727s/iter; left time: 1824.2093s
	iters: 300, epoch: 2 | loss: 0.3033488
	speed: 0.1740s/iter; left time: 1819.6020s
Epoch: 2 cost time: 65.97687864303589
Epoch: 2, Steps: 371 | Train Loss: 0.3103973 Vali Loss: 0.4998560 Test Loss: 0.6625435
Validation loss decreased (0.514300 --> 0.499856).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2681375
	speed: 0.6186s/iter; left time: 6365.2695s
	iters: 200, epoch: 3 | loss: 0.2733972
	speed: 0.1712s/iter; left time: 1744.6267s
	iters: 300, epoch: 3 | loss: 0.2645761
	speed: 0.1725s/iter; left time: 1740.5054s
Epoch: 3 cost time: 64.76942491531372
Epoch: 3, Steps: 371 | Train Loss: 0.2694172 Vali Loss: 0.4710419 Test Loss: 0.6133973
Validation loss decreased (0.499856 --> 0.471042).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2569403
	speed: 0.6199s/iter; left time: 6148.0973s
	iters: 200, epoch: 4 | loss: 0.2627761
	speed: 0.1787s/iter; left time: 1754.5850s
	iters: 300, epoch: 4 | loss: 0.2649653
	speed: 0.1906s/iter; left time: 1852.2804s
Epoch: 4 cost time: 68.82174682617188
Epoch: 4, Steps: 371 | Train Loss: 0.2564939 Vali Loss: 0.4628347 Test Loss: 0.6259885
Validation loss decreased (0.471042 --> 0.462835).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2444050
	speed: 0.6855s/iter; left time: 6544.0997s
	iters: 200, epoch: 5 | loss: 0.2404395
	speed: 0.1870s/iter; left time: 1766.7134s
	iters: 300, epoch: 5 | loss: 0.2537698
	speed: 0.1891s/iter; left time: 1767.1659s
Epoch: 5 cost time: 70.82864594459534
Epoch: 5, Steps: 371 | Train Loss: 0.2512666 Vali Loss: 0.4627819 Test Loss: 0.6289731
Validation loss decreased (0.462835 --> 0.462782).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2417446
	speed: 0.6637s/iter; left time: 6089.7844s
	iters: 200, epoch: 6 | loss: 0.2454222
	speed: 0.1771s/iter; left time: 1606.9350s
	iters: 300, epoch: 6 | loss: 0.2497064
	speed: 0.1767s/iter; left time: 1585.6487s
Epoch: 6 cost time: 67.10216045379639
Epoch: 6, Steps: 371 | Train Loss: 0.2487047 Vali Loss: 0.4602489 Test Loss: 0.6194181
Validation loss decreased (0.462782 --> 0.460249).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2472637
	speed: 0.6208s/iter; left time: 5466.0088s
	iters: 200, epoch: 7 | loss: 0.2563060
	speed: 0.1709s/iter; left time: 1487.5952s
	iters: 300, epoch: 7 | loss: 0.2541218
	speed: 0.1778s/iter; left time: 1530.0732s
Epoch: 7 cost time: 65.38564443588257
Epoch: 7, Steps: 371 | Train Loss: 0.2473657 Vali Loss: 0.4629085 Test Loss: 0.6207540
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2423323
	speed: 0.6116s/iter; left time: 5157.8167s
	iters: 200, epoch: 8 | loss: 0.2483032
	speed: 0.1773s/iter; left time: 1477.7224s
	iters: 300, epoch: 8 | loss: 0.2482104
	speed: 0.1722s/iter; left time: 1418.2714s
Epoch: 8 cost time: 66.01209330558777
Epoch: 8, Steps: 371 | Train Loss: 0.2464763 Vali Loss: 0.4618939 Test Loss: 0.6214206
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2397888
	speed: 0.6614s/iter; left time: 5332.7403s
	iters: 200, epoch: 9 | loss: 0.2500358
	speed: 0.1705s/iter; left time: 1358.0158s
	iters: 300, epoch: 9 | loss: 0.2525770
	speed: 0.1719s/iter; left time: 1351.9196s
Epoch: 9 cost time: 64.87474656105042
Epoch: 9, Steps: 371 | Train Loss: 0.2461463 Vali Loss: 0.4609762 Test Loss: 0.6210977
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Autoformer_traffic_96_336_Autoformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3173
mse:0.6188846826553345, mae:0.3813995122909546
