Args in experiment:
Namespace(is_training=1, train_only=False, model_id='Autoformer_electricity_96_336', model='Autoformer', data='custom', root_path='./dataset/', data_path='electricity.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=336, individual=False, embed_type=0, enc_in=321, dec_in=321, c_out=321, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : Autoformer_electricity_96_336_Autoformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17981
val 2297
test 4925
	iters: 100, epoch: 1 | loss: 0.3654106
	speed: 0.1565s/iter; left time: 2622.3371s
	iters: 200, epoch: 1 | loss: 0.3363998
	speed: 0.1314s/iter; left time: 2189.6871s
	iters: 300, epoch: 1 | loss: 0.2982853
	speed: 0.1325s/iter; left time: 2193.9486s
	iters: 400, epoch: 1 | loss: 0.2857826
	speed: 0.1319s/iter; left time: 2171.5533s
	iters: 500, epoch: 1 | loss: 0.2718739
	speed: 0.1306s/iter; left time: 2136.7893s
Epoch: 1 cost time: 76.67197036743164
Epoch: 1, Steps: 562 | Train Loss: 0.3326463 Vali Loss: 0.2254156 Test Loss: 0.2640839
Validation loss decreased (inf --> 0.225416).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2445322
	speed: 0.5195s/iter; left time: 8415.8253s
	iters: 200, epoch: 2 | loss: 0.2156299
	speed: 0.1318s/iter; left time: 2122.0366s
	iters: 300, epoch: 2 | loss: 0.2252445
	speed: 0.1326s/iter; left time: 2121.7874s
	iters: 400, epoch: 2 | loss: 0.2067617
	speed: 0.1326s/iter; left time: 2108.6553s
	iters: 500, epoch: 2 | loss: 0.2011757
	speed: 0.1349s/iter; left time: 2131.4604s
Epoch: 2 cost time: 75.71688055992126
Epoch: 2, Steps: 562 | Train Loss: 0.2161759 Vali Loss: 0.1967086 Test Loss: 0.2313691
Validation loss decreased (0.225416 --> 0.196709).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1757436
	speed: 0.5410s/iter; left time: 8459.7627s
	iters: 200, epoch: 3 | loss: 0.1804706
	speed: 0.1354s/iter; left time: 2103.5302s
	iters: 300, epoch: 3 | loss: 0.2016028
	speed: 0.1337s/iter; left time: 2064.2471s
	iters: 400, epoch: 3 | loss: 0.1952626
	speed: 0.1389s/iter; left time: 2129.6548s
	iters: 500, epoch: 3 | loss: 0.1826390
	speed: 0.1349s/iter; left time: 2055.8982s
Epoch: 3 cost time: 76.99131155014038
Epoch: 3, Steps: 562 | Train Loss: 0.1868557 Vali Loss: 0.2408012 Test Loss: 0.3207923
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1867803
	speed: 0.5459s/iter; left time: 8229.3380s
	iters: 200, epoch: 4 | loss: 0.1710350
	speed: 0.1335s/iter; left time: 1999.5831s
	iters: 300, epoch: 4 | loss: 0.1604487
	speed: 0.1314s/iter; left time: 1953.8794s
	iters: 400, epoch: 4 | loss: 0.1824189
	speed: 0.1352s/iter; left time: 1997.1179s
	iters: 500, epoch: 4 | loss: 0.1693870
	speed: 0.1304s/iter; left time: 1913.9537s
Epoch: 4 cost time: 75.60483741760254
Epoch: 4, Steps: 562 | Train Loss: 0.1752635 Vali Loss: 0.3121230 Test Loss: 0.4638240
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1684804
	speed: 0.5247s/iter; left time: 7615.3523s
	iters: 200, epoch: 5 | loss: 0.1807954
	speed: 0.1314s/iter; left time: 1893.9873s
	iters: 300, epoch: 5 | loss: 0.1793552
	speed: 0.1371s/iter; left time: 1961.6433s
	iters: 400, epoch: 5 | loss: 0.1746931
	speed: 0.1351s/iter; left time: 1919.8265s
	iters: 500, epoch: 5 | loss: 0.1692299
	speed: 0.1346s/iter; left time: 1899.2363s
Epoch: 5 cost time: 76.25583958625793
Epoch: 5, Steps: 562 | Train Loss: 0.1701201 Vali Loss: 0.2893578 Test Loss: 0.4360068
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Autoformer_electricity_96_336_Autoformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4925
mse:0.2312646508216858, mae:0.3364627957344055
