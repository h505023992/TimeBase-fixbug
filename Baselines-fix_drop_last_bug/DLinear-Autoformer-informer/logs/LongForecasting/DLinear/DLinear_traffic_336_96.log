Args in experiment:
Namespace(is_training=1, train_only=False, model_id='DLinear_traffic_336_96', model='DLinear', data='custom', root_path='./dataset/', data_path='traffic.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, individual=False, embed_type=0, enc_in=862, dec_in=862, c_out=862, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DLinear_traffic_336_96_DLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11849
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.5572790
	speed: 0.0940s/iter; left time: 1037.0334s
	iters: 200, epoch: 1 | loss: 0.4299823
	speed: 0.0711s/iter; left time: 777.7311s
	iters: 300, epoch: 1 | loss: 0.3755941
	speed: 0.0774s/iter; left time: 838.5036s
Epoch: 1 cost time: 29.959638833999634
Epoch: 1, Steps: 371 | Train Loss: 0.5148388 Vali Loss: 0.4935783 Test Loss: 0.6042836
Validation loss decreased (inf --> 0.493578).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3497161
	speed: 0.3943s/iter; left time: 4202.9040s
	iters: 200, epoch: 2 | loss: 0.3261873
	speed: 0.0826s/iter; left time: 871.7851s
	iters: 300, epoch: 2 | loss: 0.3022282
	speed: 0.0830s/iter; left time: 867.9089s
Epoch: 2 cost time: 31.91828465461731
Epoch: 2, Steps: 371 | Train Loss: 0.3339630 Vali Loss: 0.4158346 Test Loss: 0.5095190
Validation loss decreased (0.493578 --> 0.415835).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3065815
	speed: 0.3661s/iter; left time: 3766.9638s
	iters: 200, epoch: 3 | loss: 0.2953041
	speed: 0.0716s/iter; left time: 729.3854s
	iters: 300, epoch: 3 | loss: 0.2980742
	speed: 0.0744s/iter; left time: 750.5268s
Epoch: 3 cost time: 28.696996688842773
Epoch: 3, Steps: 371 | Train Loss: 0.3016234 Vali Loss: 0.3977547 Test Loss: 0.4869363
Validation loss decreased (0.415835 --> 0.397755).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2927342
	speed: 0.3217s/iter; left time: 3190.4295s
	iters: 200, epoch: 4 | loss: 0.3252963
	speed: 0.0701s/iter; left time: 688.3963s
	iters: 300, epoch: 4 | loss: 0.2763306
	speed: 0.0674s/iter; left time: 654.9636s
Epoch: 4 cost time: 26.462473154067993
Epoch: 4, Steps: 371 | Train Loss: 0.2917773 Vali Loss: 0.3903161 Test Loss: 0.4776952
Validation loss decreased (0.397755 --> 0.390316).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2862287
	speed: 0.3482s/iter; left time: 3324.1655s
	iters: 200, epoch: 5 | loss: 0.2973565
	speed: 0.0723s/iter; left time: 682.7373s
	iters: 300, epoch: 5 | loss: 0.2851447
	speed: 0.0715s/iter; left time: 668.4849s
Epoch: 5 cost time: 28.87403392791748
Epoch: 5, Steps: 371 | Train Loss: 0.2873425 Vali Loss: 0.3869067 Test Loss: 0.4733497
Validation loss decreased (0.390316 --> 0.386907).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2833800
	speed: 0.3419s/iter; left time: 3137.2177s
	iters: 200, epoch: 6 | loss: 0.2972876
	speed: 0.0747s/iter; left time: 677.6561s
	iters: 300, epoch: 6 | loss: 0.2908511
	speed: 0.0805s/iter; left time: 722.3365s
Epoch: 6 cost time: 29.613481521606445
Epoch: 6, Steps: 371 | Train Loss: 0.2852536 Vali Loss: 0.3852200 Test Loss: 0.4712026
Validation loss decreased (0.386907 --> 0.385220).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3096402
	speed: 0.3548s/iter; left time: 3123.9601s
	iters: 200, epoch: 7 | loss: 0.2795668
	speed: 0.0664s/iter; left time: 577.7683s
	iters: 300, epoch: 7 | loss: 0.2792076
	speed: 0.0692s/iter; left time: 595.6667s
Epoch: 7 cost time: 27.00938868522644
Epoch: 7, Steps: 371 | Train Loss: 0.2842574 Vali Loss: 0.3843863 Test Loss: 0.4701153
Validation loss decreased (0.385220 --> 0.384386).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2866991
	speed: 0.3487s/iter; left time: 2941.1378s
	iters: 200, epoch: 8 | loss: 0.2691360
	speed: 0.0807s/iter; left time: 672.5732s
	iters: 300, epoch: 8 | loss: 0.2753766
	speed: 0.0764s/iter; left time: 629.0750s
Epoch: 8 cost time: 29.832786083221436
Epoch: 8, Steps: 371 | Train Loss: 0.2836895 Vali Loss: 0.3839109 Test Loss: 0.4695354
Validation loss decreased (0.384386 --> 0.383911).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2731179
	speed: 0.3516s/iter; left time: 2834.6110s
	iters: 200, epoch: 9 | loss: 0.2967612
	speed: 0.0774s/iter; left time: 616.1047s
	iters: 300, epoch: 9 | loss: 0.2800121
	speed: 0.0777s/iter; left time: 611.3189s
Epoch: 9 cost time: 30.65120267868042
Epoch: 9, Steps: 371 | Train Loss: 0.2833627 Vali Loss: 0.3836391 Test Loss: 0.4692304
Validation loss decreased (0.383911 --> 0.383639).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3029767
	speed: 0.3751s/iter; left time: 2885.3396s
	iters: 200, epoch: 10 | loss: 0.2816778
	speed: 0.0724s/iter; left time: 549.8299s
	iters: 300, epoch: 10 | loss: 0.2900556
	speed: 0.0728s/iter; left time: 545.2027s
Epoch: 10 cost time: 28.164695978164673
Epoch: 10, Steps: 371 | Train Loss: 0.2833108 Vali Loss: 0.3835112 Test Loss: 0.4690735
Validation loss decreased (0.383639 --> 0.383511).  Saving model ...
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.2878888
	speed: 0.3307s/iter; left time: 2421.3827s
	iters: 200, epoch: 11 | loss: 0.2674677
	speed: 0.0761s/iter; left time: 549.3498s
	iters: 300, epoch: 11 | loss: 0.2916552
	speed: 0.0770s/iter; left time: 547.9619s
Epoch: 11 cost time: 29.33511996269226
Epoch: 11, Steps: 371 | Train Loss: 0.2831575 Vali Loss: 0.3834591 Test Loss: 0.4689956
Validation loss decreased (0.383511 --> 0.383459).  Saving model ...
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.2948677
	speed: 0.3591s/iter; left time: 2495.7790s
	iters: 200, epoch: 12 | loss: 0.2792453
	speed: 0.0721s/iter; left time: 493.7031s
	iters: 300, epoch: 12 | loss: 0.2905467
	speed: 0.0730s/iter; left time: 492.6507s
Epoch: 12 cost time: 28.555842876434326
Epoch: 12, Steps: 371 | Train Loss: 0.2832701 Vali Loss: 0.3834352 Test Loss: 0.4689549
Validation loss decreased (0.383459 --> 0.383435).  Saving model ...
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.2835473
	speed: 0.3530s/iter; left time: 2322.6808s
	iters: 200, epoch: 13 | loss: 0.2742292
	speed: 0.0744s/iter; left time: 482.0283s
	iters: 300, epoch: 13 | loss: 0.2721702
	speed: 0.0756s/iter; left time: 482.4335s
Epoch: 13 cost time: 28.80043935775757
Epoch: 13, Steps: 371 | Train Loss: 0.2830711 Vali Loss: 0.3834453 Test Loss: 0.4689337
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.3121342
	speed: 0.3681s/iter; left time: 2285.3989s
	iters: 200, epoch: 14 | loss: 0.2871408
	speed: 0.0801s/iter; left time: 489.4566s
	iters: 300, epoch: 14 | loss: 0.2654644
	speed: 0.0770s/iter; left time: 462.6929s
Epoch: 14 cost time: 30.459553003311157
Epoch: 14, Steps: 371 | Train Loss: 0.2831170 Vali Loss: 0.3833939 Test Loss: 0.4689232
Validation loss decreased (0.383435 --> 0.383394).  Saving model ...
Updating learning rate to 1.220703125e-08
	iters: 100, epoch: 15 | loss: 0.2927742
	speed: 0.3994s/iter; left time: 2331.5709s
	iters: 200, epoch: 15 | loss: 0.2662299
	speed: 0.0860s/iter; left time: 493.3925s
	iters: 300, epoch: 15 | loss: 0.2805283
	speed: 0.0845s/iter; left time: 476.2705s
Epoch: 15 cost time: 32.543681621551514
Epoch: 15, Steps: 371 | Train Loss: 0.2831026 Vali Loss: 0.3834039 Test Loss: 0.4689181
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.103515625e-09
	iters: 100, epoch: 16 | loss: 0.2812228
	speed: 0.3715s/iter; left time: 2030.5871s
	iters: 200, epoch: 16 | loss: 0.2695724
	speed: 0.0764s/iter; left time: 410.1767s
	iters: 300, epoch: 16 | loss: 0.2809564
	speed: 0.0791s/iter; left time: 416.7736s
Epoch: 16 cost time: 29.982413291931152
Epoch: 16, Steps: 371 | Train Loss: 0.2831590 Vali Loss: 0.3834335 Test Loss: 0.4689155
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.0517578125e-09
	iters: 100, epoch: 17 | loss: 0.2863922
	speed: 0.3539s/iter; left time: 1802.9974s
	iters: 200, epoch: 17 | loss: 0.2753017
	speed: 0.0723s/iter; left time: 361.1695s
	iters: 300, epoch: 17 | loss: 0.2800301
	speed: 0.0714s/iter; left time: 349.2760s
Epoch: 17 cost time: 27.97766876220703
Epoch: 17, Steps: 371 | Train Loss: 0.2830910 Vali Loss: 0.3833988 Test Loss: 0.4689145
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : DLinear_traffic_336_96_DLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
mse:0.4690619707107544, mae:0.3499029278755188
