Args in experiment:
Namespace(is_training=1, model_id='ETTm1_96_336', model='iTransformer', data='ETTm1', root_path='./dataset/', data_path='ETTm1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=336, enc_in=7, dec_in=7, c_out=7, d_model=128, n_heads=8, e_layers=2, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='MSE', lradj='type1', use_amp=False, use_gpu=True, gpu=2, use_multi_gpu=False, devices='0,1,2,3', exp_name='MTSF', channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv', efficient_training=False, use_norm=True, partial_start_index=0)
Use GPU: cuda:2
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.dropout.Dropout'>.
[INFO] Register count_convNd() for <class 'torch.nn.modules.conv.Conv1d'>.
[INFO] Register count_normalization() for <class 'torch.nn.modules.normalization.LayerNorm'>.
MACs: 3308032.0
Params: 255184.0
3.31M MACs
>>>>>>>start training : ETTm1_96_336_iTransformer_ETTm1_M_ft96_sl48_ll336_pl128_dm8_nh2_el1_dl128_df1_fctimeF_ebTrue_dtExp_projection_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.4614734
	speed: 0.0561s/iter; left time: 592.7702s
	iters: 200, epoch: 1 | loss: 0.5470124
	speed: 0.0313s/iter; left time: 327.5947s
	iters: 300, epoch: 1 | loss: 0.4064466
	speed: 0.0317s/iter; left time: 328.3058s
	iters: 400, epoch: 1 | loss: 0.3689108
	speed: 0.0322s/iter; left time: 329.9732s
	iters: 500, epoch: 1 | loss: 0.4341051
	speed: 0.0333s/iter; left time: 337.9155s
	iters: 600, epoch: 1 | loss: 0.3222049
	speed: 0.0318s/iter; left time: 319.8907s
	iters: 700, epoch: 1 | loss: 0.3971123
	speed: 0.0345s/iter; left time: 344.0221s
	iters: 800, epoch: 1 | loss: 0.4862398
	speed: 0.0331s/iter; left time: 326.3218s
	iters: 900, epoch: 1 | loss: 0.5301145
	speed: 0.0330s/iter; left time: 321.7022s
	iters: 1000, epoch: 1 | loss: 0.4086527
	speed: 0.0312s/iter; left time: 301.8351s
Max Memory (MB): 14.0625
Epoch: 1 cost time: 36.94679832458496
Epoch: 1, Steps: 1066 | Train Loss: 0.4383777 Vali Loss: 0.6688288 Test Loss: 0.4253529
Validation loss decreased (inf --> 0.668829).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3436666
	speed: 1.2530s/iter; left time: 11897.0897s
	iters: 200, epoch: 2 | loss: 0.4272983
	speed: 0.0342s/iter; left time: 321.6916s
	iters: 300, epoch: 2 | loss: 0.3512011
	speed: 0.0342s/iter; left time: 317.4763s
	iters: 400, epoch: 2 | loss: 0.3183121
	speed: 0.0339s/iter; left time: 311.7983s
	iters: 500, epoch: 2 | loss: 0.5220173
	speed: 0.0353s/iter; left time: 321.0222s
	iters: 600, epoch: 2 | loss: 0.3943527
	speed: 0.0350s/iter; left time: 315.2290s
	iters: 700, epoch: 2 | loss: 0.2911910
	speed: 0.0350s/iter; left time: 311.2247s
	iters: 800, epoch: 2 | loss: 0.4389449
	speed: 0.0337s/iter; left time: 296.3916s
	iters: 900, epoch: 2 | loss: 0.3395316
	speed: 0.0329s/iter; left time: 286.2689s
	iters: 1000, epoch: 2 | loss: 0.3631792
	speed: 0.0338s/iter; left time: 290.1124s
Max Memory (MB): 14.0625
Epoch: 2 cost time: 36.81743931770325
Epoch: 2, Steps: 1066 | Train Loss: 0.3976045 Vali Loss: 0.6632724 Test Loss: 0.4210357
Validation loss decreased (0.668829 --> 0.663272).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4388179
	speed: 1.2926s/iter; left time: 10895.3082s
	iters: 200, epoch: 3 | loss: 0.4484075
	speed: 0.0287s/iter; left time: 238.8764s
	iters: 300, epoch: 3 | loss: 0.3714486
	speed: 0.0292s/iter; left time: 240.6362s
	iters: 400, epoch: 3 | loss: 0.3626482
	speed: 0.0306s/iter; left time: 248.7277s
	iters: 500, epoch: 3 | loss: 0.3833033
	speed: 0.0273s/iter; left time: 219.0445s
	iters: 600, epoch: 3 | loss: 0.4256202
	speed: 0.0283s/iter; left time: 224.3192s
	iters: 700, epoch: 3 | loss: 0.4458309
	speed: 0.0280s/iter; left time: 219.5850s
	iters: 800, epoch: 3 | loss: 0.3685665
	speed: 0.0277s/iter; left time: 213.7381s
	iters: 900, epoch: 3 | loss: 0.3719545
	speed: 0.0288s/iter; left time: 220.0768s
	iters: 1000, epoch: 3 | loss: 0.3912585
	speed: 0.0291s/iter; left time: 219.3837s
Max Memory (MB): 14.0625
Epoch: 3 cost time: 31.223227977752686
Epoch: 3, Steps: 1066 | Train Loss: 0.3882459 Vali Loss: 0.6578048 Test Loss: 0.4182768
Validation loss decreased (0.663272 --> 0.657805).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3651638
	speed: 1.2040s/iter; left time: 8865.1117s
	iters: 200, epoch: 4 | loss: 0.3119359
	speed: 0.0318s/iter; left time: 231.1053s
	iters: 300, epoch: 4 | loss: 0.3782991
	speed: 0.0326s/iter; left time: 233.3467s
	iters: 400, epoch: 4 | loss: 0.5144920
	speed: 0.0310s/iter; left time: 219.2735s
	iters: 500, epoch: 4 | loss: 0.3662098
	speed: 0.0318s/iter; left time: 221.2754s
	iters: 600, epoch: 4 | loss: 0.3423735
	speed: 0.0298s/iter; left time: 204.2806s
	iters: 700, epoch: 4 | loss: 0.3748248
	speed: 0.0325s/iter; left time: 219.7544s
	iters: 800, epoch: 4 | loss: 0.3697725
	speed: 0.0305s/iter; left time: 203.3587s
	iters: 900, epoch: 4 | loss: 0.3377109
	speed: 0.0296s/iter; left time: 194.1092s
	iters: 1000, epoch: 4 | loss: 0.3962568
	speed: 0.0284s/iter; left time: 183.3831s
Max Memory (MB): 14.0625
Epoch: 4 cost time: 33.66498374938965
Epoch: 4, Steps: 1066 | Train Loss: 0.3846490 Vali Loss: 0.6570609 Test Loss: 0.4169585
Validation loss decreased (0.657805 --> 0.657061).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3282863
	speed: 1.1597s/iter; left time: 7302.5630s
	iters: 200, epoch: 5 | loss: 0.4294032
	speed: 0.0289s/iter; left time: 179.0473s
	iters: 300, epoch: 5 | loss: 0.3746975
	speed: 0.0281s/iter; left time: 171.5289s
	iters: 400, epoch: 5 | loss: 0.3831740
	speed: 0.0286s/iter; left time: 171.5274s
	iters: 500, epoch: 5 | loss: 0.3198777
	speed: 0.0285s/iter; left time: 167.8187s
	iters: 600, epoch: 5 | loss: 0.4102818
	speed: 0.0282s/iter; left time: 163.2986s
	iters: 700, epoch: 5 | loss: 0.2988605
	speed: 0.0294s/iter; left time: 167.4042s
	iters: 800, epoch: 5 | loss: 0.4325261
	speed: 0.0281s/iter; left time: 157.1839s
	iters: 900, epoch: 5 | loss: 0.4231248
	speed: 0.0289s/iter; left time: 158.6143s
	iters: 1000, epoch: 5 | loss: 0.4493901
	speed: 0.0297s/iter; left time: 160.0346s
Max Memory (MB): 14.0625
Epoch: 5 cost time: 31.555389642715454
Epoch: 5, Steps: 1066 | Train Loss: 0.3829598 Vali Loss: 0.6575255 Test Loss: 0.4172153
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3620658
	speed: 1.1913s/iter; left time: 6231.4574s
	iters: 200, epoch: 6 | loss: 0.3030743
	speed: 0.0339s/iter; left time: 173.7738s
	iters: 300, epoch: 6 | loss: 0.3527762
	speed: 0.0329s/iter; left time: 165.4602s
	iters: 400, epoch: 6 | loss: 0.3561655
	speed: 0.0322s/iter; left time: 158.8113s
	iters: 500, epoch: 6 | loss: 0.3760795
	speed: 0.0309s/iter; left time: 149.4655s
	iters: 600, epoch: 6 | loss: 0.4269194
	speed: 0.0317s/iter; left time: 149.7706s
	iters: 700, epoch: 6 | loss: 0.3476864
	speed: 0.0297s/iter; left time: 137.4549s
	iters: 800, epoch: 6 | loss: 0.3913496
	speed: 0.0324s/iter; left time: 146.7513s
	iters: 900, epoch: 6 | loss: 0.3315775
	speed: 0.0319s/iter; left time: 141.4160s
	iters: 1000, epoch: 6 | loss: 0.3722997
	speed: 0.0322s/iter; left time: 139.3181s
Max Memory (MB): 14.0625
Epoch: 6 cost time: 34.69936466217041
Epoch: 6, Steps: 1066 | Train Loss: 0.3822868 Vali Loss: 0.6563523 Test Loss: 0.4168821
Validation loss decreased (0.657061 --> 0.656352).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3351798
	speed: 1.2134s/iter; left time: 5053.7857s
	iters: 200, epoch: 7 | loss: 0.4016938
	speed: 0.0327s/iter; left time: 133.1101s
	iters: 300, epoch: 7 | loss: 0.3640064
	speed: 0.0331s/iter; left time: 131.3427s
	iters: 400, epoch: 7 | loss: 0.3729106
	speed: 0.0323s/iter; left time: 124.9914s
	iters: 500, epoch: 7 | loss: 0.3682003
	speed: 0.0325s/iter; left time: 122.4549s
	iters: 600, epoch: 7 | loss: 0.3928836
	speed: 0.0314s/iter; left time: 115.1474s
	iters: 700, epoch: 7 | loss: 0.3205780
	speed: 0.0340s/iter; left time: 121.3039s
	iters: 800, epoch: 7 | loss: 0.3438719
	speed: 0.0331s/iter; left time: 114.7185s
	iters: 900, epoch: 7 | loss: 0.4363927
	speed: 0.0369s/iter; left time: 124.1768s
	iters: 1000, epoch: 7 | loss: 0.4121918
	speed: 0.0296s/iter; left time: 96.7701s
Max Memory (MB): 14.0625
Epoch: 7 cost time: 35.74263882637024
Epoch: 7, Steps: 1066 | Train Loss: 0.3817817 Vali Loss: 0.6559293 Test Loss: 0.4171600
Validation loss decreased (0.656352 --> 0.655929).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4149607
	speed: 1.1766s/iter; left time: 3646.2996s
	iters: 200, epoch: 8 | loss: 0.3858800
	speed: 0.0298s/iter; left time: 89.3032s
	iters: 300, epoch: 8 | loss: 0.3313701
	speed: 0.0302s/iter; left time: 87.5020s
	iters: 400, epoch: 8 | loss: 0.3611390
	speed: 0.0297s/iter; left time: 83.1018s
	iters: 500, epoch: 8 | loss: 0.3602868
	speed: 0.0302s/iter; left time: 81.3997s
	iters: 600, epoch: 8 | loss: 0.4119153
	speed: 0.0291s/iter; left time: 75.7281s
	iters: 700, epoch: 8 | loss: 0.4960386
	speed: 0.0300s/iter; left time: 75.0024s
	iters: 800, epoch: 8 | loss: 0.4176748
	speed: 0.0314s/iter; left time: 75.2386s
	iters: 900, epoch: 8 | loss: 0.3433349
	speed: 0.0288s/iter; left time: 66.1439s
	iters: 1000, epoch: 8 | loss: 0.3457140
	speed: 0.0305s/iter; left time: 67.0116s
Max Memory (MB): 14.0625
Epoch: 8 cost time: 32.47857308387756
Epoch: 8, Steps: 1066 | Train Loss: 0.3815448 Vali Loss: 0.6563451 Test Loss: 0.4169383
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.4502224
	speed: 1.2418s/iter; left time: 2524.5425s
	iters: 200, epoch: 9 | loss: 0.4202052
	speed: 0.0296s/iter; left time: 57.1747s
	iters: 300, epoch: 9 | loss: 0.4254747
	speed: 0.0301s/iter; left time: 55.1904s
	iters: 400, epoch: 9 | loss: 0.3433152
	speed: 0.0300s/iter; left time: 52.0454s
	iters: 500, epoch: 9 | loss: 0.3649232
	speed: 0.0292s/iter; left time: 47.7479s
	iters: 600, epoch: 9 | loss: 0.3559214
	speed: 0.0301s/iter; left time: 46.2037s
	iters: 700, epoch: 9 | loss: 0.4044304
	speed: 0.0287s/iter; left time: 41.1240s
	iters: 800, epoch: 9 | loss: 0.4106148
	speed: 0.0299s/iter; left time: 39.8522s
	iters: 900, epoch: 9 | loss: 0.3710123
	speed: 0.0303s/iter; left time: 37.3926s
	iters: 1000, epoch: 9 | loss: 0.3642431
	speed: 0.0292s/iter; left time: 33.0605s
Max Memory (MB): 14.0625
Epoch: 9 cost time: 32.64746689796448
Epoch: 9, Steps: 1066 | Train Loss: 0.3815084 Vali Loss: 0.6560660 Test Loss: 0.4169458
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3631428
	speed: 1.1755s/iter; left time: 1136.7231s
	iters: 200, epoch: 10 | loss: 0.3574655
	speed: 0.0325s/iter; left time: 28.2184s
	iters: 300, epoch: 10 | loss: 0.3781213
	speed: 0.0329s/iter; left time: 25.2117s
	iters: 400, epoch: 10 | loss: 0.4364031
	speed: 0.0322s/iter; left time: 21.4923s
	iters: 500, epoch: 10 | loss: 0.3282993
	speed: 0.0310s/iter; left time: 17.6003s
	iters: 600, epoch: 10 | loss: 0.3469038
	speed: 0.0309s/iter; left time: 14.4113s
	iters: 700, epoch: 10 | loss: 0.3378015
	speed: 0.0303s/iter; left time: 11.1378s
	iters: 800, epoch: 10 | loss: 0.3919999
	speed: 0.0297s/iter; left time: 7.9279s
	iters: 900, epoch: 10 | loss: 0.3417933
	speed: 0.0304s/iter; left time: 5.0744s
	iters: 1000, epoch: 10 | loss: 0.3116277
	speed: 0.0336s/iter; left time: 2.2523s
Max Memory (MB): 14.0625
Epoch: 10 cost time: 34.37877678871155
Epoch: 10, Steps: 1066 | Train Loss: 0.3813928 Vali Loss: 0.6564231 Test Loss: 0.4169437
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm1_96_336_iTransformer_ETTm1_M_ft96_sl48_ll336_pl128_dm8_nh2_el1_dl128_df1_fctimeF_ebTrue_dtExp_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
test shape: (11185, 1, 336, 7) (11185, 1, 336, 7)
test shape: (11185, 336, 7) (11185, 336, 7)
mse:0.4171597361564636, mae:0.417454332113266
