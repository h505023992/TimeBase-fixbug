Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='192_720', model='PatchTST', data='custom', root_path='./dataset/', data_path='weather.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=192, label_len=48, pred_len=720, fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=21, dec_in=7, c_out=7, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=32, patience=5, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=1, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:1
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.dropout.Dropout'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.container.Sequential'>.
[INFO] Register count_normalization() for <class 'torch.nn.modules.batchnorm.BatchNorm1d'>.
MACs: 247209984.0
Params: 2612176.0
247.21M MACs
>>>>>>>start training : 192_720_PatchTST_custom_ftM_sl192_ll48_pl720_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35976
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.6631361
	speed: 0.0893s/iter; left time: 3003.7259s
	iters: 200, epoch: 1 | loss: 1.2432499
	speed: 0.0717s/iter; left time: 2406.8071s
	iters: 300, epoch: 1 | loss: 0.8841554
	speed: 0.0765s/iter; left time: 2560.4377s
	iters: 400, epoch: 1 | loss: 0.6131988
	speed: 0.0798s/iter; left time: 2661.6148s
	iters: 500, epoch: 1 | loss: 0.8125552
	speed: 0.0776s/iter; left time: 2579.1005s
	iters: 600, epoch: 1 | loss: 0.8035398
	speed: 0.0737s/iter; left time: 2442.0687s
	iters: 700, epoch: 1 | loss: 0.6609525
	speed: 0.0753s/iter; left time: 2490.3151s
	iters: 800, epoch: 1 | loss: 0.6898182
	speed: 0.0764s/iter; left time: 2518.3212s
	iters: 900, epoch: 1 | loss: 0.7059581
	speed: 0.0695s/iter; left time: 2283.2383s
	iters: 1000, epoch: 1 | loss: 0.6979939
	speed: 0.0734s/iter; left time: 2403.5543s
	iters: 1100, epoch: 1 | loss: 0.6766078
	speed: 0.0757s/iter; left time: 2470.1060s
Epoch: 1 cost time: 85.82691860198975
Epoch: 1, Steps: 1125 | Train Loss: 0.8493491 Vali Loss: 0.7636777 Test Loss: 0.3663949
Validation loss decreased (inf --> 0.763678).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6821015
	speed: 0.4906s/iter; left time: 15956.7507s
	iters: 200, epoch: 2 | loss: 0.5997921
	speed: 0.0685s/iter; left time: 2222.7293s
	iters: 300, epoch: 2 | loss: 0.5680093
	speed: 0.0687s/iter; left time: 2219.6108s
	iters: 400, epoch: 2 | loss: 0.7004158
	speed: 0.0689s/iter; left time: 2219.0382s
	iters: 500, epoch: 2 | loss: 0.6534822
	speed: 0.0715s/iter; left time: 2296.0165s
	iters: 600, epoch: 2 | loss: 0.6880887
	speed: 0.0742s/iter; left time: 2375.0881s
	iters: 700, epoch: 2 | loss: 0.5855684
	speed: 0.0672s/iter; left time: 2145.0120s
	iters: 800, epoch: 2 | loss: 0.7788162
	speed: 0.0644s/iter; left time: 2049.0244s
	iters: 900, epoch: 2 | loss: 0.5559742
	speed: 0.0686s/iter; left time: 2175.6748s
	iters: 1000, epoch: 2 | loss: 0.6606245
	speed: 0.0658s/iter; left time: 2081.9715s
	iters: 1100, epoch: 2 | loss: 0.6540786
	speed: 0.0693s/iter; left time: 2183.4090s
Epoch: 2 cost time: 78.89494752883911
Epoch: 2, Steps: 1125 | Train Loss: 0.6779857 Vali Loss: 0.6950470 Test Loss: 0.3408213
Validation loss decreased (0.763678 --> 0.695047).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.6762562
	speed: 0.4356s/iter; left time: 13679.5871s
	iters: 200, epoch: 3 | loss: 0.7315343
	speed: 0.0671s/iter; left time: 2101.2332s
	iters: 300, epoch: 3 | loss: 0.6428277
	speed: 0.0669s/iter; left time: 2085.9307s
	iters: 400, epoch: 3 | loss: 0.7270271
	speed: 0.0654s/iter; left time: 2035.4474s
	iters: 500, epoch: 3 | loss: 1.0129941
	speed: 0.0662s/iter; left time: 2051.8019s
	iters: 600, epoch: 3 | loss: 0.8440334
	speed: 0.0669s/iter; left time: 2067.0464s
	iters: 700, epoch: 3 | loss: 0.8810934
	speed: 0.0635s/iter; left time: 1956.4122s
	iters: 800, epoch: 3 | loss: 0.7448158
	speed: 0.0813s/iter; left time: 2497.4889s
	iters: 900, epoch: 3 | loss: 0.6005618
	speed: 0.0743s/iter; left time: 2274.0307s
	iters: 1000, epoch: 3 | loss: 0.6033701
	speed: 0.0743s/iter; left time: 2267.1845s
	iters: 1100, epoch: 3 | loss: 0.8109896
	speed: 0.0737s/iter; left time: 2240.5509s
Epoch: 3 cost time: 79.91675281524658
Epoch: 3, Steps: 1125 | Train Loss: 0.6536546 Vali Loss: 0.6923323 Test Loss: 0.3373787
Validation loss decreased (0.695047 --> 0.692332).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.6149625
	speed: 0.4888s/iter; left time: 14798.4035s
	iters: 200, epoch: 4 | loss: 0.5765536
	speed: 0.0709s/iter; left time: 2140.0695s
	iters: 300, epoch: 4 | loss: 0.5886346
	speed: 0.0821s/iter; left time: 2470.6912s
	iters: 400, epoch: 4 | loss: 0.6542282
	speed: 0.0677s/iter; left time: 2030.0230s
	iters: 500, epoch: 4 | loss: 0.4674849
	speed: 0.0671s/iter; left time: 2005.2816s
	iters: 600, epoch: 4 | loss: 0.5762944
	speed: 0.0715s/iter; left time: 2129.4848s
	iters: 700, epoch: 4 | loss: 0.5594647
	speed: 0.0810s/iter; left time: 2403.6925s
	iters: 800, epoch: 4 | loss: 0.8266690
	speed: 0.0773s/iter; left time: 2286.4024s
	iters: 900, epoch: 4 | loss: 0.5676718
	speed: 0.0719s/iter; left time: 2119.4282s
	iters: 1000, epoch: 4 | loss: 0.5738268
	speed: 0.0734s/iter; left time: 2156.1639s
	iters: 1100, epoch: 4 | loss: 0.5407369
	speed: 0.0745s/iter; left time: 2180.8657s
Epoch: 4 cost time: 84.18203401565552
Epoch: 4, Steps: 1125 | Train Loss: 0.6445904 Vali Loss: 0.6845958 Test Loss: 0.3346399
Validation loss decreased (0.692332 --> 0.684596).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.7346779
	speed: 0.4617s/iter; left time: 13458.1366s
	iters: 200, epoch: 5 | loss: 0.5538337
	speed: 0.0726s/iter; left time: 2109.8161s
	iters: 300, epoch: 5 | loss: 0.5891063
	speed: 0.0779s/iter; left time: 2254.1470s
	iters: 400, epoch: 5 | loss: 0.6709679
	speed: 0.0696s/iter; left time: 2007.8990s
	iters: 500, epoch: 5 | loss: 0.5233636
	speed: 0.0715s/iter; left time: 2054.6438s
	iters: 600, epoch: 5 | loss: 0.5860696
	speed: 0.0785s/iter; left time: 2249.9074s
	iters: 700, epoch: 5 | loss: 0.6063839
	speed: 0.0758s/iter; left time: 2164.7623s
	iters: 800, epoch: 5 | loss: 0.5958508
	speed: 0.0790s/iter; left time: 2248.7548s
	iters: 900, epoch: 5 | loss: 0.5498018
	speed: 0.0752s/iter; left time: 2131.8847s
	iters: 1000, epoch: 5 | loss: 0.7064922
	speed: 0.0750s/iter; left time: 2118.3884s
	iters: 1100, epoch: 5 | loss: 0.6163865
	speed: 0.0750s/iter; left time: 2110.6290s
Epoch: 5 cost time: 84.94935917854309
Epoch: 5, Steps: 1125 | Train Loss: 0.6392281 Vali Loss: 0.6904507 Test Loss: 0.3359763
EarlyStopping counter: 1 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.5078874
	speed: 0.4721s/iter; left time: 13230.2029s
	iters: 200, epoch: 6 | loss: 0.6020396
	speed: 0.0803s/iter; left time: 2242.9131s
	iters: 300, epoch: 6 | loss: 0.7022730
	speed: 0.0703s/iter; left time: 1956.8995s
	iters: 400, epoch: 6 | loss: 0.6645623
	speed: 0.0698s/iter; left time: 1935.7695s
	iters: 500, epoch: 6 | loss: 0.6679203
	speed: 0.0704s/iter; left time: 1944.8878s
	iters: 600, epoch: 6 | loss: 0.5782774
	speed: 0.0862s/iter; left time: 2372.4997s
	iters: 700, epoch: 6 | loss: 0.7937256
	speed: 0.0757s/iter; left time: 2074.9394s
	iters: 800, epoch: 6 | loss: 0.5408906
	speed: 0.0760s/iter; left time: 2075.4154s
	iters: 900, epoch: 6 | loss: 0.6426228
	speed: 0.0743s/iter; left time: 2022.4817s
	iters: 1000, epoch: 6 | loss: 0.5705046
	speed: 0.0744s/iter; left time: 2018.5960s
	iters: 1100, epoch: 6 | loss: 0.5553202
	speed: 0.0754s/iter; left time: 2037.1365s
Epoch: 6 cost time: 85.17430305480957
Epoch: 6, Steps: 1125 | Train Loss: 0.6343778 Vali Loss: 0.6822341 Test Loss: 0.3337239
Validation loss decreased (0.684596 --> 0.682234).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.7822093
	speed: 0.4967s/iter; left time: 13362.9062s
	iters: 200, epoch: 7 | loss: 0.7146667
	speed: 0.0709s/iter; left time: 1899.8631s
	iters: 300, epoch: 7 | loss: 0.5753135
	speed: 0.0683s/iter; left time: 1822.5360s
	iters: 400, epoch: 7 | loss: 0.6062659
	speed: 0.0707s/iter; left time: 1880.5413s
	iters: 500, epoch: 7 | loss: 0.6898275
	speed: 0.0840s/iter; left time: 2227.0168s
	iters: 600, epoch: 7 | loss: 0.7600709
	speed: 0.0718s/iter; left time: 1894.8121s
	iters: 700, epoch: 7 | loss: 0.5505555
	speed: 0.0763s/iter; left time: 2005.9545s
	iters: 800, epoch: 7 | loss: 0.7350677
	speed: 0.0757s/iter; left time: 1983.5448s
	iters: 900, epoch: 7 | loss: 0.6252891
	speed: 0.0751s/iter; left time: 1959.4105s
	iters: 1000, epoch: 7 | loss: 0.6418940
	speed: 0.0776s/iter; left time: 2017.3743s
	iters: 1100, epoch: 7 | loss: 0.6438587
	speed: 0.0712s/iter; left time: 1844.0533s
Epoch: 7 cost time: 85.52052617073059
Epoch: 7, Steps: 1125 | Train Loss: 0.6307140 Vali Loss: 0.6781970 Test Loss: 0.3332642
Validation loss decreased (0.682234 --> 0.678197).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.5384684
	speed: 0.4866s/iter; left time: 12542.4740s
	iters: 200, epoch: 8 | loss: 0.7756512
	speed: 0.0695s/iter; left time: 1785.7564s
	iters: 300, epoch: 8 | loss: 0.8839507
	speed: 0.0666s/iter; left time: 1703.8850s
	iters: 400, epoch: 8 | loss: 0.7226145
	speed: 0.0803s/iter; left time: 2044.7391s
	iters: 500, epoch: 8 | loss: 0.5268403
	speed: 0.0788s/iter; left time: 2000.7437s
	iters: 600, epoch: 8 | loss: 0.6976210
	speed: 0.0716s/iter; left time: 1809.4867s
	iters: 700, epoch: 8 | loss: 0.5441250
	speed: 0.0679s/iter; left time: 1708.9408s
	iters: 800, epoch: 8 | loss: 0.6383359
	speed: 0.0743s/iter; left time: 1862.4724s
	iters: 900, epoch: 8 | loss: 0.7392988
	speed: 0.0751s/iter; left time: 1876.5793s
	iters: 1000, epoch: 8 | loss: 0.4956597
	speed: 0.0764s/iter; left time: 1900.6015s
	iters: 1100, epoch: 8 | loss: 0.5508772
	speed: 0.0727s/iter; left time: 1800.3949s
Epoch: 8 cost time: 83.3923110961914
Epoch: 8, Steps: 1125 | Train Loss: 0.6284831 Vali Loss: 0.6788583 Test Loss: 0.3321365
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.6492712
	speed: 0.4905s/iter; left time: 12090.5509s
	iters: 200, epoch: 9 | loss: 0.7982874
	speed: 0.0713s/iter; left time: 1750.1869s
	iters: 300, epoch: 9 | loss: 0.7757850
	speed: 0.0805s/iter; left time: 1969.4478s
	iters: 400, epoch: 9 | loss: 0.5930439
	speed: 0.0710s/iter; left time: 1728.5359s
	iters: 500, epoch: 9 | loss: 0.8083332
	speed: 0.0757s/iter; left time: 1836.1207s
	iters: 600, epoch: 9 | loss: 0.6233423
	speed: 0.0759s/iter; left time: 1833.4399s
	iters: 700, epoch: 9 | loss: 0.5749906
	speed: 0.0728s/iter; left time: 1750.7216s
	iters: 800, epoch: 9 | loss: 0.7146769
	speed: 0.0790s/iter; left time: 1890.9879s
	iters: 900, epoch: 9 | loss: 0.6296479
	speed: 0.0770s/iter; left time: 1836.7001s
	iters: 1000, epoch: 9 | loss: 0.4564704
	speed: 0.0734s/iter; left time: 1743.0465s
	iters: 1100, epoch: 9 | loss: 0.5950575
	speed: 0.0718s/iter; left time: 1697.1623s
Epoch: 9 cost time: 84.92859387397766
Epoch: 9, Steps: 1125 | Train Loss: 0.6253461 Vali Loss: 0.6791791 Test Loss: 0.3338395
EarlyStopping counter: 2 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.9673725
	speed: 0.4880s/iter; left time: 11479.6745s
	iters: 200, epoch: 10 | loss: 0.6704500
	speed: 0.0822s/iter; left time: 1924.8291s
	iters: 300, epoch: 10 | loss: 0.6979696
	speed: 0.0740s/iter; left time: 1724.9833s
	iters: 400, epoch: 10 | loss: 0.6357645
	speed: 0.0705s/iter; left time: 1638.1950s
	iters: 500, epoch: 10 | loss: 0.4809089
	speed: 0.0721s/iter; left time: 1667.4035s
	iters: 600, epoch: 10 | loss: 0.5516272
	speed: 0.0761s/iter; left time: 1751.4690s
	iters: 700, epoch: 10 | loss: 0.5564765
	speed: 0.0729s/iter; left time: 1672.3548s
	iters: 800, epoch: 10 | loss: 0.5982962
	speed: 0.0756s/iter; left time: 1726.1496s
	iters: 900, epoch: 10 | loss: 0.7311262
	speed: 0.0727s/iter; left time: 1651.5337s
	iters: 1000, epoch: 10 | loss: 0.5227955
	speed: 0.0674s/iter; left time: 1525.3865s
	iters: 1100, epoch: 10 | loss: 0.5793907
	speed: 0.0689s/iter; left time: 1553.0262s
Epoch: 10 cost time: 83.09099817276001
Epoch: 10, Steps: 1125 | Train Loss: 0.6233828 Vali Loss: 0.6841266 Test Loss: 0.3339204
EarlyStopping counter: 3 out of 5
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.5118661
	speed: 0.4788s/iter; left time: 10726.2874s
	iters: 200, epoch: 11 | loss: 0.5187282
	speed: 0.0805s/iter; left time: 1795.0825s
	iters: 300, epoch: 11 | loss: 0.5240213
	speed: 0.0752s/iter; left time: 1669.6510s
	iters: 400, epoch: 11 | loss: 0.6549177
	speed: 0.0697s/iter; left time: 1539.7638s
	iters: 500, epoch: 11 | loss: 0.6498320
	speed: 0.0736s/iter; left time: 1618.2338s
	iters: 600, epoch: 11 | loss: 0.4498241
	speed: 0.0746s/iter; left time: 1634.5012s
	iters: 700, epoch: 11 | loss: 0.6993325
	speed: 0.0708s/iter; left time: 1543.6894s
	iters: 800, epoch: 11 | loss: 0.5222494
	speed: 0.0764s/iter; left time: 1658.4056s
	iters: 900, epoch: 11 | loss: 0.7232796
	speed: 0.0717s/iter; left time: 1548.3499s
	iters: 1000, epoch: 11 | loss: 0.8426468
	speed: 0.0719s/iter; left time: 1545.3755s
	iters: 1100, epoch: 11 | loss: 0.8657427
	speed: 0.0743s/iter; left time: 1591.0611s
Epoch: 11 cost time: 84.32791209220886
Epoch: 11, Steps: 1125 | Train Loss: 0.6212336 Vali Loss: 0.6823096 Test Loss: 0.3328138
EarlyStopping counter: 4 out of 5
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.4998601
	speed: 0.5049s/iter; left time: 10742.9741s
	iters: 200, epoch: 12 | loss: 0.5694771
	speed: 0.0742s/iter; left time: 1571.0292s
	iters: 300, epoch: 12 | loss: 0.6913256
	speed: 0.0735s/iter; left time: 1549.0330s
	iters: 400, epoch: 12 | loss: 0.8141064
	speed: 0.0688s/iter; left time: 1443.2620s
	iters: 500, epoch: 12 | loss: 0.5168628
	speed: 0.0756s/iter; left time: 1578.5345s
	iters: 600, epoch: 12 | loss: 0.4779676
	speed: 0.0750s/iter; left time: 1558.4013s
	iters: 700, epoch: 12 | loss: 0.6758484
	speed: 0.0725s/iter; left time: 1499.3013s
	iters: 800, epoch: 12 | loss: 0.6783432
	speed: 0.0730s/iter; left time: 1502.2016s
	iters: 900, epoch: 12 | loss: 0.5133026
	speed: 0.0708s/iter; left time: 1450.6978s
	iters: 1000, epoch: 12 | loss: 0.6550485
	speed: 0.0730s/iter; left time: 1487.9946s
	iters: 1100, epoch: 12 | loss: 0.6933319
	speed: 0.0725s/iter; left time: 1469.7650s
Epoch: 12 cost time: 84.14695572853088
Epoch: 12, Steps: 1125 | Train Loss: 0.6192153 Vali Loss: 0.6755127 Test Loss: 0.3316503
Validation loss decreased (0.678197 --> 0.675513).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.7471011
	speed: 0.5053s/iter; left time: 10182.5008s
	iters: 200, epoch: 13 | loss: 0.4999758
	speed: 0.0744s/iter; left time: 1491.0908s
	iters: 300, epoch: 13 | loss: 0.6144082
	speed: 0.0769s/iter; left time: 1535.1254s
	iters: 400, epoch: 13 | loss: 0.5343248
	speed: 0.0770s/iter; left time: 1528.5254s
	iters: 500, epoch: 13 | loss: 0.5972584
	speed: 0.0739s/iter; left time: 1458.6687s
	iters: 600, epoch: 13 | loss: 0.6295391
	speed: 0.0765s/iter; left time: 1504.1368s
	iters: 700, epoch: 13 | loss: 0.5928307
	speed: 0.0700s/iter; left time: 1368.1247s
	iters: 800, epoch: 13 | loss: 0.6166260
	speed: 0.0718s/iter; left time: 1397.1168s
	iters: 900, epoch: 13 | loss: 0.5362306
	speed: 0.0736s/iter; left time: 1424.8225s
	iters: 1000, epoch: 13 | loss: 0.5298386
	speed: 0.0693s/iter; left time: 1334.4598s
	iters: 1100, epoch: 13 | loss: 0.8803089
	speed: 0.0808s/iter; left time: 1547.6542s
Epoch: 13 cost time: 84.94648241996765
Epoch: 13, Steps: 1125 | Train Loss: 0.6175245 Vali Loss: 0.6790541 Test Loss: 0.3334442
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.6362828
	speed: 0.5070s/iter; left time: 9645.7177s
	iters: 200, epoch: 14 | loss: 0.6545462
	speed: 0.0748s/iter; left time: 1414.9500s
	iters: 300, epoch: 14 | loss: 0.4936323
	speed: 0.0757s/iter; left time: 1425.0244s
	iters: 400, epoch: 14 | loss: 0.5997239
	speed: 0.0723s/iter; left time: 1353.2056s
	iters: 500, epoch: 14 | loss: 0.5445130
	speed: 0.0717s/iter; left time: 1336.2710s
	iters: 600, epoch: 14 | loss: 0.5792591
	speed: 0.0744s/iter; left time: 1379.1366s
	iters: 700, epoch: 14 | loss: 0.5686612
	speed: 0.0703s/iter; left time: 1296.0582s
	iters: 800, epoch: 14 | loss: 0.5608354
	speed: 0.0730s/iter; left time: 1338.4636s
	iters: 900, epoch: 14 | loss: 0.5932583
	speed: 0.0721s/iter; left time: 1314.9756s
	iters: 1000, epoch: 14 | loss: 0.6629848
	speed: 0.0794s/iter; left time: 1438.4746s
	iters: 1100, epoch: 14 | loss: 0.4840373
	speed: 0.0766s/iter; left time: 1380.1586s
Epoch: 14 cost time: 84.61242270469666
Epoch: 14, Steps: 1125 | Train Loss: 0.6158623 Vali Loss: 0.6730140 Test Loss: 0.3331635
Validation loss decreased (0.675513 --> 0.673014).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.4448321
	speed: 0.4916s/iter; left time: 8800.0265s
	iters: 200, epoch: 15 | loss: 0.6704716
	speed: 0.0695s/iter; left time: 1237.8258s
	iters: 300, epoch: 15 | loss: 0.7284213
	speed: 0.0684s/iter; left time: 1210.3992s
	iters: 400, epoch: 15 | loss: 0.4729795
	speed: 0.0683s/iter; left time: 1201.5139s
	iters: 500, epoch: 15 | loss: 0.5056629
	speed: 0.0663s/iter; left time: 1160.1773s
	iters: 600, epoch: 15 | loss: 0.4379385
	speed: 0.0651s/iter; left time: 1132.4542s
	iters: 700, epoch: 15 | loss: 0.8028371
	speed: 0.0634s/iter; left time: 1096.8487s
	iters: 800, epoch: 15 | loss: 0.4831514
	speed: 0.0661s/iter; left time: 1137.2742s
	iters: 900, epoch: 15 | loss: 0.5526488
	speed: 0.0640s/iter; left time: 1094.3694s
	iters: 1000, epoch: 15 | loss: 0.5603766
	speed: 0.0713s/iter; left time: 1211.8786s
	iters: 1100, epoch: 15 | loss: 0.7443026
	speed: 0.0666s/iter; left time: 1126.0282s
Epoch: 15 cost time: 77.09896206855774
Epoch: 15, Steps: 1125 | Train Loss: 0.6142314 Vali Loss: 0.6803749 Test Loss: 0.3330452
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.4919535
	speed: 0.5118s/iter; left time: 8585.9023s
	iters: 200, epoch: 16 | loss: 0.4743716
	speed: 0.0777s/iter; left time: 1295.8520s
	iters: 300, epoch: 16 | loss: 0.8585054
	speed: 0.0723s/iter; left time: 1198.6048s
	iters: 400, epoch: 16 | loss: 0.5359039
	speed: 0.0786s/iter; left time: 1295.3910s
	iters: 500, epoch: 16 | loss: 0.6467056
	speed: 0.0687s/iter; left time: 1125.6677s
	iters: 600, epoch: 16 | loss: 0.5649876
	speed: 0.0694s/iter; left time: 1129.2725s
	iters: 700, epoch: 16 | loss: 0.5710908
	speed: 0.0751s/iter; left time: 1214.2815s
	iters: 800, epoch: 16 | loss: 0.5772300
	speed: 0.0679s/iter; left time: 1092.2719s
	iters: 900, epoch: 16 | loss: 0.8002104
	speed: 0.0793s/iter; left time: 1266.1343s
	iters: 1000, epoch: 16 | loss: 0.5225319
	speed: 0.0723s/iter; left time: 1148.2633s
	iters: 1100, epoch: 16 | loss: 0.7534218
	speed: 0.0683s/iter; left time: 1077.7471s
Epoch: 16 cost time: 83.63696217536926
Epoch: 16, Steps: 1125 | Train Loss: 0.6128632 Vali Loss: 0.6784925 Test Loss: 0.3334415
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.6710474
	speed: 0.5005s/iter; left time: 7832.7094s
	iters: 200, epoch: 17 | loss: 0.4719228
	speed: 0.0761s/iter; left time: 1184.0410s
	iters: 300, epoch: 17 | loss: 0.6181815
	speed: 0.0736s/iter; left time: 1136.6201s
	iters: 400, epoch: 17 | loss: 0.4923109
	speed: 0.0801s/iter; left time: 1229.2722s
	iters: 500, epoch: 17 | loss: 0.4271403
	speed: 0.0717s/iter; left time: 1093.0288s
	iters: 600, epoch: 17 | loss: 0.6408118
	speed: 0.0727s/iter; left time: 1101.6745s
	iters: 700, epoch: 17 | loss: 0.5996289
	speed: 0.0718s/iter; left time: 1081.1945s
	iters: 800, epoch: 17 | loss: 0.8178139
	speed: 0.0801s/iter; left time: 1198.2549s
	iters: 900, epoch: 17 | loss: 0.5918638
	speed: 0.0706s/iter; left time: 1048.1877s
	iters: 1000, epoch: 17 | loss: 0.4971514
	speed: 0.0713s/iter; left time: 1052.1638s
	iters: 1100, epoch: 17 | loss: 0.6157638
	speed: 0.0684s/iter; left time: 1002.4297s
Epoch: 17 cost time: 84.16164565086365
Epoch: 17, Steps: 1125 | Train Loss: 0.6115536 Vali Loss: 0.6777956 Test Loss: 0.3333261
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.6346651
	speed: 0.5072s/iter; left time: 7368.1492s
	iters: 200, epoch: 18 | loss: 0.5625567
	speed: 0.0771s/iter; left time: 1112.3785s
	iters: 300, epoch: 18 | loss: 0.4784021
	speed: 0.0702s/iter; left time: 1005.8517s
	iters: 400, epoch: 18 | loss: 0.5213434
	speed: 0.0696s/iter; left time: 989.9827s
	iters: 500, epoch: 18 | loss: 0.5497697
	speed: 0.0720s/iter; left time: 1017.2795s
	iters: 600, epoch: 18 | loss: 0.6828404
	speed: 0.0723s/iter; left time: 1013.9239s
	iters: 700, epoch: 18 | loss: 0.5684506
	speed: 0.0845s/iter; left time: 1176.5514s
	iters: 800, epoch: 18 | loss: 0.5359395
	speed: 0.0700s/iter; left time: 968.3183s
	iters: 900, epoch: 18 | loss: 0.6303914
	speed: 0.0696s/iter; left time: 955.6389s
	iters: 1000, epoch: 18 | loss: 0.5688902
	speed: 0.0685s/iter; left time: 933.0357s
	iters: 1100, epoch: 18 | loss: 0.6902941
	speed: 0.0832s/iter; left time: 1125.3555s
Epoch: 18 cost time: 84.02354383468628
Epoch: 18, Steps: 1125 | Train Loss: 0.6104230 Vali Loss: 0.6814959 Test Loss: 0.3337612
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.5053506
	speed: 0.4969s/iter; left time: 6658.9083s
	iters: 200, epoch: 19 | loss: 0.5660939
	speed: 0.0703s/iter; left time: 935.0241s
	iters: 300, epoch: 19 | loss: 0.5673645
	speed: 0.0690s/iter; left time: 911.2151s
	iters: 400, epoch: 19 | loss: 0.5681791
	speed: 0.0718s/iter; left time: 940.4897s
	iters: 500, epoch: 19 | loss: 0.5627918
	speed: 0.0732s/iter; left time: 951.1964s
	iters: 600, epoch: 19 | loss: 0.6989613
	speed: 0.0831s/iter; left time: 1072.4916s
	iters: 700, epoch: 19 | loss: 0.6285259
	speed: 0.0731s/iter; left time: 935.5133s
	iters: 800, epoch: 19 | loss: 0.5775158
	speed: 0.0720s/iter; left time: 914.9053s
	iters: 900, epoch: 19 | loss: 0.7582543
	speed: 0.0706s/iter; left time: 889.3288s
	iters: 1000, epoch: 19 | loss: 0.4886339
	speed: 0.0772s/iter; left time: 965.4885s
	iters: 1100, epoch: 19 | loss: 0.6895698
	speed: 0.0769s/iter; left time: 953.5788s
Epoch: 19 cost time: 84.12170028686523
Epoch: 19, Steps: 1125 | Train Loss: 0.6093497 Vali Loss: 0.6779702 Test Loss: 0.3349462
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : 192_720_PatchTST_custom_ftM_sl192_ll48_pl720_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
mse:0.3330555260181427, mae:0.33676931262016296, rse:0.7594345808029175
