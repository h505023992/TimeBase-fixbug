Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=128, d_layers=1, d_model=16, data='ETTh1', data_path='ETTh1.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.3, e_layers=3, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.3, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='type3', model='PatchTST', model_id='336_720', moving_avg=25, n_heads=4, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=100, pct_start=0.3, pred_len=720, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : 336_720_PatchTST_ETTh1_ftM_sl336_ll48_pl720_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7585
val 2161
test 2161
Epoch: 1 cost time: 12.139817476272583
Epoch: 1, Steps: 59 | Train Loss: 0.8997809 Vali Loss: 1.9738188 Test Loss: 0.7991090
Validation loss decreased (inf --> 1.973819).  Saving model ...
Updating learning rate to 0.0001
Epoch: 2 cost time: 11.215251445770264
Epoch: 2, Steps: 59 | Train Loss: 0.7684237 Vali Loss: 1.5425930 Test Loss: 0.5163817
Validation loss decreased (1.973819 --> 1.542593).  Saving model ...
Updating learning rate to 0.0001
Epoch: 3 cost time: 11.115424394607544
Epoch: 3, Steps: 59 | Train Loss: 0.6730149 Vali Loss: 1.4896688 Test Loss: 0.4718477
Validation loss decreased (1.542593 --> 1.489669).  Saving model ...
Updating learning rate to 0.0001
Epoch: 4 cost time: 11.542557001113892
Epoch: 4, Steps: 59 | Train Loss: 0.6385555 Vali Loss: 1.4600728 Test Loss: 0.4611450
Validation loss decreased (1.489669 --> 1.460073).  Saving model ...
Updating learning rate to 9e-05
Epoch: 5 cost time: 11.598304033279419
Epoch: 5, Steps: 59 | Train Loss: 0.6195662 Vali Loss: 1.4527767 Test Loss: 0.4570263
Validation loss decreased (1.460073 --> 1.452777).  Saving model ...
Updating learning rate to 8.1e-05
Epoch: 6 cost time: 11.333583116531372
Epoch: 6, Steps: 59 | Train Loss: 0.6079111 Vali Loss: 1.4439903 Test Loss: 0.4569925
Validation loss decreased (1.452777 --> 1.443990).  Saving model ...
Updating learning rate to 7.290000000000001e-05
Epoch: 7 cost time: 11.370646953582764
Epoch: 7, Steps: 59 | Train Loss: 0.5999761 Vali Loss: 1.4492719 Test Loss: 0.4615969
EarlyStopping counter: 1 out of 100
Updating learning rate to 6.561e-05
Epoch: 8 cost time: 11.801835298538208
Epoch: 8, Steps: 59 | Train Loss: 0.5936045 Vali Loss: 1.4525526 Test Loss: 0.4670887
EarlyStopping counter: 2 out of 100
Updating learning rate to 5.904900000000001e-05
Epoch: 9 cost time: 11.423980712890625
Epoch: 9, Steps: 59 | Train Loss: 0.5889818 Vali Loss: 1.4633174 Test Loss: 0.4711164
EarlyStopping counter: 3 out of 100
Updating learning rate to 5.3144100000000005e-05
Epoch: 10 cost time: 11.691878080368042
Epoch: 10, Steps: 59 | Train Loss: 0.5861171 Vali Loss: 1.4602652 Test Loss: 0.4731697
EarlyStopping counter: 4 out of 100
Updating learning rate to 4.782969000000001e-05
Epoch: 11 cost time: 11.862687587738037
Epoch: 11, Steps: 59 | Train Loss: 0.5830231 Vali Loss: 1.4649315 Test Loss: 0.4739343
EarlyStopping counter: 5 out of 100
Updating learning rate to 4.304672100000001e-05
Epoch: 12 cost time: 10.713537216186523
Epoch: 12, Steps: 59 | Train Loss: 0.5811610 Vali Loss: 1.4704630 Test Loss: 0.4735268
EarlyStopping counter: 6 out of 100
Updating learning rate to 3.874204890000001e-05
Epoch: 13 cost time: 10.485651969909668
Epoch: 13, Steps: 59 | Train Loss: 0.5801771 Vali Loss: 1.4773529 Test Loss: 0.4730303
EarlyStopping counter: 7 out of 100
Updating learning rate to 3.486784401000001e-05
Epoch: 14 cost time: 11.087979316711426
Epoch: 14, Steps: 59 | Train Loss: 0.5783252 Vali Loss: 1.4776058 Test Loss: 0.4720341
EarlyStopping counter: 8 out of 100
Updating learning rate to 3.138105960900001e-05
Epoch: 15 cost time: 11.465266466140747
Epoch: 15, Steps: 59 | Train Loss: 0.5767990 Vali Loss: 1.4732453 Test Loss: 0.4732131
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.824295364810001e-05
Epoch: 16 cost time: 11.83625841140747
Epoch: 16, Steps: 59 | Train Loss: 0.5754589 Vali Loss: 1.4719355 Test Loss: 0.4725175
EarlyStopping counter: 10 out of 100
Updating learning rate to 2.541865828329001e-05
Epoch: 17 cost time: 10.651659965515137
Epoch: 17, Steps: 59 | Train Loss: 0.5751861 Vali Loss: 1.4837600 Test Loss: 0.4724579
EarlyStopping counter: 11 out of 100
Updating learning rate to 2.287679245496101e-05
Epoch: 18 cost time: 11.846261978149414
Epoch: 18, Steps: 59 | Train Loss: 0.5736648 Vali Loss: 1.4777153 Test Loss: 0.4715738
EarlyStopping counter: 12 out of 100
Updating learning rate to 2.0589113209464907e-05
Epoch: 19 cost time: 11.06355619430542
Epoch: 19, Steps: 59 | Train Loss: 0.5729915 Vali Loss: 1.4803399 Test Loss: 0.4718812
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.8530201888518416e-05
Epoch: 20 cost time: 11.437562942504883
Epoch: 20, Steps: 59 | Train Loss: 0.5718465 Vali Loss: 1.4845068 Test Loss: 0.4721407
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.6677181699666577e-05
Epoch: 21 cost time: 11.114771842956543
Epoch: 21, Steps: 59 | Train Loss: 0.5712715 Vali Loss: 1.4772087 Test Loss: 0.4726926
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.5009463529699919e-05
Epoch: 22 cost time: 12.433674573898315
Epoch: 22, Steps: 59 | Train Loss: 0.5704049 Vali Loss: 1.4853730 Test Loss: 0.4729072
EarlyStopping counter: 16 out of 100
Updating learning rate to 1.3508517176729929e-05
Epoch: 23 cost time: 10.652776956558228
Epoch: 23, Steps: 59 | Train Loss: 0.5700042 Vali Loss: 1.4854257 Test Loss: 0.4728281
EarlyStopping counter: 17 out of 100
Updating learning rate to 1.2157665459056936e-05
Epoch: 24 cost time: 11.16568899154663
Epoch: 24, Steps: 59 | Train Loss: 0.5689468 Vali Loss: 1.4856972 Test Loss: 0.4732601
EarlyStopping counter: 18 out of 100
Updating learning rate to 1.0941898913151242e-05
Epoch: 25 cost time: 10.028002977371216
Epoch: 25, Steps: 59 | Train Loss: 0.5695474 Vali Loss: 1.4877621 Test Loss: 0.4735074
EarlyStopping counter: 19 out of 100
Updating learning rate to 9.847709021836118e-06
Epoch: 26 cost time: 12.347257614135742
Epoch: 26, Steps: 59 | Train Loss: 0.5680356 Vali Loss: 1.4891181 Test Loss: 0.4737332
EarlyStopping counter: 20 out of 100
Updating learning rate to 8.862938119652508e-06
Epoch: 27 cost time: 11.69151258468628
Epoch: 27, Steps: 59 | Train Loss: 0.5680782 Vali Loss: 1.4881861 Test Loss: 0.4738860
EarlyStopping counter: 21 out of 100
Updating learning rate to 7.976644307687255e-06
Epoch: 28 cost time: 10.960559129714966
Epoch: 28, Steps: 59 | Train Loss: 0.5677318 Vali Loss: 1.4871330 Test Loss: 0.4743183
EarlyStopping counter: 22 out of 100
Updating learning rate to 7.178979876918531e-06
Epoch: 29 cost time: 11.917226791381836
Epoch: 29, Steps: 59 | Train Loss: 0.5673631 Vali Loss: 1.4866771 Test Loss: 0.4753997
EarlyStopping counter: 23 out of 100
Updating learning rate to 6.4610818892266776e-06
Epoch: 30 cost time: 12.728904485702515
Epoch: 30, Steps: 59 | Train Loss: 0.5666689 Vali Loss: 1.4859060 Test Loss: 0.4753959
EarlyStopping counter: 24 out of 100
Updating learning rate to 5.8149737003040096e-06
Epoch: 31 cost time: 10.924875736236572
Epoch: 31, Steps: 59 | Train Loss: 0.5667500 Vali Loss: 1.4866590 Test Loss: 0.4761312
EarlyStopping counter: 25 out of 100
Updating learning rate to 5.23347633027361e-06
Epoch: 32 cost time: 11.212932586669922
Epoch: 32, Steps: 59 | Train Loss: 0.5666384 Vali Loss: 1.4821558 Test Loss: 0.4758921
EarlyStopping counter: 26 out of 100
Updating learning rate to 4.710128697246249e-06
Epoch: 33 cost time: 10.563488006591797
Epoch: 33, Steps: 59 | Train Loss: 0.5662013 Vali Loss: 1.4825099 Test Loss: 0.4762414
EarlyStopping counter: 27 out of 100
Updating learning rate to 4.239115827521624e-06
Epoch: 34 cost time: 11.111886024475098
Epoch: 34, Steps: 59 | Train Loss: 0.5658020 Vali Loss: 1.4918530 Test Loss: 0.4757844
EarlyStopping counter: 28 out of 100
Updating learning rate to 3.815204244769462e-06
Epoch: 35 cost time: 11.12856388092041
Epoch: 35, Steps: 59 | Train Loss: 0.5654465 Vali Loss: 1.4858313 Test Loss: 0.4760194
EarlyStopping counter: 29 out of 100
Updating learning rate to 3.4336838202925152e-06
Epoch: 36 cost time: 11.136043787002563
Epoch: 36, Steps: 59 | Train Loss: 0.5658288 Vali Loss: 1.4875966 Test Loss: 0.4771832
EarlyStopping counter: 30 out of 100
Updating learning rate to 3.090315438263264e-06
Epoch: 37 cost time: 11.217147588729858
Epoch: 37, Steps: 59 | Train Loss: 0.5656439 Vali Loss: 1.4911985 Test Loss: 0.4775740
EarlyStopping counter: 31 out of 100
Updating learning rate to 2.7812838944369375e-06
Epoch: 38 cost time: 10.162503480911255
Epoch: 38, Steps: 59 | Train Loss: 0.5654173 Vali Loss: 1.4905214 Test Loss: 0.4773940
EarlyStopping counter: 32 out of 100
Updating learning rate to 2.503155504993244e-06
Epoch: 39 cost time: 12.453937768936157
Epoch: 39, Steps: 59 | Train Loss: 0.5654013 Vali Loss: 1.4827149 Test Loss: 0.4781858
EarlyStopping counter: 33 out of 100
Updating learning rate to 2.2528399544939195e-06
Epoch: 40 cost time: 12.266364812850952
Epoch: 40, Steps: 59 | Train Loss: 0.5649799 Vali Loss: 1.4884644 Test Loss: 0.4769507
EarlyStopping counter: 34 out of 100
Updating learning rate to 2.0275559590445276e-06
Epoch: 41 cost time: 12.440505981445312
Epoch: 41, Steps: 59 | Train Loss: 0.5648421 Vali Loss: 1.4913338 Test Loss: 0.4768136
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.8248003631400751e-06
Epoch: 42 cost time: 11.529927492141724
Epoch: 42, Steps: 59 | Train Loss: 0.5647611 Vali Loss: 1.4858463 Test Loss: 0.4775639
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.6423203268260676e-06
Epoch: 43 cost time: 10.750434160232544
Epoch: 43, Steps: 59 | Train Loss: 0.5650857 Vali Loss: 1.4896678 Test Loss: 0.4769468
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.4780882941434609e-06
Epoch: 44 cost time: 10.925122737884521
Epoch: 44, Steps: 59 | Train Loss: 0.5655046 Vali Loss: 1.4911991 Test Loss: 0.4782111
EarlyStopping counter: 38 out of 100
Updating learning rate to 1.3302794647291146e-06
Epoch: 45 cost time: 11.373408794403076
Epoch: 45, Steps: 59 | Train Loss: 0.5649063 Vali Loss: 1.4891603 Test Loss: 0.4779465
EarlyStopping counter: 39 out of 100
Updating learning rate to 1.1972515182562034e-06
Epoch: 46 cost time: 10.804991722106934
Epoch: 46, Steps: 59 | Train Loss: 0.5646878 Vali Loss: 1.4906781 Test Loss: 0.4784862
EarlyStopping counter: 40 out of 100
Updating learning rate to 1.077526366430583e-06
Epoch: 47 cost time: 11.449778079986572
Epoch: 47, Steps: 59 | Train Loss: 0.5645886 Vali Loss: 1.4907024 Test Loss: 0.4775274
EarlyStopping counter: 41 out of 100
Updating learning rate to 9.697737297875248e-07
Epoch: 48 cost time: 12.724277019500732
Epoch: 48, Steps: 59 | Train Loss: 0.5649203 Vali Loss: 1.4958030 Test Loss: 0.4778760
EarlyStopping counter: 42 out of 100
Updating learning rate to 8.727963568087723e-07
Epoch: 49 cost time: 12.383164405822754
Epoch: 49, Steps: 59 | Train Loss: 0.5645643 Vali Loss: 1.4950964 Test Loss: 0.4774485
EarlyStopping counter: 43 out of 100
Updating learning rate to 7.855167211278951e-07
Epoch: 50 cost time: 12.441412687301636
Epoch: 50, Steps: 59 | Train Loss: 0.5650149 Vali Loss: 1.4898221 Test Loss: 0.4781119
EarlyStopping counter: 44 out of 100
Updating learning rate to 7.069650490151056e-07
Epoch: 51 cost time: 11.593435764312744
Epoch: 51, Steps: 59 | Train Loss: 0.5644016 Vali Loss: 1.4951879 Test Loss: 0.4773904
EarlyStopping counter: 45 out of 100
Updating learning rate to 6.36268544113595e-07
Epoch: 52 cost time: 12.17664384841919
Epoch: 52, Steps: 59 | Train Loss: 0.5643011 Vali Loss: 1.4911941 Test Loss: 0.4775270
EarlyStopping counter: 46 out of 100
Updating learning rate to 5.726416897022355e-07
Epoch: 53 cost time: 11.821015119552612
Epoch: 53, Steps: 59 | Train Loss: 0.5646379 Vali Loss: 1.4938102 Test Loss: 0.4779659
EarlyStopping counter: 47 out of 100
Updating learning rate to 5.15377520732012e-07
Epoch: 54 cost time: 11.710315942764282
Epoch: 54, Steps: 59 | Train Loss: 0.5644188 Vali Loss: 1.4879128 Test Loss: 0.4776318
EarlyStopping counter: 48 out of 100
Updating learning rate to 4.6383976865881085e-07
Epoch: 55 cost time: 11.212769985198975
Epoch: 55, Steps: 59 | Train Loss: 0.5649732 Vali Loss: 1.4891925 Test Loss: 0.4770089
EarlyStopping counter: 49 out of 100
Updating learning rate to 4.174557917929298e-07
Epoch: 56 cost time: 12.251789093017578
Epoch: 56, Steps: 59 | Train Loss: 0.5645231 Vali Loss: 1.4910851 Test Loss: 0.4781052
EarlyStopping counter: 50 out of 100
Updating learning rate to 3.7571021261363677e-07
Epoch: 57 cost time: 11.372713565826416
Epoch: 57, Steps: 59 | Train Loss: 0.5641943 Vali Loss: 1.4900118 Test Loss: 0.4783370
EarlyStopping counter: 51 out of 100
Updating learning rate to 3.381391913522731e-07
Epoch: 58 cost time: 11.166550636291504
Epoch: 58, Steps: 59 | Train Loss: 0.5644446 Vali Loss: 1.4911406 Test Loss: 0.4787258
EarlyStopping counter: 52 out of 100
Updating learning rate to 3.043252722170458e-07
Epoch: 59 cost time: 10.189978122711182
Epoch: 59, Steps: 59 | Train Loss: 0.5645185 Vali Loss: 1.4889762 Test Loss: 0.4771730
EarlyStopping counter: 53 out of 100
Updating learning rate to 2.7389274499534124e-07
Epoch: 60 cost time: 11.395060777664185
Epoch: 60, Steps: 59 | Train Loss: 0.5644525 Vali Loss: 1.4912544 Test Loss: 0.4787879
EarlyStopping counter: 54 out of 100
Updating learning rate to 2.465034704958071e-07
Epoch: 61 cost time: 11.392032861709595
Epoch: 61, Steps: 59 | Train Loss: 0.5643802 Vali Loss: 1.4869300 Test Loss: 0.4777407
EarlyStopping counter: 55 out of 100
Updating learning rate to 2.218531234462264e-07
Epoch: 62 cost time: 11.162539720535278
Epoch: 62, Steps: 59 | Train Loss: 0.5643300 Vali Loss: 1.4949824 Test Loss: 0.4776384
EarlyStopping counter: 56 out of 100
Updating learning rate to 1.9966781110160376e-07
Epoch: 63 cost time: 11.169015169143677
Epoch: 63, Steps: 59 | Train Loss: 0.5642427 Vali Loss: 1.4874208 Test Loss: 0.4782675
EarlyStopping counter: 57 out of 100
Updating learning rate to 1.797010299914434e-07
Epoch: 64 cost time: 11.394517421722412
Epoch: 64, Steps: 59 | Train Loss: 0.5641018 Vali Loss: 1.4934487 Test Loss: 0.4784585
EarlyStopping counter: 58 out of 100
Updating learning rate to 1.6173092699229907e-07
Epoch: 65 cost time: 10.955618619918823
Epoch: 65, Steps: 59 | Train Loss: 0.5643365 Vali Loss: 1.4950061 Test Loss: 0.4778800
EarlyStopping counter: 59 out of 100
Updating learning rate to 1.4555783429306916e-07
Epoch: 66 cost time: 10.78491735458374
Epoch: 66, Steps: 59 | Train Loss: 0.5641504 Vali Loss: 1.4889739 Test Loss: 0.4780195
EarlyStopping counter: 60 out of 100
Updating learning rate to 1.3100205086376224e-07
Epoch: 67 cost time: 10.627856492996216
Epoch: 67, Steps: 59 | Train Loss: 0.5645502 Vali Loss: 1.4918087 Test Loss: 0.4780954
EarlyStopping counter: 61 out of 100
Updating learning rate to 1.1790184577738603e-07
Epoch: 68 cost time: 10.729459762573242
Epoch: 68, Steps: 59 | Train Loss: 0.5645605 Vali Loss: 1.4954506 Test Loss: 0.4793273
EarlyStopping counter: 62 out of 100
Updating learning rate to 1.0611166119964742e-07
Epoch: 69 cost time: 11.471252679824829
Epoch: 69, Steps: 59 | Train Loss: 0.5644076 Vali Loss: 1.4958782 Test Loss: 0.4786359
EarlyStopping counter: 63 out of 100
Updating learning rate to 9.550049507968268e-08
Epoch: 70 cost time: 11.639048337936401
Epoch: 70, Steps: 59 | Train Loss: 0.5636872 Vali Loss: 1.4940033 Test Loss: 0.4779847
EarlyStopping counter: 64 out of 100
Updating learning rate to 8.595044557171442e-08
Epoch: 71 cost time: 11.906422138214111
Epoch: 71, Steps: 59 | Train Loss: 0.5645319 Vali Loss: 1.4959731 Test Loss: 0.4787975
EarlyStopping counter: 65 out of 100
Updating learning rate to 7.735540101454298e-08
Epoch: 72 cost time: 11.928565502166748
Epoch: 72, Steps: 59 | Train Loss: 0.5642071 Vali Loss: 1.4909915 Test Loss: 0.4784320
EarlyStopping counter: 66 out of 100
Updating learning rate to 6.961986091308869e-08
Epoch: 73 cost time: 11.91534948348999
Epoch: 73, Steps: 59 | Train Loss: 0.5644000 Vali Loss: 1.4932047 Test Loss: 0.4777377
EarlyStopping counter: 67 out of 100
Updating learning rate to 6.265787482177981e-08
Epoch: 74 cost time: 12.670011281967163
Epoch: 74, Steps: 59 | Train Loss: 0.5643714 Vali Loss: 1.4884976 Test Loss: 0.4792006
EarlyStopping counter: 68 out of 100
Updating learning rate to 5.639208733960184e-08
Epoch: 75 cost time: 12.669684171676636
Epoch: 75, Steps: 59 | Train Loss: 0.5640539 Vali Loss: 1.4949503 Test Loss: 0.4793856
EarlyStopping counter: 69 out of 100
Updating learning rate to 5.075287860564165e-08
Epoch: 76 cost time: 11.636422872543335
Epoch: 76, Steps: 59 | Train Loss: 0.5645594 Vali Loss: 1.4949626 Test Loss: 0.4781553
EarlyStopping counter: 70 out of 100
Updating learning rate to 4.567759074507749e-08
Epoch: 77 cost time: 11.627944469451904
Epoch: 77, Steps: 59 | Train Loss: 0.5648333 Vali Loss: 1.4864882 Test Loss: 0.4790526
EarlyStopping counter: 71 out of 100
Updating learning rate to 4.1109831670569744e-08
Epoch: 78 cost time: 11.76239013671875
Epoch: 78, Steps: 59 | Train Loss: 0.5639701 Vali Loss: 1.4958751 Test Loss: 0.4775596
EarlyStopping counter: 72 out of 100
Updating learning rate to 3.6998848503512764e-08
Epoch: 79 cost time: 11.703764915466309
Epoch: 79, Steps: 59 | Train Loss: 0.5645934 Vali Loss: 1.4880209 Test Loss: 0.4780343
EarlyStopping counter: 73 out of 100
Updating learning rate to 3.3298963653161496e-08
Epoch: 80 cost time: 11.833518505096436
Epoch: 80, Steps: 59 | Train Loss: 0.5644162 Vali Loss: 1.4969418 Test Loss: 0.4771982
EarlyStopping counter: 74 out of 100
Updating learning rate to 2.996906728784534e-08
Epoch: 81 cost time: 12.111324310302734
Epoch: 81, Steps: 59 | Train Loss: 0.5644305 Vali Loss: 1.4950666 Test Loss: 0.4791076
EarlyStopping counter: 75 out of 100
Updating learning rate to 2.697216055906081e-08
Epoch: 82 cost time: 12.458383798599243
Epoch: 82, Steps: 59 | Train Loss: 0.5642376 Vali Loss: 1.4934049 Test Loss: 0.4790052
EarlyStopping counter: 76 out of 100
Updating learning rate to 2.427494450315473e-08
Epoch: 83 cost time: 12.01925802230835
Epoch: 83, Steps: 59 | Train Loss: 0.5642576 Vali Loss: 1.4947274 Test Loss: 0.4785922
EarlyStopping counter: 77 out of 100
Updating learning rate to 2.1847450052839257e-08
Epoch: 84 cost time: 11.807528018951416
Epoch: 84, Steps: 59 | Train Loss: 0.5649697 Vali Loss: 1.4971862 Test Loss: 0.4779788
EarlyStopping counter: 78 out of 100
Updating learning rate to 1.9662705047555332e-08
Epoch: 85 cost time: 11.371918678283691
Epoch: 85, Steps: 59 | Train Loss: 0.5648087 Vali Loss: 1.4892601 Test Loss: 0.4781995
EarlyStopping counter: 79 out of 100
Updating learning rate to 1.7696434542799797e-08
Epoch: 86 cost time: 11.652438163757324
Epoch: 86, Steps: 59 | Train Loss: 0.5645783 Vali Loss: 1.4875945 Test Loss: 0.4784481
EarlyStopping counter: 80 out of 100
Updating learning rate to 1.5926791088519817e-08
Epoch: 87 cost time: 11.52641487121582
Epoch: 87, Steps: 59 | Train Loss: 0.5641498 Vali Loss: 1.4894724 Test Loss: 0.4793243
EarlyStopping counter: 81 out of 100
Updating learning rate to 1.4334111979667836e-08
Epoch: 88 cost time: 9.403555154800415
Epoch: 88, Steps: 59 | Train Loss: 0.5634500 Vali Loss: 1.4941809 Test Loss: 0.4784336
EarlyStopping counter: 82 out of 100
Updating learning rate to 1.2900700781701054e-08
Epoch: 89 cost time: 11.485660791397095
Epoch: 89, Steps: 59 | Train Loss: 0.5638030 Vali Loss: 1.4901793 Test Loss: 0.4786835
EarlyStopping counter: 83 out of 100
Updating learning rate to 1.161063070353095e-08
Epoch: 90 cost time: 11.277032613754272
Epoch: 90, Steps: 59 | Train Loss: 0.5641424 Vali Loss: 1.4913229 Test Loss: 0.4787859
EarlyStopping counter: 84 out of 100
Updating learning rate to 1.0449567633177854e-08
Epoch: 91 cost time: 9.262747764587402
Epoch: 91, Steps: 59 | Train Loss: 0.5646140 Vali Loss: 1.4907751 Test Loss: 0.4779060
EarlyStopping counter: 85 out of 100
Updating learning rate to 9.404610869860069e-09
Epoch: 92 cost time: 12.116191625595093
Epoch: 92, Steps: 59 | Train Loss: 0.5645811 Vali Loss: 1.4997199 Test Loss: 0.4786452
EarlyStopping counter: 86 out of 100
Updating learning rate to 8.464149782874063e-09
Epoch: 93 cost time: 11.663546323776245
Epoch: 93, Steps: 59 | Train Loss: 0.5642959 Vali Loss: 1.4861717 Test Loss: 0.4778726
EarlyStopping counter: 87 out of 100
Updating learning rate to 7.617734804586658e-09
Epoch: 94 cost time: 12.036256074905396
Epoch: 94, Steps: 59 | Train Loss: 0.5639479 Vali Loss: 1.4952809 Test Loss: 0.4791122
EarlyStopping counter: 88 out of 100
Updating learning rate to 6.855961324127991e-09
Epoch: 95 cost time: 11.615105867385864
Epoch: 95, Steps: 59 | Train Loss: 0.5640455 Vali Loss: 1.4952433 Test Loss: 0.4799917
EarlyStopping counter: 89 out of 100
Updating learning rate to 6.170365191715193e-09
Epoch: 96 cost time: 12.30484414100647
Epoch: 96, Steps: 59 | Train Loss: 0.5645662 Vali Loss: 1.4930329 Test Loss: 0.4773611
EarlyStopping counter: 90 out of 100
Updating learning rate to 5.5533286725436726e-09
Epoch: 97 cost time: 12.444008588790894
Epoch: 97, Steps: 59 | Train Loss: 0.5646619 Vali Loss: 1.4909874 Test Loss: 0.4779793
EarlyStopping counter: 91 out of 100
Updating learning rate to 4.997995805289306e-09
Epoch: 98 cost time: 12.770886659622192
Epoch: 98, Steps: 59 | Train Loss: 0.5643808 Vali Loss: 1.4919419 Test Loss: 0.4773344
EarlyStopping counter: 92 out of 100
Updating learning rate to 4.498196224760375e-09
Epoch: 99 cost time: 11.738376379013062
Epoch: 99, Steps: 59 | Train Loss: 0.5642814 Vali Loss: 1.4894416 Test Loss: 0.4783723
EarlyStopping counter: 93 out of 100
Updating learning rate to 4.048376602284338e-09
Epoch: 100 cost time: 12.505576133728027
Epoch: 100, Steps: 59 | Train Loss: 0.5641917 Vali Loss: 1.4895222 Test Loss: 0.4780904
EarlyStopping counter: 94 out of 100
Updating learning rate to 3.643538942055904e-09
>>>>>>>testing : 336_720_PatchTST_ETTh1_ftM_sl336_ll48_pl720_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.4561306834220886, mae:0.4709123969078064, rse:0.6465417742729187
