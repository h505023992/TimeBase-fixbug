True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ECL_192_192         Model:              TimesNet            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/          
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            192                 Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ECL_192_192_TimesNet_custom_ftM_sl192_ll48_pl192_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18029
val 2441
test 5069
	iters: 100, epoch: 1 | loss: 0.4913579
	speed: 0.4368s/iter; left time: 7346.7897s
	iters: 200, epoch: 1 | loss: 0.3365387
	speed: 0.2913s/iter; left time: 4870.7693s
	iters: 300, epoch: 1 | loss: 0.2979164
	speed: 0.2966s/iter; left time: 4930.2143s
	iters: 400, epoch: 1 | loss: 0.2606387
	speed: 0.3035s/iter; left time: 5014.2504s
	iters: 500, epoch: 1 | loss: 0.2549500
	speed: 0.3049s/iter; left time: 5007.4624s
Epoch: 1 cost time: 182.99999952316284
Epoch: 1, Steps: 564 | Train Loss: 0.3855763 Vali Loss: 0.2237518 Test Loss: 0.2598307
Validation loss decreased (inf --> 0.223752).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2581977
	speed: 1.1454s/iter; left time: 18621.5542s
	iters: 200, epoch: 2 | loss: 0.2593051
	speed: 0.3096s/iter; left time: 5002.1329s
	iters: 300, epoch: 2 | loss: 0.2418267
	speed: 0.3090s/iter; left time: 4961.5999s
	iters: 400, epoch: 2 | loss: 0.2217167
	speed: 0.3008s/iter; left time: 4799.4394s
	iters: 500, epoch: 2 | loss: 0.2210044
	speed: 0.3049s/iter; left time: 4834.6900s
Epoch: 2 cost time: 176.56798434257507
Epoch: 2, Steps: 564 | Train Loss: 0.2427448 Vali Loss: 0.2117347 Test Loss: 0.2499229
Validation loss decreased (0.223752 --> 0.211735).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2556061
	speed: 1.1665s/iter; left time: 18306.3705s
	iters: 200, epoch: 3 | loss: 0.2239701
	speed: 0.3153s/iter; left time: 4917.1535s
	iters: 300, epoch: 3 | loss: 0.2130596
	speed: 0.3139s/iter; left time: 4862.5406s
	iters: 400, epoch: 3 | loss: 0.2303416
	speed: 0.3042s/iter; left time: 4683.3056s
	iters: 500, epoch: 3 | loss: 0.2220959
	speed: 0.2996s/iter; left time: 4582.5120s
Epoch: 3 cost time: 176.73416256904602
Epoch: 3, Steps: 564 | Train Loss: 0.2348823 Vali Loss: 0.2097204 Test Loss: 0.2443114
Validation loss decreased (0.211735 --> 0.209720).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2127011
	speed: 1.1657s/iter; left time: 17636.0175s
	iters: 200, epoch: 4 | loss: 0.2323653
	speed: 0.3208s/iter; left time: 4821.4778s
	iters: 300, epoch: 4 | loss: 0.2201922
	speed: 0.3142s/iter; left time: 4690.4791s
	iters: 400, epoch: 4 | loss: 0.2275142
	speed: 0.3246s/iter; left time: 4812.9966s
	iters: 500, epoch: 4 | loss: 0.2291515
	speed: 0.3095s/iter; left time: 4558.6497s
Epoch: 4 cost time: 180.50732040405273
Epoch: 4, Steps: 564 | Train Loss: 0.2287439 Vali Loss: 0.2055724 Test Loss: 0.2396231
Validation loss decreased (0.209720 --> 0.205572).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2491091
	speed: 1.1933s/iter; left time: 17380.1497s
	iters: 200, epoch: 5 | loss: 0.2101816
	speed: 0.3132s/iter; left time: 4530.6878s
	iters: 300, epoch: 5 | loss: 0.2257506
	speed: 0.3099s/iter; left time: 4451.8398s
	iters: 400, epoch: 5 | loss: 0.2162218
	speed: 0.3127s/iter; left time: 4460.1712s
	iters: 500, epoch: 5 | loss: 0.2071299
	speed: 0.3159s/iter; left time: 4474.3565s
Epoch: 5 cost time: 182.18506264686584
Epoch: 5, Steps: 564 | Train Loss: 0.2172052 Vali Loss: 0.1892995 Test Loss: 0.2228492
Validation loss decreased (0.205572 --> 0.189300).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1984971
	speed: 1.3729s/iter; left time: 19222.0187s
	iters: 200, epoch: 6 | loss: 0.1995844
	speed: 0.3747s/iter; left time: 5209.3610s
	iters: 300, epoch: 6 | loss: 0.1959304
	speed: 0.3838s/iter; left time: 5297.0069s
	iters: 400, epoch: 6 | loss: 0.1823994
	speed: 0.3990s/iter; left time: 5466.5973s
	iters: 500, epoch: 6 | loss: 0.2034469
	speed: 0.4289s/iter; left time: 5833.3440s
Epoch: 6 cost time: 225.4746129512787
Epoch: 6, Steps: 564 | Train Loss: 0.2036051 Vali Loss: 0.1812840 Test Loss: 0.2141404
Validation loss decreased (0.189300 --> 0.181284).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1923458
	speed: 1.6122s/iter; left time: 21662.7559s
	iters: 200, epoch: 7 | loss: 0.1852811
	speed: 0.4330s/iter; left time: 5774.5459s
	iters: 300, epoch: 7 | loss: 0.2075564
	speed: 0.4385s/iter; left time: 5803.8147s
	iters: 400, epoch: 7 | loss: 0.1877368
	speed: 0.4217s/iter; left time: 5539.5909s
	iters: 500, epoch: 7 | loss: 0.2128641
	speed: 0.4133s/iter; left time: 5388.0101s
Epoch: 7 cost time: 242.80886697769165
Epoch: 7, Steps: 564 | Train Loss: 0.1975709 Vali Loss: 0.1782695 Test Loss: 0.2109773
Validation loss decreased (0.181284 --> 0.178269).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2062884
	speed: 1.5952s/iter; left time: 20535.6364s
	iters: 200, epoch: 8 | loss: 0.2231823
	speed: 0.4290s/iter; left time: 5479.2343s
	iters: 300, epoch: 8 | loss: 0.1943896
	speed: 0.4338s/iter; left time: 5497.6155s
	iters: 400, epoch: 8 | loss: 0.2130691
	speed: 0.4142s/iter; left time: 5208.0088s
	iters: 500, epoch: 8 | loss: 0.2038763
	speed: 0.4165s/iter; left time: 5195.2112s
Epoch: 8 cost time: 240.53180074691772
Epoch: 8, Steps: 564 | Train Loss: 0.1951910 Vali Loss: 0.1772997 Test Loss: 0.2096754
Validation loss decreased (0.178269 --> 0.177300).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2025870
	speed: 1.5820s/iter; left time: 19473.1873s
	iters: 200, epoch: 9 | loss: 0.2404901
	speed: 0.4204s/iter; left time: 5132.9472s
	iters: 300, epoch: 9 | loss: 0.1813499
	speed: 0.4261s/iter; left time: 5159.1135s
	iters: 400, epoch: 9 | loss: 0.1915164
	speed: 0.4262s/iter; left time: 5118.7299s
	iters: 500, epoch: 9 | loss: 0.2023299
	speed: 0.4228s/iter; left time: 5035.3890s
Epoch: 9 cost time: 240.8301544189453
Epoch: 9, Steps: 564 | Train Loss: 0.1941274 Vali Loss: 0.1769397 Test Loss: 0.2091374
Validation loss decreased (0.177300 --> 0.176940).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2039798
	speed: 1.5907s/iter; left time: 18682.3863s
	iters: 200, epoch: 10 | loss: 0.2064611
	speed: 0.4273s/iter; left time: 4975.8542s
	iters: 300, epoch: 10 | loss: 0.1862900
	speed: 0.4190s/iter; left time: 4837.0577s
	iters: 400, epoch: 10 | loss: 0.2048628
	speed: 0.4206s/iter; left time: 4813.9615s
	iters: 500, epoch: 10 | loss: 0.1648386
	speed: 0.4174s/iter; left time: 4735.6922s
Epoch: 10 cost time: 239.88798809051514
Epoch: 10, Steps: 564 | Train Loss: 0.1936152 Vali Loss: 0.1766100 Test Loss: 0.2088144
Validation loss decreased (0.176940 --> 0.176610).  Saving model ...
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1873758
	speed: 1.6150s/iter; left time: 18056.8477s
	iters: 200, epoch: 11 | loss: 0.1982987
	speed: 0.4176s/iter; left time: 4627.0825s
	iters: 300, epoch: 11 | loss: 0.1986442
	speed: 0.4135s/iter; left time: 4541.1286s
	iters: 400, epoch: 11 | loss: 0.1889266
	speed: 0.4218s/iter; left time: 4589.5405s
	iters: 500, epoch: 11 | loss: 0.1838085
	speed: 0.4212s/iter; left time: 4541.1782s
Epoch: 11 cost time: 238.96123456954956
Epoch: 11, Steps: 564 | Train Loss: 0.1933393 Vali Loss: 0.1765615 Test Loss: 0.2086504
Validation loss decreased (0.176610 --> 0.176562).  Saving model ...
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.2038705
	speed: 1.5881s/iter; left time: 16861.2482s
	iters: 200, epoch: 12 | loss: 0.1856948
	speed: 0.4329s/iter; left time: 4552.3689s
	iters: 300, epoch: 12 | loss: 0.1786904
	speed: 0.4308s/iter; left time: 4487.6862s
	iters: 400, epoch: 12 | loss: 0.1886019
	speed: 0.4206s/iter; left time: 4339.5632s
	iters: 500, epoch: 12 | loss: 0.1916397
	speed: 0.4269s/iter; left time: 4361.4128s
Epoch: 12 cost time: 242.71795344352722
Epoch: 12, Steps: 564 | Train Loss: 0.1932020 Vali Loss: 0.1761961 Test Loss: 0.2085933
Validation loss decreased (0.176562 --> 0.176196).  Saving model ...
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.1834844
	speed: 1.6460s/iter; left time: 16546.8374s
	iters: 200, epoch: 13 | loss: 0.1723427
	speed: 0.4275s/iter; left time: 4254.4434s
	iters: 300, epoch: 13 | loss: 0.2236436
	speed: 0.4215s/iter; left time: 4153.0023s
	iters: 400, epoch: 13 | loss: 0.1871820
	speed: 0.4200s/iter; left time: 4096.7015s
	iters: 500, epoch: 13 | loss: 0.2001069
	speed: 0.4153s/iter; left time: 4008.5605s
Epoch: 13 cost time: 240.1951277256012
Epoch: 13, Steps: 564 | Train Loss: 0.1931065 Vali Loss: 0.1762611 Test Loss: 0.2085425
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.1898481
	speed: 1.6271s/iter; left time: 15439.1534s
	iters: 200, epoch: 14 | loss: 0.1750075
	speed: 0.4273s/iter; left time: 4012.0134s
	iters: 300, epoch: 14 | loss: 0.1959571
	speed: 0.4182s/iter; left time: 3884.8439s
	iters: 400, epoch: 14 | loss: 0.1740132
	speed: 0.4311s/iter; left time: 3961.0884s
	iters: 500, epoch: 14 | loss: 0.2014929
	speed: 0.4326s/iter; left time: 3931.4580s
Epoch: 14 cost time: 243.56442046165466
Epoch: 14, Steps: 564 | Train Loss: 0.1930636 Vali Loss: 0.1762380 Test Loss: 0.2085189
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.220703125e-08
	iters: 100, epoch: 15 | loss: 0.1974866
	speed: 1.6262s/iter; left time: 14514.0450s
	iters: 200, epoch: 15 | loss: 0.2378700
	speed: 0.4302s/iter; left time: 3796.1125s
	iters: 300, epoch: 15 | loss: 0.1967231
	speed: 0.4262s/iter; left time: 3718.6933s
	iters: 400, epoch: 15 | loss: 0.1767214
	speed: 0.4324s/iter; left time: 3729.2843s
	iters: 500, epoch: 15 | loss: 0.2028190
	speed: 0.4315s/iter; left time: 3678.5704s
Epoch: 15 cost time: 245.88006472587585
Epoch: 15, Steps: 564 | Train Loss: 0.1930969 Vali Loss: 0.1763900 Test Loss: 0.2085228
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ECL_192_192_TimesNet_custom_ftM_sl192_ll48_pl192_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5069
test shape: (5069, 192, 321) (5069, 192, 321)
test shape: (5069, 192, 321) (5069, 192, 321)
mse:0.20745693147182465, mae:0.3109222650527954, dtw:not calculated
