Args in experiment:
Namespace(is_training=1, model_id='ETTh2_96_96', model='SparseTSF', data='ETTh2', root_path='./dataset/', data_path='ETTh2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=96, period_len=24, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=256, patience=5, learning_rate=0.03, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=2, use_multi_gpu=0, devices='0,1', test_flop=False)
Use GPU: cuda:2
>>>>>>>start training : ETTh2_96_96_SparseTSF_ETTh2_ftM_sl96_pl96_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8449
val 2785
test 2785
Epoch: 1 cost time: 6.079382419586182
Epoch: 1, Steps: 33 | Train Loss: 0.5693379 Vali Loss: 0.2933912 Test Loss: 0.3815608
Validation loss decreased (inf --> 0.293391).  Saving model ...
Updating learning rate to 0.03
Epoch: 2 cost time: 2.2692341804504395
Epoch: 2, Steps: 33 | Train Loss: 0.5009443 Vali Loss: 0.2309149 Test Loss: 0.3235233
Validation loss decreased (0.293391 --> 0.230915).  Saving model ...
Updating learning rate to 0.03
Epoch: 3 cost time: 2.248535394668579
Epoch: 3, Steps: 33 | Train Loss: 0.4583596 Vali Loss: 0.2235328 Test Loss: 0.3125599
Validation loss decreased (0.230915 --> 0.223533).  Saving model ...
Updating learning rate to 0.03
Epoch: 4 cost time: 2.290247678756714
Epoch: 4, Steps: 33 | Train Loss: 0.4499079 Vali Loss: 0.2225179 Test Loss: 0.3071747
Validation loss decreased (0.223533 --> 0.222518).  Saving model ...
Updating learning rate to 0.024
Epoch: 5 cost time: 2.32000732421875
Epoch: 5, Steps: 33 | Train Loss: 0.4471870 Vali Loss: 0.2204722 Test Loss: 0.3067489
Validation loss decreased (0.222518 --> 0.220472).  Saving model ...
Updating learning rate to 0.019200000000000002
Epoch: 6 cost time: 2.3400189876556396
Epoch: 6, Steps: 33 | Train Loss: 0.4467129 Vali Loss: 0.2202606 Test Loss: 0.3051982
Validation loss decreased (0.220472 --> 0.220261).  Saving model ...
Updating learning rate to 0.015360000000000004
Epoch: 7 cost time: 1.6129851341247559
Epoch: 7, Steps: 33 | Train Loss: 0.4459878 Vali Loss: 0.2217021 Test Loss: 0.3064340
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.012288000000000002
Epoch: 8 cost time: 1.7076258659362793
Epoch: 8, Steps: 33 | Train Loss: 0.4469148 Vali Loss: 0.2210702 Test Loss: 0.3058021
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.009830400000000001
Epoch: 9 cost time: 1.6099724769592285
Epoch: 9, Steps: 33 | Train Loss: 0.4458081 Vali Loss: 0.2186517 Test Loss: 0.3056176
Validation loss decreased (0.220261 --> 0.218652).  Saving model ...
Updating learning rate to 0.007864320000000003
Epoch: 10 cost time: 1.8653888702392578
Epoch: 10, Steps: 33 | Train Loss: 0.4450880 Vali Loss: 0.2197726 Test Loss: 0.3044782
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.006291456000000002
Epoch: 11 cost time: 2.376063823699951
Epoch: 11, Steps: 33 | Train Loss: 0.4450123 Vali Loss: 0.2192324 Test Loss: 0.3053556
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.005033164800000003
Epoch: 12 cost time: 2.0169241428375244
Epoch: 12, Steps: 33 | Train Loss: 0.4448178 Vali Loss: 0.2213823 Test Loss: 0.3046353
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.004026531840000002
Epoch: 13 cost time: 2.1032471656799316
Epoch: 13, Steps: 33 | Train Loss: 0.4447156 Vali Loss: 0.2211262 Test Loss: 0.3049872
EarlyStopping counter: 4 out of 5
Updating learning rate to 0.0032212254720000015
Epoch: 14 cost time: 2.204359769821167
Epoch: 14, Steps: 33 | Train Loss: 0.4446349 Vali Loss: 0.2182240 Test Loss: 0.3047144
Validation loss decreased (0.218652 --> 0.218224).  Saving model ...
Updating learning rate to 0.0025769803776000016
Epoch: 15 cost time: 2.196272611618042
Epoch: 15, Steps: 33 | Train Loss: 0.4447498 Vali Loss: 0.2197563 Test Loss: 0.3047306
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.002061584302080001
Epoch: 16 cost time: 2.1496739387512207
Epoch: 16, Steps: 33 | Train Loss: 0.4447166 Vali Loss: 0.2181425 Test Loss: 0.3047881
Validation loss decreased (0.218224 --> 0.218143).  Saving model ...
Updating learning rate to 0.001649267441664001
Epoch: 17 cost time: 2.201169729232788
Epoch: 17, Steps: 33 | Train Loss: 0.4444683 Vali Loss: 0.2194081 Test Loss: 0.3048259
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.001319413953331201
Epoch: 18 cost time: 2.233006715774536
Epoch: 18, Steps: 33 | Train Loss: 0.4445710 Vali Loss: 0.2193968 Test Loss: 0.3046964
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.0010555311626649609
Epoch: 19 cost time: 2.1575188636779785
Epoch: 19, Steps: 33 | Train Loss: 0.4444980 Vali Loss: 0.2172012 Test Loss: 0.3045895
Validation loss decreased (0.218143 --> 0.217201).  Saving model ...
Updating learning rate to 0.0008444249301319687
Epoch: 20 cost time: 2.320758104324341
Epoch: 20, Steps: 33 | Train Loss: 0.4444966 Vali Loss: 0.2192898 Test Loss: 0.3047644
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.000675539944105575
Epoch: 21 cost time: 2.215618371963501
Epoch: 21, Steps: 33 | Train Loss: 0.4443152 Vali Loss: 0.2189829 Test Loss: 0.3047442
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.00054043195528446
Epoch: 22 cost time: 2.2230820655822754
Epoch: 22, Steps: 33 | Train Loss: 0.4444120 Vali Loss: 0.2174674 Test Loss: 0.3047733
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.00043234556422756804
Epoch: 23 cost time: 2.2687394618988037
Epoch: 23, Steps: 33 | Train Loss: 0.4443179 Vali Loss: 0.2189409 Test Loss: 0.3047527
EarlyStopping counter: 4 out of 5
Updating learning rate to 0.00034587645138205446
Epoch: 24 cost time: 2.197880744934082
Epoch: 24, Steps: 33 | Train Loss: 0.4444434 Vali Loss: 0.2190097 Test Loss: 0.3047214
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTh2_96_96_SparseTSF_ETTh2_ftM_sl96_pl96_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.3027011454105377, mae:0.34663471579551697, rse:0.4433925151824951
