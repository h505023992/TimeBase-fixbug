Args in experiment:
Namespace(is_training=1, train_only=False, model_id='electricity_720_192', model='Autoformer', data='custom', root_path='./dataset/', data_path='electricity.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=192, individual=False, embed_type=0, enc_in=321, dec_in=321, c_out=321, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : electricity_720_192_Autoformer_custom_ftM_sl720_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17501
val 2441
test 5069
	iters: 100, epoch: 1 | loss: 0.2581793
	speed: 0.3080s/iter; left time: 5023.6621s
	iters: 200, epoch: 1 | loss: 0.2417519
	speed: 0.2703s/iter; left time: 4382.5983s
	iters: 300, epoch: 1 | loss: 0.2245712
	speed: 0.2776s/iter; left time: 4471.7667s
	iters: 400, epoch: 1 | loss: 0.2005846
	speed: 0.2722s/iter; left time: 4357.8762s
	iters: 500, epoch: 1 | loss: 0.1812424
	speed: 0.2719s/iter; left time: 4325.6375s
Epoch: 1 cost time: 153.15460681915283
Epoch: 1, Steps: 547 | Train Loss: 0.2523864 Vali Loss: 0.1927920 Test Loss: 0.2462969
Validation loss decreased (inf --> 0.192792).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1724708
	speed: 1.0692s/iter; left time: 16854.8028s
	iters: 200, epoch: 2 | loss: 0.1459331
	speed: 0.2806s/iter; left time: 4394.6285s
	iters: 300, epoch: 2 | loss: 0.1651176
	speed: 0.2740s/iter; left time: 4264.7586s
	iters: 400, epoch: 2 | loss: 0.1390197
	speed: 0.2734s/iter; left time: 4227.8349s
	iters: 500, epoch: 2 | loss: 0.1301621
	speed: 0.2756s/iter; left time: 4234.9216s
Epoch: 2 cost time: 152.36202549934387
Epoch: 2, Steps: 547 | Train Loss: 0.1531193 Vali Loss: 0.1888912 Test Loss: 0.2321762
Validation loss decreased (0.192792 --> 0.188891).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1333224
	speed: 1.0670s/iter; left time: 16236.7792s
	iters: 200, epoch: 3 | loss: 0.1180985
	speed: 0.2766s/iter; left time: 4180.9597s
	iters: 300, epoch: 3 | loss: 0.1222519
	speed: 0.2750s/iter; left time: 4130.0270s
	iters: 400, epoch: 3 | loss: 0.1227355
	speed: 0.2736s/iter; left time: 4081.6044s
	iters: 500, epoch: 3 | loss: 0.1177758
	speed: 0.2742s/iter; left time: 4062.4498s
Epoch: 3 cost time: 151.84699821472168
Epoch: 3, Steps: 547 | Train Loss: 0.1222079 Vali Loss: 0.1880863 Test Loss: 0.2239078
Validation loss decreased (0.188891 --> 0.188086).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1124969
	speed: 1.0590s/iter; left time: 15535.9755s
	iters: 200, epoch: 4 | loss: 0.1150271
	speed: 0.2768s/iter; left time: 4032.7644s
	iters: 300, epoch: 4 | loss: 0.1153504
	speed: 0.2746s/iter; left time: 3973.1612s
	iters: 400, epoch: 4 | loss: 0.1140291
	speed: 0.2766s/iter; left time: 3974.3300s
	iters: 500, epoch: 4 | loss: 0.1083324
	speed: 0.2750s/iter; left time: 3924.4928s
Epoch: 4 cost time: 152.39098930358887
Epoch: 4, Steps: 547 | Train Loss: 0.1121713 Vali Loss: 0.1939770 Test Loss: 0.2226882
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1049761
	speed: 1.0861s/iter; left time: 15339.1118s
	iters: 200, epoch: 5 | loss: 0.1028201
	speed: 0.2799s/iter; left time: 3925.0742s
	iters: 300, epoch: 5 | loss: 0.1088773
	speed: 0.2740s/iter; left time: 3814.3205s
	iters: 400, epoch: 5 | loss: 0.1129151
	speed: 0.2776s/iter; left time: 3836.9829s
	iters: 500, epoch: 5 | loss: 0.1064781
	speed: 0.2760s/iter; left time: 3787.5643s
Epoch: 5 cost time: 153.36746311187744
Epoch: 5, Steps: 547 | Train Loss: 0.1076450 Vali Loss: 0.1969150 Test Loss: 0.2226369
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0973098
	speed: 1.0338s/iter; left time: 14034.8156s
	iters: 200, epoch: 6 | loss: 0.1077639
	speed: 0.2725s/iter; left time: 3672.1789s
	iters: 300, epoch: 6 | loss: 0.1068768
	speed: 0.2759s/iter; left time: 3690.2034s
	iters: 400, epoch: 6 | loss: 0.1012869
	speed: 0.2761s/iter; left time: 3666.0847s
	iters: 500, epoch: 6 | loss: 0.1087836
	speed: 0.2739s/iter; left time: 3609.2949s
Epoch: 6 cost time: 151.69962882995605
Epoch: 6, Steps: 547 | Train Loss: 0.1053186 Vali Loss: 0.1989439 Test Loss: 0.2231023
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : electricity_720_192_Autoformer_custom_ftM_sl720_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5069
mse:0.2226487547159195, mae:0.33174192905426025
