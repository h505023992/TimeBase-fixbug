True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           traffic_192_336     Model:              TimesNet            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/          
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            192                 Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         8                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_traffic_192_336_TimesNet_custom_ftM_sl192_ll48_pl336_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11753
val 1421
test 3173
	iters: 100, epoch: 1 | loss: 0.7759782
	speed: 0.2734s/iter; left time: 12031.8424s
	iters: 200, epoch: 1 | loss: 0.5518982
	speed: 0.2019s/iter; left time: 8865.7666s
	iters: 300, epoch: 1 | loss: 0.4849518
	speed: 0.1983s/iter; left time: 8686.4679s
	iters: 400, epoch: 1 | loss: 0.4922376
	speed: 0.1922s/iter; left time: 8397.1830s
	iters: 500, epoch: 1 | loss: 0.4525377
	speed: 0.1872s/iter; left time: 8160.1220s
	iters: 600, epoch: 1 | loss: 0.3921317
	speed: 0.1918s/iter; left time: 8345.2155s
	iters: 700, epoch: 1 | loss: 0.3865513
	speed: 0.1855s/iter; left time: 8049.5237s
	iters: 800, epoch: 1 | loss: 0.3779184
	speed: 0.1908s/iter; left time: 8262.8936s
	iters: 900, epoch: 1 | loss: 0.3545845
	speed: 0.1935s/iter; left time: 8361.3114s
	iters: 1000, epoch: 1 | loss: 0.3200352
	speed: 0.1953s/iter; left time: 8419.3735s
	iters: 1100, epoch: 1 | loss: 0.2777773
	speed: 0.1856s/iter; left time: 7980.4197s
	iters: 1200, epoch: 1 | loss: 0.2790787
	speed: 0.1922s/iter; left time: 8245.2282s
	iters: 1300, epoch: 1 | loss: 0.2672424
	speed: 0.2002s/iter; left time: 8568.8138s
	iters: 1400, epoch: 1 | loss: 0.2689312
	speed: 0.2149s/iter; left time: 9176.3014s
Epoch: 1 cost time: 295.20054149627686
Epoch: 1, Steps: 1470 | Train Loss: 0.4307100 Vali Loss: 0.4719881 Test Loss: 0.6432041
Validation loss decreased (inf --> 0.471988).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2764464
	speed: 1.3710s/iter; left time: 58311.2213s
	iters: 200, epoch: 2 | loss: 0.2621183
	speed: 0.1920s/iter; left time: 8148.6960s
	iters: 300, epoch: 2 | loss: 0.2553045
	speed: 0.1946s/iter; left time: 8236.2130s
	iters: 400, epoch: 2 | loss: 0.2504344
	speed: 0.1923s/iter; left time: 8122.4388s
	iters: 500, epoch: 2 | loss: 0.2640564
	speed: 0.1940s/iter; left time: 8174.6518s
	iters: 600, epoch: 2 | loss: 0.2531514
	speed: 0.1956s/iter; left time: 8220.0037s
	iters: 700, epoch: 2 | loss: 0.2541432
	speed: 0.1949s/iter; left time: 8171.9293s
	iters: 800, epoch: 2 | loss: 0.2463907
	speed: 0.1995s/iter; left time: 8344.0939s
	iters: 900, epoch: 2 | loss: 0.2513761
	speed: 0.2043s/iter; left time: 8525.3767s
	iters: 1000, epoch: 2 | loss: 0.2431231
	speed: 0.2080s/iter; left time: 8660.7942s
	iters: 1100, epoch: 2 | loss: 0.2404665
	speed: 0.2189s/iter; left time: 9089.3135s
	iters: 1200, epoch: 2 | loss: 0.2462065
	speed: 0.2184s/iter; left time: 9049.0525s
	iters: 1300, epoch: 2 | loss: 0.2344446
	speed: 0.2302s/iter; left time: 9515.2166s
	iters: 1400, epoch: 2 | loss: 0.2448102
	speed: 0.2376s/iter; left time: 9796.9237s
Epoch: 2 cost time: 305.52286553382874
Epoch: 2, Steps: 1470 | Train Loss: 0.2490993 Vali Loss: 0.4752422 Test Loss: 0.6311255
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2332160
	speed: 1.6486s/iter; left time: 67691.5663s
	iters: 200, epoch: 3 | loss: 0.2187133
	speed: 0.2400s/iter; left time: 9828.5973s
	iters: 300, epoch: 3 | loss: 0.2241779
	speed: 0.2423s/iter; left time: 9899.2146s
	iters: 400, epoch: 3 | loss: 0.2299831
	speed: 0.2354s/iter; left time: 9593.5989s
	iters: 500, epoch: 3 | loss: 0.2386781
	speed: 0.2251s/iter; left time: 9153.4448s
	iters: 600, epoch: 3 | loss: 0.2498427
	speed: 0.2294s/iter; left time: 9305.5173s
	iters: 700, epoch: 3 | loss: 0.2300921
	speed: 0.2385s/iter; left time: 9650.3662s
	iters: 800, epoch: 3 | loss: 0.2165104
	speed: 0.2355s/iter; left time: 9505.8375s
	iters: 900, epoch: 3 | loss: 0.2336267
	speed: 0.2343s/iter; left time: 9432.2759s
	iters: 1000, epoch: 3 | loss: 0.2342631
	speed: 0.2431s/iter; left time: 9763.1214s
	iters: 1100, epoch: 3 | loss: 0.2345929
	speed: 0.2735s/iter; left time: 10957.0969s
	iters: 1200, epoch: 3 | loss: 0.2123941
	speed: 0.2530s/iter; left time: 10109.4755s
	iters: 1300, epoch: 3 | loss: 0.2304195
	speed: 0.2449s/iter; left time: 9763.1838s
	iters: 1400, epoch: 3 | loss: 0.2311023
	speed: 0.2439s/iter; left time: 9698.8462s
Epoch: 3 cost time: 358.10942339897156
Epoch: 3, Steps: 1470 | Train Loss: 0.2308072 Vali Loss: 0.4722552 Test Loss: 0.6326054
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2338257
	speed: 1.7877s/iter; left time: 70776.8199s
	iters: 200, epoch: 4 | loss: 0.2153436
	speed: 0.2142s/iter; left time: 8459.2374s
	iters: 300, epoch: 4 | loss: 0.2483518
	speed: 0.2689s/iter; left time: 10590.3282s
	iters: 400, epoch: 4 | loss: 0.2150259
	speed: 0.2703s/iter; left time: 10621.6647s
	iters: 500, epoch: 4 | loss: 0.2265552
	speed: 0.2726s/iter; left time: 10682.2140s
	iters: 600, epoch: 4 | loss: 0.2189188
	speed: 0.2669s/iter; left time: 10433.0771s
	iters: 700, epoch: 4 | loss: 0.2189708
	speed: 0.2756s/iter; left time: 10746.5974s
	iters: 800, epoch: 4 | loss: 0.2364051
	speed: 0.2822s/iter; left time: 10973.8782s
	iters: 900, epoch: 4 | loss: 0.2224677
	speed: 0.2797s/iter; left time: 10851.2655s
	iters: 1000, epoch: 4 | loss: 0.2215897
	speed: 0.2763s/iter; left time: 10688.4863s
	iters: 1100, epoch: 4 | loss: 0.2464783
	speed: 0.2786s/iter; left time: 10751.6292s
	iters: 1200, epoch: 4 | loss: 0.2271010
	speed: 0.2726s/iter; left time: 10490.8162s
	iters: 1300, epoch: 4 | loss: 0.2237233
	speed: 0.2717s/iter; left time: 10431.2409s
	iters: 1400, epoch: 4 | loss: 0.2249808
	speed: 0.2760s/iter; left time: 10568.0035s
Epoch: 4 cost time: 399.1099467277527
Epoch: 4, Steps: 1470 | Train Loss: 0.2242253 Vali Loss: 0.4710613 Test Loss: 0.6274959
Validation loss decreased (0.471988 --> 0.471061).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2278666
	speed: 1.9124s/iter; left time: 72902.5233s
	iters: 200, epoch: 5 | loss: 0.2152325
	speed: 0.2752s/iter; left time: 10463.5866s
	iters: 300, epoch: 5 | loss: 0.2153990
	speed: 0.2736s/iter; left time: 10376.1354s
	iters: 400, epoch: 5 | loss: 0.2267213
	speed: 0.2733s/iter; left time: 10336.0718s
	iters: 500, epoch: 5 | loss: 0.2251109
	speed: 0.2745s/iter; left time: 10353.6306s
	iters: 600, epoch: 5 | loss: 0.2175978
	speed: 0.2768s/iter; left time: 10414.7463s
	iters: 700, epoch: 5 | loss: 0.2212447
	speed: 0.2774s/iter; left time: 10406.9170s
	iters: 800, epoch: 5 | loss: 0.2260454
	speed: 0.2686s/iter; left time: 10051.6000s
	iters: 900, epoch: 5 | loss: 0.2282183
	speed: 0.2720s/iter; left time: 10152.4946s
	iters: 1000, epoch: 5 | loss: 0.2366311
	speed: 0.2763s/iter; left time: 10285.1732s
	iters: 1100, epoch: 5 | loss: 0.2233679
	speed: 0.2772s/iter; left time: 10289.7181s
	iters: 1200, epoch: 5 | loss: 0.2012763
	speed: 0.2767s/iter; left time: 10244.6738s
	iters: 1300, epoch: 5 | loss: 0.2229458
	speed: 0.2782s/iter; left time: 10273.2007s
	iters: 1400, epoch: 5 | loss: 0.2171149
	speed: 0.2806s/iter; left time: 10333.4436s
Epoch: 5 cost time: 407.39016604423523
Epoch: 5, Steps: 1470 | Train Loss: 0.2211204 Vali Loss: 0.4661137 Test Loss: 0.6283769
Validation loss decreased (0.471061 --> 0.466114).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2155451
	speed: 1.9703s/iter; left time: 72213.0717s
	iters: 200, epoch: 6 | loss: 0.2058915
	speed: 0.2764s/iter; left time: 10103.8934s
	iters: 300, epoch: 6 | loss: 0.2051003
	speed: 0.2708s/iter; left time: 9869.7600s
	iters: 400, epoch: 6 | loss: 0.2183606
	speed: 0.2736s/iter; left time: 9945.1965s
	iters: 500, epoch: 6 | loss: 0.2389639
	speed: 0.2768s/iter; left time: 10032.6799s
	iters: 600, epoch: 6 | loss: 0.2203688
	speed: 0.2716s/iter; left time: 9817.9595s
	iters: 700, epoch: 6 | loss: 0.2059390
	speed: 0.2781s/iter; left time: 10027.4858s
	iters: 800, epoch: 6 | loss: 0.2140033
	speed: 0.2761s/iter; left time: 9924.6549s
	iters: 900, epoch: 6 | loss: 0.2260661
	speed: 0.2753s/iter; left time: 9869.1232s
	iters: 1000, epoch: 6 | loss: 0.2262424
	speed: 0.2718s/iter; left time: 9716.7870s
	iters: 1100, epoch: 6 | loss: 0.2182748
	speed: 0.2700s/iter; left time: 9625.0235s
	iters: 1200, epoch: 6 | loss: 0.2051599
	speed: 0.2740s/iter; left time: 9740.1249s
	iters: 1300, epoch: 6 | loss: 0.2135406
	speed: 0.2753s/iter; left time: 9757.9207s
	iters: 1400, epoch: 6 | loss: 0.2065355
	speed: 0.2723s/iter; left time: 9625.7017s
Epoch: 6 cost time: 406.5975375175476
Epoch: 6, Steps: 1470 | Train Loss: 0.2195843 Vali Loss: 0.4687755 Test Loss: 0.6288106
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2197666
	speed: 1.9057s/iter; left time: 67044.9943s
	iters: 200, epoch: 7 | loss: 0.2224867
	speed: 0.2740s/iter; left time: 9611.3530s
	iters: 300, epoch: 7 | loss: 0.1994234
	speed: 0.2710s/iter; left time: 9478.5399s
	iters: 400, epoch: 7 | loss: 0.2142469
	speed: 0.2717s/iter; left time: 9476.1641s
	iters: 500, epoch: 7 | loss: 0.2281571
	speed: 0.2745s/iter; left time: 9547.4878s
	iters: 600, epoch: 7 | loss: 0.2089457
	speed: 0.2806s/iter; left time: 9730.3475s
	iters: 700, epoch: 7 | loss: 0.2141727
	speed: 0.2699s/iter; left time: 9334.6402s
	iters: 800, epoch: 7 | loss: 0.2157978
	speed: 0.2729s/iter; left time: 9408.1862s
	iters: 900, epoch: 7 | loss: 0.2056686
	speed: 0.2714s/iter; left time: 9329.7408s
	iters: 1000, epoch: 7 | loss: 0.2149894
	speed: 0.2698s/iter; left time: 9250.5205s
	iters: 1100, epoch: 7 | loss: 0.2167214
	speed: 0.2709s/iter; left time: 9260.1024s
	iters: 1200, epoch: 7 | loss: 0.2004128
	speed: 0.2741s/iter; left time: 9342.0795s
	iters: 1300, epoch: 7 | loss: 0.2298471
	speed: 0.2749s/iter; left time: 9340.9922s
	iters: 1400, epoch: 7 | loss: 0.2241486
	speed: 0.2834s/iter; left time: 9602.8546s
Epoch: 7 cost time: 405.6144824028015
Epoch: 7, Steps: 1470 | Train Loss: 0.2187645 Vali Loss: 0.4672982 Test Loss: 0.6287135
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2195678
	speed: 1.8321s/iter; left time: 61760.7121s
	iters: 200, epoch: 8 | loss: 0.2175493
	speed: 0.2764s/iter; left time: 9288.5239s
	iters: 300, epoch: 8 | loss: 0.2062746
	speed: 0.2726s/iter; left time: 9135.3469s
	iters: 400, epoch: 8 | loss: 0.2168256
	speed: 0.2718s/iter; left time: 9081.3659s
	iters: 500, epoch: 8 | loss: 0.2169621
	speed: 0.2718s/iter; left time: 9054.5406s
	iters: 600, epoch: 8 | loss: 0.2077115
	speed: 0.2742s/iter; left time: 9106.2298s
	iters: 700, epoch: 8 | loss: 0.2146547
	speed: 0.2715s/iter; left time: 8990.0586s
	iters: 800, epoch: 8 | loss: 0.2171253
	speed: 0.2703s/iter; left time: 8921.6767s
	iters: 900, epoch: 8 | loss: 0.2300972
	speed: 0.2731s/iter; left time: 8988.3305s
	iters: 1000, epoch: 8 | loss: 0.2213257
	speed: 0.2755s/iter; left time: 9040.3246s
	iters: 1100, epoch: 8 | loss: 0.2175753
	speed: 0.2746s/iter; left time: 8983.0513s
	iters: 1200, epoch: 8 | loss: 0.2219963
	speed: 0.2776s/iter; left time: 9052.7960s
	iters: 1300, epoch: 8 | loss: 0.2242287
	speed: 0.2768s/iter; left time: 8998.6216s
	iters: 1400, epoch: 8 | loss: 0.2118509
	speed: 0.2730s/iter; left time: 8847.6390s
Epoch: 8 cost time: 405.7391505241394
Epoch: 8, Steps: 1470 | Train Loss: 0.2183596 Vali Loss: 0.4703162 Test Loss: 0.6302910
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_traffic_192_336_TimesNet_custom_ftM_sl192_ll48_pl336_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3173
test shape: (3173, 336, 862) (3173, 336, 862)
test shape: (3173, 336, 862) (3173, 336, 862)
mse:0.6283789277076721, mae:0.3370525538921356, dtw:not calculated
