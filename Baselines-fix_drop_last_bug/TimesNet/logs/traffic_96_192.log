True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           traffic_96_192      Model:              TimesNet            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/          
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         8                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_traffic_96_192_TimesNet_custom_ftM_sl96_ll48_pl192_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11993
val 1565
test 3317
	iters: 100, epoch: 1 | loss: 0.7995483
	speed: 0.2694s/iter; left time: 12097.7513s
	iters: 200, epoch: 1 | loss: 0.5975170
	speed: 0.1912s/iter; left time: 8563.8499s
	iters: 300, epoch: 1 | loss: 0.4632516
	speed: 0.1811s/iter; left time: 8095.0777s
	iters: 400, epoch: 1 | loss: 0.4652258
	speed: 0.1777s/iter; left time: 7924.7424s
	iters: 500, epoch: 1 | loss: 0.4752781
	speed: 0.1787s/iter; left time: 7952.1219s
	iters: 600, epoch: 1 | loss: 0.4474757
	speed: 0.1892s/iter; left time: 8400.8425s
	iters: 700, epoch: 1 | loss: 0.4195103
	speed: 0.1920s/iter; left time: 8506.0832s
	iters: 800, epoch: 1 | loss: 0.3969594
	speed: 0.1899s/iter; left time: 8395.3728s
	iters: 900, epoch: 1 | loss: 0.3594775
	speed: 0.2106s/iter; left time: 9289.1279s
	iters: 1000, epoch: 1 | loss: 0.3585081
	speed: 0.2248s/iter; left time: 9893.2127s
	iters: 1100, epoch: 1 | loss: 0.3375123
	speed: 0.2351s/iter; left time: 10319.2301s
	iters: 1200, epoch: 1 | loss: 0.3196034
	speed: 0.2375s/iter; left time: 10402.2564s
	iters: 1300, epoch: 1 | loss: 0.3024350
	speed: 0.2336s/iter; left time: 10207.2416s
	iters: 1400, epoch: 1 | loss: 0.3275578
	speed: 0.2362s/iter; left time: 10299.3891s
	iters: 1500, epoch: 1 | loss: 0.2635464
	speed: 0.2388s/iter; left time: 10388.3447s
Epoch: 1 cost time: 318.7807970046997
Epoch: 1, Steps: 1500 | Train Loss: 0.4496839 Vali Loss: 0.4908105 Test Loss: 0.6522890
Validation loss decreased (inf --> 0.490810).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2831287
	speed: 1.6067s/iter; left time: 69734.3044s
	iters: 200, epoch: 2 | loss: 0.2993761
	speed: 0.2354s/iter; left time: 10192.9827s
	iters: 300, epoch: 2 | loss: 0.2826114
	speed: 0.2353s/iter; left time: 10166.3016s
	iters: 400, epoch: 2 | loss: 0.2840883
	speed: 0.2408s/iter; left time: 10380.6694s
	iters: 500, epoch: 2 | loss: 0.2861724
	speed: 0.2495s/iter; left time: 10727.2970s
	iters: 600, epoch: 2 | loss: 0.2538442
	speed: 0.2340s/iter; left time: 10040.2282s
	iters: 700, epoch: 2 | loss: 0.2629464
	speed: 0.2322s/iter; left time: 9940.1469s
	iters: 800, epoch: 2 | loss: 0.2751166
	speed: 0.2312s/iter; left time: 9871.6298s
	iters: 900, epoch: 2 | loss: 0.2430171
	speed: 0.2312s/iter; left time: 9849.9756s
	iters: 1000, epoch: 2 | loss: 0.2564299
	speed: 0.2313s/iter; left time: 9832.4282s
	iters: 1100, epoch: 2 | loss: 0.2741419
	speed: 0.2323s/iter; left time: 9847.9924s
	iters: 1200, epoch: 2 | loss: 0.2655939
	speed: 0.2361s/iter; left time: 9988.7103s
	iters: 1300, epoch: 2 | loss: 0.2587796
	speed: 0.2388s/iter; left time: 10079.1252s
	iters: 1400, epoch: 2 | loss: 0.2180237
	speed: 0.2381s/iter; left time: 10023.6474s
	iters: 1500, epoch: 2 | loss: 0.2355147
	speed: 0.2388s/iter; left time: 10029.4541s
Epoch: 2 cost time: 356.46837401390076
Epoch: 2, Steps: 1500 | Train Loss: 0.2655948 Vali Loss: 0.4826197 Test Loss: 0.6370248
Validation loss decreased (0.490810 --> 0.482620).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2585756
	speed: 1.5371s/iter; left time: 64405.9945s
	iters: 200, epoch: 3 | loss: 0.2484869
	speed: 0.2340s/iter; left time: 9782.4509s
	iters: 300, epoch: 3 | loss: 0.2236662
	speed: 0.2402s/iter; left time: 10016.0025s
	iters: 400, epoch: 3 | loss: 0.2106901
	speed: 0.2350s/iter; left time: 9776.9493s
	iters: 500, epoch: 3 | loss: 0.2646587
	speed: 0.2326s/iter; left time: 9651.8365s
	iters: 600, epoch: 3 | loss: 0.2160209
	speed: 0.2341s/iter; left time: 9690.8091s
	iters: 700, epoch: 3 | loss: 0.2207918
	speed: 0.2298s/iter; left time: 9489.1501s
	iters: 800, epoch: 3 | loss: 0.2509825
	speed: 0.2343s/iter; left time: 9652.5099s
	iters: 900, epoch: 3 | loss: 0.2371598
	speed: 0.2302s/iter; left time: 9459.8167s
	iters: 1000, epoch: 3 | loss: 0.2525333
	speed: 0.2366s/iter; left time: 9701.3973s
	iters: 1100, epoch: 3 | loss: 0.2271977
	speed: 0.2365s/iter; left time: 9672.2110s
	iters: 1200, epoch: 3 | loss: 0.2635031
	speed: 0.2405s/iter; left time: 9813.2376s
	iters: 1300, epoch: 3 | loss: 0.2678651
	speed: 0.2357s/iter; left time: 9593.5807s
	iters: 1400, epoch: 3 | loss: 0.2574356
	speed: 0.2414s/iter; left time: 9799.7822s
	iters: 1500, epoch: 3 | loss: 0.3173133
	speed: 0.2418s/iter; left time: 9792.0070s
Epoch: 3 cost time: 355.7214663028717
Epoch: 3, Steps: 1500 | Train Loss: 0.2448535 Vali Loss: 0.4769468 Test Loss: 0.6263837
Validation loss decreased (0.482620 --> 0.476947).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2582203
	speed: 1.6799s/iter; left time: 67868.1465s
	iters: 200, epoch: 4 | loss: 0.2336026
	speed: 0.2327s/iter; left time: 9378.9297s
	iters: 300, epoch: 4 | loss: 0.2304379
	speed: 0.2299s/iter; left time: 9242.5742s
	iters: 400, epoch: 4 | loss: 0.2325995
	speed: 0.2346s/iter; left time: 9408.8995s
	iters: 500, epoch: 4 | loss: 0.2522355
	speed: 0.2347s/iter; left time: 9387.7554s
	iters: 600, epoch: 4 | loss: 0.2597923
	speed: 0.2359s/iter; left time: 9413.7183s
	iters: 700, epoch: 4 | loss: 0.2369790
	speed: 0.2363s/iter; left time: 9404.5980s
	iters: 800, epoch: 4 | loss: 0.2376550
	speed: 0.2365s/iter; left time: 9389.6201s
	iters: 900, epoch: 4 | loss: 0.2407589
	speed: 0.2314s/iter; left time: 9164.3151s
	iters: 1000, epoch: 4 | loss: 0.2343291
	speed: 0.2305s/iter; left time: 9106.1757s
	iters: 1100, epoch: 4 | loss: 0.2546985
	speed: 0.2346s/iter; left time: 9243.5390s
	iters: 1200, epoch: 4 | loss: 0.2405234
	speed: 0.2373s/iter; left time: 9325.9104s
	iters: 1300, epoch: 4 | loss: 0.2516418
	speed: 0.2326s/iter; left time: 9119.8551s
	iters: 1400, epoch: 4 | loss: 0.2315017
	speed: 0.2335s/iter; left time: 9129.8011s
	iters: 1500, epoch: 4 | loss: 0.2130457
	speed: 0.2405s/iter; left time: 9378.2555s
Epoch: 4 cost time: 353.79041290283203
Epoch: 4, Steps: 1500 | Train Loss: 0.2380139 Vali Loss: 0.4677547 Test Loss: 0.6243238
Validation loss decreased (0.476947 --> 0.467755).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2509560
	speed: 1.6374s/iter; left time: 63696.4973s
	iters: 200, epoch: 5 | loss: 0.2505057
	speed: 0.2454s/iter; left time: 9523.0272s
	iters: 300, epoch: 5 | loss: 0.2062533
	speed: 0.2439s/iter; left time: 9439.3864s
	iters: 400, epoch: 5 | loss: 0.2213695
	speed: 0.2346s/iter; left time: 9054.0124s
	iters: 500, epoch: 5 | loss: 0.2384155
	speed: 0.2382s/iter; left time: 9169.8427s
	iters: 600, epoch: 5 | loss: 0.2237804
	speed: 0.2369s/iter; left time: 9097.3964s
	iters: 700, epoch: 5 | loss: 0.2271087
	speed: 0.2353s/iter; left time: 9013.0102s
	iters: 800, epoch: 5 | loss: 0.2439619
	speed: 0.2323s/iter; left time: 8875.1317s
	iters: 900, epoch: 5 | loss: 0.2253678
	speed: 0.2342s/iter; left time: 8924.1413s
	iters: 1000, epoch: 5 | loss: 0.2288380
	speed: 0.2314s/iter; left time: 8792.4163s
	iters: 1100, epoch: 5 | loss: 0.2382009
	speed: 0.2335s/iter; left time: 8848.2501s
	iters: 1200, epoch: 5 | loss: 0.2348655
	speed: 0.2454s/iter; left time: 9277.1181s
	iters: 1300, epoch: 5 | loss: 0.2202570
	speed: 0.2410s/iter; left time: 9085.2976s
	iters: 1400, epoch: 5 | loss: 0.2446951
	speed: 0.2314s/iter; left time: 8700.8156s
	iters: 1500, epoch: 5 | loss: 0.2220478
	speed: 0.2337s/iter; left time: 8765.8052s
Epoch: 5 cost time: 357.93346095085144
Epoch: 5, Steps: 1500 | Train Loss: 0.2347756 Vali Loss: 0.4671346 Test Loss: 0.6262541
Validation loss decreased (0.467755 --> 0.467135).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2413304
	speed: 1.6417s/iter; left time: 61400.3322s
	iters: 200, epoch: 6 | loss: 0.2244062
	speed: 0.2303s/iter; left time: 8588.8309s
	iters: 300, epoch: 6 | loss: 0.2228232
	speed: 0.2315s/iter; left time: 8612.6143s
	iters: 400, epoch: 6 | loss: 0.2570629
	speed: 0.2373s/iter; left time: 8804.3950s
	iters: 500, epoch: 6 | loss: 0.2376228
	speed: 0.2330s/iter; left time: 8620.6150s
	iters: 600, epoch: 6 | loss: 0.2301260
	speed: 0.2350s/iter; left time: 8670.6889s
	iters: 700, epoch: 6 | loss: 0.2233427
	speed: 0.2356s/iter; left time: 8669.4764s
	iters: 800, epoch: 6 | loss: 0.2537013
	speed: 0.2374s/iter; left time: 8711.8734s
	iters: 900, epoch: 6 | loss: 0.2306045
	speed: 0.2346s/iter; left time: 8586.9626s
	iters: 1000, epoch: 6 | loss: 0.2366400
	speed: 0.2327s/iter; left time: 8493.4853s
	iters: 1100, epoch: 6 | loss: 0.2111880
	speed: 0.2352s/iter; left time: 8563.1037s
	iters: 1200, epoch: 6 | loss: 0.2261577
	speed: 0.2383s/iter; left time: 8649.4745s
	iters: 1300, epoch: 6 | loss: 0.2187576
	speed: 0.2347s/iter; left time: 8497.0524s
	iters: 1400, epoch: 6 | loss: 0.2293091
	speed: 0.2317s/iter; left time: 8364.7383s
	iters: 1500, epoch: 6 | loss: 0.2012551
	speed: 0.2414s/iter; left time: 8690.5270s
Epoch: 6 cost time: 355.2520809173584
Epoch: 6, Steps: 1500 | Train Loss: 0.2330747 Vali Loss: 0.4678910 Test Loss: 0.6237031
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2430550
	speed: 1.5552s/iter; left time: 55833.1986s
	iters: 200, epoch: 7 | loss: 0.2169748
	speed: 0.2349s/iter; left time: 8411.1301s
	iters: 300, epoch: 7 | loss: 0.2021584
	speed: 0.2377s/iter; left time: 8487.8375s
	iters: 400, epoch: 7 | loss: 0.2672958
	speed: 0.2395s/iter; left time: 8527.1945s
	iters: 500, epoch: 7 | loss: 0.2445982
	speed: 0.2382s/iter; left time: 8456.2385s
	iters: 600, epoch: 7 | loss: 0.2592157
	speed: 0.2397s/iter; left time: 8483.8722s
	iters: 700, epoch: 7 | loss: 0.2094258
	speed: 0.2384s/iter; left time: 8416.8738s
	iters: 800, epoch: 7 | loss: 0.2234424
	speed: 0.2332s/iter; left time: 8207.7068s
	iters: 900, epoch: 7 | loss: 0.1980846
	speed: 0.2319s/iter; left time: 8138.7305s
	iters: 1000, epoch: 7 | loss: 0.2379545
	speed: 0.2401s/iter; left time: 8404.0892s
	iters: 1100, epoch: 7 | loss: 0.2168794
	speed: 0.2322s/iter; left time: 8103.0115s
	iters: 1200, epoch: 7 | loss: 0.2089316
	speed: 0.2370s/iter; left time: 8247.1040s
	iters: 1300, epoch: 7 | loss: 0.2403159
	speed: 0.2344s/iter; left time: 8133.2574s
	iters: 1400, epoch: 7 | loss: 0.2192762
	speed: 0.2370s/iter; left time: 8199.8006s
	iters: 1500, epoch: 7 | loss: 0.2556427
	speed: 0.2360s/iter; left time: 8142.2479s
Epoch: 7 cost time: 356.44096064567566
Epoch: 7, Steps: 1500 | Train Loss: 0.2322804 Vali Loss: 0.4683375 Test Loss: 0.6237922
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2373308
	speed: 1.6627s/iter; left time: 57198.9669s
	iters: 200, epoch: 8 | loss: 0.2182243
	speed: 0.2384s/iter; left time: 8178.8102s
	iters: 300, epoch: 8 | loss: 0.2339343
	speed: 0.2487s/iter; left time: 8504.5786s
	iters: 400, epoch: 8 | loss: 0.2472228
	speed: 0.2405s/iter; left time: 8200.9106s
	iters: 500, epoch: 8 | loss: 0.2511467
	speed: 0.2396s/iter; left time: 8145.3748s
	iters: 600, epoch: 8 | loss: 0.2298404
	speed: 0.2398s/iter; left time: 8130.2725s
	iters: 700, epoch: 8 | loss: 0.2579287
	speed: 0.2356s/iter; left time: 7962.4097s
	iters: 800, epoch: 8 | loss: 0.2258286
	speed: 0.2356s/iter; left time: 7940.8239s
	iters: 900, epoch: 8 | loss: 0.2060217
	speed: 0.2379s/iter; left time: 7995.1655s
	iters: 1000, epoch: 8 | loss: 0.2314388
	speed: 0.2331s/iter; left time: 7810.3887s
	iters: 1100, epoch: 8 | loss: 0.2196653
	speed: 0.2376s/iter; left time: 7934.7342s
	iters: 1200, epoch: 8 | loss: 0.2146718
	speed: 0.2352s/iter; left time: 7832.1510s
	iters: 1300, epoch: 8 | loss: 0.2374235
	speed: 0.2381s/iter; left time: 7905.4827s
	iters: 1400, epoch: 8 | loss: 0.2375354
	speed: 0.2409s/iter; left time: 7974.5937s
	iters: 1500, epoch: 8 | loss: 0.2177467
	speed: 0.2355s/iter; left time: 7771.5861s
Epoch: 8 cost time: 359.5730633735657
Epoch: 8, Steps: 1500 | Train Loss: 0.2318436 Vali Loss: 0.4690369 Test Loss: 0.6232287
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_traffic_96_192_TimesNet_custom_ftM_sl96_ll48_pl192_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3317
test shape: (3317, 192, 862) (3317, 192, 862)
test shape: (3317, 192, 862) (3317, 192, 862)
mse:0.6263875365257263, mae:0.34040921926498413, dtw:not calculated
