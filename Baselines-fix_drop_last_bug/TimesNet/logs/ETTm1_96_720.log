True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm1_96_96         Model:              TimesNet            

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/          
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm1_96_96_TimesNet_ETTm1_ftM_sl96_ll48_pl720_dm16_nh8_el2_dl1_df32_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.6182780
	speed: 0.3467s/iter; left time: 10939.7312s
	iters: 200, epoch: 1 | loss: 0.5679565
	speed: 0.2799s/iter; left time: 8802.8257s
	iters: 300, epoch: 1 | loss: 0.4830890
	speed: 0.2887s/iter; left time: 9050.8949s
	iters: 400, epoch: 1 | loss: 0.4814639
	speed: 0.2888s/iter; left time: 9024.1290s
	iters: 500, epoch: 1 | loss: 0.4201814
	speed: 0.2859s/iter; left time: 8907.5066s
	iters: 600, epoch: 1 | loss: 0.4394855
	speed: 0.2856s/iter; left time: 8869.3830s
	iters: 700, epoch: 1 | loss: 0.4386434
	speed: 0.2841s/iter; left time: 8793.5098s
	iters: 800, epoch: 1 | loss: 0.4592905
	speed: 0.2702s/iter; left time: 8336.0047s
	iters: 900, epoch: 1 | loss: 0.4429966
	speed: 0.2635s/iter; left time: 8103.9710s
	iters: 1000, epoch: 1 | loss: 0.4538202
	speed: 0.2649s/iter; left time: 8118.0254s
Epoch: 1 cost time: 300.66147017478943
Epoch: 1, Steps: 1055 | Train Loss: 0.5028508 Vali Loss: 0.9759072 Test Loss: 0.4856986
Validation loss decreased (inf --> 0.975907).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4721996
	speed: 1.2680s/iter; left time: 38670.2676s
	iters: 200, epoch: 2 | loss: 0.4399668
	speed: 0.2715s/iter; left time: 8252.3191s
	iters: 300, epoch: 2 | loss: 0.4767587
	speed: 0.2696s/iter; left time: 8167.2425s
	iters: 400, epoch: 2 | loss: 0.5147614
	speed: 0.2702s/iter; left time: 8158.4286s
	iters: 500, epoch: 2 | loss: 0.4943305
	speed: 0.2689s/iter; left time: 8091.8153s
	iters: 600, epoch: 2 | loss: 0.4801598
	speed: 0.2697s/iter; left time: 8090.4067s
	iters: 700, epoch: 2 | loss: 0.4108002
	speed: 0.2685s/iter; left time: 8026.5785s
	iters: 800, epoch: 2 | loss: 0.3960179
	speed: 0.2696s/iter; left time: 8033.3143s
	iters: 900, epoch: 2 | loss: 0.4591720
	speed: 0.2704s/iter; left time: 8031.1519s
	iters: 1000, epoch: 2 | loss: 0.4455053
	speed: 0.2704s/iter; left time: 8002.5593s
Epoch: 2 cost time: 285.42405009269714
Epoch: 2, Steps: 1055 | Train Loss: 0.4458854 Vali Loss: 0.9668654 Test Loss: 0.4827309
Validation loss decreased (0.975907 --> 0.966865).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4651236
	speed: 1.3190s/iter; left time: 38832.2177s
	iters: 200, epoch: 3 | loss: 0.5036949
	speed: 0.2698s/iter; left time: 7915.0718s
	iters: 300, epoch: 3 | loss: 0.3624278
	speed: 0.2720s/iter; left time: 7954.3506s
	iters: 400, epoch: 3 | loss: 0.3942290
	speed: 0.2711s/iter; left time: 7899.5990s
	iters: 500, epoch: 3 | loss: 0.4392509
	speed: 0.2699s/iter; left time: 7838.0415s
	iters: 600, epoch: 3 | loss: 0.4485978
	speed: 0.2708s/iter; left time: 7837.7716s
	iters: 700, epoch: 3 | loss: 0.4269336
	speed: 0.2738s/iter; left time: 7896.9103s
	iters: 800, epoch: 3 | loss: 0.5447053
	speed: 0.2721s/iter; left time: 7819.0326s
	iters: 900, epoch: 3 | loss: 0.3544001
	speed: 0.2709s/iter; left time: 7759.9855s
	iters: 1000, epoch: 3 | loss: 0.4099206
	speed: 0.2763s/iter; left time: 7885.0257s
Epoch: 3 cost time: 287.72386837005615
Epoch: 3, Steps: 1055 | Train Loss: 0.4276318 Vali Loss: 0.9705970 Test Loss: 0.5035660
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4310921
	speed: 1.3498s/iter; left time: 38316.5004s
	iters: 200, epoch: 4 | loss: 0.4948366
	speed: 0.2715s/iter; left time: 7680.7792s
	iters: 300, epoch: 4 | loss: 0.4274863
	speed: 0.2730s/iter; left time: 7693.5624s
	iters: 400, epoch: 4 | loss: 0.3577095
	speed: 0.2815s/iter; left time: 7905.4988s
	iters: 500, epoch: 4 | loss: 0.4339446
	speed: 0.2768s/iter; left time: 7746.2777s
	iters: 600, epoch: 4 | loss: 0.3747570
	speed: 0.2761s/iter; left time: 7698.4932s
	iters: 700, epoch: 4 | loss: 0.4147518
	speed: 0.2758s/iter; left time: 7664.3750s
	iters: 800, epoch: 4 | loss: 0.3592058
	speed: 0.2842s/iter; left time: 7868.5303s
	iters: 900, epoch: 4 | loss: 0.4323110
	speed: 0.2844s/iter; left time: 7845.5189s
	iters: 1000, epoch: 4 | loss: 0.4088923
	speed: 0.2848s/iter; left time: 7827.9975s
Epoch: 4 cost time: 294.6648941040039
Epoch: 4, Steps: 1055 | Train Loss: 0.4190118 Vali Loss: 0.9690473 Test Loss: 0.5094935
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3562772
	speed: 1.4247s/iter; left time: 38938.6105s
	iters: 200, epoch: 5 | loss: 0.4644994
	speed: 0.2889s/iter; left time: 7866.2498s
	iters: 300, epoch: 5 | loss: 0.4656958
	speed: 0.2873s/iter; left time: 7794.3616s
	iters: 400, epoch: 5 | loss: 0.4584269
	speed: 0.2907s/iter; left time: 7857.6333s
	iters: 500, epoch: 5 | loss: 0.4074662
	speed: 0.2927s/iter; left time: 7881.6714s
	iters: 600, epoch: 5 | loss: 0.3944502
	speed: 0.2913s/iter; left time: 7814.8366s
	iters: 700, epoch: 5 | loss: 0.4275980
	speed: 0.2901s/iter; left time: 7754.8203s
	iters: 800, epoch: 5 | loss: 0.4602481
	speed: 0.2860s/iter; left time: 7617.4405s
	iters: 900, epoch: 5 | loss: 0.4022911
	speed: 0.2930s/iter; left time: 7773.5938s
	iters: 1000, epoch: 5 | loss: 0.5419028
	speed: 0.2922s/iter; left time: 7722.5658s
Epoch: 5 cost time: 306.65472865104675
Epoch: 5, Steps: 1055 | Train Loss: 0.4147180 Vali Loss: 0.9737821 Test Loss: 0.5129176
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm1_96_96_TimesNet_ETTm1_ftM_sl96_ll48_pl720_dm16_nh8_el2_dl1_df32_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
test shape: (10801, 720, 7) (10801, 720, 7)
test shape: (10801, 720, 7) (10801, 720, 7)
mse:0.48237428069114685, mae:0.45955178141593933, dtw:not calculated
