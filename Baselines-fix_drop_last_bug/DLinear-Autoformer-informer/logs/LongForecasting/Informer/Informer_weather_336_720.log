Args in experiment:
Namespace(is_training=1, train_only=False, model_id='Informer_weather_336_720', model='Informer', data='custom', root_path='./dataset/', data_path='weather.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=720, individual=False, embed_type=0, enc_in=21, dec_in=21, c_out=21, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : Informer_weather_336_720_Informer_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35832
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.6687910
	speed: 0.4692s/iter; left time: 15719.7773s
	iters: 200, epoch: 1 | loss: 0.5141435
	speed: 0.4182s/iter; left time: 13968.1317s
	iters: 300, epoch: 1 | loss: 0.7050307
	speed: 0.4247s/iter; left time: 14143.5547s
	iters: 400, epoch: 1 | loss: 0.3833611
	speed: 0.4254s/iter; left time: 14124.0071s
	iters: 500, epoch: 1 | loss: 0.5025313
	speed: 0.4268s/iter; left time: 14126.3513s
	iters: 600, epoch: 1 | loss: 0.3350586
	speed: 0.4283s/iter; left time: 14135.0657s
	iters: 700, epoch: 1 | loss: 0.4897003
	speed: 0.4265s/iter; left time: 14031.6482s
	iters: 800, epoch: 1 | loss: 0.3045483
	speed: 0.4195s/iter; left time: 13761.2302s
	iters: 900, epoch: 1 | loss: 0.7072257
	speed: 0.4265s/iter; left time: 13946.8512s
	iters: 1000, epoch: 1 | loss: 0.2692882
	speed: 0.4562s/iter; left time: 14872.2600s
	iters: 1100, epoch: 1 | loss: 0.4620512
	speed: 0.4339s/iter; left time: 14102.7465s
Epoch: 1 cost time: 484.2586305141449
Epoch: 1, Steps: 1120 | Train Loss: 0.5021776 Vali Loss: 1.0486294 Test Loss: 1.3189176
Validation loss decreased (inf --> 1.048629).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4510797
	speed: 1.5386s/iter; left time: 49822.8476s
	iters: 200, epoch: 2 | loss: 0.2517040
	speed: 0.4337s/iter; left time: 14000.1085s
	iters: 300, epoch: 2 | loss: 0.3478933
	speed: 0.4378s/iter; left time: 14087.4793s
	iters: 400, epoch: 2 | loss: 0.5627318
	speed: 0.4269s/iter; left time: 13695.7227s
	iters: 500, epoch: 2 | loss: 0.3079506
	speed: 0.4254s/iter; left time: 13605.0714s
	iters: 600, epoch: 2 | loss: 0.3966482
	speed: 0.4223s/iter; left time: 13463.3076s
	iters: 700, epoch: 2 | loss: 0.3940321
	speed: 0.4160s/iter; left time: 13219.3840s
	iters: 800, epoch: 2 | loss: 0.4800751
	speed: 0.4308s/iter; left time: 13648.4652s
	iters: 900, epoch: 2 | loss: 0.4524979
	speed: 0.4336s/iter; left time: 13692.8441s
	iters: 1000, epoch: 2 | loss: 0.2696329
	speed: 0.4334s/iter; left time: 13645.3414s
	iters: 1100, epoch: 2 | loss: 0.4215986
	speed: 0.4274s/iter; left time: 13410.7035s
Epoch: 2 cost time: 480.53918528556824
Epoch: 2, Steps: 1120 | Train Loss: 0.3600767 Vali Loss: 0.9866156 Test Loss: 1.2572874
Validation loss decreased (1.048629 --> 0.986616).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3061014
	speed: 1.5590s/iter; left time: 48734.6968s
	iters: 200, epoch: 3 | loss: 0.2733033
	speed: 0.4263s/iter; left time: 13282.9088s
	iters: 300, epoch: 3 | loss: 0.4062752
	speed: 0.4293s/iter; left time: 13333.0673s
	iters: 400, epoch: 3 | loss: 0.3435361
	speed: 0.4265s/iter; left time: 13204.1544s
	iters: 500, epoch: 3 | loss: 0.3522764
	speed: 0.4290s/iter; left time: 13240.8705s
	iters: 600, epoch: 3 | loss: 0.2223343
	speed: 0.4363s/iter; left time: 13419.5889s
	iters: 700, epoch: 3 | loss: 0.2245510
	speed: 0.4278s/iter; left time: 13118.0676s
	iters: 800, epoch: 3 | loss: 0.1948045
	speed: 0.4191s/iter; left time: 12808.8763s
	iters: 900, epoch: 3 | loss: 0.1993558
	speed: 0.4264s/iter; left time: 12988.7242s
	iters: 1000, epoch: 3 | loss: 0.4209324
	speed: 0.4294s/iter; left time: 13038.5033s
	iters: 1100, epoch: 3 | loss: 0.2892383
	speed: 0.4251s/iter; left time: 12865.4372s
Epoch: 3 cost time: 479.32978868484497
Epoch: 3, Steps: 1120 | Train Loss: 0.2956002 Vali Loss: 0.8765740 Test Loss: 1.1363516
Validation loss decreased (0.986616 --> 0.876574).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3978596
	speed: 1.5265s/iter; left time: 46010.9827s
	iters: 200, epoch: 4 | loss: 0.2075273
	speed: 0.4298s/iter; left time: 12912.7362s
	iters: 300, epoch: 4 | loss: 0.4414216
	speed: 0.4218s/iter; left time: 12627.9792s
	iters: 400, epoch: 4 | loss: 0.3252147
	speed: 0.4221s/iter; left time: 12595.7292s
	iters: 500, epoch: 4 | loss: 0.3331659
	speed: 0.4272s/iter; left time: 12705.6927s
	iters: 600, epoch: 4 | loss: 0.1983581
	speed: 0.4346s/iter; left time: 12881.0482s
	iters: 700, epoch: 4 | loss: 0.3074014
	speed: 0.4255s/iter; left time: 12568.4236s
	iters: 800, epoch: 4 | loss: 0.2493030
	speed: 0.4126s/iter; left time: 12148.4139s
	iters: 900, epoch: 4 | loss: 0.3294027
	speed: 0.4258s/iter; left time: 12493.5271s
	iters: 1000, epoch: 4 | loss: 0.1855057
	speed: 0.4247s/iter; left time: 12419.1900s
	iters: 1100, epoch: 4 | loss: 0.2132932
	speed: 0.4200s/iter; left time: 12239.2698s
Epoch: 4 cost time: 475.88727045059204
Epoch: 4, Steps: 1120 | Train Loss: 0.2699000 Vali Loss: 0.9292384 Test Loss: 1.2220464
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2550974
	speed: 1.5458s/iter; left time: 44861.4205s
	iters: 200, epoch: 5 | loss: 0.2563987
	speed: 0.4248s/iter; left time: 12285.6414s
	iters: 300, epoch: 5 | loss: 0.1965642
	speed: 0.4169s/iter; left time: 12014.4483s
	iters: 400, epoch: 5 | loss: 0.2683687
	speed: 0.4274s/iter; left time: 12273.9588s
	iters: 500, epoch: 5 | loss: 0.1853730
	speed: 0.4340s/iter; left time: 12421.8824s
	iters: 600, epoch: 5 | loss: 0.1990727
	speed: 0.4368s/iter; left time: 12458.3130s
	iters: 700, epoch: 5 | loss: 0.1921666
	speed: 0.4122s/iter; left time: 11715.5044s
	iters: 800, epoch: 5 | loss: 0.3266934
	speed: 0.4186s/iter; left time: 11855.9457s
	iters: 900, epoch: 5 | loss: 0.1966465
	speed: 0.4280s/iter; left time: 12077.7431s
	iters: 1000, epoch: 5 | loss: 0.1965883
	speed: 0.4360s/iter; left time: 12262.0148s
	iters: 1100, epoch: 5 | loss: 0.3038457
	speed: 0.4355s/iter; left time: 12203.4272s
Epoch: 5 cost time: 478.14348101615906
Epoch: 5, Steps: 1120 | Train Loss: 0.2579606 Vali Loss: 0.9023971 Test Loss: 1.1770130
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1933989
	speed: 1.5105s/iter; left time: 42144.0116s
	iters: 200, epoch: 6 | loss: 0.1764691
	speed: 0.4068s/iter; left time: 11308.1837s
	iters: 300, epoch: 6 | loss: 0.1898484
	speed: 0.4084s/iter; left time: 11312.2420s
	iters: 400, epoch: 6 | loss: 0.2690829
	speed: 0.4289s/iter; left time: 11838.8083s
	iters: 500, epoch: 6 | loss: 0.2619418
	speed: 0.4459s/iter; left time: 12263.0302s
	iters: 600, epoch: 6 | loss: 0.1774064
	speed: 0.4319s/iter; left time: 11833.5406s
	iters: 700, epoch: 6 | loss: 0.2355226
	speed: 0.4113s/iter; left time: 11229.6246s
	iters: 800, epoch: 6 | loss: 0.2357491
	speed: 0.4172s/iter; left time: 11349.4435s
	iters: 900, epoch: 6 | loss: 0.2810142
	speed: 0.4163s/iter; left time: 11282.9243s
	iters: 1000, epoch: 6 | loss: 0.1968901
	speed: 0.4168s/iter; left time: 11252.8502s
	iters: 1100, epoch: 6 | loss: 0.1799965
	speed: 0.4295s/iter; left time: 11552.8653s
Epoch: 6 cost time: 471.404905796051
Epoch: 6, Steps: 1120 | Train Loss: 0.2523252 Vali Loss: 0.9117017 Test Loss: 1.2282337
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Informer_weather_336_720_Informer_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
mse:1.136332631111145, mae:0.7675790786743164
