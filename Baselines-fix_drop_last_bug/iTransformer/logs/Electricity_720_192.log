Args in experiment:
Namespace(is_training=1, model_id='ECL_720_192', model='iTransformer', data='custom', root_path='./dataset/', data_path='electricity.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=192, enc_in=321, dec_in=321, c_out=321, d_model=512, n_heads=8, e_layers=3, d_layers=1, d_ff=512, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=10, batch_size=16, patience=3, learning_rate=0.0001, des='Exp', loss='MSE', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', exp_name='MTSF', channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv', efficient_training=False, use_norm=True, partial_start_index=0)
Use GPU: cuda:0
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.dropout.Dropout'>.
[INFO] Register count_convNd() for <class 'torch.nn.modules.conv.Conv1d'>.
[INFO] Register count_normalization() for <class 'torch.nn.modules.normalization.LayerNorm'>.
MACs: 1700358144.0
Params: 5202624.0
1.70G MACs
>>>>>>>start training : ECL_720_192_iTransformer_custom_M_ft720_sl48_ll192_pl512_dm8_nh3_el1_dl512_df1_fctimeF_ebTrue_dtExp_projection_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17501
val 2441
test 5069
	iters: 100, epoch: 1 | loss: 0.2412383
	speed: 0.1015s/iter; left time: 1099.8818s
	iters: 200, epoch: 1 | loss: 0.2534977
	speed: 0.0819s/iter; left time: 878.7365s
	iters: 300, epoch: 1 | loss: 0.1608712
	speed: 0.0861s/iter; left time: 915.6090s
	iters: 400, epoch: 1 | loss: 0.1747601
	speed: 0.0860s/iter; left time: 905.1571s
	iters: 500, epoch: 1 | loss: 0.1853148
	speed: 0.0812s/iter; left time: 846.7815s
	iters: 600, epoch: 1 | loss: 0.1711180
	speed: 0.0823s/iter; left time: 850.1156s
	iters: 700, epoch: 1 | loss: 0.1646291
	speed: 0.0772s/iter; left time: 790.1074s
	iters: 800, epoch: 1 | loss: 0.1545950
	speed: 0.0820s/iter; left time: 830.4743s
	iters: 900, epoch: 1 | loss: 0.1609433
	speed: 0.0776s/iter; left time: 778.5344s
	iters: 1000, epoch: 1 | loss: 0.1551241
	speed: 0.0795s/iter; left time: 789.7576s
Max Memory (MB): 962.93701171875
Epoch: 1 cost time: 90.81518721580505
Epoch: 1, Steps: 1093 | Train Loss: 0.1965080 Vali Loss: 0.1359083 Test Loss: 0.1593765
Validation loss decreased (inf --> 0.135908).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1564147
	speed: 1.3342s/iter; left time: 12992.7044s
	iters: 200, epoch: 2 | loss: 0.1575292
	speed: 0.0799s/iter; left time: 769.8743s
	iters: 300, epoch: 2 | loss: 0.1763678
	speed: 0.0809s/iter; left time: 771.8000s
	iters: 400, epoch: 2 | loss: 0.1617223
	speed: 0.0818s/iter; left time: 772.4088s
	iters: 500, epoch: 2 | loss: 0.1655777
	speed: 0.0829s/iter; left time: 773.6945s
	iters: 600, epoch: 2 | loss: 0.1621254
	speed: 0.0807s/iter; left time: 745.3421s
	iters: 700, epoch: 2 | loss: 0.1710557
	speed: 0.0849s/iter; left time: 775.9292s
	iters: 800, epoch: 2 | loss: 0.1643259
	speed: 0.0858s/iter; left time: 775.7935s
	iters: 900, epoch: 2 | loss: 0.1525399
	speed: 0.0841s/iter; left time: 752.1282s
	iters: 1000, epoch: 2 | loss: 0.1379263
	speed: 0.0845s/iter; left time: 746.4410s
Max Memory (MB): 962.93701171875
Epoch: 2 cost time: 92.85827326774597
Epoch: 2, Steps: 1093 | Train Loss: 0.1611365 Vali Loss: 0.1307374 Test Loss: 0.1541497
Validation loss decreased (0.135908 --> 0.130737).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1250024
	speed: 1.8705s/iter; left time: 16170.7899s
	iters: 200, epoch: 3 | loss: 0.1498695
	speed: 0.0816s/iter; left time: 697.6351s
	iters: 300, epoch: 3 | loss: 0.1323673
	speed: 0.0820s/iter; left time: 692.7989s
	iters: 400, epoch: 3 | loss: 0.1352393
	speed: 0.0806s/iter; left time: 672.6243s
	iters: 500, epoch: 3 | loss: 0.1576613
	speed: 0.0881s/iter; left time: 726.1447s
	iters: 600, epoch: 3 | loss: 0.1394138
	speed: 0.0808s/iter; left time: 658.4517s
	iters: 700, epoch: 3 | loss: 0.1728279
	speed: 0.0856s/iter; left time: 688.3074s
	iters: 800, epoch: 3 | loss: 0.1528014
	speed: 0.0946s/iter; left time: 751.7706s
	iters: 900, epoch: 3 | loss: 0.1552465
	speed: 0.0860s/iter; left time: 674.3114s
	iters: 1000, epoch: 3 | loss: 0.1379201
	speed: 0.0853s/iter; left time: 660.7030s
Max Memory (MB): 962.93701171875
Epoch: 3 cost time: 94.81178879737854
Epoch: 3, Steps: 1093 | Train Loss: 0.1502190 Vali Loss: 0.1313149 Test Loss: 0.1558922
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1489840
	speed: 1.7245s/iter; left time: 13023.6210s
	iters: 200, epoch: 4 | loss: 0.1412475
	speed: 0.0835s/iter; left time: 622.4971s
	iters: 300, epoch: 4 | loss: 0.1305937
	speed: 0.0862s/iter; left time: 633.4583s
	iters: 400, epoch: 4 | loss: 0.1439028
	speed: 0.0835s/iter; left time: 605.8839s
	iters: 500, epoch: 4 | loss: 0.1578176
	speed: 0.0843s/iter; left time: 602.7325s
	iters: 600, epoch: 4 | loss: 0.1486054
	speed: 0.0782s/iter; left time: 551.6455s
	iters: 700, epoch: 4 | loss: 0.1199981
	speed: 0.0853s/iter; left time: 592.9436s
	iters: 800, epoch: 4 | loss: 0.1703810
	speed: 0.0914s/iter; left time: 626.1156s
	iters: 900, epoch: 4 | loss: 0.1306349
	speed: 0.0857s/iter; left time: 578.5351s
	iters: 1000, epoch: 4 | loss: 0.1253182
	speed: 0.0825s/iter; left time: 549.0472s
Max Memory (MB): 962.93701171875
Epoch: 4 cost time: 94.87149977684021
Epoch: 4, Steps: 1093 | Train Loss: 0.1445289 Vali Loss: 0.1300382 Test Loss: 0.1551988
Validation loss decreased (0.130737 --> 0.130038).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1402643
	speed: 1.7011s/iter; left time: 10987.6668s
	iters: 200, epoch: 5 | loss: 0.1367042
	speed: 0.0703s/iter; left time: 447.2939s
	iters: 300, epoch: 5 | loss: 0.1578400
	speed: 0.0735s/iter; left time: 460.2050s
	iters: 400, epoch: 5 | loss: 0.1463578
	speed: 0.0807s/iter; left time: 497.2449s
	iters: 500, epoch: 5 | loss: 0.1593718
	speed: 0.0773s/iter; left time: 468.4034s
	iters: 600, epoch: 5 | loss: 0.1330593
	speed: 0.0761s/iter; left time: 453.5220s
	iters: 700, epoch: 5 | loss: 0.1557992
	speed: 0.0740s/iter; left time: 433.4421s
	iters: 800, epoch: 5 | loss: 0.1231819
	speed: 0.0756s/iter; left time: 435.0945s
	iters: 900, epoch: 5 | loss: 0.1458832
	speed: 0.0752s/iter; left time: 425.6711s
	iters: 1000, epoch: 5 | loss: 0.1381790
	speed: 0.0655s/iter; left time: 364.2898s
Max Memory (MB): 962.93701171875
Epoch: 5 cost time: 82.37689447402954
Epoch: 5, Steps: 1093 | Train Loss: 0.1419554 Vali Loss: 0.1294418 Test Loss: 0.1552467
Validation loss decreased (0.130038 --> 0.129442).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1588306
	speed: 1.7062s/iter; left time: 9155.4446s
	iters: 200, epoch: 6 | loss: 0.1320863
	speed: 0.0849s/iter; left time: 447.1599s
	iters: 300, epoch: 6 | loss: 0.1354295
	speed: 0.0807s/iter; left time: 417.1465s
	iters: 400, epoch: 6 | loss: 0.1294936
	speed: 0.0852s/iter; left time: 431.8004s
	iters: 500, epoch: 6 | loss: 0.1717168
	speed: 0.0927s/iter; left time: 460.2935s
	iters: 600, epoch: 6 | loss: 0.1251637
	speed: 0.0831s/iter; left time: 404.5408s
	iters: 700, epoch: 6 | loss: 0.1351667
	speed: 0.0838s/iter; left time: 399.3076s
	iters: 800, epoch: 6 | loss: 0.1557661
	speed: 0.0891s/iter; left time: 415.6656s
	iters: 900, epoch: 6 | loss: 0.1367915
	speed: 0.0849s/iter; left time: 387.8723s
	iters: 1000, epoch: 6 | loss: 0.1258902
	speed: 0.0852s/iter; left time: 380.4223s
Max Memory (MB): 962.93701171875
Epoch: 6 cost time: 95.41355443000793
Epoch: 6, Steps: 1093 | Train Loss: 0.1407080 Vali Loss: 0.1292407 Test Loss: 0.1550619
Validation loss decreased (0.129442 --> 0.129241).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1637404
	speed: 1.6907s/iter; left time: 7224.1731s
	iters: 200, epoch: 7 | loss: 0.1245364
	speed: 0.0857s/iter; left time: 357.6529s
	iters: 300, epoch: 7 | loss: 0.1430223
	speed: 0.0839s/iter; left time: 341.7677s
	iters: 400, epoch: 7 | loss: 0.1662522
	speed: 0.0831s/iter; left time: 330.1427s
	iters: 500, epoch: 7 | loss: 0.1386696
	speed: 0.0806s/iter; left time: 312.0023s
	iters: 600, epoch: 7 | loss: 0.1489282
	speed: 0.0792s/iter; left time: 298.8540s
	iters: 700, epoch: 7 | loss: 0.1324428
	speed: 0.0820s/iter; left time: 301.0831s
	iters: 800, epoch: 7 | loss: 0.1349632
	speed: 0.0830s/iter; left time: 296.5181s
	iters: 900, epoch: 7 | loss: 0.1093362
	speed: 0.0788s/iter; left time: 273.6107s
	iters: 1000, epoch: 7 | loss: 0.1397501
	speed: 0.0815s/iter; left time: 274.8538s
Max Memory (MB): 962.93701171875
Epoch: 7 cost time: 91.3965494632721
Epoch: 7, Steps: 1093 | Train Loss: 0.1400916 Vali Loss: 0.1293327 Test Loss: 0.1552562
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1371915
	speed: 1.4111s/iter; left time: 4487.3561s
	iters: 200, epoch: 8 | loss: 0.1437591
	speed: 0.0851s/iter; left time: 262.1281s
	iters: 300, epoch: 8 | loss: 0.1319948
	speed: 0.0800s/iter; left time: 238.3810s
	iters: 400, epoch: 8 | loss: 0.1754825
	speed: 0.0826s/iter; left time: 237.8111s
	iters: 500, epoch: 8 | loss: 0.1616297
	speed: 0.0864s/iter; left time: 240.1495s
	iters: 600, epoch: 8 | loss: 0.1342670
	speed: 0.0830s/iter; left time: 222.3186s
	iters: 700, epoch: 8 | loss: 0.1363198
	speed: 0.0838s/iter; left time: 216.2263s
	iters: 800, epoch: 8 | loss: 0.1430721
	speed: 0.0818s/iter; left time: 202.9582s
	iters: 900, epoch: 8 | loss: 0.1296448
	speed: 0.0811s/iter; left time: 192.9601s
	iters: 1000, epoch: 8 | loss: 0.1667797
	speed: 0.0790s/iter; left time: 180.1769s
Max Memory (MB): 962.93701171875
Epoch: 8 cost time: 91.29136323928833
Epoch: 8, Steps: 1093 | Train Loss: 0.1397488 Vali Loss: 0.1292104 Test Loss: 0.1550835
Validation loss decreased (0.129241 --> 0.129210).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1229628
	speed: 1.5366s/iter; left time: 3206.8916s
	iters: 200, epoch: 9 | loss: 0.1226255
	speed: 0.0800s/iter; left time: 159.0439s
	iters: 300, epoch: 9 | loss: 0.1517324
	speed: 0.0785s/iter; left time: 148.2076s
	iters: 400, epoch: 9 | loss: 0.1184530
	speed: 0.0769s/iter; left time: 137.3531s
	iters: 500, epoch: 9 | loss: 0.1484487
	speed: 0.0786s/iter; left time: 132.6788s
	iters: 600, epoch: 9 | loss: 0.1227710
	speed: 0.0847s/iter; left time: 134.4347s
	iters: 700, epoch: 9 | loss: 0.1588603
	speed: 0.0777s/iter; left time: 115.5547s
	iters: 800, epoch: 9 | loss: 0.1291695
	speed: 0.0821s/iter; left time: 113.8236s
	iters: 900, epoch: 9 | loss: 0.1600408
	speed: 0.0839s/iter; left time: 108.0318s
	iters: 1000, epoch: 9 | loss: 0.1375618
	speed: 0.0817s/iter; left time: 96.9261s
Max Memory (MB): 962.93701171875
Epoch: 9 cost time: 90.33519077301025
Epoch: 9, Steps: 1093 | Train Loss: 0.1395979 Vali Loss: 0.1291767 Test Loss: 0.1552356
Validation loss decreased (0.129210 --> 0.129177).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1398804
	speed: 1.3879s/iter; left time: 1379.5318s
	iters: 200, epoch: 10 | loss: 0.1528431
	speed: 0.0600s/iter; left time: 53.6007s
	iters: 300, epoch: 10 | loss: 0.1266439
	speed: 0.0676s/iter; left time: 53.6502s
	iters: 400, epoch: 10 | loss: 0.1202550
	speed: 0.0656s/iter; left time: 45.5484s
	iters: 500, epoch: 10 | loss: 0.1276099
	speed: 0.0751s/iter; left time: 44.5950s
	iters: 600, epoch: 10 | loss: 0.1473125
	speed: 0.0694s/iter; left time: 34.2775s
	iters: 700, epoch: 10 | loss: 0.1384459
	speed: 0.0738s/iter; left time: 29.0746s
	iters: 800, epoch: 10 | loss: 0.1254303
	speed: 0.0785s/iter; left time: 23.0645s
	iters: 900, epoch: 10 | loss: 0.1237966
	speed: 0.0801s/iter; left time: 15.5298s
	iters: 1000, epoch: 10 | loss: 0.1426064
	speed: 0.0760s/iter; left time: 7.1449s
Max Memory (MB): 962.93701171875
Epoch: 10 cost time: 81.36004543304443
Epoch: 10, Steps: 1093 | Train Loss: 0.1395293 Vali Loss: 0.1291350 Test Loss: 0.1552014
Validation loss decreased (0.129177 --> 0.129135).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : ECL_720_192_iTransformer_custom_M_ft720_sl48_ll192_pl512_dm8_nh3_el1_dl512_df1_fctimeF_ebTrue_dtExp_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5069
test shape: (5069, 1, 192, 321) (5069, 1, 192, 321)
test shape: (5069, 192, 321) (5069, 192, 321)
mse:0.15520192682743073, mae:0.2526713013648987
