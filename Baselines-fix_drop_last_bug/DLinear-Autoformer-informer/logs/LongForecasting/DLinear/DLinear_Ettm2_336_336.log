Args in experiment:
Namespace(is_training=1, train_only=False, model_id='DLinear_ETTm2_336_336', model='DLinear', data='ETTm2', root_path='./dataset/', data_path='ETTm2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=336, individual=False, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DLinear_ETTm2_336_336_DLinear_ETTm2_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33889
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.2984715
	speed: 0.0609s/iter; left time: 1929.0668s
	iters: 200, epoch: 1 | loss: 0.7299743
	speed: 0.0374s/iter; left time: 1181.7340s
	iters: 300, epoch: 1 | loss: 0.6095999
	speed: 0.0381s/iter; left time: 1198.8472s
	iters: 400, epoch: 1 | loss: 0.4883705
	speed: 0.0403s/iter; left time: 1264.8685s
	iters: 500, epoch: 1 | loss: 0.6206241
	speed: 0.0392s/iter; left time: 1225.9757s
	iters: 600, epoch: 1 | loss: 0.4354220
	speed: 0.0416s/iter; left time: 1297.3075s
	iters: 700, epoch: 1 | loss: 0.9234368
	speed: 0.0329s/iter; left time: 1023.1046s
	iters: 800, epoch: 1 | loss: 0.6253121
	speed: 0.0273s/iter; left time: 845.5711s
	iters: 900, epoch: 1 | loss: 0.3480770
	speed: 0.0273s/iter; left time: 844.7016s
	iters: 1000, epoch: 1 | loss: 0.2683436
	speed: 0.0296s/iter; left time: 910.9430s
Epoch: 1 cost time: 39.0690393447876
Epoch: 1, Steps: 1060 | Train Loss: 0.4289063 Vali Loss: 0.2220050 Test Loss: 0.3139497
Validation loss decreased (inf --> 0.222005).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2985070
	speed: 0.3906s/iter; left time: 11968.3023s
	iters: 200, epoch: 2 | loss: 1.1798549
	speed: 0.0421s/iter; left time: 1287.0164s
	iters: 300, epoch: 2 | loss: 0.3775428
	speed: 0.0394s/iter; left time: 1200.1112s
	iters: 400, epoch: 2 | loss: 0.5272587
	speed: 0.0491s/iter; left time: 1489.6912s
	iters: 500, epoch: 2 | loss: 0.3670855
	speed: 0.0487s/iter; left time: 1473.4404s
	iters: 600, epoch: 2 | loss: 0.2938200
	speed: 0.0509s/iter; left time: 1534.4967s
	iters: 700, epoch: 2 | loss: 0.5889313
	speed: 0.0479s/iter; left time: 1440.2258s
	iters: 800, epoch: 2 | loss: 0.3238623
	speed: 0.0422s/iter; left time: 1264.4980s
	iters: 900, epoch: 2 | loss: 0.3682087
	speed: 0.0468s/iter; left time: 1396.3472s
	iters: 1000, epoch: 2 | loss: 0.7015521
	speed: 0.0486s/iter; left time: 1446.3202s
Epoch: 2 cost time: 48.16927695274353
Epoch: 2, Steps: 1060 | Train Loss: 0.3816481 Vali Loss: 0.2338974 Test Loss: 0.3425111
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2968666
	speed: 0.7252s/iter; left time: 21451.3142s
	iters: 200, epoch: 3 | loss: 0.4838744
	speed: 0.0409s/iter; left time: 1204.6621s
	iters: 300, epoch: 3 | loss: 0.2370064
	speed: 0.0406s/iter; left time: 1191.9100s
	iters: 400, epoch: 3 | loss: 0.2312347
	speed: 0.0391s/iter; left time: 1144.8887s
	iters: 500, epoch: 3 | loss: 0.2093013
	speed: 0.0406s/iter; left time: 1184.1835s
	iters: 600, epoch: 3 | loss: 0.4818213
	speed: 0.0384s/iter; left time: 1117.4776s
	iters: 700, epoch: 3 | loss: 0.2624025
	speed: 0.0396s/iter; left time: 1146.7306s
	iters: 800, epoch: 3 | loss: 0.4674942
	speed: 0.0400s/iter; left time: 1156.4593s
	iters: 900, epoch: 3 | loss: 0.3216912
	speed: 0.0400s/iter; left time: 1152.0294s
	iters: 1000, epoch: 3 | loss: 0.2844403
	speed: 0.0406s/iter; left time: 1164.5131s
Epoch: 3 cost time: 43.49512815475464
Epoch: 3, Steps: 1060 | Train Loss: 0.3767386 Vali Loss: 0.2302353 Test Loss: 0.3333229
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2823418
	speed: 0.4571s/iter; left time: 13035.8757s
	iters: 200, epoch: 4 | loss: 0.2534168
	speed: 0.0295s/iter; left time: 838.0574s
	iters: 300, epoch: 4 | loss: 0.1931475
	speed: 0.0276s/iter; left time: 782.1926s
	iters: 400, epoch: 4 | loss: 0.9361276
	speed: 0.0282s/iter; left time: 795.4966s
	iters: 500, epoch: 4 | loss: 0.3031783
	speed: 0.0282s/iter; left time: 791.6082s
	iters: 600, epoch: 4 | loss: 0.3210651
	speed: 0.0248s/iter; left time: 694.4340s
	iters: 700, epoch: 4 | loss: 0.2306709
	speed: 0.0273s/iter; left time: 763.4569s
	iters: 800, epoch: 4 | loss: 0.4533398
	speed: 0.0216s/iter; left time: 599.8524s
	iters: 900, epoch: 4 | loss: 0.3214541
	speed: 0.0351s/iter; left time: 973.8757s
	iters: 1000, epoch: 4 | loss: 0.1855137
	speed: 0.0331s/iter; left time: 913.2882s
Epoch: 4 cost time: 30.93232798576355
Epoch: 4, Steps: 1060 | Train Loss: 0.3754754 Vali Loss: 0.2213002 Test Loss: 0.3157020
Validation loss decreased (0.222005 --> 0.221300).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2626548
	speed: 0.5948s/iter; left time: 16333.5014s
	iters: 200, epoch: 5 | loss: 0.2401261
	speed: 0.0400s/iter; left time: 1094.4887s
	iters: 300, epoch: 5 | loss: 0.3677953
	speed: 0.0397s/iter; left time: 1081.9294s
	iters: 400, epoch: 5 | loss: 0.4293215
	speed: 0.0407s/iter; left time: 1105.2237s
	iters: 500, epoch: 5 | loss: 0.2180480
	speed: 0.0388s/iter; left time: 1050.0337s
	iters: 600, epoch: 5 | loss: 0.2250470
	speed: 0.0386s/iter; left time: 1041.4340s
	iters: 700, epoch: 5 | loss: 0.3033859
	speed: 0.0407s/iter; left time: 1092.7506s
	iters: 800, epoch: 5 | loss: 0.2096299
	speed: 0.0392s/iter; left time: 1048.3894s
	iters: 900, epoch: 5 | loss: 0.4298695
	speed: 0.0400s/iter; left time: 1066.0386s
	iters: 1000, epoch: 5 | loss: 0.4704616
	speed: 0.0428s/iter; left time: 1136.4966s
Epoch: 5 cost time: 43.6177978515625
Epoch: 5, Steps: 1060 | Train Loss: 0.3744986 Vali Loss: 0.2215583 Test Loss: 0.3158239
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4413657
	speed: 0.6026s/iter; left time: 15909.3362s
	iters: 200, epoch: 6 | loss: 0.3824448
	speed: 0.0503s/iter; left time: 1322.3706s
	iters: 300, epoch: 6 | loss: 0.2034527
	speed: 0.0485s/iter; left time: 1271.1199s
	iters: 400, epoch: 6 | loss: 0.3578290
	speed: 0.0374s/iter; left time: 976.2029s
	iters: 500, epoch: 6 | loss: 0.9445510
	speed: 0.0345s/iter; left time: 898.0710s
	iters: 600, epoch: 6 | loss: 0.2924438
	speed: 0.0378s/iter; left time: 980.2465s
	iters: 700, epoch: 6 | loss: 0.3141421
	speed: 0.0381s/iter; left time: 983.8427s
	iters: 800, epoch: 6 | loss: 0.5126337
	speed: 0.0392s/iter; left time: 1006.8824s
	iters: 900, epoch: 6 | loss: 0.2394969
	speed: 0.0379s/iter; left time: 969.1909s
	iters: 1000, epoch: 6 | loss: 0.2767134
	speed: 0.0362s/iter; left time: 922.1408s
Epoch: 6 cost time: 43.62298822402954
Epoch: 6, Steps: 1060 | Train Loss: 0.3741821 Vali Loss: 0.2245668 Test Loss: 0.3232666
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.6270995
	speed: 0.5699s/iter; left time: 14443.0522s
	iters: 200, epoch: 7 | loss: 0.2970192
	speed: 0.0512s/iter; left time: 1292.2151s
	iters: 300, epoch: 7 | loss: 0.2923125
	speed: 0.0462s/iter; left time: 1161.2325s
	iters: 400, epoch: 7 | loss: 0.3225830
	speed: 0.0446s/iter; left time: 1116.4525s
	iters: 500, epoch: 7 | loss: 0.2440297
	speed: 0.0451s/iter; left time: 1124.7730s
	iters: 600, epoch: 7 | loss: 0.1652994
	speed: 0.0454s/iter; left time: 1127.7889s
	iters: 700, epoch: 7 | loss: 0.3055445
	speed: 0.0444s/iter; left time: 1098.5968s
	iters: 800, epoch: 7 | loss: 0.2707224
	speed: 0.0425s/iter; left time: 1048.3491s
	iters: 900, epoch: 7 | loss: 0.5483962
	speed: 0.0451s/iter; left time: 1107.6098s
	iters: 1000, epoch: 7 | loss: 0.2415983
	speed: 0.0461s/iter; left time: 1127.7552s
Epoch: 7 cost time: 49.36363196372986
Epoch: 7, Steps: 1060 | Train Loss: 0.3740306 Vali Loss: 0.2256526 Test Loss: 0.3254578
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : DLinear_ETTm2_336_336_DLinear_ETTm2_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.3159896731376648, mae:0.3751758933067322
