True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm1_720_96        Model:              TimesNet            

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/          
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            720                 Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm1_720_96_TimesNet_ETTm1_ftM_sl720_ll48_pl96_dm16_nh8_el2_dl1_df32_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.3887122
	speed: 0.3144s/iter; left time: 9918.3956s
	iters: 200, epoch: 1 | loss: 0.2912480
	speed: 0.2255s/iter; left time: 7093.6470s
	iters: 300, epoch: 1 | loss: 0.3158117
	speed: 0.2538s/iter; left time: 7956.2037s
	iters: 400, epoch: 1 | loss: 0.3027886
	speed: 0.2452s/iter; left time: 7662.1556s
	iters: 500, epoch: 1 | loss: 0.2468757
	speed: 0.2774s/iter; left time: 8639.9612s
	iters: 600, epoch: 1 | loss: 0.2431576
	speed: 0.2716s/iter; left time: 8434.9454s
	iters: 700, epoch: 1 | loss: 0.1988475
	speed: 0.2644s/iter; left time: 8184.1998s
	iters: 800, epoch: 1 | loss: 0.2221196
	speed: 0.2178s/iter; left time: 6718.7263s
	iters: 900, epoch: 1 | loss: 0.2113642
	speed: 0.2458s/iter; left time: 7559.8762s
	iters: 1000, epoch: 1 | loss: 0.2437357
	speed: 0.2131s/iter; left time: 6533.0680s
Epoch: 1 cost time: 267.00852489471436
Epoch: 1, Steps: 1055 | Train Loss: 0.2978253 Vali Loss: 0.5134468 Test Loss: 0.3337161
Validation loss decreased (inf --> 0.513447).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2344390
	speed: 1.2959s/iter; left time: 39520.1466s
	iters: 200, epoch: 2 | loss: 0.2378910
	speed: 0.2030s/iter; left time: 6171.0720s
	iters: 300, epoch: 2 | loss: 0.2554641
	speed: 0.2203s/iter; left time: 6673.8863s
	iters: 400, epoch: 2 | loss: 0.2225519
	speed: 0.2160s/iter; left time: 6522.5989s
	iters: 500, epoch: 2 | loss: 0.2064521
	speed: 0.2070s/iter; left time: 6230.9349s
	iters: 600, epoch: 2 | loss: 0.2083777
	speed: 0.2094s/iter; left time: 6281.8362s
	iters: 700, epoch: 2 | loss: 0.1824521
	speed: 0.2102s/iter; left time: 6285.2564s
	iters: 800, epoch: 2 | loss: 0.2077927
	speed: 0.2227s/iter; left time: 6636.0619s
	iters: 900, epoch: 2 | loss: 0.1752697
	speed: 0.2085s/iter; left time: 6190.6912s
	iters: 1000, epoch: 2 | loss: 0.1727968
	speed: 0.2116s/iter; left time: 6262.6247s
Epoch: 2 cost time: 226.53700494766235
Epoch: 2, Steps: 1055 | Train Loss: 0.2073212 Vali Loss: 0.5130967 Test Loss: 0.3586161
Validation loss decreased (0.513447 --> 0.513097).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1457833
	speed: 1.2058s/iter; left time: 35499.9255s
	iters: 200, epoch: 3 | loss: 0.1528790
	speed: 0.1980s/iter; left time: 5810.6905s
	iters: 300, epoch: 3 | loss: 0.1693350
	speed: 0.2101s/iter; left time: 6142.8072s
	iters: 400, epoch: 3 | loss: 0.1837467
	speed: 0.2143s/iter; left time: 6245.4027s
	iters: 500, epoch: 3 | loss: 0.1498934
	speed: 0.1970s/iter; left time: 5721.5514s
	iters: 600, epoch: 3 | loss: 0.1874186
	speed: 0.2064s/iter; left time: 5973.2076s
	iters: 700, epoch: 3 | loss: 0.1539523
	speed: 0.2094s/iter; left time: 6040.4161s
	iters: 800, epoch: 3 | loss: 0.1362815
	speed: 0.2068s/iter; left time: 5943.6436s
	iters: 900, epoch: 3 | loss: 0.1450649
	speed: 0.2132s/iter; left time: 6106.3126s
	iters: 1000, epoch: 3 | loss: 0.1463844
	speed: 0.1890s/iter; left time: 5393.2542s
Epoch: 3 cost time: 218.36162638664246
Epoch: 3, Steps: 1055 | Train Loss: 0.1680749 Vali Loss: 0.5508949 Test Loss: 0.4035635
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1716378
	speed: 1.1315s/iter; left time: 32118.2398s
	iters: 200, epoch: 4 | loss: 0.1309289
	speed: 0.2112s/iter; left time: 5973.8262s
	iters: 300, epoch: 4 | loss: 0.1624602
	speed: 0.2156s/iter; left time: 6077.0663s
	iters: 400, epoch: 4 | loss: 0.1301085
	speed: 0.2270s/iter; left time: 6374.4542s
	iters: 500, epoch: 4 | loss: 0.1378092
	speed: 0.2191s/iter; left time: 6131.7206s
	iters: 600, epoch: 4 | loss: 0.1308176
	speed: 0.2330s/iter; left time: 6497.7237s
	iters: 700, epoch: 4 | loss: 0.1446249
	speed: 0.2384s/iter; left time: 6625.4229s
	iters: 800, epoch: 4 | loss: 0.1339703
	speed: 0.2226s/iter; left time: 6161.5439s
	iters: 900, epoch: 4 | loss: 0.1588506
	speed: 0.2173s/iter; left time: 5993.5973s
	iters: 1000, epoch: 4 | loss: 0.1531402
	speed: 0.2099s/iter; left time: 5768.0708s
Epoch: 4 cost time: 233.5408489704132
Epoch: 4, Steps: 1055 | Train Loss: 0.1514828 Vali Loss: 0.5701415 Test Loss: 0.4257546
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1476192
	speed: 1.1530s/iter; left time: 31513.7724s
	iters: 200, epoch: 5 | loss: 0.1438811
	speed: 0.1983s/iter; left time: 5400.2249s
	iters: 300, epoch: 5 | loss: 0.1741018
	speed: 0.1972s/iter; left time: 5350.6486s
	iters: 400, epoch: 5 | loss: 0.1357625
	speed: 0.2171s/iter; left time: 5868.6976s
	iters: 500, epoch: 5 | loss: 0.1477514
	speed: 0.2315s/iter; left time: 6234.8545s
	iters: 600, epoch: 5 | loss: 0.1677474
	speed: 0.2051s/iter; left time: 5502.4033s
	iters: 700, epoch: 5 | loss: 0.1368616
	speed: 0.2138s/iter; left time: 5715.6148s
	iters: 800, epoch: 5 | loss: 0.1169277
	speed: 0.2147s/iter; left time: 5718.2887s
	iters: 900, epoch: 5 | loss: 0.1317862
	speed: 0.2013s/iter; left time: 5341.2637s
	iters: 1000, epoch: 5 | loss: 0.1469161
	speed: 0.2318s/iter; left time: 6125.6139s
Epoch: 5 cost time: 224.93950271606445
Epoch: 5, Steps: 1055 | Train Loss: 0.1444598 Vali Loss: 0.5883312 Test Loss: 0.4354228
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm1_720_96_TimesNet_ETTm1_ftM_sl720_ll48_pl96_dm16_nh8_el2_dl1_df32_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
test shape: (11425, 96, 7) (11425, 96, 7)
test shape: (11425, 96, 7) (11425, 96, 7)
mse:0.3589320778846741, mae:0.39088863134384155, dtw:not calculated
