Args in experiment:
Namespace(is_training=1, model_id='ETTm1_336_720', model='iTransformer', data='ETTm1', root_path='./dataset/', data_path='ETTm1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=720, enc_in=7, dec_in=7, c_out=7, d_model=128, n_heads=8, e_layers=2, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='MSE', lradj='type1', use_amp=False, use_gpu=True, gpu=2, use_multi_gpu=False, devices='0,1,2,3', exp_name='MTSF', channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv', efficient_training=False, use_norm=True, partial_start_index=0)
Use GPU: cuda:2
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.dropout.Dropout'>.
[INFO] Register count_convNd() for <class 'torch.nn.modules.conv.Conv1d'>.
[INFO] Register count_normalization() for <class 'torch.nn.modules.normalization.LayerNorm'>.
MACs: 4346368.0
Params: 335440.0
4.35M MACs
>>>>>>>start training : ETTm1_336_720_iTransformer_ETTm1_M_ft336_sl48_ll720_pl128_dm8_nh2_el1_dl128_df1_fctimeF_ebTrue_dtExp_projection_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33505
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.5635070
	speed: 0.0532s/iter; left time: 551.5825s
	iters: 200, epoch: 1 | loss: 0.4995303
	speed: 0.0338s/iter; left time: 347.5689s
	iters: 300, epoch: 1 | loss: 0.4381159
	speed: 0.0330s/iter; left time: 335.8473s
	iters: 400, epoch: 1 | loss: 0.4173568
	speed: 0.0326s/iter; left time: 328.2763s
	iters: 500, epoch: 1 | loss: 0.5247253
	speed: 0.0334s/iter; left time: 332.6938s
	iters: 600, epoch: 1 | loss: 0.4102497
	speed: 0.0324s/iter; left time: 320.2267s
	iters: 700, epoch: 1 | loss: 0.4493183
	speed: 0.0302s/iter; left time: 295.4111s
	iters: 800, epoch: 1 | loss: 0.4433723
	speed: 0.0307s/iter; left time: 297.2880s
	iters: 900, epoch: 1 | loss: 0.3770111
	speed: 0.0306s/iter; left time: 292.4725s
	iters: 1000, epoch: 1 | loss: 0.4064634
	speed: 0.0314s/iter; left time: 297.5935s
Max Memory (MB): 17.63671875
Epoch: 1 cost time: 35.7673716545105
Epoch: 1, Steps: 1047 | Train Loss: 0.4608030 Vali Loss: 0.9526312 Test Loss: 0.4390115
Validation loss decreased (inf --> 0.952631).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3931292
	speed: 0.8398s/iter; left time: 7830.0017s
	iters: 200, epoch: 2 | loss: 0.4527754
	speed: 0.0342s/iter; left time: 315.6564s
	iters: 300, epoch: 2 | loss: 0.4549014
	speed: 0.0328s/iter; left time: 299.3842s
	iters: 400, epoch: 2 | loss: 0.4134837
	speed: 0.0350s/iter; left time: 315.5766s
	iters: 500, epoch: 2 | loss: 0.4168134
	speed: 0.0394s/iter; left time: 351.4344s
	iters: 600, epoch: 2 | loss: 0.3623129
	speed: 0.0386s/iter; left time: 340.2238s
	iters: 700, epoch: 2 | loss: 0.3792919
	speed: 0.0396s/iter; left time: 345.6501s
	iters: 800, epoch: 2 | loss: 0.3527371
	speed: 0.0418s/iter; left time: 360.2440s
	iters: 900, epoch: 2 | loss: 0.3917807
	speed: 0.0399s/iter; left time: 339.9348s
	iters: 1000, epoch: 2 | loss: 0.3914497
	speed: 0.0368s/iter; left time: 310.2954s
Max Memory (MB): 17.63671875
Epoch: 2 cost time: 39.55377244949341
Epoch: 2, Steps: 1047 | Train Loss: 0.4119923 Vali Loss: 0.9557375 Test Loss: 0.4390601
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4545773
	speed: 0.8360s/iter; left time: 6919.6050s
	iters: 200, epoch: 3 | loss: 0.3998549
	speed: 0.0339s/iter; left time: 276.8352s
	iters: 300, epoch: 3 | loss: 0.3429905
	speed: 0.0299s/iter; left time: 241.4245s
	iters: 400, epoch: 3 | loss: 0.4866228
	speed: 0.0296s/iter; left time: 235.8123s
	iters: 500, epoch: 3 | loss: 0.3732517
	speed: 0.0289s/iter; left time: 228.0090s
	iters: 600, epoch: 3 | loss: 0.3303171
	speed: 0.0303s/iter; left time: 235.5535s
	iters: 700, epoch: 3 | loss: 0.4298397
	speed: 0.0288s/iter; left time: 220.7913s
	iters: 800, epoch: 3 | loss: 0.4110608
	speed: 0.0298s/iter; left time: 225.9939s
	iters: 900, epoch: 3 | loss: 0.3888605
	speed: 0.0294s/iter; left time: 219.8599s
	iters: 1000, epoch: 3 | loss: 0.3795515
	speed: 0.0283s/iter; left time: 208.7737s
Max Memory (MB): 17.63671875
Epoch: 3 cost time: 32.62801432609558
Epoch: 3, Steps: 1047 | Train Loss: 0.3964547 Vali Loss: 0.9709094 Test Loss: 0.4391680
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4032845
	speed: 0.8664s/iter; left time: 6263.7945s
	iters: 200, epoch: 4 | loss: 0.3566485
	speed: 0.0404s/iter; left time: 288.0334s
	iters: 300, epoch: 4 | loss: 0.3578556
	speed: 0.0397s/iter; left time: 279.2213s
	iters: 400, epoch: 4 | loss: 0.3585365
	speed: 0.0303s/iter; left time: 210.0225s
	iters: 500, epoch: 4 | loss: 0.3125588
	speed: 0.0301s/iter; left time: 205.7119s
	iters: 600, epoch: 4 | loss: 0.3929967
	speed: 0.0276s/iter; left time: 185.9655s
	iters: 700, epoch: 4 | loss: 0.3599717
	speed: 0.0290s/iter; left time: 192.4196s
	iters: 800, epoch: 4 | loss: 0.4068724
	speed: 0.0276s/iter; left time: 180.0071s
	iters: 900, epoch: 4 | loss: 0.3023397
	speed: 0.0282s/iter; left time: 181.1099s
	iters: 1000, epoch: 4 | loss: 0.3395551
	speed: 0.0291s/iter; left time: 183.9414s
Max Memory (MB): 17.63671875
Epoch: 4 cost time: 34.72028613090515
Epoch: 4, Steps: 1047 | Train Loss: 0.3900531 Vali Loss: 0.9655910 Test Loss: 0.4398396
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm1_336_720_iTransformer_ETTm1_M_ft336_sl48_ll720_pl128_dm8_nh2_el1_dl128_df1_fctimeF_ebTrue_dtExp_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
test shape: (10801, 1, 720, 7) (10801, 1, 720, 7)
test shape: (10801, 720, 7) (10801, 720, 7)
mse:0.4390111565589905, mae:0.43610164523124695
