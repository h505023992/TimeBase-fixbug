Args in experiment:
Namespace(is_training=1, train_only=False, model_id='Autoformer_traffic_336_96', model='Autoformer', data='custom', root_path='./dataset/', data_path='traffic.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, individual=False, embed_type=0, enc_in=862, dec_in=862, c_out=862, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : Autoformer_traffic_336_96_Autoformer_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11849
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.3593163
	speed: 0.2651s/iter; left time: 2924.4869s
	iters: 200, epoch: 1 | loss: 0.2907573
	speed: 0.2294s/iter; left time: 2507.4291s
	iters: 300, epoch: 1 | loss: 0.2615785
	speed: 0.2325s/iter; left time: 2518.1677s
Epoch: 1 cost time: 89.06393671035767
Epoch: 1, Steps: 371 | Train Loss: 0.3487192 Vali Loss: 0.4966073 Test Loss: 0.6612313
Validation loss decreased (inf --> 0.496607).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2185980
	speed: 0.7668s/iter; left time: 8174.5965s
	iters: 200, epoch: 2 | loss: 0.2202620
	speed: 0.2346s/iter; left time: 2477.5453s
	iters: 300, epoch: 2 | loss: 0.2221612
	speed: 0.2318s/iter; left time: 2424.4606s
Epoch: 2 cost time: 88.11145830154419
Epoch: 2, Steps: 371 | Train Loss: 0.2311692 Vali Loss: 0.4842553 Test Loss: 0.6640433
Validation loss decreased (0.496607 --> 0.484255).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2187593
	speed: 0.7473s/iter; left time: 7688.6101s
	iters: 200, epoch: 3 | loss: 0.2186495
	speed: 0.2282s/iter; left time: 2325.3308s
	iters: 300, epoch: 3 | loss: 0.1948028
	speed: 0.2308s/iter; left time: 2328.8548s
Epoch: 3 cost time: 86.34957098960876
Epoch: 3, Steps: 371 | Train Loss: 0.2094557 Vali Loss: 0.4766903 Test Loss: 0.6586053
Validation loss decreased (0.484255 --> 0.476690).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1964170
	speed: 0.7592s/iter; left time: 7529.7620s
	iters: 200, epoch: 4 | loss: 0.2048876
	speed: 0.2311s/iter; left time: 2268.7247s
	iters: 300, epoch: 4 | loss: 0.1958682
	speed: 0.2319s/iter; left time: 2253.8191s
Epoch: 4 cost time: 86.70336651802063
Epoch: 4, Steps: 371 | Train Loss: 0.2010360 Vali Loss: 0.4752152 Test Loss: 0.6695667
Validation loss decreased (0.476690 --> 0.475215).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1937730
	speed: 0.7893s/iter; left time: 7535.6995s
	iters: 200, epoch: 5 | loss: 0.1901127
	speed: 0.2624s/iter; left time: 2478.9604s
	iters: 300, epoch: 5 | loss: 0.2025391
	speed: 0.2606s/iter; left time: 2436.2695s
Epoch: 5 cost time: 97.10458278656006
Epoch: 5, Steps: 371 | Train Loss: 0.1971602 Vali Loss: 0.4742573 Test Loss: 0.6615757
Validation loss decreased (0.475215 --> 0.474257).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1980403
	speed: 0.8382s/iter; left time: 7691.7005s
	iters: 200, epoch: 6 | loss: 0.1866088
	speed: 0.2414s/iter; left time: 2190.4944s
	iters: 300, epoch: 6 | loss: 0.2033125
	speed: 0.2411s/iter; left time: 2163.8576s
Epoch: 6 cost time: 90.52781772613525
Epoch: 6, Steps: 371 | Train Loss: 0.1951414 Vali Loss: 0.4758615 Test Loss: 0.6684415
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1954593
	speed: 0.8227s/iter; left time: 7243.6661s
	iters: 200, epoch: 7 | loss: 0.2128987
	speed: 0.2431s/iter; left time: 2116.5222s
	iters: 300, epoch: 7 | loss: 0.2050899
	speed: 0.2432s/iter; left time: 2093.1187s
Epoch: 7 cost time: 91.12157678604126
Epoch: 7, Steps: 371 | Train Loss: 0.1940055 Vali Loss: 0.4768227 Test Loss: 0.6653903
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1969299
	speed: 0.8384s/iter; left time: 7070.8604s
	iters: 200, epoch: 8 | loss: 0.2006091
	speed: 0.2410s/iter; left time: 2008.3285s
	iters: 300, epoch: 8 | loss: 0.2009915
	speed: 0.2360s/iter; left time: 1943.1211s
Epoch: 8 cost time: 90.09696507453918
Epoch: 8, Steps: 371 | Train Loss: 0.1933753 Vali Loss: 0.4781792 Test Loss: 0.6682279
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Autoformer_traffic_336_96_Autoformer_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
mse:0.6622504591941833, mae:0.4059584140777588
