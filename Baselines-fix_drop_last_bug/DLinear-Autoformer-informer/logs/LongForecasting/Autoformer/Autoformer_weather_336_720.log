Args in experiment:
Namespace(is_training=1, train_only=False, model_id='Autoformer_weather_336_720', model='Autoformer', data='custom', root_path='./dataset/', data_path='weather.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=720, individual=False, embed_type=0, enc_in=21, dec_in=21, c_out=21, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : Autoformer_weather_336_720_Autoformer_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35832
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.7744080
	speed: 0.3329s/iter; left time: 11151.5028s
	iters: 200, epoch: 1 | loss: 0.7933780
	speed: 0.2954s/iter; left time: 9868.1037s
	iters: 300, epoch: 1 | loss: 0.6718639
	speed: 0.2911s/iter; left time: 9695.1198s
	iters: 400, epoch: 1 | loss: 0.5281333
	speed: 0.2844s/iter; left time: 9441.1237s
	iters: 500, epoch: 1 | loss: 0.6679863
	speed: 0.2912s/iter; left time: 9639.0090s
	iters: 600, epoch: 1 | loss: 0.6102145
	speed: 0.2951s/iter; left time: 9740.1447s
	iters: 700, epoch: 1 | loss: 0.8414206
	speed: 0.2818s/iter; left time: 9270.6685s
	iters: 800, epoch: 1 | loss: 0.5657285
	speed: 0.2787s/iter; left time: 9142.2370s
	iters: 900, epoch: 1 | loss: 0.5053135
	speed: 0.2864s/iter; left time: 9364.1192s
	iters: 1000, epoch: 1 | loss: 0.6075283
	speed: 0.2889s/iter; left time: 9417.3222s
	iters: 1100, epoch: 1 | loss: 0.8102850
	speed: 0.2847s/iter; left time: 9254.5682s
Epoch: 1 cost time: 327.0132563114166
Epoch: 1, Steps: 1120 | Train Loss: 0.6539213 Vali Loss: 0.8406164 Test Loss: 0.5317889
Validation loss decreased (inf --> 0.840616).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7575437
	speed: 1.6531s/iter; left time: 53530.1667s
	iters: 200, epoch: 2 | loss: 0.6013831
	speed: 0.2886s/iter; left time: 9316.8078s
	iters: 300, epoch: 2 | loss: 0.5695921
	speed: 0.2936s/iter; left time: 9448.9825s
	iters: 400, epoch: 2 | loss: 0.6497542
	speed: 0.3003s/iter; left time: 9633.8601s
	iters: 500, epoch: 2 | loss: 0.4846250
	speed: 0.2976s/iter; left time: 9517.6783s
	iters: 600, epoch: 2 | loss: 0.5497108
	speed: 0.3001s/iter; left time: 9568.9489s
	iters: 700, epoch: 2 | loss: 0.4882137
	speed: 0.3007s/iter; left time: 9556.4752s
	iters: 800, epoch: 2 | loss: 0.4845375
	speed: 0.2866s/iter; left time: 9079.2744s
	iters: 900, epoch: 2 | loss: 0.4805911
	speed: 0.2822s/iter; left time: 8912.3519s
	iters: 1000, epoch: 2 | loss: 0.6060401
	speed: 0.2805s/iter; left time: 8828.9242s
	iters: 1100, epoch: 2 | loss: 0.6686828
	speed: 0.2899s/iter; left time: 9097.5043s
Epoch: 2 cost time: 328.21332335472107
Epoch: 2, Steps: 1120 | Train Loss: 0.5798964 Vali Loss: 0.9254080 Test Loss: 0.6237997
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4486096
	speed: 1.6473s/iter; left time: 51495.9051s
	iters: 200, epoch: 3 | loss: 0.7364712
	speed: 0.2853s/iter; left time: 8891.7638s
	iters: 300, epoch: 3 | loss: 0.5892701
	speed: 0.2878s/iter; left time: 8937.9349s
	iters: 400, epoch: 3 | loss: 0.4474839
	speed: 0.2884s/iter; left time: 8930.0422s
	iters: 500, epoch: 3 | loss: 0.4669186
	speed: 0.2891s/iter; left time: 8922.1786s
	iters: 600, epoch: 3 | loss: 0.6500309
	speed: 0.2895s/iter; left time: 8906.1369s
	iters: 700, epoch: 3 | loss: 0.4089285
	speed: 0.2900s/iter; left time: 8892.4603s
	iters: 800, epoch: 3 | loss: 0.6233090
	speed: 0.2890s/iter; left time: 8830.9064s
	iters: 900, epoch: 3 | loss: 0.4991326
	speed: 0.2987s/iter; left time: 9097.5490s
	iters: 1000, epoch: 3 | loss: 0.4619957
	speed: 0.2990s/iter; left time: 9078.4357s
	iters: 1100, epoch: 3 | loss: 0.6960353
	speed: 0.3018s/iter; left time: 9133.9664s
Epoch: 3 cost time: 327.25497603416443
Epoch: 3, Steps: 1120 | Train Loss: 0.5128158 Vali Loss: 0.8723137 Test Loss: 0.6175720
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4689454
	speed: 1.5490s/iter; left time: 46687.2996s
	iters: 200, epoch: 4 | loss: 0.4298003
	speed: 0.2887s/iter; left time: 8673.8338s
	iters: 300, epoch: 4 | loss: 0.4686611
	speed: 0.2898s/iter; left time: 8677.4091s
	iters: 400, epoch: 4 | loss: 0.4841205
	speed: 0.2902s/iter; left time: 8658.4125s
	iters: 500, epoch: 4 | loss: 0.4240033
	speed: 0.2950s/iter; left time: 8772.1688s
	iters: 600, epoch: 4 | loss: 0.3903654
	speed: 0.2975s/iter; left time: 8816.7356s
	iters: 700, epoch: 4 | loss: 0.5893679
	speed: 0.2822s/iter; left time: 8337.4946s
	iters: 800, epoch: 4 | loss: 0.4330772
	speed: 0.2793s/iter; left time: 8222.7763s
	iters: 900, epoch: 4 | loss: 0.4288353
	speed: 0.2953s/iter; left time: 8665.5863s
	iters: 1000, epoch: 4 | loss: 0.4101045
	speed: 0.2967s/iter; left time: 8675.5827s
	iters: 1100, epoch: 4 | loss: 0.4861006
	speed: 0.2926s/iter; left time: 8525.8485s
Epoch: 4 cost time: 326.03955245018005
Epoch: 4, Steps: 1120 | Train Loss: 0.4824060 Vali Loss: 0.8786862 Test Loss: 0.5908382
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Autoformer_weather_336_720_Autoformer_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
mse:0.5315180420875549, mae:0.4994412660598755
