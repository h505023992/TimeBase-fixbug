Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='192_96', model='PatchTST', data='custom', root_path='./dataset/', data_path='weather.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=192, label_len=48, pred_len=96, fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=21, dec_in=7, c_out=7, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=32, patience=5, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=1, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:1
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.dropout.Dropout'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.container.Sequential'>.
[INFO] Register count_normalization() for <class 'torch.nn.modules.batchnorm.BatchNorm1d'>.
MACs: 206954496.0
Params: 694624.0
206.95M MACs
>>>>>>>start training : 192_96_PatchTST_custom_ftM_sl192_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36600
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 1.4737244
	speed: 0.0660s/iter; left time: 2259.9722s
	iters: 200, epoch: 1 | loss: 0.6143404
	speed: 0.0680s/iter; left time: 2321.6664s
	iters: 300, epoch: 1 | loss: 1.3463432
	speed: 0.0610s/iter; left time: 2075.5933s
	iters: 400, epoch: 1 | loss: 0.5719509
	speed: 0.0594s/iter; left time: 2014.2921s
	iters: 500, epoch: 1 | loss: 0.5368368
	speed: 0.0666s/iter; left time: 2253.2312s
	iters: 600, epoch: 1 | loss: 0.9515474
	speed: 0.0620s/iter; left time: 2091.3216s
	iters: 700, epoch: 1 | loss: 0.4489409
	speed: 0.0618s/iter; left time: 2076.5330s
	iters: 800, epoch: 1 | loss: 0.4775309
	speed: 0.0622s/iter; left time: 2084.6825s
	iters: 900, epoch: 1 | loss: 0.6828139
	speed: 0.0640s/iter; left time: 2138.5039s
	iters: 1000, epoch: 1 | loss: 0.4109400
	speed: 0.0620s/iter; left time: 2064.3869s
	iters: 1100, epoch: 1 | loss: 1.2859656
	speed: 0.0602s/iter; left time: 1998.8744s
Epoch: 1 cost time: 72.11232280731201
Epoch: 1, Steps: 1144 | Train Loss: 0.6842585 Vali Loss: 0.5160424 Test Loss: 0.2102365
Validation loss decreased (inf --> 0.516042).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 1.3111757
	speed: 0.4588s/iter; left time: 15174.6546s
	iters: 200, epoch: 2 | loss: 1.2099860
	speed: 0.0649s/iter; left time: 2141.3216s
	iters: 300, epoch: 2 | loss: 0.3303968
	speed: 0.0626s/iter; left time: 2056.6717s
	iters: 400, epoch: 2 | loss: 0.4403163
	speed: 0.0658s/iter; left time: 2157.4570s
	iters: 500, epoch: 2 | loss: 0.4211705
	speed: 0.0631s/iter; left time: 2061.8731s
	iters: 600, epoch: 2 | loss: 0.2820386
	speed: 0.0627s/iter; left time: 2042.3673s
	iters: 700, epoch: 2 | loss: 0.3727897
	speed: 0.0600s/iter; left time: 1948.4885s
	iters: 800, epoch: 2 | loss: 0.4483923
	speed: 0.0574s/iter; left time: 1858.3696s
	iters: 900, epoch: 2 | loss: 0.4163237
	speed: 0.0595s/iter; left time: 1920.6861s
	iters: 1000, epoch: 2 | loss: 0.4836877
	speed: 0.0596s/iter; left time: 1917.2756s
	iters: 1100, epoch: 2 | loss: 0.4821641
	speed: 0.0672s/iter; left time: 2156.6026s
Epoch: 2 cost time: 72.94839859008789
Epoch: 2, Steps: 1144 | Train Loss: 0.4852942 Vali Loss: 0.4199912 Test Loss: 0.1746915
Validation loss decreased (0.516042 --> 0.419991).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.3034461
	speed: 0.4528s/iter; left time: 14458.6201s
	iters: 200, epoch: 3 | loss: 0.4835748
	speed: 0.0594s/iter; left time: 1889.9666s
	iters: 300, epoch: 3 | loss: 0.3807663
	speed: 0.0621s/iter; left time: 1970.5836s
	iters: 400, epoch: 3 | loss: 0.3776148
	speed: 0.0614s/iter; left time: 1942.5012s
	iters: 500, epoch: 3 | loss: 0.5066193
	speed: 0.0615s/iter; left time: 1938.4317s
	iters: 600, epoch: 3 | loss: 0.2856944
	speed: 0.0575s/iter; left time: 1807.9168s
	iters: 700, epoch: 3 | loss: 0.4074220
	speed: 0.0705s/iter; left time: 2208.8496s
	iters: 800, epoch: 3 | loss: 0.2863712
	speed: 0.0592s/iter; left time: 1850.3000s
	iters: 900, epoch: 3 | loss: 0.3348181
	speed: 0.0593s/iter; left time: 1847.5745s
	iters: 1000, epoch: 3 | loss: 1.4207954
	speed: 0.0668s/iter; left time: 2072.1018s
	iters: 1100, epoch: 3 | loss: 0.4351018
	speed: 0.0615s/iter; left time: 1903.4451s
Epoch: 3 cost time: 71.98656988143921
Epoch: 3, Steps: 1144 | Train Loss: 0.4588936 Vali Loss: 0.4079790 Test Loss: 0.1650903
Validation loss decreased (0.419991 --> 0.407979).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3113647
	speed: 0.4326s/iter; left time: 13317.9688s
	iters: 200, epoch: 4 | loss: 0.5866099
	speed: 0.0595s/iter; left time: 1825.2859s
	iters: 300, epoch: 4 | loss: 0.3797752
	speed: 0.0641s/iter; left time: 1959.3813s
	iters: 400, epoch: 4 | loss: 0.3373812
	speed: 0.0618s/iter; left time: 1884.1941s
	iters: 500, epoch: 4 | loss: 0.6117929
	speed: 0.0590s/iter; left time: 1793.3177s
	iters: 600, epoch: 4 | loss: 0.3054698
	speed: 0.0628s/iter; left time: 1901.7404s
	iters: 700, epoch: 4 | loss: 1.2887189
	speed: 0.0682s/iter; left time: 2057.7125s
	iters: 800, epoch: 4 | loss: 0.3051938
	speed: 0.0630s/iter; left time: 1896.5103s
	iters: 900, epoch: 4 | loss: 0.2875102
	speed: 0.0628s/iter; left time: 1882.6913s
	iters: 1000, epoch: 4 | loss: 0.3083845
	speed: 0.0638s/iter; left time: 1906.3479s
	iters: 1100, epoch: 4 | loss: 0.4640760
	speed: 0.0640s/iter; left time: 1907.6266s
Epoch: 4 cost time: 72.50085425376892
Epoch: 4, Steps: 1144 | Train Loss: 0.4470984 Vali Loss: 0.4096332 Test Loss: 0.1633045
EarlyStopping counter: 1 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 1.1617813
	speed: 0.4438s/iter; left time: 13155.2012s
	iters: 200, epoch: 5 | loss: 0.3554447
	speed: 0.0645s/iter; left time: 1906.2369s
	iters: 300, epoch: 5 | loss: 0.3775830
	speed: 0.0670s/iter; left time: 1973.7366s
	iters: 400, epoch: 5 | loss: 0.4772188
	speed: 0.0642s/iter; left time: 1883.6828s
	iters: 500, epoch: 5 | loss: 0.4406874
	speed: 0.0625s/iter; left time: 1826.6044s
	iters: 600, epoch: 5 | loss: 0.3539902
	speed: 0.0624s/iter; left time: 1819.9522s
	iters: 700, epoch: 5 | loss: 0.3013496
	speed: 0.0597s/iter; left time: 1733.8353s
	iters: 800, epoch: 5 | loss: 0.3369345
	speed: 0.0624s/iter; left time: 1804.7520s
	iters: 900, epoch: 5 | loss: 0.2559102
	speed: 0.0602s/iter; left time: 1736.1483s
	iters: 1000, epoch: 5 | loss: 0.2243604
	speed: 0.0574s/iter; left time: 1650.3106s
	iters: 1100, epoch: 5 | loss: 0.2664293
	speed: 0.0598s/iter; left time: 1712.0750s
Epoch: 5 cost time: 71.53517866134644
Epoch: 5, Steps: 1144 | Train Loss: 0.4409867 Vali Loss: 0.4079864 Test Loss: 0.1601580
EarlyStopping counter: 2 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.3059581
	speed: 0.4534s/iter; left time: 12923.1700s
	iters: 200, epoch: 6 | loss: 0.4488215
	speed: 0.0646s/iter; left time: 1835.4857s
	iters: 300, epoch: 6 | loss: 0.3497917
	speed: 0.0650s/iter; left time: 1838.7476s
	iters: 400, epoch: 6 | loss: 0.3456101
	speed: 0.0686s/iter; left time: 1935.9589s
	iters: 500, epoch: 6 | loss: 1.2399564
	speed: 0.0637s/iter; left time: 1788.7366s
	iters: 600, epoch: 6 | loss: 0.3006783
	speed: 0.0620s/iter; left time: 1735.6452s
	iters: 700, epoch: 6 | loss: 0.3382186
	speed: 0.0642s/iter; left time: 1791.1700s
	iters: 800, epoch: 6 | loss: 0.2728124
	speed: 0.0659s/iter; left time: 1831.0174s
	iters: 900, epoch: 6 | loss: 0.3679247
	speed: 0.0635s/iter; left time: 1759.6879s
	iters: 1000, epoch: 6 | loss: 0.2420346
	speed: 0.0611s/iter; left time: 1686.9767s
	iters: 1100, epoch: 6 | loss: 0.2763051
	speed: 0.0634s/iter; left time: 1742.4253s
Epoch: 6 cost time: 74.66281199455261
Epoch: 6, Steps: 1144 | Train Loss: 0.4358890 Vali Loss: 0.4063003 Test Loss: 0.1597725
Validation loss decreased (0.407979 --> 0.406300).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.3669307
	speed: 0.4525s/iter; left time: 12377.8963s
	iters: 200, epoch: 7 | loss: 0.3656218
	speed: 0.0587s/iter; left time: 1599.9403s
	iters: 300, epoch: 7 | loss: 0.2917067
	speed: 0.0610s/iter; left time: 1656.6768s
	iters: 400, epoch: 7 | loss: 0.4750580
	speed: 0.0613s/iter; left time: 1659.5133s
	iters: 500, epoch: 7 | loss: 0.3255018
	speed: 0.0668s/iter; left time: 1801.6946s
	iters: 600, epoch: 7 | loss: 0.4236035
	speed: 0.0594s/iter; left time: 1595.0953s
	iters: 700, epoch: 7 | loss: 0.5312735
	speed: 0.0606s/iter; left time: 1622.2923s
	iters: 800, epoch: 7 | loss: 0.3008735
	speed: 0.0664s/iter; left time: 1770.7953s
	iters: 900, epoch: 7 | loss: 0.3890195
	speed: 0.0641s/iter; left time: 1701.6821s
	iters: 1000, epoch: 7 | loss: 0.4293913
	speed: 0.0625s/iter; left time: 1652.3785s
	iters: 1100, epoch: 7 | loss: 0.3814679
	speed: 0.0631s/iter; left time: 1663.2409s
Epoch: 7 cost time: 71.94087648391724
Epoch: 7, Steps: 1144 | Train Loss: 0.4320803 Vali Loss: 0.4039816 Test Loss: 0.1580541
Validation loss decreased (0.406300 --> 0.403982).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.2337082
	speed: 0.4350s/iter; left time: 11402.0837s
	iters: 200, epoch: 8 | loss: 0.5156483
	speed: 0.0581s/iter; left time: 1518.2603s
	iters: 300, epoch: 8 | loss: 0.2857106
	speed: 0.0580s/iter; left time: 1507.9721s
	iters: 400, epoch: 8 | loss: 0.3155653
	speed: 0.0667s/iter; left time: 1727.8381s
	iters: 500, epoch: 8 | loss: 0.4080171
	speed: 0.0603s/iter; left time: 1557.0525s
	iters: 600, epoch: 8 | loss: 0.3863991
	speed: 0.0628s/iter; left time: 1614.5647s
	iters: 700, epoch: 8 | loss: 0.3141542
	speed: 0.0632s/iter; left time: 1618.5352s
	iters: 800, epoch: 8 | loss: 0.3282025
	speed: 0.0598s/iter; left time: 1524.9543s
	iters: 900, epoch: 8 | loss: 0.3660102
	speed: 0.0616s/iter; left time: 1564.8518s
	iters: 1000, epoch: 8 | loss: 0.3659899
	speed: 0.0644s/iter; left time: 1630.6639s
	iters: 1100, epoch: 8 | loss: 0.2779969
	speed: 0.0607s/iter; left time: 1529.7651s
Epoch: 8 cost time: 71.82631850242615
Epoch: 8, Steps: 1144 | Train Loss: 0.4285513 Vali Loss: 0.4020563 Test Loss: 0.1571931
Validation loss decreased (0.403982 --> 0.402056).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.2432681
	speed: 0.4544s/iter; left time: 11390.8736s
	iters: 200, epoch: 9 | loss: 0.2460677
	speed: 0.0619s/iter; left time: 1544.4532s
	iters: 300, epoch: 9 | loss: 0.3598461
	speed: 0.0650s/iter; left time: 1616.6766s
	iters: 400, epoch: 9 | loss: 0.3016734
	speed: 0.0657s/iter; left time: 1626.6116s
	iters: 500, epoch: 9 | loss: 0.3059243
	speed: 0.0648s/iter; left time: 1599.6221s
	iters: 600, epoch: 9 | loss: 0.2607204
	speed: 0.0684s/iter; left time: 1680.1375s
	iters: 700, epoch: 9 | loss: 0.3186370
	speed: 0.0628s/iter; left time: 1537.2416s
	iters: 800, epoch: 9 | loss: 0.4002454
	speed: 0.0626s/iter; left time: 1524.4790s
	iters: 900, epoch: 9 | loss: 0.2776670
	speed: 0.0593s/iter; left time: 1439.5088s
	iters: 1000, epoch: 9 | loss: 0.5835305
	speed: 0.0654s/iter; left time: 1580.2703s
	iters: 1100, epoch: 9 | loss: 0.3556857
	speed: 0.0584s/iter; left time: 1406.0576s
Epoch: 9 cost time: 73.5641942024231
Epoch: 9, Steps: 1144 | Train Loss: 0.4252557 Vali Loss: 0.3997020 Test Loss: 0.1577944
Validation loss decreased (0.402056 --> 0.399702).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.4622903
	speed: 0.4608s/iter; left time: 11024.0273s
	iters: 200, epoch: 10 | loss: 0.4650640
	speed: 0.0619s/iter; left time: 1474.4153s
	iters: 300, epoch: 10 | loss: 1.1831430
	speed: 0.0580s/iter; left time: 1376.6414s
	iters: 400, epoch: 10 | loss: 0.4370572
	speed: 0.0578s/iter; left time: 1365.3245s
	iters: 500, epoch: 10 | loss: 0.2936641
	speed: 0.0606s/iter; left time: 1424.5155s
	iters: 600, epoch: 10 | loss: 0.4786028
	speed: 0.0653s/iter; left time: 1529.2047s
	iters: 700, epoch: 10 | loss: 0.3467456
	speed: 0.0587s/iter; left time: 1370.1108s
	iters: 800, epoch: 10 | loss: 1.0144933
	speed: 0.0628s/iter; left time: 1459.5557s
	iters: 900, epoch: 10 | loss: 0.2791694
	speed: 0.0675s/iter; left time: 1561.7252s
	iters: 1000, epoch: 10 | loss: 0.4065696
	speed: 0.0642s/iter; left time: 1478.3459s
	iters: 1100, epoch: 10 | loss: 0.3266802
	speed: 0.0613s/iter; left time: 1406.0177s
Epoch: 10 cost time: 71.80512380599976
Epoch: 10, Steps: 1144 | Train Loss: 0.4223791 Vali Loss: 0.4010459 Test Loss: 0.1573730
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.3593818
	speed: 0.4532s/iter; left time: 10323.2220s
	iters: 200, epoch: 11 | loss: 0.3859910
	speed: 0.0693s/iter; left time: 1570.6917s
	iters: 300, epoch: 11 | loss: 0.3551392
	speed: 0.0622s/iter; left time: 1404.7862s
	iters: 400, epoch: 11 | loss: 0.9895501
	speed: 0.0596s/iter; left time: 1340.8734s
	iters: 500, epoch: 11 | loss: 0.4509183
	speed: 0.0671s/iter; left time: 1501.6979s
	iters: 600, epoch: 11 | loss: 0.3639610
	speed: 0.0624s/iter; left time: 1389.6022s
	iters: 700, epoch: 11 | loss: 0.3635954
	speed: 0.0608s/iter; left time: 1348.2228s
	iters: 800, epoch: 11 | loss: 0.2620829
	speed: 0.0643s/iter; left time: 1419.1193s
	iters: 900, epoch: 11 | loss: 0.3204158
	speed: 0.0629s/iter; left time: 1382.9988s
	iters: 1000, epoch: 11 | loss: 0.3004649
	speed: 0.0630s/iter; left time: 1378.4658s
	iters: 1100, epoch: 11 | loss: 0.3363535
	speed: 0.0620s/iter; left time: 1350.6801s
Epoch: 11 cost time: 73.2972309589386
Epoch: 11, Steps: 1144 | Train Loss: 0.4207441 Vali Loss: 0.3982022 Test Loss: 0.1575289
Validation loss decreased (0.399702 --> 0.398202).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.3121327
	speed: 0.4351s/iter; left time: 9413.5002s
	iters: 200, epoch: 12 | loss: 0.4635495
	speed: 0.0707s/iter; left time: 1523.2104s
	iters: 300, epoch: 12 | loss: 0.3469574
	speed: 0.0627s/iter; left time: 1344.9074s
	iters: 400, epoch: 12 | loss: 0.9315389
	speed: 0.0624s/iter; left time: 1330.5835s
	iters: 500, epoch: 12 | loss: 0.3310909
	speed: 0.0602s/iter; left time: 1277.7645s
	iters: 600, epoch: 12 | loss: 0.3497693
	speed: 0.0619s/iter; left time: 1308.6938s
	iters: 700, epoch: 12 | loss: 0.2523107
	speed: 0.0643s/iter; left time: 1352.3694s
	iters: 800, epoch: 12 | loss: 0.4380316
	speed: 0.0585s/iter; left time: 1224.1072s
	iters: 900, epoch: 12 | loss: 0.2898533
	speed: 0.0602s/iter; left time: 1253.7097s
	iters: 1000, epoch: 12 | loss: 0.2871899
	speed: 0.0657s/iter; left time: 1363.3553s
	iters: 1100, epoch: 12 | loss: 0.2858438
	speed: 0.0606s/iter; left time: 1250.3128s
Epoch: 12 cost time: 73.07641100883484
Epoch: 12, Steps: 1144 | Train Loss: 0.4180755 Vali Loss: 0.4023834 Test Loss: 0.1580229
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.2685061
	speed: 0.4286s/iter; left time: 8783.5482s
	iters: 200, epoch: 13 | loss: 0.2486279
	speed: 0.0622s/iter; left time: 1268.7835s
	iters: 300, epoch: 13 | loss: 0.2776853
	speed: 0.0648s/iter; left time: 1315.9775s
	iters: 400, epoch: 13 | loss: 0.2837971
	speed: 0.0651s/iter; left time: 1315.3748s
	iters: 500, epoch: 13 | loss: 0.3363017
	speed: 0.0650s/iter; left time: 1306.7083s
	iters: 600, epoch: 13 | loss: 0.3728886
	speed: 0.0625s/iter; left time: 1248.9182s
	iters: 700, epoch: 13 | loss: 0.2438429
	speed: 0.0597s/iter; left time: 1186.9989s
	iters: 800, epoch: 13 | loss: 0.2504380
	speed: 0.0609s/iter; left time: 1205.1896s
	iters: 900, epoch: 13 | loss: 0.2445761
	speed: 0.0613s/iter; left time: 1208.1392s
	iters: 1000, epoch: 13 | loss: 0.4248442
	speed: 0.0699s/iter; left time: 1368.6771s
	iters: 1100, epoch: 13 | loss: 0.8890041
	speed: 0.0613s/iter; left time: 1194.1193s
Epoch: 13 cost time: 73.57784414291382
Epoch: 13, Steps: 1144 | Train Loss: 0.4162546 Vali Loss: 0.3995137 Test Loss: 0.1579964
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.2599469
	speed: 0.4719s/iter; left time: 9130.6414s
	iters: 200, epoch: 14 | loss: 0.3167797
	speed: 0.0608s/iter; left time: 1170.2857s
	iters: 300, epoch: 14 | loss: 0.4575081
	speed: 0.0592s/iter; left time: 1134.0961s
	iters: 400, epoch: 14 | loss: 0.5427935
	speed: 0.0606s/iter; left time: 1155.2778s
	iters: 500, epoch: 14 | loss: 0.5382965
	speed: 0.0608s/iter; left time: 1151.3204s
	iters: 600, epoch: 14 | loss: 0.3245580
	speed: 0.0696s/iter; left time: 1312.3611s
	iters: 700, epoch: 14 | loss: 0.2941500
	speed: 0.0600s/iter; left time: 1124.6303s
	iters: 800, epoch: 14 | loss: 1.4474685
	speed: 0.0593s/iter; left time: 1106.6610s
	iters: 900, epoch: 14 | loss: 0.4045865
	speed: 0.0699s/iter; left time: 1296.0046s
	iters: 1000, epoch: 14 | loss: 0.2178455
	speed: 0.0619s/iter; left time: 1142.3522s
	iters: 1100, epoch: 14 | loss: 0.4386025
	speed: 0.0628s/iter; left time: 1152.7787s
Epoch: 14 cost time: 72.51090049743652
Epoch: 14, Steps: 1144 | Train Loss: 0.4149320 Vali Loss: 0.3977939 Test Loss: 0.1561673
Validation loss decreased (0.398202 --> 0.397794).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.2825600
	speed: 0.4456s/iter; left time: 8111.2904s
	iters: 200, epoch: 15 | loss: 0.4017034
	speed: 0.0702s/iter; left time: 1271.1551s
	iters: 300, epoch: 15 | loss: 0.3923692
	speed: 0.0569s/iter; left time: 1024.7421s
	iters: 400, epoch: 15 | loss: 0.3872165
	speed: 0.0605s/iter; left time: 1084.0591s
	iters: 500, epoch: 15 | loss: 0.3900870
	speed: 0.0693s/iter; left time: 1233.3354s
	iters: 600, epoch: 15 | loss: 0.3076640
	speed: 0.0638s/iter; left time: 1129.3385s
	iters: 700, epoch: 15 | loss: 0.5389423
	speed: 0.0654s/iter; left time: 1150.7569s
	iters: 800, epoch: 15 | loss: 0.2651352
	speed: 0.0649s/iter; left time: 1136.7523s
	iters: 900, epoch: 15 | loss: 0.3647546
	speed: 0.0644s/iter; left time: 1121.3256s
	iters: 1000, epoch: 15 | loss: 0.4139253
	speed: 0.0621s/iter; left time: 1075.3234s
	iters: 1100, epoch: 15 | loss: 0.2667436
	speed: 0.0615s/iter; left time: 1057.8797s
Epoch: 15 cost time: 73.57992601394653
Epoch: 15, Steps: 1144 | Train Loss: 0.4140832 Vali Loss: 0.3967910 Test Loss: 0.1560789
Validation loss decreased (0.397794 --> 0.396791).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.3589584
	speed: 0.4361s/iter; left time: 7439.6030s
	iters: 200, epoch: 16 | loss: 0.3904814
	speed: 0.0668s/iter; left time: 1132.8561s
	iters: 300, epoch: 16 | loss: 0.3070759
	speed: 0.0636s/iter; left time: 1071.5572s
	iters: 400, epoch: 16 | loss: 0.2347668
	speed: 0.0638s/iter; left time: 1068.8768s
	iters: 500, epoch: 16 | loss: 0.3785142
	speed: 0.0628s/iter; left time: 1046.2232s
	iters: 600, epoch: 16 | loss: 0.4665327
	speed: 0.0627s/iter; left time: 1038.6712s
	iters: 700, epoch: 16 | loss: 0.2933185
	speed: 0.0593s/iter; left time: 975.6441s
	iters: 800, epoch: 16 | loss: 0.4019995
	speed: 0.0583s/iter; left time: 953.6945s
	iters: 900, epoch: 16 | loss: 1.3195312
	speed: 0.0638s/iter; left time: 1036.6400s
	iters: 1000, epoch: 16 | loss: 1.2443256
	speed: 0.0621s/iter; left time: 1003.9949s
	iters: 1100, epoch: 16 | loss: 0.2758677
	speed: 0.0649s/iter; left time: 1042.3405s
Epoch: 16 cost time: 72.45297861099243
Epoch: 16, Steps: 1144 | Train Loss: 0.4127678 Vali Loss: 0.3977684 Test Loss: 0.1566384
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.3278377
	speed: 0.4348s/iter; left time: 6921.2870s
	iters: 200, epoch: 17 | loss: 0.2794793
	speed: 0.0625s/iter; left time: 988.5964s
	iters: 300, epoch: 17 | loss: 1.3081634
	speed: 0.0578s/iter; left time: 909.1000s
	iters: 400, epoch: 17 | loss: 0.3702323
	speed: 0.0592s/iter; left time: 924.1652s
	iters: 500, epoch: 17 | loss: 0.4862967
	speed: 0.0604s/iter; left time: 936.9628s
	iters: 600, epoch: 17 | loss: 0.2831657
	speed: 0.0580s/iter; left time: 893.5089s
	iters: 700, epoch: 17 | loss: 0.4169209
	speed: 0.0650s/iter; left time: 995.4947s
	iters: 800, epoch: 17 | loss: 0.3407732
	speed: 0.0588s/iter; left time: 894.1255s
	iters: 900, epoch: 17 | loss: 0.3841852
	speed: 0.0609s/iter; left time: 921.3791s
	iters: 1000, epoch: 17 | loss: 0.3713446
	speed: 0.0699s/iter; left time: 1048.9537s
	iters: 1100, epoch: 17 | loss: 0.4237516
	speed: 0.0650s/iter; left time: 969.7173s
Epoch: 17 cost time: 71.56258416175842
Epoch: 17, Steps: 1144 | Train Loss: 0.4120872 Vali Loss: 0.3977924 Test Loss: 0.1563758
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.2837491
	speed: 0.4500s/iter; left time: 6648.5235s
	iters: 200, epoch: 18 | loss: 0.2600287
	speed: 0.0621s/iter; left time: 911.8947s
	iters: 300, epoch: 18 | loss: 0.2466651
	speed: 0.0621s/iter; left time: 904.7715s
	iters: 400, epoch: 18 | loss: 1.1910398
	speed: 0.0594s/iter; left time: 860.1314s
	iters: 500, epoch: 18 | loss: 0.4239473
	speed: 0.0586s/iter; left time: 841.9193s
	iters: 600, epoch: 18 | loss: 0.3369811
	speed: 0.0648s/iter; left time: 924.4939s
	iters: 700, epoch: 18 | loss: 0.2827124
	speed: 0.0642s/iter; left time: 909.6265s
	iters: 800, epoch: 18 | loss: 0.2275552
	speed: 0.0613s/iter; left time: 862.7770s
	iters: 900, epoch: 18 | loss: 0.4898955
	speed: 0.0605s/iter; left time: 845.9837s
	iters: 1000, epoch: 18 | loss: 0.2955848
	speed: 0.0603s/iter; left time: 837.0173s
	iters: 1100, epoch: 18 | loss: 0.3234677
	speed: 0.0611s/iter; left time: 841.2710s
Epoch: 18 cost time: 71.42118620872498
Epoch: 18, Steps: 1144 | Train Loss: 0.4113023 Vali Loss: 0.3999917 Test Loss: 0.1573234
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.4645368
	speed: 0.4337s/iter; left time: 5910.9272s
	iters: 200, epoch: 19 | loss: 0.3378487
	speed: 0.0662s/iter; left time: 895.4127s
	iters: 300, epoch: 19 | loss: 0.2980557
	speed: 0.0607s/iter; left time: 814.6913s
	iters: 400, epoch: 19 | loss: 0.2268087
	speed: 0.0614s/iter; left time: 818.8794s
	iters: 500, epoch: 19 | loss: 0.2952363
	speed: 0.0598s/iter; left time: 791.0627s
	iters: 600, epoch: 19 | loss: 0.3309970
	speed: 0.0621s/iter; left time: 815.6871s
	iters: 700, epoch: 19 | loss: 0.2975059
	speed: 0.0624s/iter; left time: 813.5667s
	iters: 800, epoch: 19 | loss: 0.2767348
	speed: 0.0601s/iter; left time: 777.3594s
	iters: 900, epoch: 19 | loss: 0.2166946
	speed: 0.0580s/iter; left time: 744.2359s
	iters: 1000, epoch: 19 | loss: 0.6275361
	speed: 0.0641s/iter; left time: 815.3850s
	iters: 1100, epoch: 19 | loss: 0.1590053
	speed: 0.0608s/iter; left time: 768.3955s
Epoch: 19 cost time: 71.9745523929596
Epoch: 19, Steps: 1144 | Train Loss: 0.4103895 Vali Loss: 0.3977304 Test Loss: 0.1567103
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.3324204
	speed: 0.4572s/iter; left time: 5708.5094s
	iters: 200, epoch: 20 | loss: 0.3837624
	speed: 0.0596s/iter; left time: 738.5475s
	iters: 300, epoch: 20 | loss: 0.2904271
	speed: 0.0646s/iter; left time: 794.0069s
	iters: 400, epoch: 20 | loss: 0.4026011
	speed: 0.0595s/iter; left time: 724.7218s
	iters: 500, epoch: 20 | loss: 0.4327812
	speed: 0.0601s/iter; left time: 726.5237s
	iters: 600, epoch: 20 | loss: 0.3656805
	speed: 0.0654s/iter; left time: 783.8169s
	iters: 700, epoch: 20 | loss: 0.2952044
	speed: 0.0629s/iter; left time: 747.1899s
	iters: 800, epoch: 20 | loss: 0.3203236
	speed: 0.0650s/iter; left time: 766.6003s
	iters: 900, epoch: 20 | loss: 0.4313529
	speed: 0.0602s/iter; left time: 703.2922s
	iters: 1000, epoch: 20 | loss: 0.1848218
	speed: 0.0619s/iter; left time: 716.7627s
	iters: 1100, epoch: 20 | loss: 0.3318373
	speed: 0.0683s/iter; left time: 784.7181s
Epoch: 20 cost time: 72.5165843963623
Epoch: 20, Steps: 1144 | Train Loss: 0.4097089 Vali Loss: 0.3982228 Test Loss: 0.1565069
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : 192_96_PatchTST_custom_ftM_sl192_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
mse:0.15630921721458435, mae:0.20053234696388245, rse:0.5210081338882446
