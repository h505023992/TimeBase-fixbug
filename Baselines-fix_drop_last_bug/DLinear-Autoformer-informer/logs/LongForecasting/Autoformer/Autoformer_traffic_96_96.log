Args in experiment:
Namespace(is_training=1, train_only=False, model_id='Autoformer_traffic_96_96', model='Autoformer', data='custom', root_path='./dataset/', data_path='traffic.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=96, individual=False, embed_type=0, enc_in=862, dec_in=862, c_out=862, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : Autoformer_traffic_96_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 12089
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.3787415
	speed: 0.1586s/iter; left time: 1782.6054s
	iters: 200, epoch: 1 | loss: 0.3230872
	speed: 0.1262s/iter; left time: 1406.1630s
	iters: 300, epoch: 1 | loss: 0.2859653
	speed: 0.1211s/iter; left time: 1337.4086s
Epoch: 1 cost time: 49.70175909996033
Epoch: 1, Steps: 378 | Train Loss: 0.3727153 Vali Loss: 0.4989448 Test Loss: 0.6204680
Validation loss decreased (inf --> 0.498945).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2633764
	speed: 0.4149s/iter; left time: 4507.0725s
	iters: 200, epoch: 2 | loss: 0.2568015
	speed: 0.1259s/iter; left time: 1355.2205s
	iters: 300, epoch: 2 | loss: 0.2312537
	speed: 0.1234s/iter; left time: 1315.4418s
Epoch: 2 cost time: 48.62846922874451
Epoch: 2, Steps: 378 | Train Loss: 0.2538792 Vali Loss: 0.4764910 Test Loss: 0.6484083
Validation loss decreased (0.498945 --> 0.476491).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2243828
	speed: 0.5023s/iter; left time: 5266.5123s
	iters: 200, epoch: 3 | loss: 0.2104107
	speed: 0.1196s/iter; left time: 1242.1001s
	iters: 300, epoch: 3 | loss: 0.2265893
	speed: 0.1212s/iter; left time: 1246.5501s
Epoch: 3 cost time: 47.264392137527466
Epoch: 3, Steps: 378 | Train Loss: 0.2299007 Vali Loss: 0.4748245 Test Loss: 0.7137732
Validation loss decreased (0.476491 --> 0.474824).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2089825
	speed: 0.4663s/iter; left time: 4712.8734s
	iters: 200, epoch: 4 | loss: 0.2206521
	speed: 0.1279s/iter; left time: 1279.8902s
	iters: 300, epoch: 4 | loss: 0.2231263
	speed: 0.1257s/iter; left time: 1245.3495s
Epoch: 4 cost time: 50.27348875999451
Epoch: 4, Steps: 378 | Train Loss: 0.2204686 Vali Loss: 0.4704985 Test Loss: 0.6855130
Validation loss decreased (0.474824 --> 0.470499).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2114641
	speed: 0.5093s/iter; left time: 4954.5851s
	iters: 200, epoch: 5 | loss: 0.2199361
	speed: 0.1149s/iter; left time: 1106.6334s
	iters: 300, epoch: 5 | loss: 0.2071592
	speed: 0.1232s/iter; left time: 1173.8631s
Epoch: 5 cost time: 46.451313972473145
Epoch: 5, Steps: 378 | Train Loss: 0.2159271 Vali Loss: 0.4674416 Test Loss: 0.6695629
Validation loss decreased (0.470499 --> 0.467442).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2203507
	speed: 0.5056s/iter; left time: 4727.9246s
	iters: 200, epoch: 6 | loss: 0.2192899
	speed: 0.1305s/iter; left time: 1207.1515s
	iters: 300, epoch: 6 | loss: 0.2145179
	speed: 0.1298s/iter; left time: 1187.6121s
Epoch: 6 cost time: 52.390275955200195
Epoch: 6, Steps: 378 | Train Loss: 0.2136235 Vali Loss: 0.4665931 Test Loss: 0.6569706
Validation loss decreased (0.467442 --> 0.466593).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2182931
	speed: 0.5517s/iter; left time: 4950.6154s
	iters: 200, epoch: 7 | loss: 0.2176976
	speed: 0.1306s/iter; left time: 1158.5424s
	iters: 300, epoch: 7 | loss: 0.2157163
	speed: 0.1352s/iter; left time: 1186.2383s
Epoch: 7 cost time: 51.02528381347656
Epoch: 7, Steps: 378 | Train Loss: 0.2124649 Vali Loss: 0.4649713 Test Loss: 0.6546460
Validation loss decreased (0.466593 --> 0.464971).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2219674
	speed: 0.5271s/iter; left time: 4530.2117s
	iters: 200, epoch: 8 | loss: 0.2213132
	speed: 0.1172s/iter; left time: 995.9773s
	iters: 300, epoch: 8 | loss: 0.2101284
	speed: 0.1161s/iter; left time: 974.8561s
Epoch: 8 cost time: 47.600093364715576
Epoch: 8, Steps: 378 | Train Loss: 0.2118143 Vali Loss: 0.4654998 Test Loss: 0.6588746
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1999203
	speed: 0.4699s/iter; left time: 3860.8592s
	iters: 200, epoch: 9 | loss: 0.2246593
	speed: 0.1255s/iter; left time: 1018.7172s
	iters: 300, epoch: 9 | loss: 0.2233707
	speed: 0.1267s/iter; left time: 1015.8147s
Epoch: 9 cost time: 49.09381985664368
Epoch: 9, Steps: 378 | Train Loss: 0.2114409 Vali Loss: 0.4656820 Test Loss: 0.6586908
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2027108
	speed: 0.4978s/iter; left time: 3902.5222s
	iters: 200, epoch: 10 | loss: 0.2044507
	speed: 0.1250s/iter; left time: 967.0412s
	iters: 300, epoch: 10 | loss: 0.2091122
	speed: 0.1221s/iter; left time: 932.8235s
Epoch: 10 cost time: 48.846604108810425
Epoch: 10, Steps: 378 | Train Loss: 0.2112546 Vali Loss: 0.4665292 Test Loss: 0.6647201
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Autoformer_traffic_96_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
mse:0.654732346534729, mae:0.4232802987098694
