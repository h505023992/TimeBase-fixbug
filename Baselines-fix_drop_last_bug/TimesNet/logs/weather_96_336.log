True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_336      Model:              TimesNet            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/          
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_weather_96_336_TimesNet_custom_ftM_sl96_ll48_pl336_dm32_nh8_el2_dl1_df32_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.6704316
	speed: 0.3536s/iter; left time: 12057.4879s
	iters: 200, epoch: 1 | loss: 0.5191317
	speed: 0.2621s/iter; left time: 8913.0630s
	iters: 300, epoch: 1 | loss: 0.5304478
	speed: 0.2751s/iter; left time: 9326.7315s
	iters: 400, epoch: 1 | loss: 0.7325848
	speed: 0.2818s/iter; left time: 9524.9157s
	iters: 500, epoch: 1 | loss: 0.4557821
	speed: 0.2771s/iter; left time: 9339.5198s
	iters: 600, epoch: 1 | loss: 0.8751704
	speed: 0.2860s/iter; left time: 9610.1180s
	iters: 700, epoch: 1 | loss: 0.4735374
	speed: 0.3033s/iter; left time: 10161.0585s
	iters: 800, epoch: 1 | loss: 0.5302014
	speed: 0.2863s/iter; left time: 9561.1054s
	iters: 900, epoch: 1 | loss: 0.5885770
	speed: 0.3039s/iter; left time: 10121.3522s
	iters: 1000, epoch: 1 | loss: 0.7287865
	speed: 0.2929s/iter; left time: 9725.7133s
	iters: 1100, epoch: 1 | loss: 0.4796914
	speed: 0.2847s/iter; left time: 9423.3832s
Epoch: 1 cost time: 332.2197859287262
Epoch: 1, Steps: 1140 | Train Loss: 0.6259935 Vali Loss: 0.5868829 Test Loss: 0.2806517
Validation loss decreased (inf --> 0.586883).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5020872
	speed: 1.3723s/iter; left time: 45232.7558s
	iters: 200, epoch: 2 | loss: 0.4749917
	speed: 0.2872s/iter; left time: 9436.1185s
	iters: 300, epoch: 2 | loss: 0.4185841
	speed: 0.2838s/iter; left time: 9298.5273s
	iters: 400, epoch: 2 | loss: 0.3528315
	speed: 0.2800s/iter; left time: 9144.4143s
	iters: 500, epoch: 2 | loss: 0.4749850
	speed: 0.2747s/iter; left time: 8944.3528s
	iters: 600, epoch: 2 | loss: 0.4663377
	speed: 0.2850s/iter; left time: 9252.9262s
	iters: 700, epoch: 2 | loss: 0.4847373
	speed: 0.2854s/iter; left time: 9237.0365s
	iters: 800, epoch: 2 | loss: 0.8155797
	speed: 0.2825s/iter; left time: 9115.2624s
	iters: 900, epoch: 2 | loss: 0.9630251
	speed: 0.2877s/iter; left time: 9251.3091s
	iters: 1000, epoch: 2 | loss: 0.4159628
	speed: 0.2776s/iter; left time: 8899.6890s
	iters: 1100, epoch: 2 | loss: 0.3818329
	speed: 0.2786s/iter; left time: 8904.0913s
Epoch: 2 cost time: 323.1525580883026
Epoch: 2, Steps: 1140 | Train Loss: 0.5441077 Vali Loss: 0.5810588 Test Loss: 0.2819633
Validation loss decreased (0.586883 --> 0.581059).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4612784
	speed: 1.3461s/iter; left time: 42834.4046s
	iters: 200, epoch: 3 | loss: 0.5124908
	speed: 0.2831s/iter; left time: 8979.8989s
	iters: 300, epoch: 3 | loss: 0.7643271
	speed: 0.2848s/iter; left time: 9007.2240s
	iters: 400, epoch: 3 | loss: 0.5093690
	speed: 0.2888s/iter; left time: 9104.7064s
	iters: 500, epoch: 3 | loss: 0.5567622
	speed: 0.2823s/iter; left time: 8871.3440s
	iters: 600, epoch: 3 | loss: 0.6169862
	speed: 0.2941s/iter; left time: 9210.4263s
	iters: 700, epoch: 3 | loss: 0.7480111
	speed: 0.2958s/iter; left time: 9233.7611s
	iters: 800, epoch: 3 | loss: 1.0536077
	speed: 0.2893s/iter; left time: 9004.6329s
	iters: 900, epoch: 3 | loss: 0.4253970
	speed: 0.2903s/iter; left time: 9006.1877s
	iters: 1000, epoch: 3 | loss: 0.7181116
	speed: 0.2856s/iter; left time: 8832.5035s
	iters: 1100, epoch: 3 | loss: 0.7528008
	speed: 0.2840s/iter; left time: 8754.2625s
Epoch: 3 cost time: 329.8709828853607
Epoch: 3, Steps: 1140 | Train Loss: 0.5214176 Vali Loss: 0.5874944 Test Loss: 0.2828088
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3800382
	speed: 1.5444s/iter; left time: 47382.9174s
	iters: 200, epoch: 4 | loss: 0.7800432
	speed: 0.2853s/iter; left time: 8725.8511s
	iters: 300, epoch: 4 | loss: 0.4610238
	speed: 0.2855s/iter; left time: 8700.8901s
	iters: 400, epoch: 4 | loss: 0.3631160
	speed: 0.2853s/iter; left time: 8669.0984s
	iters: 500, epoch: 4 | loss: 0.3576159
	speed: 0.2868s/iter; left time: 8685.0152s
	iters: 600, epoch: 4 | loss: 0.6702356
	speed: 0.2994s/iter; left time: 9037.4424s
	iters: 700, epoch: 4 | loss: 0.4034150
	speed: 0.2881s/iter; left time: 8667.1989s
	iters: 800, epoch: 4 | loss: 0.4044352
	speed: 0.2842s/iter; left time: 8521.3519s
	iters: 900, epoch: 4 | loss: 0.4831998
	speed: 0.2951s/iter; left time: 8818.8214s
	iters: 1000, epoch: 4 | loss: 0.3521350
	speed: 0.2866s/iter; left time: 8536.4335s
	iters: 1100, epoch: 4 | loss: 0.4576446
	speed: 0.2919s/iter; left time: 8664.4667s
Epoch: 4 cost time: 332.1346995830536
Epoch: 4, Steps: 1140 | Train Loss: 0.5105448 Vali Loss: 0.5865152 Test Loss: 0.2849529
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3820226
	speed: 1.5335s/iter; left time: 45302.2673s
	iters: 200, epoch: 5 | loss: 0.5484242
	speed: 0.2948s/iter; left time: 8679.0581s
	iters: 300, epoch: 5 | loss: 0.7724385
	speed: 0.3043s/iter; left time: 8927.3649s
	iters: 400, epoch: 5 | loss: 0.4829253
	speed: 0.2953s/iter; left time: 8634.6982s
	iters: 500, epoch: 5 | loss: 0.8661903
	speed: 0.2926s/iter; left time: 8525.7101s
	iters: 600, epoch: 5 | loss: 0.6975484
	speed: 0.2919s/iter; left time: 8476.0983s
	iters: 700, epoch: 5 | loss: 1.0066160
	speed: 0.2984s/iter; left time: 8635.5561s
	iters: 800, epoch: 5 | loss: 0.4179882
	speed: 0.2944s/iter; left time: 8491.4946s
	iters: 900, epoch: 5 | loss: 0.7756695
	speed: 0.3033s/iter; left time: 8715.7993s
	iters: 1000, epoch: 5 | loss: 0.4142989
	speed: 0.2968s/iter; left time: 8499.4527s
	iters: 1100, epoch: 5 | loss: 0.3930402
	speed: 0.2918s/iter; left time: 8329.6746s
Epoch: 5 cost time: 339.2370283603668
Epoch: 5, Steps: 1140 | Train Loss: 0.5051770 Vali Loss: 0.5907082 Test Loss: 0.2844885
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_336_TimesNet_custom_ftM_sl96_ll48_pl336_dm32_nh8_el2_dl1_df32_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
test shape: (10204, 336, 21) (10204, 336, 21)
test shape: (10204, 336, 21) (10204, 336, 21)
mse:0.28196826577186584, mae:0.30419355630874634, dtw:not calculated
