Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='ETTm2', data_path='ETTm2.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='TST', model='PatchTST', model_id='336_192', moving_avg=25, n_heads=16, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.4, pred_len=192, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : 336_192_PatchTST_ETTm2_ftM_sl336_ll48_pl192_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34033
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.3312865
	speed: 0.1324s/iter; left time: 3495.0000s
	iters: 200, epoch: 1 | loss: 0.4382438
	speed: 0.1117s/iter; left time: 2939.0601s
Epoch: 1 cost time: 31.604944467544556
Epoch: 1, Steps: 265 | Train Loss: 0.4114049 Vali Loss: 0.1839773 Test Loss: 0.2523832
Validation loss decreased (inf --> 0.183977).  Saving model ...
Updating learning rate to 4.147995888890545e-06
	iters: 100, epoch: 2 | loss: 0.2377864
	speed: 0.6798s/iter; left time: 17766.0656s
	iters: 200, epoch: 2 | loss: 0.2521552
	speed: 0.1242s/iter; left time: 3234.6171s
Epoch: 2 cost time: 34.16298580169678
Epoch: 2, Steps: 265 | Train Loss: 0.3487334 Vali Loss: 0.1711622 Test Loss: 0.2365646
Validation loss decreased (0.183977 --> 0.171162).  Saving model ...
Updating learning rate to 4.591070939598485e-06
	iters: 100, epoch: 3 | loss: 0.4668902
	speed: 0.6639s/iter; left time: 17175.0365s
	iters: 200, epoch: 3 | loss: 0.4223274
	speed: 0.1286s/iter; left time: 3313.0489s
Epoch: 3 cost time: 34.733927965164185
Epoch: 3, Steps: 265 | Train Loss: 0.3309471 Vali Loss: 0.1651658 Test Loss: 0.2291729
Validation loss decreased (0.171162 --> 0.165166).  Saving model ...
Updating learning rate to 5.326492931874866e-06
	iters: 100, epoch: 4 | loss: 0.3293460
	speed: 0.6843s/iter; left time: 17522.2404s
	iters: 200, epoch: 4 | loss: 0.4633981
	speed: 0.1299s/iter; left time: 3312.9764s
Epoch: 4 cost time: 35.06949162483215
Epoch: 4, Steps: 265 | Train Loss: 0.3207303 Vali Loss: 0.1625654 Test Loss: 0.2252035
Validation loss decreased (0.165166 --> 0.162565).  Saving model ...
Updating learning rate to 6.349726889409005e-06
	iters: 100, epoch: 5 | loss: 0.3744208
	speed: 0.6721s/iter; left time: 17031.7318s
	iters: 200, epoch: 5 | loss: 0.3648736
	speed: 0.1146s/iter; left time: 2892.8090s
Epoch: 5 cost time: 31.56419587135315
Epoch: 5, Steps: 265 | Train Loss: 0.3145981 Vali Loss: 0.1616243 Test Loss: 0.2235432
Validation loss decreased (0.162565 --> 0.161624).  Saving model ...
Updating learning rate to 7.654463044738896e-06
	iters: 100, epoch: 6 | loss: 0.3052644
	speed: 0.6505s/iter; left time: 16311.0435s
	iters: 200, epoch: 6 | loss: 0.2359602
	speed: 0.1325s/iter; left time: 3309.5129s
Epoch: 6 cost time: 35.81273150444031
Epoch: 6, Steps: 265 | Train Loss: 0.3099981 Vali Loss: 0.1595854 Test Loss: 0.2217930
Validation loss decreased (0.161624 --> 0.159585).  Saving model ...
Updating learning rate to 9.232655748403029e-06
	iters: 100, epoch: 7 | loss: 0.2474089
	speed: 0.6707s/iter; left time: 16641.2450s
	iters: 200, epoch: 7 | loss: 0.3779338
	speed: 0.1324s/iter; left time: 3271.9655s
Epoch: 7 cost time: 35.86272192001343
Epoch: 7, Steps: 265 | Train Loss: 0.3065780 Vali Loss: 0.1586576 Test Loss: 0.2199980
Validation loss decreased (0.159585 --> 0.158658).  Saving model ...
Updating learning rate to 1.107457308240065e-05
	iters: 100, epoch: 8 | loss: 0.2412393
	speed: 0.7493s/iter; left time: 18393.5220s
	iters: 200, epoch: 8 | loss: 0.4113297
	speed: 0.1376s/iter; left time: 3364.2411s
Epoch: 8 cost time: 36.264015674591064
Epoch: 8, Steps: 265 | Train Loss: 0.3043143 Vali Loss: 0.1594865 Test Loss: 0.2186074
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.3168856872018862e-05
	iters: 100, epoch: 9 | loss: 0.2929602
	speed: 0.7114s/iter; left time: 17273.4073s
	iters: 200, epoch: 9 | loss: 0.2055102
	speed: 0.1320s/iter; left time: 3191.1137s
Epoch: 9 cost time: 35.966482162475586
Epoch: 9, Steps: 265 | Train Loss: 0.3008240 Vali Loss: 0.1585738 Test Loss: 0.2190493
Validation loss decreased (0.158658 --> 0.158574).  Saving model ...
Updating learning rate to 1.550259272596464e-05
	iters: 100, epoch: 10 | loss: 0.2378531
	speed: 0.7645s/iter; left time: 18361.2928s
	iters: 200, epoch: 10 | loss: 0.3081962
	speed: 0.1348s/iter; left time: 3224.1234s
Epoch: 10 cost time: 36.71058130264282
Epoch: 10, Steps: 265 | Train Loss: 0.2973372 Vali Loss: 0.1595892 Test Loss: 0.2210666
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.806138967289881e-05
	iters: 100, epoch: 11 | loss: 0.2023901
	speed: 0.6536s/iter; left time: 15524.5285s
	iters: 200, epoch: 11 | loss: 0.2759215
	speed: 0.1254s/iter; left time: 2965.3727s
Epoch: 11 cost time: 33.614145278930664
Epoch: 11, Steps: 265 | Train Loss: 0.2928972 Vali Loss: 0.1608856 Test Loss: 0.2215036
EarlyStopping counter: 2 out of 20
Updating learning rate to 2.0829468903294163e-05
	iters: 100, epoch: 12 | loss: 0.3642865
	speed: 0.6100s/iter; left time: 14326.2286s
	iters: 200, epoch: 12 | loss: 0.2345933
	speed: 0.1135s/iter; left time: 2653.5054s
Epoch: 12 cost time: 30.99669623374939
Epoch: 12, Steps: 265 | Train Loss: 0.2870506 Vali Loss: 0.1632601 Test Loss: 0.2220865
EarlyStopping counter: 3 out of 20
Updating learning rate to 2.3789761069391508e-05
	iters: 100, epoch: 13 | loss: 0.2826214
	speed: 0.6620s/iter; left time: 15371.7365s
	iters: 200, epoch: 13 | loss: 0.2382094
	speed: 0.1128s/iter; left time: 2607.1111s
Epoch: 13 cost time: 31.572472095489502
Epoch: 13, Steps: 265 | Train Loss: 0.2810156 Vali Loss: 0.1648751 Test Loss: 0.2257902
EarlyStopping counter: 4 out of 20
Updating learning rate to 2.692401154325343e-05
	iters: 100, epoch: 14 | loss: 0.3773200
	speed: 0.7224s/iter; left time: 16583.3300s
	iters: 200, epoch: 14 | loss: 0.2580555
	speed: 0.1391s/iter; left time: 3178.1531s
Epoch: 14 cost time: 38.81368041038513
Epoch: 14, Steps: 265 | Train Loss: 0.2748964 Vali Loss: 0.1644332 Test Loss: 0.2286736
EarlyStopping counter: 5 out of 20
Updating learning rate to 3.0212892983843068e-05
	iters: 100, epoch: 15 | loss: 0.2920365
	speed: 0.7618s/iter; left time: 17285.4212s
	iters: 200, epoch: 15 | loss: 0.2339305
	speed: 0.1363s/iter; left time: 3080.0997s
Epoch: 15 cost time: 37.56469202041626
Epoch: 15, Steps: 265 | Train Loss: 0.2680025 Vali Loss: 0.1694955 Test Loss: 0.2324403
EarlyStopping counter: 6 out of 20
Updating learning rate to 3.3636124518983084e-05
	iters: 100, epoch: 16 | loss: 0.3037620
	speed: 0.7523s/iter; left time: 16870.0400s
	iters: 200, epoch: 16 | loss: 0.2182774
	speed: 0.1378s/iter; left time: 3076.9591s
Epoch: 16 cost time: 37.65508532524109
Epoch: 16, Steps: 265 | Train Loss: 0.2617682 Vali Loss: 0.1714929 Test Loss: 0.2339966
EarlyStopping counter: 7 out of 20
Updating learning rate to 3.717259680726015e-05
	iters: 100, epoch: 17 | loss: 0.3017896
	speed: 0.7510s/iter; left time: 16642.6985s
	iters: 200, epoch: 17 | loss: 0.3508841
	speed: 0.1385s/iter; left time: 3054.8942s
Epoch: 17 cost time: 37.57274270057678
Epoch: 17, Steps: 265 | Train Loss: 0.2568022 Vali Loss: 0.1673356 Test Loss: 0.2310937
EarlyStopping counter: 8 out of 20
Updating learning rate to 4.080050220868085e-05
	iters: 100, epoch: 18 | loss: 0.2896022
	speed: 0.7050s/iter; left time: 15436.6867s
	iters: 200, epoch: 18 | loss: 0.2455514
	speed: 0.1146s/iter; left time: 2496.8273s
Epoch: 18 cost time: 32.45977807044983
Epoch: 18, Steps: 265 | Train Loss: 0.2513541 Vali Loss: 0.1674882 Test Loss: 0.2382061
EarlyStopping counter: 9 out of 20
Updating learning rate to 4.449746926138297e-05
	iters: 100, epoch: 19 | loss: 0.2756385
	speed: 0.7289s/iter; left time: 15767.8683s
	iters: 200, epoch: 19 | loss: 0.3489408
	speed: 0.1386s/iter; left time: 2984.3061s
Epoch: 19 cost time: 37.16351580619812
Epoch: 19, Steps: 265 | Train Loss: 0.2471928 Vali Loss: 0.1694669 Test Loss: 0.2353035
EarlyStopping counter: 10 out of 20
Updating learning rate to 4.824070063515135e-05
	iters: 100, epoch: 20 | loss: 0.2892322
	speed: 0.7368s/iter; left time: 15743.0472s
	iters: 200, epoch: 20 | loss: 0.2222889
	speed: 0.1342s/iter; left time: 2854.8990s
Epoch: 20 cost time: 36.551337480545044
Epoch: 20, Steps: 265 | Train Loss: 0.2442501 Vali Loss: 0.1710235 Test Loss: 0.2407554
EarlyStopping counter: 11 out of 20
Updating learning rate to 5.200711371104918e-05
	iters: 100, epoch: 21 | loss: 0.2211807
	speed: 0.7269s/iter; left time: 15337.9028s
	iters: 200, epoch: 21 | loss: 0.2890655
	speed: 0.1344s/iter; left time: 2821.9718s
Epoch: 21 cost time: 35.162792444229126
Epoch: 21, Steps: 265 | Train Loss: 0.2399066 Vali Loss: 0.1750990 Test Loss: 0.2447684
EarlyStopping counter: 12 out of 20
Updating learning rate to 5.577348292028073e-05
	iters: 100, epoch: 22 | loss: 0.1816032
	speed: 0.6923s/iter; left time: 14424.1404s
	iters: 200, epoch: 22 | loss: 0.2414444
	speed: 0.1384s/iter; left time: 2869.6842s
Epoch: 22 cost time: 37.302905559539795
Epoch: 22, Steps: 265 | Train Loss: 0.2365482 Vali Loss: 0.1719095 Test Loss: 0.2335746
EarlyStopping counter: 13 out of 20
Updating learning rate to 5.9516582964553954e-05
	iters: 100, epoch: 23 | loss: 0.2537404
	speed: 0.7624s/iter; left time: 15682.3394s
	iters: 200, epoch: 23 | loss: 0.1996739
	speed: 0.1401s/iter; left time: 2867.2243s
Epoch: 23 cost time: 37.97612524032593
Epoch: 23, Steps: 265 | Train Loss: 0.2335037 Vali Loss: 0.1716056 Test Loss: 0.2347150
EarlyStopping counter: 14 out of 20
Updating learning rate to 6.321333203477474e-05
	iters: 100, epoch: 24 | loss: 0.2463781
	speed: 0.7643s/iter; left time: 15520.1083s
	iters: 200, epoch: 24 | loss: 0.2773716
	speed: 0.1391s/iter; left time: 2811.5103s
Epoch: 24 cost time: 37.62892389297485
Epoch: 24, Steps: 265 | Train Loss: 0.2313395 Vali Loss: 0.1733849 Test Loss: 0.2383898
EarlyStopping counter: 15 out of 20
Updating learning rate to 6.684093414491588e-05
	iters: 100, epoch: 25 | loss: 0.2369946
	speed: 0.7068s/iter; left time: 14165.3124s
	iters: 200, epoch: 25 | loss: 0.2454882
	speed: 0.1169s/iter; left time: 2330.5204s
Epoch: 25 cost time: 32.91847491264343
Epoch: 25, Steps: 265 | Train Loss: 0.2283133 Vali Loss: 0.1727721 Test Loss: 0.2406163
EarlyStopping counter: 16 out of 20
Updating learning rate to 7.037701970335941e-05
	iters: 100, epoch: 26 | loss: 0.1816059
	speed: 0.7437s/iter; left time: 14706.6840s
	iters: 200, epoch: 26 | loss: 0.2246288
	speed: 0.1384s/iter; left time: 2723.3905s
Epoch: 26 cost time: 37.49305272102356
Epoch: 26, Steps: 265 | Train Loss: 0.2259302 Vali Loss: 0.1712137 Test Loss: 0.2388113
EarlyStopping counter: 17 out of 20
Updating learning rate to 7.379978345487968e-05
	iters: 100, epoch: 27 | loss: 0.2461142
	speed: 0.7465s/iter; left time: 14564.9050s
	iters: 200, epoch: 27 | loss: 0.1839522
	speed: 0.1353s/iter; left time: 2626.3223s
Epoch: 27 cost time: 37.591888189315796
Epoch: 27, Steps: 265 | Train Loss: 0.2228541 Vali Loss: 0.1709767 Test Loss: 0.2376744
EarlyStopping counter: 18 out of 20
Updating learning rate to 7.70881189426489e-05
	iters: 100, epoch: 28 | loss: 0.2185547
	speed: 0.7427s/iter; left time: 14294.1724s
	iters: 200, epoch: 28 | loss: 0.2382617
	speed: 0.1340s/iter; left time: 2564.7996s
Epoch: 28 cost time: 36.37716627120972
Epoch: 28, Steps: 265 | Train Loss: 0.2203938 Vali Loss: 0.1707017 Test Loss: 0.2434276
EarlyStopping counter: 19 out of 20
Updating learning rate to 8.022174866110521e-05
	iters: 100, epoch: 29 | loss: 0.1849529
	speed: 0.7062s/iter; left time: 13404.3038s
	iters: 200, epoch: 29 | loss: 0.1883237
	speed: 0.1209s/iter; left time: 2282.3253s
Epoch: 29 cost time: 33.49838852882385
Epoch: 29, Steps: 265 | Train Loss: 0.2172686 Vali Loss: 0.1726947 Test Loss: 0.2407648
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : 336_192_PatchTST_ETTm2_ftM_sl336_ll48_pl192_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.21972347795963287, mae:0.29158106446266174, rse:0.37943145632743835
