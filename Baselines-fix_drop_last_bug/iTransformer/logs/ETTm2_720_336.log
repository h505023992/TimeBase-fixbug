Args in experiment:
Namespace(is_training=1, model_id='ETTm2_720_336', model='iTransformer', data='ETTm2', root_path='./dataset/', data_path='ETTm2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=336, enc_in=7, dec_in=7, c_out=7, d_model=128, n_heads=8, e_layers=2, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='MSE', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', exp_name='MTSF', channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv', efficient_training=False, use_norm=True, partial_start_index=0)
Use GPU: cuda:0
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.dropout.Dropout'>.
[INFO] Register count_convNd() for <class 'torch.nn.modules.conv.Conv1d'>.
[INFO] Register count_normalization() for <class 'torch.nn.modules.normalization.LayerNorm'>.
MACs: 4346368.0
Params: 335056.0
4.35M MACs
>>>>>>>start training : ETTm2_720_336_iTransformer_ETTm2_M_ft720_sl48_ll336_pl128_dm8_nh2_el1_dl128_df1_fctimeF_ebTrue_dtExp_projection_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33505
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.3225575
	speed: 0.0524s/iter; left time: 543.0246s
	iters: 200, epoch: 1 | loss: 0.4231858
	speed: 0.0285s/iter; left time: 292.6168s
	iters: 300, epoch: 1 | loss: 0.2862548
	speed: 0.0321s/iter; left time: 326.0345s
	iters: 400, epoch: 1 | loss: 0.3435328
	speed: 0.0427s/iter; left time: 430.0172s
	iters: 500, epoch: 1 | loss: 0.1956747
	speed: 0.0404s/iter; left time: 403.2057s
	iters: 600, epoch: 1 | loss: 0.2742744
	speed: 0.0344s/iter; left time: 339.6719s
	iters: 700, epoch: 1 | loss: 0.3412345
	speed: 0.0336s/iter; left time: 328.1552s
	iters: 800, epoch: 1 | loss: 0.2056089
	speed: 0.0328s/iter; left time: 317.2862s
	iters: 900, epoch: 1 | loss: 0.2908164
	speed: 0.0342s/iter; left time: 327.7930s
	iters: 1000, epoch: 1 | loss: 0.5336072
	speed: 0.0337s/iter; left time: 319.1353s
Max Memory (MB): 17.490234375
Epoch: 1 cost time: 38.14964818954468
Epoch: 1, Steps: 1047 | Train Loss: 0.3854851 Vali Loss: 0.2331016 Test Loss: 0.3092583
Validation loss decreased (inf --> 0.233102).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2048405
	speed: 1.6189s/iter; left time: 15094.3899s
	iters: 200, epoch: 2 | loss: 0.3160625
	speed: 0.0373s/iter; left time: 344.2597s
	iters: 300, epoch: 2 | loss: 0.3292741
	speed: 0.0413s/iter; left time: 376.4397s
	iters: 400, epoch: 2 | loss: 0.3825273
	speed: 0.0324s/iter; left time: 292.3965s
	iters: 500, epoch: 2 | loss: 0.2200237
	speed: 0.0317s/iter; left time: 282.6940s
	iters: 600, epoch: 2 | loss: 0.1797467
	speed: 0.0355s/iter; left time: 313.0548s
	iters: 700, epoch: 2 | loss: 0.2297005
	speed: 0.0445s/iter; left time: 388.2747s
	iters: 800, epoch: 2 | loss: 0.3352063
	speed: 0.0330s/iter; left time: 284.2669s
	iters: 900, epoch: 2 | loss: 0.1768152
	speed: 0.0379s/iter; left time: 323.2779s
	iters: 1000, epoch: 2 | loss: 0.2615187
	speed: 0.0466s/iter; left time: 392.3165s
Max Memory (MB): 17.490234375
Epoch: 2 cost time: 40.94242596626282
Epoch: 2, Steps: 1047 | Train Loss: 0.2922271 Vali Loss: 0.2468314 Test Loss: 0.3216209
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2604441
	speed: 1.0438s/iter; left time: 8639.4301s
	iters: 200, epoch: 3 | loss: 0.3713121
	speed: 0.0338s/iter; left time: 276.5364s
	iters: 300, epoch: 3 | loss: 0.2083459
	speed: 0.0404s/iter; left time: 325.9212s
	iters: 400, epoch: 3 | loss: 0.1670996
	speed: 0.0362s/iter; left time: 288.9324s
	iters: 500, epoch: 3 | loss: 0.2213523
	speed: 0.0290s/iter; left time: 228.4210s
	iters: 600, epoch: 3 | loss: 0.2080234
	speed: 0.0359s/iter; left time: 279.3704s
	iters: 700, epoch: 3 | loss: 0.3098708
	speed: 0.0236s/iter; left time: 180.8877s
	iters: 800, epoch: 3 | loss: 0.1821645
	speed: 0.0255s/iter; left time: 192.8753s
	iters: 900, epoch: 3 | loss: 0.2001435
	speed: 0.0255s/iter; left time: 190.3430s
	iters: 1000, epoch: 3 | loss: 0.2001425
	speed: 0.0266s/iter; left time: 196.1898s
Max Memory (MB): 17.490234375
Epoch: 3 cost time: 32.31842827796936
Epoch: 3, Steps: 1047 | Train Loss: 0.2680181 Vali Loss: 0.2453104 Test Loss: 0.3233617
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1400211
	speed: 1.5684s/iter; left time: 11339.1706s
	iters: 200, epoch: 4 | loss: 0.2146661
	speed: 0.0283s/iter; left time: 201.7089s
	iters: 300, epoch: 4 | loss: 0.2748668
	speed: 0.0357s/iter; left time: 250.7098s
	iters: 400, epoch: 4 | loss: 0.2626446
	speed: 0.0295s/iter; left time: 204.7744s
	iters: 500, epoch: 4 | loss: 0.2607749
	speed: 0.0421s/iter; left time: 287.7820s
	iters: 600, epoch: 4 | loss: 0.4369141
	speed: 0.0307s/iter; left time: 206.8673s
	iters: 700, epoch: 4 | loss: 0.3270380
	speed: 0.0302s/iter; left time: 200.3358s
	iters: 800, epoch: 4 | loss: 0.1416962
	speed: 0.0404s/iter; left time: 263.8461s
	iters: 900, epoch: 4 | loss: 0.2223113
	speed: 0.0370s/iter; left time: 237.7615s
	iters: 1000, epoch: 4 | loss: 0.3422238
	speed: 0.0374s/iter; left time: 236.7925s
Max Memory (MB): 17.490234375
Epoch: 4 cost time: 36.281017541885376
Epoch: 4, Steps: 1047 | Train Loss: 0.2597499 Vali Loss: 0.2457579 Test Loss: 0.3238044
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm2_720_336_iTransformer_ETTm2_M_ft720_sl48_ll336_pl128_dm8_nh2_el1_dl128_df1_fctimeF_ebTrue_dtExp_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
test shape: (11185, 1, 336, 7) (11185, 1, 336, 7)
test shape: (11185, 336, 7) (11185, 336, 7)
mse:0.3092583119869232, mae:0.3561537265777588
