Args in experiment:
Namespace(is_training=1, train_only=False, model_id='Electricity_720_336', model='DLinear', data='custom', root_path='./dataset/', data_path='electricity.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=336, individual=False, embed_type=0, enc_in=321, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=10, batch_size=16, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=7, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:7
>>>>>>>start training : Electricity_720_336_DLinear_custom_ftM_sl720_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17357
val 2297
test 4925
	iters: 100, epoch: 1 | loss: 0.2659581
	speed: 0.0449s/iter; left time: 482.7991s
	iters: 200, epoch: 1 | loss: 0.2788844
	speed: 0.0258s/iter; left time: 274.5156s
	iters: 300, epoch: 1 | loss: 0.2117462
	speed: 0.0266s/iter; left time: 280.0435s
	iters: 400, epoch: 1 | loss: 0.1964258
	speed: 0.0317s/iter; left time: 330.8731s
	iters: 500, epoch: 1 | loss: 0.2018514
	speed: 0.0274s/iter; left time: 283.7164s
	iters: 600, epoch: 1 | loss: 0.2039896
	speed: 0.0251s/iter; left time: 256.8567s
	iters: 700, epoch: 1 | loss: 0.2001686
	speed: 0.0271s/iter; left time: 274.6674s
	iters: 800, epoch: 1 | loss: 0.1794257
	speed: 0.0265s/iter; left time: 265.5855s
	iters: 900, epoch: 1 | loss: 0.1852999
	speed: 0.0270s/iter; left time: 268.1333s
	iters: 1000, epoch: 1 | loss: 0.1542919
	speed: 0.0254s/iter; left time: 250.0164s
Epoch: 1 cost time: 31.016696214675903
Epoch: 1, Steps: 1084 | Train Loss: 0.2360622 Vali Loss: 0.1590882 Test Loss: 0.1841006
Validation loss decreased (inf --> 0.159088).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2068665
	speed: 0.2297s/iter; left time: 2218.6686s
	iters: 200, epoch: 2 | loss: 0.1780866
	speed: 0.0247s/iter; left time: 236.2372s
	iters: 300, epoch: 2 | loss: 0.1700664
	speed: 0.0264s/iter; left time: 249.2383s
	iters: 400, epoch: 2 | loss: 0.1982203
	speed: 0.0266s/iter; left time: 248.4504s
	iters: 500, epoch: 2 | loss: 0.1641586
	speed: 0.0320s/iter; left time: 295.9663s
	iters: 600, epoch: 2 | loss: 0.1613673
	speed: 0.0272s/iter; left time: 248.6802s
	iters: 700, epoch: 2 | loss: 0.2055654
	speed: 0.0252s/iter; left time: 228.5956s
	iters: 800, epoch: 2 | loss: 0.1658396
	speed: 0.0268s/iter; left time: 239.8693s
	iters: 900, epoch: 2 | loss: 0.1686318
	speed: 0.0267s/iter; left time: 236.4539s
	iters: 1000, epoch: 2 | loss: 0.1555697
	speed: 0.0266s/iter; left time: 232.7892s
Epoch: 2 cost time: 30.664777040481567
Epoch: 2, Steps: 1084 | Train Loss: 0.1837117 Vali Loss: 0.1495655 Test Loss: 0.1743874
Validation loss decreased (0.159088 --> 0.149566).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1662355
	speed: 0.2542s/iter; left time: 2179.6457s
	iters: 200, epoch: 3 | loss: 0.1987982
	speed: 0.0251s/iter; left time: 212.2615s
	iters: 300, epoch: 3 | loss: 0.1650333
	speed: 0.0287s/iter; left time: 240.4633s
	iters: 400, epoch: 3 | loss: 0.1856851
	speed: 0.0347s/iter; left time: 286.8284s
	iters: 500, epoch: 3 | loss: 0.1574388
	speed: 0.0276s/iter; left time: 225.9833s
	iters: 600, epoch: 3 | loss: 0.1734004
	speed: 0.0262s/iter; left time: 211.3624s
	iters: 700, epoch: 3 | loss: 0.1637323
	speed: 0.0254s/iter; left time: 202.7948s
	iters: 800, epoch: 3 | loss: 0.1845802
	speed: 0.0260s/iter; left time: 205.0371s
	iters: 900, epoch: 3 | loss: 0.1886502
	speed: 0.0260s/iter; left time: 202.2875s
	iters: 1000, epoch: 3 | loss: 0.2019754
	speed: 0.0251s/iter; left time: 192.5926s
Epoch: 3 cost time: 30.79505681991577
Epoch: 3, Steps: 1084 | Train Loss: 0.1775544 Vali Loss: 0.1467515 Test Loss: 0.1717895
Validation loss decreased (0.149566 --> 0.146752).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1557070
	speed: 0.2651s/iter; left time: 1985.5949s
	iters: 200, epoch: 4 | loss: 0.1397174
	speed: 0.0259s/iter; left time: 191.2758s
	iters: 300, epoch: 4 | loss: 0.1827031
	speed: 0.0305s/iter; left time: 222.5502s
	iters: 400, epoch: 4 | loss: 0.2201531
	speed: 0.0276s/iter; left time: 198.1273s
	iters: 500, epoch: 4 | loss: 0.1718407
	speed: 0.0273s/iter; left time: 193.4244s
	iters: 600, epoch: 4 | loss: 0.1499994
	speed: 0.0259s/iter; left time: 181.1245s
	iters: 700, epoch: 4 | loss: 0.2014288
	speed: 0.0260s/iter; left time: 179.3369s
	iters: 800, epoch: 4 | loss: 0.1820138
	speed: 0.0257s/iter; left time: 174.1995s
	iters: 900, epoch: 4 | loss: 0.1865903
	speed: 0.0274s/iter; left time: 183.2198s
	iters: 1000, epoch: 4 | loss: 0.1555871
	speed: 0.0269s/iter; left time: 177.2965s
Epoch: 4 cost time: 30.87554907798767
Epoch: 4, Steps: 1084 | Train Loss: 0.1755701 Vali Loss: 0.1450159 Test Loss: 0.1701831
Validation loss decreased (0.146752 --> 0.145016).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1692747
	speed: 0.2619s/iter; left time: 1677.3021s
	iters: 200, epoch: 5 | loss: 0.1673849
	speed: 0.0331s/iter; left time: 208.4675s
	iters: 300, epoch: 5 | loss: 0.1581198
	speed: 0.0274s/iter; left time: 170.0795s
	iters: 400, epoch: 5 | loss: 0.1796818
	speed: 0.0269s/iter; left time: 164.0183s
	iters: 500, epoch: 5 | loss: 0.1742270
	speed: 0.0268s/iter; left time: 160.9078s
	iters: 600, epoch: 5 | loss: 0.1714023
	speed: 0.0271s/iter; left time: 160.1610s
	iters: 700, epoch: 5 | loss: 0.2251278
	speed: 0.0260s/iter; left time: 150.6982s
	iters: 800, epoch: 5 | loss: 0.1755984
	speed: 0.0266s/iter; left time: 151.8883s
	iters: 900, epoch: 5 | loss: 0.1894936
	speed: 0.0264s/iter; left time: 148.0261s
	iters: 1000, epoch: 5 | loss: 0.1827888
	speed: 0.0273s/iter; left time: 150.0990s
Epoch: 5 cost time: 30.732686758041382
Epoch: 5, Steps: 1084 | Train Loss: 0.1747057 Vali Loss: 0.1443165 Test Loss: 0.1690492
Validation loss decreased (0.145016 --> 0.144317).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1574862
	speed: 0.2730s/iter; left time: 1452.6169s
	iters: 200, epoch: 6 | loss: 0.1511478
	speed: 0.0273s/iter; left time: 142.4849s
	iters: 300, epoch: 6 | loss: 0.1645761
	speed: 0.0282s/iter; left time: 144.4637s
	iters: 400, epoch: 6 | loss: 0.1759667
	speed: 0.0289s/iter; left time: 145.1291s
	iters: 500, epoch: 6 | loss: 0.1680207
	speed: 0.0259s/iter; left time: 127.6687s
	iters: 600, epoch: 6 | loss: 0.1523243
	speed: 0.0268s/iter; left time: 129.3507s
	iters: 700, epoch: 6 | loss: 0.1683686
	speed: 0.0261s/iter; left time: 123.3601s
	iters: 800, epoch: 6 | loss: 0.1971025
	speed: 0.0262s/iter; left time: 121.0463s
	iters: 900, epoch: 6 | loss: 0.1808204
	speed: 0.0262s/iter; left time: 118.4921s
	iters: 1000, epoch: 6 | loss: 0.1993202
	speed: 0.0257s/iter; left time: 113.6392s
Epoch: 6 cost time: 31.003321886062622
Epoch: 6, Steps: 1084 | Train Loss: 0.1743165 Vali Loss: 0.1443980 Test Loss: 0.1695538
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1676966
	speed: 0.2592s/iter; left time: 1098.2474s
	iters: 200, epoch: 7 | loss: 0.1528133
	speed: 0.0257s/iter; left time: 106.1579s
	iters: 300, epoch: 7 | loss: 0.1818668
	speed: 0.0244s/iter; left time: 98.3916s
	iters: 400, epoch: 7 | loss: 0.1846197
	speed: 0.0251s/iter; left time: 98.7085s
	iters: 500, epoch: 7 | loss: 0.1900283
	speed: 0.0239s/iter; left time: 91.8647s
	iters: 600, epoch: 7 | loss: 0.1942414
	speed: 0.0249s/iter; left time: 92.8963s
	iters: 700, epoch: 7 | loss: 0.1566012
	speed: 0.0231s/iter; left time: 84.0689s
	iters: 800, epoch: 7 | loss: 0.1767811
	speed: 0.0229s/iter; left time: 80.9785s
	iters: 900, epoch: 7 | loss: 0.1624311
	speed: 0.0223s/iter; left time: 76.4923s
	iters: 1000, epoch: 7 | loss: 0.1651088
	speed: 0.0228s/iter; left time: 76.1067s
Epoch: 7 cost time: 27.703043937683105
Epoch: 7, Steps: 1084 | Train Loss: 0.1740840 Vali Loss: 0.1439974 Test Loss: 0.1691004
Validation loss decreased (0.144317 --> 0.143997).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1420580
	speed: 0.2358s/iter; left time: 743.5405s
	iters: 200, epoch: 8 | loss: 0.1629581
	speed: 0.0254s/iter; left time: 77.4620s
	iters: 300, epoch: 8 | loss: 0.1746727
	speed: 0.0323s/iter; left time: 95.4071s
	iters: 400, epoch: 8 | loss: 0.1796463
	speed: 0.0317s/iter; left time: 90.4954s
	iters: 500, epoch: 8 | loss: 0.1540674
	speed: 0.0288s/iter; left time: 79.2980s
	iters: 600, epoch: 8 | loss: 0.1824717
	speed: 0.0282s/iter; left time: 74.8808s
	iters: 700, epoch: 8 | loss: 0.1914751
	speed: 0.0269s/iter; left time: 68.7058s
	iters: 800, epoch: 8 | loss: 0.1670073
	speed: 0.0269s/iter; left time: 65.9298s
	iters: 900, epoch: 8 | loss: 0.1706903
	speed: 0.0280s/iter; left time: 65.9368s
	iters: 1000, epoch: 8 | loss: 0.1761011
	speed: 0.0277s/iter; left time: 62.3369s
Epoch: 8 cost time: 31.90440845489502
Epoch: 8, Steps: 1084 | Train Loss: 0.1739985 Vali Loss: 0.1440524 Test Loss: 0.1691153
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1633739
	speed: 0.2915s/iter; left time: 603.0710s
	iters: 200, epoch: 9 | loss: 0.1740760
	speed: 0.0286s/iter; left time: 56.4036s
	iters: 300, epoch: 9 | loss: 0.1632513
	speed: 0.0339s/iter; left time: 63.2950s
	iters: 400, epoch: 9 | loss: 0.1799006
	speed: 0.0297s/iter; left time: 52.5702s
	iters: 500, epoch: 9 | loss: 0.1601805
	speed: 0.0273s/iter; left time: 45.5950s
	iters: 600, epoch: 9 | loss: 0.2004711
	speed: 0.0279s/iter; left time: 43.8115s
	iters: 700, epoch: 9 | loss: 0.1526207
	speed: 0.0277s/iter; left time: 40.7028s
	iters: 800, epoch: 9 | loss: 0.1489835
	speed: 0.0271s/iter; left time: 37.1296s
	iters: 900, epoch: 9 | loss: 0.1655897
	speed: 0.0274s/iter; left time: 34.7353s
	iters: 1000, epoch: 9 | loss: 0.1963646
	speed: 0.0287s/iter; left time: 33.4967s
Epoch: 9 cost time: 32.53390288352966
Epoch: 9, Steps: 1084 | Train Loss: 0.1739533 Vali Loss: 0.1440369 Test Loss: 0.1691301
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1586828
	speed: 0.2825s/iter; left time: 278.2340s
	iters: 200, epoch: 10 | loss: 0.1625621
	speed: 0.0322s/iter; left time: 28.5191s
	iters: 300, epoch: 10 | loss: 0.1481268
	speed: 0.0294s/iter; left time: 23.1074s
	iters: 400, epoch: 10 | loss: 0.1438691
	speed: 0.0274s/iter; left time: 18.7583s
	iters: 500, epoch: 10 | loss: 0.1774086
	speed: 0.0258s/iter; left time: 15.1024s
	iters: 600, epoch: 10 | loss: 0.1633598
	speed: 0.0261s/iter; left time: 12.6439s
	iters: 700, epoch: 10 | loss: 0.1975596
	speed: 0.0247s/iter; left time: 9.5181s
	iters: 800, epoch: 10 | loss: 0.1714711
	speed: 0.0252s/iter; left time: 7.1840s
	iters: 900, epoch: 10 | loss: 0.1873564
	speed: 0.0277s/iter; left time: 5.1179s
	iters: 1000, epoch: 10 | loss: 0.1954998
	speed: 0.0266s/iter; left time: 2.2635s
Epoch: 10 cost time: 30.646560192108154
Epoch: 10, Steps: 1084 | Train Loss: 0.1739271 Vali Loss: 0.1440200 Test Loss: 0.1690342
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Electricity_720_336_DLinear_custom_ftM_sl720_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4925
mse:0.16998038983345032, mae:0.27455639028549194
