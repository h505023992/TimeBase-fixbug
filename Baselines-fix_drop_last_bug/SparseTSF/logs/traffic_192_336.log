Args in experiment:
Namespace(is_training=1, model_id='traffic_192_336', model='SparseTSF', data='custom', root_path='./dataset/', data_path='traffic.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=192, label_len=48, pred_len=336, period_len=24, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=862, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=128, patience=5, learning_rate=0.03, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=2, use_multi_gpu=0, devices='0,1', test_flop=False)
Use GPU: cuda:2
>>>>>>>start training : traffic_192_336_SparseTSF_custom_ftM_sl192_pl336_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11753
val 1421
test 3173
Epoch: 1 cost time: 33.78604173660278
Epoch: 1, Steps: 91 | Train Loss: 0.8378593 Vali Loss: 0.7587217 Test Loss: 0.9325817
Validation loss decreased (inf --> 0.758722).  Saving model ...
Updating learning rate to 0.03
Epoch: 2 cost time: 29.875698566436768
Epoch: 2, Steps: 91 | Train Loss: 0.3920083 Vali Loss: 0.4050150 Test Loss: 0.5075005
Validation loss decreased (0.758722 --> 0.405015).  Saving model ...
Updating learning rate to 0.03
Epoch: 3 cost time: 29.88246440887451
Epoch: 3, Steps: 91 | Train Loss: 0.2977358 Vali Loss: 0.3864796 Test Loss: 0.4834468
Validation loss decreased (0.405015 --> 0.386480).  Saving model ...
Updating learning rate to 0.03
Epoch: 4 cost time: 29.84917640686035
Epoch: 4, Steps: 91 | Train Loss: 0.2917036 Vali Loss: 0.3855319 Test Loss: 0.4789929
Validation loss decreased (0.386480 --> 0.385532).  Saving model ...
Updating learning rate to 0.024
Epoch: 5 cost time: 29.789751768112183
Epoch: 5, Steps: 91 | Train Loss: 0.2901789 Vali Loss: 0.3843026 Test Loss: 0.4784270
Validation loss decreased (0.385532 --> 0.384303).  Saving model ...
Updating learning rate to 0.019200000000000002
Epoch: 6 cost time: 29.192878007888794
Epoch: 6, Steps: 91 | Train Loss: 0.2898699 Vali Loss: 0.3848957 Test Loss: 0.4781021
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.015360000000000004
Epoch: 7 cost time: 29.57595705986023
Epoch: 7, Steps: 91 | Train Loss: 0.2897300 Vali Loss: 0.3843311 Test Loss: 0.4780723
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.012288000000000002
Epoch: 8 cost time: 29.494399309158325
Epoch: 8, Steps: 91 | Train Loss: 0.2896552 Vali Loss: 0.3844387 Test Loss: 0.4784206
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.009830400000000001
Epoch: 9 cost time: 29.883110761642456
Epoch: 9, Steps: 91 | Train Loss: 0.2896492 Vali Loss: 0.3851413 Test Loss: 0.4785450
EarlyStopping counter: 4 out of 5
Updating learning rate to 0.007864320000000003
Epoch: 10 cost time: 30.6105055809021
Epoch: 10, Steps: 91 | Train Loss: 0.2895057 Vali Loss: 0.3848385 Test Loss: 0.4785864
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : traffic_192_336_SparseTSF_custom_ftM_sl192_pl336_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3173
mse:0.47633442282676697, mae:0.30591824650764465, rse:0.5672248601913452
