Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=128, d_layers=1, d_model=16, data='ETTh2', data_path='ETTh2.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.3, e_layers=3, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.3, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='type3', model='PatchTST', model_id='336_96', moving_avg=25, n_heads=4, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=100, pct_start=0.3, pred_len=96, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : 336_96_PatchTST_ETTh2_ftM_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8209
val 2785
test 2785
Epoch: 1 cost time: 13.197271585464478
Epoch: 1, Steps: 64 | Train Loss: 0.6769271 Vali Loss: 0.3607866 Test Loss: 0.4233750
Validation loss decreased (inf --> 0.360787).  Saving model ...
Updating learning rate to 0.0001
Epoch: 2 cost time: 13.010318040847778
Epoch: 2, Steps: 64 | Train Loss: 0.5850014 Vali Loss: 0.2609713 Test Loss: 0.3334156
Validation loss decreased (0.360787 --> 0.260971).  Saving model ...
Updating learning rate to 0.0001
Epoch: 3 cost time: 12.139394760131836
Epoch: 3, Steps: 64 | Train Loss: 0.4987745 Vali Loss: 0.2369744 Test Loss: 0.3015307
Validation loss decreased (0.260971 --> 0.236974).  Saving model ...
Updating learning rate to 0.0001
Epoch: 4 cost time: 12.592360973358154
Epoch: 4, Steps: 64 | Train Loss: 0.4620605 Vali Loss: 0.2229223 Test Loss: 0.2903744
Validation loss decreased (0.236974 --> 0.222922).  Saving model ...
Updating learning rate to 9e-05
Epoch: 5 cost time: 12.038934707641602
Epoch: 5, Steps: 64 | Train Loss: 0.4420802 Vali Loss: 0.2169837 Test Loss: 0.2840109
Validation loss decreased (0.222922 --> 0.216984).  Saving model ...
Updating learning rate to 8.1e-05
Epoch: 6 cost time: 12.370706558227539
Epoch: 6, Steps: 64 | Train Loss: 0.4327865 Vali Loss: 0.2150207 Test Loss: 0.2820172
Validation loss decreased (0.216984 --> 0.215021).  Saving model ...
Updating learning rate to 7.290000000000001e-05
Epoch: 7 cost time: 11.83957314491272
Epoch: 7, Steps: 64 | Train Loss: 0.4262038 Vali Loss: 0.2146346 Test Loss: 0.2796984
Validation loss decreased (0.215021 --> 0.214635).  Saving model ...
Updating learning rate to 6.561e-05
Epoch: 8 cost time: 12.567179441452026
Epoch: 8, Steps: 64 | Train Loss: 0.4215585 Vali Loss: 0.2132369 Test Loss: 0.2786460
Validation loss decreased (0.214635 --> 0.213237).  Saving model ...
Updating learning rate to 5.904900000000001e-05
Epoch: 9 cost time: 12.484100580215454
Epoch: 9, Steps: 64 | Train Loss: 0.4190557 Vali Loss: 0.2127028 Test Loss: 0.2778621
Validation loss decreased (0.213237 --> 0.212703).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
Epoch: 10 cost time: 12.992504596710205
Epoch: 10, Steps: 64 | Train Loss: 0.4159656 Vali Loss: 0.2111180 Test Loss: 0.2773914
Validation loss decreased (0.212703 --> 0.211118).  Saving model ...
Updating learning rate to 4.782969000000001e-05
Epoch: 11 cost time: 12.978744506835938
Epoch: 11, Steps: 64 | Train Loss: 0.4152596 Vali Loss: 0.2119685 Test Loss: 0.2768740
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.304672100000001e-05
Epoch: 12 cost time: 13.73307180404663
Epoch: 12, Steps: 64 | Train Loss: 0.4153054 Vali Loss: 0.2105182 Test Loss: 0.2766673
Validation loss decreased (0.211118 --> 0.210518).  Saving model ...
Updating learning rate to 3.874204890000001e-05
Epoch: 13 cost time: 13.022035121917725
Epoch: 13, Steps: 64 | Train Loss: 0.4131527 Vali Loss: 0.2107550 Test Loss: 0.2760519
EarlyStopping counter: 1 out of 100
Updating learning rate to 3.486784401000001e-05
Epoch: 14 cost time: 13.815850257873535
Epoch: 14, Steps: 64 | Train Loss: 0.4112626 Vali Loss: 0.2098459 Test Loss: 0.2763092
Validation loss decreased (0.210518 --> 0.209846).  Saving model ...
Updating learning rate to 3.138105960900001e-05
Epoch: 15 cost time: 13.596372842788696
Epoch: 15, Steps: 64 | Train Loss: 0.4105468 Vali Loss: 0.2109429 Test Loss: 0.2758029
EarlyStopping counter: 1 out of 100
Updating learning rate to 2.824295364810001e-05
Epoch: 16 cost time: 13.085766077041626
Epoch: 16, Steps: 64 | Train Loss: 0.4101926 Vali Loss: 0.2104724 Test Loss: 0.2757694
EarlyStopping counter: 2 out of 100
Updating learning rate to 2.541865828329001e-05
Epoch: 17 cost time: 11.446200847625732
Epoch: 17, Steps: 64 | Train Loss: 0.4095684 Vali Loss: 0.2103099 Test Loss: 0.2758643
EarlyStopping counter: 3 out of 100
Updating learning rate to 2.287679245496101e-05
Epoch: 18 cost time: 11.010290145874023
Epoch: 18, Steps: 64 | Train Loss: 0.4091370 Vali Loss: 0.2104092 Test Loss: 0.2755124
EarlyStopping counter: 4 out of 100
Updating learning rate to 2.0589113209464907e-05
Epoch: 19 cost time: 10.728139877319336
Epoch: 19, Steps: 64 | Train Loss: 0.4091115 Vali Loss: 0.2111995 Test Loss: 0.2755327
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.8530201888518416e-05
Epoch: 20 cost time: 10.701637983322144
Epoch: 20, Steps: 64 | Train Loss: 0.4073277 Vali Loss: 0.2089439 Test Loss: 0.2757266
Validation loss decreased (0.209846 --> 0.208944).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
Epoch: 21 cost time: 11.399376630783081
Epoch: 21, Steps: 64 | Train Loss: 0.4081879 Vali Loss: 0.2113740 Test Loss: 0.2753508
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5009463529699919e-05
Epoch: 22 cost time: 11.395866632461548
Epoch: 22, Steps: 64 | Train Loss: 0.4076608 Vali Loss: 0.2099313 Test Loss: 0.2753803
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.3508517176729929e-05
Epoch: 23 cost time: 12.14439868927002
Epoch: 23, Steps: 64 | Train Loss: 0.4077531 Vali Loss: 0.2098321 Test Loss: 0.2752364
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2157665459056936e-05
Epoch: 24 cost time: 12.972440481185913
Epoch: 24, Steps: 64 | Train Loss: 0.4074170 Vali Loss: 0.2094980 Test Loss: 0.2752655
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.0941898913151242e-05
Epoch: 25 cost time: 12.613725662231445
Epoch: 25, Steps: 64 | Train Loss: 0.4082104 Vali Loss: 0.2105578 Test Loss: 0.2753082
EarlyStopping counter: 5 out of 100
Updating learning rate to 9.847709021836118e-06
Epoch: 26 cost time: 12.044336795806885
Epoch: 26, Steps: 64 | Train Loss: 0.4065868 Vali Loss: 0.2099822 Test Loss: 0.2752499
EarlyStopping counter: 6 out of 100
Updating learning rate to 8.862938119652508e-06
Epoch: 27 cost time: 14.083120107650757
Epoch: 27, Steps: 64 | Train Loss: 0.4070302 Vali Loss: 0.2100430 Test Loss: 0.2750636
EarlyStopping counter: 7 out of 100
Updating learning rate to 7.976644307687255e-06
Epoch: 28 cost time: 13.347196578979492
Epoch: 28, Steps: 64 | Train Loss: 0.4063734 Vali Loss: 0.2103623 Test Loss: 0.2751308
EarlyStopping counter: 8 out of 100
Updating learning rate to 7.178979876918531e-06
Epoch: 29 cost time: 14.127330303192139
Epoch: 29, Steps: 64 | Train Loss: 0.4061883 Vali Loss: 0.2107980 Test Loss: 0.2750923
EarlyStopping counter: 9 out of 100
Updating learning rate to 6.4610818892266776e-06
Epoch: 30 cost time: 12.966989517211914
Epoch: 30, Steps: 64 | Train Loss: 0.4052022 Vali Loss: 0.2104860 Test Loss: 0.2750595
EarlyStopping counter: 10 out of 100
Updating learning rate to 5.8149737003040096e-06
Epoch: 31 cost time: 12.94754934310913
Epoch: 31, Steps: 64 | Train Loss: 0.4061392 Vali Loss: 0.2088463 Test Loss: 0.2750526
Validation loss decreased (0.208944 --> 0.208846).  Saving model ...
Updating learning rate to 5.23347633027361e-06
Epoch: 32 cost time: 12.591487407684326
Epoch: 32, Steps: 64 | Train Loss: 0.4045365 Vali Loss: 0.2109637 Test Loss: 0.2749673
EarlyStopping counter: 1 out of 100
Updating learning rate to 4.710128697246249e-06
Epoch: 33 cost time: 11.825706958770752
Epoch: 33, Steps: 64 | Train Loss: 0.4040547 Vali Loss: 0.2108446 Test Loss: 0.2750164
EarlyStopping counter: 2 out of 100
Updating learning rate to 4.239115827521624e-06
Epoch: 34 cost time: 12.879664421081543
Epoch: 34, Steps: 64 | Train Loss: 0.4067103 Vali Loss: 0.2100398 Test Loss: 0.2750225
EarlyStopping counter: 3 out of 100
Updating learning rate to 3.815204244769462e-06
Epoch: 35 cost time: 12.914673089981079
Epoch: 35, Steps: 64 | Train Loss: 0.4055921 Vali Loss: 0.2099774 Test Loss: 0.2750230
EarlyStopping counter: 4 out of 100
Updating learning rate to 3.4336838202925152e-06
Epoch: 36 cost time: 12.305983304977417
Epoch: 36, Steps: 64 | Train Loss: 0.4064026 Vali Loss: 0.2101399 Test Loss: 0.2750328
EarlyStopping counter: 5 out of 100
Updating learning rate to 3.090315438263264e-06
Epoch: 37 cost time: 12.321213006973267
Epoch: 37, Steps: 64 | Train Loss: 0.4057781 Vali Loss: 0.2104044 Test Loss: 0.2750649
EarlyStopping counter: 6 out of 100
Updating learning rate to 2.7812838944369375e-06
Epoch: 38 cost time: 12.237632513046265
Epoch: 38, Steps: 64 | Train Loss: 0.4055839 Vali Loss: 0.2106084 Test Loss: 0.2750734
EarlyStopping counter: 7 out of 100
Updating learning rate to 2.503155504993244e-06
Epoch: 39 cost time: 12.589021682739258
Epoch: 39, Steps: 64 | Train Loss: 0.4060600 Vali Loss: 0.2105059 Test Loss: 0.2750512
EarlyStopping counter: 8 out of 100
Updating learning rate to 2.2528399544939195e-06
Epoch: 40 cost time: 12.049750328063965
Epoch: 40, Steps: 64 | Train Loss: 0.4053749 Vali Loss: 0.2098509 Test Loss: 0.2750832
EarlyStopping counter: 9 out of 100
Updating learning rate to 2.0275559590445276e-06
Epoch: 41 cost time: 12.01789379119873
Epoch: 41, Steps: 64 | Train Loss: 0.4058662 Vali Loss: 0.2090175 Test Loss: 0.2750586
EarlyStopping counter: 10 out of 100
Updating learning rate to 1.8248003631400751e-06
Epoch: 42 cost time: 12.001583337783813
Epoch: 42, Steps: 64 | Train Loss: 0.4062656 Vali Loss: 0.2097760 Test Loss: 0.2750248
EarlyStopping counter: 11 out of 100
Updating learning rate to 1.6423203268260676e-06
Epoch: 43 cost time: 11.24631142616272
Epoch: 43, Steps: 64 | Train Loss: 0.4045131 Vali Loss: 0.2097849 Test Loss: 0.2750078
EarlyStopping counter: 12 out of 100
Updating learning rate to 1.4780882941434609e-06
Epoch: 44 cost time: 12.086997032165527
Epoch: 44, Steps: 64 | Train Loss: 0.4039726 Vali Loss: 0.2096766 Test Loss: 0.2749917
EarlyStopping counter: 13 out of 100
Updating learning rate to 1.3302794647291146e-06
Epoch: 45 cost time: 11.66434359550476
Epoch: 45, Steps: 64 | Train Loss: 0.4053313 Vali Loss: 0.2096132 Test Loss: 0.2750361
EarlyStopping counter: 14 out of 100
Updating learning rate to 1.1972515182562034e-06
Epoch: 46 cost time: 12.117827892303467
Epoch: 46, Steps: 64 | Train Loss: 0.4048324 Vali Loss: 0.2100348 Test Loss: 0.2750116
EarlyStopping counter: 15 out of 100
Updating learning rate to 1.077526366430583e-06
Epoch: 47 cost time: 12.514536619186401
Epoch: 47, Steps: 64 | Train Loss: 0.4055155 Vali Loss: 0.2097562 Test Loss: 0.2750215
EarlyStopping counter: 16 out of 100
Updating learning rate to 9.697737297875248e-07
Epoch: 48 cost time: 12.88584589958191
Epoch: 48, Steps: 64 | Train Loss: 0.4045072 Vali Loss: 0.2100576 Test Loss: 0.2749733
EarlyStopping counter: 17 out of 100
Updating learning rate to 8.727963568087723e-07
Epoch: 49 cost time: 12.435667991638184
Epoch: 49, Steps: 64 | Train Loss: 0.4048920 Vali Loss: 0.2095607 Test Loss: 0.2749946
EarlyStopping counter: 18 out of 100
Updating learning rate to 7.855167211278951e-07
Epoch: 50 cost time: 12.157906532287598
Epoch: 50, Steps: 64 | Train Loss: 0.4045809 Vali Loss: 0.2091530 Test Loss: 0.2749889
EarlyStopping counter: 19 out of 100
Updating learning rate to 7.069650490151056e-07
Epoch: 51 cost time: 12.670888662338257
Epoch: 51, Steps: 64 | Train Loss: 0.4055003 Vali Loss: 0.2098865 Test Loss: 0.2749859
EarlyStopping counter: 20 out of 100
Updating learning rate to 6.36268544113595e-07
Epoch: 52 cost time: 12.322679281234741
Epoch: 52, Steps: 64 | Train Loss: 0.4049673 Vali Loss: 0.2096104 Test Loss: 0.2749816
EarlyStopping counter: 21 out of 100
Updating learning rate to 5.726416897022355e-07
Epoch: 53 cost time: 12.781586170196533
Epoch: 53, Steps: 64 | Train Loss: 0.4048089 Vali Loss: 0.2106259 Test Loss: 0.2749673
EarlyStopping counter: 22 out of 100
Updating learning rate to 5.15377520732012e-07
Epoch: 54 cost time: 11.995796203613281
Epoch: 54, Steps: 64 | Train Loss: 0.4044324 Vali Loss: 0.2095171 Test Loss: 0.2749757
EarlyStopping counter: 23 out of 100
Updating learning rate to 4.6383976865881085e-07
Epoch: 55 cost time: 13.26148271560669
Epoch: 55, Steps: 64 | Train Loss: 0.4047793 Vali Loss: 0.2100104 Test Loss: 0.2749971
EarlyStopping counter: 24 out of 100
Updating learning rate to 4.174557917929298e-07
Epoch: 56 cost time: 13.584674596786499
Epoch: 56, Steps: 64 | Train Loss: 0.4039882 Vali Loss: 0.2100529 Test Loss: 0.2749991
EarlyStopping counter: 25 out of 100
Updating learning rate to 3.7571021261363677e-07
Epoch: 57 cost time: 12.871794939041138
Epoch: 57, Steps: 64 | Train Loss: 0.4047480 Vali Loss: 0.2097704 Test Loss: 0.2750373
EarlyStopping counter: 26 out of 100
Updating learning rate to 3.381391913522731e-07
Epoch: 58 cost time: 14.622174739837646
Epoch: 58, Steps: 64 | Train Loss: 0.4025008 Vali Loss: 0.2096794 Test Loss: 0.2749706
EarlyStopping counter: 27 out of 100
Updating learning rate to 3.043252722170458e-07
Epoch: 59 cost time: 13.12937879562378
Epoch: 59, Steps: 64 | Train Loss: 0.4048873 Vali Loss: 0.2095049 Test Loss: 0.2750178
EarlyStopping counter: 28 out of 100
Updating learning rate to 2.7389274499534124e-07
Epoch: 60 cost time: 12.787734746932983
Epoch: 60, Steps: 64 | Train Loss: 0.4047693 Vali Loss: 0.2098660 Test Loss: 0.2749696
EarlyStopping counter: 29 out of 100
Updating learning rate to 2.465034704958071e-07
Epoch: 61 cost time: 13.337988376617432
Epoch: 61, Steps: 64 | Train Loss: 0.4050466 Vali Loss: 0.2091313 Test Loss: 0.2749676
EarlyStopping counter: 30 out of 100
Updating learning rate to 2.218531234462264e-07
Epoch: 62 cost time: 12.93707275390625
Epoch: 62, Steps: 64 | Train Loss: 0.4049379 Vali Loss: 0.2098184 Test Loss: 0.2749741
EarlyStopping counter: 31 out of 100
Updating learning rate to 1.9966781110160376e-07
Epoch: 63 cost time: 12.738356113433838
Epoch: 63, Steps: 64 | Train Loss: 0.4039647 Vali Loss: 0.2097483 Test Loss: 0.2749386
EarlyStopping counter: 32 out of 100
Updating learning rate to 1.797010299914434e-07
Epoch: 64 cost time: 12.416853666305542
Epoch: 64, Steps: 64 | Train Loss: 0.4052533 Vali Loss: 0.2099310 Test Loss: 0.2749830
EarlyStopping counter: 33 out of 100
Updating learning rate to 1.6173092699229907e-07
Epoch: 65 cost time: 11.996326923370361
Epoch: 65, Steps: 64 | Train Loss: 0.4048749 Vali Loss: 0.2092356 Test Loss: 0.2749551
EarlyStopping counter: 34 out of 100
Updating learning rate to 1.4555783429306916e-07
Epoch: 66 cost time: 11.120596647262573
Epoch: 66, Steps: 64 | Train Loss: 0.4047633 Vali Loss: 0.2102888 Test Loss: 0.2750016
EarlyStopping counter: 35 out of 100
Updating learning rate to 1.3100205086376224e-07
Epoch: 67 cost time: 12.764831304550171
Epoch: 67, Steps: 64 | Train Loss: 0.4053665 Vali Loss: 0.2102936 Test Loss: 0.2749821
EarlyStopping counter: 36 out of 100
Updating learning rate to 1.1790184577738603e-07
Epoch: 68 cost time: 12.581326961517334
Epoch: 68, Steps: 64 | Train Loss: 0.4044776 Vali Loss: 0.2097530 Test Loss: 0.2749516
EarlyStopping counter: 37 out of 100
Updating learning rate to 1.0611166119964742e-07
Epoch: 69 cost time: 12.26132869720459
Epoch: 69, Steps: 64 | Train Loss: 0.4050503 Vali Loss: 0.2094258 Test Loss: 0.2749780
EarlyStopping counter: 38 out of 100
Updating learning rate to 9.550049507968268e-08
Epoch: 70 cost time: 11.839491844177246
Epoch: 70, Steps: 64 | Train Loss: 0.4052508 Vali Loss: 0.2103797 Test Loss: 0.2749764
EarlyStopping counter: 39 out of 100
Updating learning rate to 8.595044557171442e-08
Epoch: 71 cost time: 12.262676000595093
Epoch: 71, Steps: 64 | Train Loss: 0.4055479 Vali Loss: 0.2101491 Test Loss: 0.2749438
EarlyStopping counter: 40 out of 100
Updating learning rate to 7.735540101454298e-08
Epoch: 72 cost time: 12.300784349441528
Epoch: 72, Steps: 64 | Train Loss: 0.4048968 Vali Loss: 0.2100467 Test Loss: 0.2749257
EarlyStopping counter: 41 out of 100
Updating learning rate to 6.961986091308869e-08
Epoch: 73 cost time: 11.613797426223755
Epoch: 73, Steps: 64 | Train Loss: 0.4049969 Vali Loss: 0.2102903 Test Loss: 0.2749558
EarlyStopping counter: 42 out of 100
Updating learning rate to 6.265787482177981e-08
Epoch: 74 cost time: 11.844513654708862
Epoch: 74, Steps: 64 | Train Loss: 0.4047160 Vali Loss: 0.2094956 Test Loss: 0.2749927
EarlyStopping counter: 43 out of 100
Updating learning rate to 5.639208733960184e-08
Epoch: 75 cost time: 12.886187314987183
Epoch: 75, Steps: 64 | Train Loss: 0.4044811 Vali Loss: 0.2105576 Test Loss: 0.2749839
EarlyStopping counter: 44 out of 100
Updating learning rate to 5.075287860564165e-08
Epoch: 76 cost time: 12.904234409332275
Epoch: 76, Steps: 64 | Train Loss: 0.4037961 Vali Loss: 0.2099171 Test Loss: 0.2749959
EarlyStopping counter: 45 out of 100
Updating learning rate to 4.567759074507749e-08
Epoch: 77 cost time: 12.751789093017578
Epoch: 77, Steps: 64 | Train Loss: 0.4044911 Vali Loss: 0.2097578 Test Loss: 0.2749469
EarlyStopping counter: 46 out of 100
Updating learning rate to 4.1109831670569744e-08
Epoch: 78 cost time: 12.143641233444214
Epoch: 78, Steps: 64 | Train Loss: 0.4029365 Vali Loss: 0.2090441 Test Loss: 0.2749808
EarlyStopping counter: 47 out of 100
Updating learning rate to 3.6998848503512764e-08
Epoch: 79 cost time: 11.47710371017456
Epoch: 79, Steps: 64 | Train Loss: 0.4053277 Vali Loss: 0.2103801 Test Loss: 0.2749950
EarlyStopping counter: 48 out of 100
Updating learning rate to 3.3298963653161496e-08
Epoch: 80 cost time: 12.244327068328857
Epoch: 80, Steps: 64 | Train Loss: 0.4065360 Vali Loss: 0.2088933 Test Loss: 0.2749682
EarlyStopping counter: 49 out of 100
Updating learning rate to 2.996906728784534e-08
Epoch: 81 cost time: 12.180678367614746
Epoch: 81, Steps: 64 | Train Loss: 0.4041302 Vali Loss: 0.2097167 Test Loss: 0.2749830
EarlyStopping counter: 50 out of 100
Updating learning rate to 2.697216055906081e-08
Epoch: 82 cost time: 11.903539180755615
Epoch: 82, Steps: 64 | Train Loss: 0.4041279 Vali Loss: 0.2092777 Test Loss: 0.2749942
EarlyStopping counter: 51 out of 100
Updating learning rate to 2.427494450315473e-08
Epoch: 83 cost time: 13.382908821105957
Epoch: 83, Steps: 64 | Train Loss: 0.4044973 Vali Loss: 0.2094746 Test Loss: 0.2749411
EarlyStopping counter: 52 out of 100
Updating learning rate to 2.1847450052839257e-08
Epoch: 84 cost time: 13.648301601409912
Epoch: 84, Steps: 64 | Train Loss: 0.4047941 Vali Loss: 0.2097254 Test Loss: 0.2749808
EarlyStopping counter: 53 out of 100
Updating learning rate to 1.9662705047555332e-08
Epoch: 85 cost time: 12.943995714187622
Epoch: 85, Steps: 64 | Train Loss: 0.4050851 Vali Loss: 0.2086351 Test Loss: 0.2749960
Validation loss decreased (0.208846 --> 0.208635).  Saving model ...
Updating learning rate to 1.7696434542799797e-08
Epoch: 86 cost time: 13.057864904403687
Epoch: 86, Steps: 64 | Train Loss: 0.4060305 Vali Loss: 0.2091228 Test Loss: 0.2749597
EarlyStopping counter: 1 out of 100
Updating learning rate to 1.5926791088519817e-08
Epoch: 87 cost time: 11.292457103729248
Epoch: 87, Steps: 64 | Train Loss: 0.4052236 Vali Loss: 0.2092927 Test Loss: 0.2749760
EarlyStopping counter: 2 out of 100
Updating learning rate to 1.4334111979667836e-08
Epoch: 88 cost time: 11.923815965652466
Epoch: 88, Steps: 64 | Train Loss: 0.4039955 Vali Loss: 0.2099247 Test Loss: 0.2749761
EarlyStopping counter: 3 out of 100
Updating learning rate to 1.2900700781701054e-08
Epoch: 89 cost time: 11.762354612350464
Epoch: 89, Steps: 64 | Train Loss: 0.4053566 Vali Loss: 0.2101187 Test Loss: 0.2749731
EarlyStopping counter: 4 out of 100
Updating learning rate to 1.161063070353095e-08
Epoch: 90 cost time: 12.520024061203003
Epoch: 90, Steps: 64 | Train Loss: 0.4047579 Vali Loss: 0.2108348 Test Loss: 0.2749806
EarlyStopping counter: 5 out of 100
Updating learning rate to 1.0449567633177854e-08
Epoch: 91 cost time: 12.366849899291992
Epoch: 91, Steps: 64 | Train Loss: 0.4044400 Vali Loss: 0.2085066 Test Loss: 0.2749780
Validation loss decreased (0.208635 --> 0.208507).  Saving model ...
Updating learning rate to 9.404610869860069e-09
Epoch: 92 cost time: 12.392238140106201
Epoch: 92, Steps: 64 | Train Loss: 0.4050714 Vali Loss: 0.2098096 Test Loss: 0.2749645
EarlyStopping counter: 1 out of 100
Updating learning rate to 8.464149782874063e-09
Epoch: 93 cost time: 12.472325325012207
Epoch: 93, Steps: 64 | Train Loss: 0.4050516 Vali Loss: 0.2098718 Test Loss: 0.2749749
EarlyStopping counter: 2 out of 100
Updating learning rate to 7.617734804586658e-09
Epoch: 94 cost time: 12.589529514312744
Epoch: 94, Steps: 64 | Train Loss: 0.4049268 Vali Loss: 0.2098526 Test Loss: 0.2749365
EarlyStopping counter: 3 out of 100
Updating learning rate to 6.855961324127991e-09
Epoch: 95 cost time: 12.64346432685852
Epoch: 95, Steps: 64 | Train Loss: 0.4054978 Vali Loss: 0.2095625 Test Loss: 0.2749812
EarlyStopping counter: 4 out of 100
Updating learning rate to 6.170365191715193e-09
Epoch: 96 cost time: 13.18484902381897
Epoch: 96, Steps: 64 | Train Loss: 0.4043824 Vali Loss: 0.2104826 Test Loss: 0.2749801
EarlyStopping counter: 5 out of 100
Updating learning rate to 5.5533286725436726e-09
Epoch: 97 cost time: 12.394187688827515
Epoch: 97, Steps: 64 | Train Loss: 0.4052014 Vali Loss: 0.2095696 Test Loss: 0.2749930
EarlyStopping counter: 6 out of 100
Updating learning rate to 4.997995805289306e-09
Epoch: 98 cost time: 13.10267186164856
Epoch: 98, Steps: 64 | Train Loss: 0.4048274 Vali Loss: 0.2095579 Test Loss: 0.2749918
EarlyStopping counter: 7 out of 100
Updating learning rate to 4.498196224760375e-09
Epoch: 99 cost time: 12.195381879806519
Epoch: 99, Steps: 64 | Train Loss: 0.4047457 Vali Loss: 0.2098947 Test Loss: 0.2749810
EarlyStopping counter: 8 out of 100
Updating learning rate to 4.048376602284338e-09
Epoch: 100 cost time: 12.046332120895386
Epoch: 100, Steps: 64 | Train Loss: 0.4060434 Vali Loss: 0.2092985 Test Loss: 0.2749463
EarlyStopping counter: 9 out of 100
Updating learning rate to 3.643538942055904e-09
>>>>>>>testing : 336_96_PatchTST_ETTh2_ftM_sl336_ll48_pl96_dm16_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.27482959628105164, mae:0.3373226523399353, rse:0.42248669266700745
