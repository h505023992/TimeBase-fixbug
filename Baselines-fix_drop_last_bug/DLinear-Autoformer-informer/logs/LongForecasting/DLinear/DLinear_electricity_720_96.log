Args in experiment:
Namespace(is_training=1, train_only=False, model_id='Electricity_720_96', model='DLinear', data='custom', root_path='./dataset/', data_path='electricity.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=96, individual=False, embed_type=0, enc_in=321, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=10, batch_size=16, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=7, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:7
>>>>>>>start training : Electricity_720_96_DLinear_custom_ftM_sl720_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17597
val 2537
test 5165
	iters: 100, epoch: 1 | loss: 0.2518772
	speed: 0.0381s/iter; left time: 414.6215s
	iters: 200, epoch: 1 | loss: 0.2265113
	speed: 0.0258s/iter; left time: 278.3533s
	iters: 300, epoch: 1 | loss: 0.1995628
	speed: 0.0330s/iter; left time: 352.6079s
	iters: 400, epoch: 1 | loss: 0.1739496
	speed: 0.0227s/iter; left time: 240.4947s
	iters: 500, epoch: 1 | loss: 0.1662153
	speed: 0.0223s/iter; left time: 234.2858s
	iters: 600, epoch: 1 | loss: 0.1864462
	speed: 0.0237s/iter; left time: 246.4528s
	iters: 700, epoch: 1 | loss: 0.1737876
	speed: 0.0230s/iter; left time: 237.0886s
	iters: 800, epoch: 1 | loss: 0.1674516
	speed: 0.0225s/iter; left time: 228.8113s
	iters: 900, epoch: 1 | loss: 0.1404089
	speed: 0.0233s/iter; left time: 234.9389s
	iters: 1000, epoch: 1 | loss: 0.1407450
	speed: 0.0235s/iter; left time: 234.3432s
Epoch: 1 cost time: 28.111895084381104
Epoch: 1, Steps: 1099 | Train Loss: 0.2048901 Vali Loss: 0.1348557 Test Loss: 0.1559962
Validation loss decreased (inf --> 0.134856).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1632675
	speed: 0.2418s/iter; left time: 2368.0055s
	iters: 200, epoch: 2 | loss: 0.1464788
	speed: 0.0269s/iter; left time: 260.3140s
	iters: 300, epoch: 2 | loss: 0.1345259
	speed: 0.0241s/iter; left time: 231.4222s
	iters: 400, epoch: 2 | loss: 0.1660407
	speed: 0.0213s/iter; left time: 202.0725s
	iters: 500, epoch: 2 | loss: 0.1270406
	speed: 0.0221s/iter; left time: 207.6211s
	iters: 600, epoch: 2 | loss: 0.1761397
	speed: 0.0230s/iter; left time: 213.9806s
	iters: 700, epoch: 2 | loss: 0.1263697
	speed: 0.0224s/iter; left time: 205.6055s
	iters: 800, epoch: 2 | loss: 0.1508876
	speed: 0.0224s/iter; left time: 203.2871s
	iters: 900, epoch: 2 | loss: 0.1260487
	speed: 0.0215s/iter; left time: 193.1896s
	iters: 1000, epoch: 2 | loss: 0.1843020
	speed: 0.0206s/iter; left time: 183.5365s
Epoch: 2 cost time: 26.207053422927856
Epoch: 2, Steps: 1099 | Train Loss: 0.1491095 Vali Loss: 0.1234592 Test Loss: 0.1444241
Validation loss decreased (0.134856 --> 0.123459).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1525898
	speed: 0.2129s/iter; left time: 1850.6825s
	iters: 200, epoch: 3 | loss: 0.1353832
	speed: 0.0214s/iter; left time: 183.6993s
	iters: 300, epoch: 3 | loss: 0.1288924
	speed: 0.0241s/iter; left time: 204.3385s
	iters: 400, epoch: 3 | loss: 0.1273646
	speed: 0.0220s/iter; left time: 184.6854s
	iters: 500, epoch: 3 | loss: 0.1276111
	speed: 0.0228s/iter; left time: 188.9470s
	iters: 600, epoch: 3 | loss: 0.1355881
	speed: 0.0232s/iter; left time: 190.0255s
	iters: 700, epoch: 3 | loss: 0.1613074
	speed: 0.0220s/iter; left time: 177.6963s
	iters: 800, epoch: 3 | loss: 0.1497689
	speed: 0.0213s/iter; left time: 170.2931s
	iters: 900, epoch: 3 | loss: 0.1379583
	speed: 0.0190s/iter; left time: 150.2617s
	iters: 1000, epoch: 3 | loss: 0.1216303
	speed: 0.0229s/iter; left time: 178.6410s
Epoch: 3 cost time: 26.127217292785645
Epoch: 3, Steps: 1099 | Train Loss: 0.1425544 Vali Loss: 0.1202404 Test Loss: 0.1412854
Validation loss decreased (0.123459 --> 0.120240).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1478078
	speed: 0.1886s/iter; left time: 1432.2667s
	iters: 200, epoch: 4 | loss: 0.1441911
	speed: 0.0209s/iter; left time: 156.4860s
	iters: 300, epoch: 4 | loss: 0.1162109
	speed: 0.0203s/iter; left time: 149.8403s
	iters: 400, epoch: 4 | loss: 0.1378156
	speed: 0.0190s/iter; left time: 138.9465s
	iters: 500, epoch: 4 | loss: 0.1341025
	speed: 0.0184s/iter; left time: 132.4015s
	iters: 600, epoch: 4 | loss: 0.1560367
	speed: 0.0193s/iter; left time: 136.8918s
	iters: 700, epoch: 4 | loss: 0.1321386
	speed: 0.0191s/iter; left time: 133.8077s
	iters: 800, epoch: 4 | loss: 0.1381227
	speed: 0.0191s/iter; left time: 131.3330s
	iters: 900, epoch: 4 | loss: 0.1570843
	speed: 0.0196s/iter; left time: 132.8309s
	iters: 1000, epoch: 4 | loss: 0.1149051
	speed: 0.0186s/iter; left time: 124.5319s
Epoch: 4 cost time: 22.251051902770996
Epoch: 4, Steps: 1099 | Train Loss: 0.1405386 Vali Loss: 0.1190935 Test Loss: 0.1401690
Validation loss decreased (0.120240 --> 0.119093).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1383019
	speed: 0.1720s/iter; left time: 1117.0170s
	iters: 200, epoch: 5 | loss: 0.1442423
	speed: 0.0190s/iter; left time: 121.4689s
	iters: 300, epoch: 5 | loss: 0.1233938
	speed: 0.0196s/iter; left time: 123.3874s
	iters: 400, epoch: 5 | loss: 0.1682180
	speed: 0.0191s/iter; left time: 118.0422s
	iters: 500, epoch: 5 | loss: 0.1228517
	speed: 0.0193s/iter; left time: 117.3370s
	iters: 600, epoch: 5 | loss: 0.1888750
	speed: 0.0187s/iter; left time: 111.9899s
	iters: 700, epoch: 5 | loss: 0.1448689
	speed: 0.0191s/iter; left time: 112.5045s
	iters: 800, epoch: 5 | loss: 0.1141258
	speed: 0.0199s/iter; left time: 115.3834s
	iters: 900, epoch: 5 | loss: 0.1219177
	speed: 0.0194s/iter; left time: 110.2642s
	iters: 1000, epoch: 5 | loss: 0.1232222
	speed: 0.0192s/iter; left time: 107.4323s
Epoch: 5 cost time: 22.146250009536743
Epoch: 5, Steps: 1099 | Train Loss: 0.1406422 Vali Loss: 0.1185123 Test Loss: 0.1404782
Validation loss decreased (0.119093 --> 0.118512).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1157263
	speed: 0.1763s/iter; left time: 951.1413s
	iters: 200, epoch: 6 | loss: 0.1328071
	speed: 0.0198s/iter; left time: 104.8880s
	iters: 300, epoch: 6 | loss: 0.1409387
	speed: 0.0191s/iter; left time: 99.4717s
	iters: 400, epoch: 6 | loss: 0.1419111
	speed: 0.0191s/iter; left time: 97.3525s
	iters: 500, epoch: 6 | loss: 0.1323260
	speed: 0.0192s/iter; left time: 95.7625s
	iters: 600, epoch: 6 | loss: 0.1535410
	speed: 0.0194s/iter; left time: 94.8724s
	iters: 700, epoch: 6 | loss: 0.1258443
	speed: 0.0202s/iter; left time: 97.0189s
	iters: 800, epoch: 6 | loss: 0.1275446
	speed: 0.0191s/iter; left time: 89.8095s
	iters: 900, epoch: 6 | loss: 0.1158726
	speed: 0.0199s/iter; left time: 91.3892s
	iters: 1000, epoch: 6 | loss: 0.1308748
	speed: 0.0196s/iter; left time: 88.0733s
Epoch: 6 cost time: 22.42163586616516
Epoch: 6, Steps: 1099 | Train Loss: 0.1401912 Vali Loss: 0.1183389 Test Loss: 0.1403098
Validation loss decreased (0.118512 --> 0.118339).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1381120
	speed: 0.1733s/iter; left time: 744.8400s
	iters: 200, epoch: 7 | loss: 0.2210613
	speed: 0.0193s/iter; left time: 81.0908s
	iters: 300, epoch: 7 | loss: 0.1292296
	speed: 0.0187s/iter; left time: 76.4499s
	iters: 400, epoch: 7 | loss: 0.1471945
	speed: 0.0182s/iter; left time: 72.6627s
	iters: 500, epoch: 7 | loss: 0.1244876
	speed: 0.0191s/iter; left time: 74.3142s
	iters: 600, epoch: 7 | loss: 0.1226807
	speed: 0.0188s/iter; left time: 71.4403s
	iters: 700, epoch: 7 | loss: 0.1367100
	speed: 0.0190s/iter; left time: 70.0853s
	iters: 800, epoch: 7 | loss: 0.1521661
	speed: 0.0189s/iter; left time: 68.0994s
	iters: 900, epoch: 7 | loss: 0.1137730
	speed: 0.0198s/iter; left time: 69.2029s
	iters: 1000, epoch: 7 | loss: 0.1424479
	speed: 0.0189s/iter; left time: 64.2855s
Epoch: 7 cost time: 21.780131340026855
Epoch: 7, Steps: 1099 | Train Loss: 0.1400468 Vali Loss: 0.1182189 Test Loss: 0.1401951
Validation loss decreased (0.118339 --> 0.118219).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1160716
	speed: 0.1788s/iter; left time: 571.6689s
	iters: 200, epoch: 8 | loss: 0.1205395
	speed: 0.0261s/iter; left time: 80.8852s
	iters: 300, epoch: 8 | loss: 0.1360959
	speed: 0.0251s/iter; left time: 75.1654s
	iters: 400, epoch: 8 | loss: 0.1354551
	speed: 0.0236s/iter; left time: 68.4428s
	iters: 500, epoch: 8 | loss: 0.1237692
	speed: 0.0230s/iter; left time: 64.3040s
	iters: 600, epoch: 8 | loss: 0.1652687
	speed: 0.0216s/iter; left time: 58.2473s
	iters: 700, epoch: 8 | loss: 0.1435998
	speed: 0.0224s/iter; left time: 58.0912s
	iters: 800, epoch: 8 | loss: 0.1411795
	speed: 0.0218s/iter; left time: 54.5743s
	iters: 900, epoch: 8 | loss: 0.1263738
	speed: 0.0221s/iter; left time: 52.9909s
	iters: 1000, epoch: 8 | loss: 0.1252664
	speed: 0.0221s/iter; left time: 50.6849s
Epoch: 8 cost time: 26.70573353767395
Epoch: 8, Steps: 1099 | Train Loss: 0.1389350 Vali Loss: 0.1180016 Test Loss: 0.1400352
Validation loss decreased (0.118219 --> 0.118002).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1360225
	speed: 0.2171s/iter; left time: 455.7258s
	iters: 200, epoch: 9 | loss: 0.1213079
	speed: 0.0300s/iter; left time: 59.9360s
	iters: 300, epoch: 9 | loss: 0.1336400
	speed: 0.0274s/iter; left time: 51.9725s
	iters: 400, epoch: 9 | loss: 0.1421247
	speed: 0.0230s/iter; left time: 41.4013s
	iters: 500, epoch: 9 | loss: 0.1302289
	speed: 0.0219s/iter; left time: 37.1839s
	iters: 600, epoch: 9 | loss: 0.1354743
	speed: 0.0220s/iter; left time: 35.1834s
	iters: 700, epoch: 9 | loss: 0.1625983
	speed: 0.0223s/iter; left time: 33.3723s
	iters: 800, epoch: 9 | loss: 0.1192237
	speed: 0.0215s/iter; left time: 30.1118s
	iters: 900, epoch: 9 | loss: 0.1377687
	speed: 0.0245s/iter; left time: 31.8305s
	iters: 1000, epoch: 9 | loss: 0.1092211
	speed: 0.0222s/iter; left time: 26.6700s
Epoch: 9 cost time: 27.28519320487976
Epoch: 9, Steps: 1099 | Train Loss: 0.1388822 Vali Loss: 0.1180325 Test Loss: 0.1400071
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1406598
	speed: 0.2091s/iter; left time: 209.1500s
	iters: 200, epoch: 10 | loss: 0.1095350
	speed: 0.0236s/iter; left time: 21.2503s
	iters: 300, epoch: 10 | loss: 0.1494432
	speed: 0.0269s/iter; left time: 21.5438s
	iters: 400, epoch: 10 | loss: 0.1349561
	speed: 0.0257s/iter; left time: 17.9867s
	iters: 500, epoch: 10 | loss: 0.1229054
	speed: 0.0224s/iter; left time: 13.4239s
	iters: 600, epoch: 10 | loss: 0.1412418
	speed: 0.0211s/iter; left time: 10.5608s
	iters: 700, epoch: 10 | loss: 0.1682947
	speed: 0.0217s/iter; left time: 8.6970s
	iters: 800, epoch: 10 | loss: 0.1466508
	speed: 0.0221s/iter; left time: 6.6203s
	iters: 900, epoch: 10 | loss: 0.1358866
	speed: 0.0220s/iter; left time: 4.4005s
	iters: 1000, epoch: 10 | loss: 0.1224073
	speed: 0.0211s/iter; left time: 2.1058s
Epoch: 10 cost time: 26.16362738609314
Epoch: 10, Steps: 1099 | Train Loss: 0.1388549 Vali Loss: 0.1180150 Test Loss: 0.1400293
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : Electricity_720_96_DLinear_custom_ftM_sl720_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
mse:0.14081948928833008, mae:0.2435976334810257
