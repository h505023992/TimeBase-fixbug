Args in experiment:
Namespace(is_training=1, train_only=False, model_id='DLinear_weather_336_720', model='DLinear', data='custom', root_path='./dataset/', data_path='weather.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=720, individual=False, embed_type=0, enc_in=21, dec_in=21, c_out=21, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DLinear_weather_336_720_DLinear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35832
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.6387075
	speed: 0.0575s/iter; left time: 1926.3475s
	iters: 200, epoch: 1 | loss: 0.6627840
	speed: 0.0350s/iter; left time: 1170.5762s
	iters: 300, epoch: 1 | loss: 0.7560809
	speed: 0.0348s/iter; left time: 1160.0955s
	iters: 400, epoch: 1 | loss: 0.5882436
	speed: 0.0344s/iter; left time: 1143.4287s
	iters: 500, epoch: 1 | loss: 0.4641429
	speed: 0.0395s/iter; left time: 1306.2250s
	iters: 600, epoch: 1 | loss: 0.6686467
	speed: 0.0433s/iter; left time: 1429.5452s
	iters: 700, epoch: 1 | loss: 0.5885876
	speed: 0.0432s/iter; left time: 1422.3905s
	iters: 800, epoch: 1 | loss: 0.5876266
	speed: 0.0424s/iter; left time: 1389.2122s
	iters: 900, epoch: 1 | loss: 0.7837139
	speed: 0.0430s/iter; left time: 1406.9346s
	iters: 1000, epoch: 1 | loss: 0.4966156
	speed: 0.0414s/iter; left time: 1349.6482s
	iters: 1100, epoch: 1 | loss: 0.5862833
	speed: 0.0415s/iter; left time: 1348.0698s
Epoch: 1 cost time: 46.433618783950806
Epoch: 1, Steps: 1120 | Train Loss: 0.6607701 Vali Loss: 0.6246637 Test Loss: 0.3325651
Validation loss decreased (inf --> 0.624664).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4947988
	speed: 0.4569s/iter; left time: 14793.8890s
	iters: 200, epoch: 2 | loss: 0.6539524
	speed: 0.0559s/iter; left time: 1803.5491s
	iters: 300, epoch: 2 | loss: 0.6398062
	speed: 0.0572s/iter; left time: 1839.7664s
	iters: 400, epoch: 2 | loss: 0.7195736
	speed: 0.0553s/iter; left time: 1775.3350s
	iters: 500, epoch: 2 | loss: 0.7808820
	speed: 0.0584s/iter; left time: 1869.1252s
	iters: 600, epoch: 2 | loss: 0.6542438
	speed: 0.0564s/iter; left time: 1798.4771s
	iters: 700, epoch: 2 | loss: 0.6408607
	speed: 0.0565s/iter; left time: 1795.4725s
	iters: 800, epoch: 2 | loss: 0.5701616
	speed: 0.0512s/iter; left time: 1622.6038s
	iters: 900, epoch: 2 | loss: 0.4945354
	speed: 0.0507s/iter; left time: 1600.5815s
	iters: 1000, epoch: 2 | loss: 0.7224439
	speed: 0.0521s/iter; left time: 1639.9032s
	iters: 1100, epoch: 2 | loss: 0.7324030
	speed: 0.0535s/iter; left time: 1680.3612s
Epoch: 2 cost time: 62.376540660858154
Epoch: 2, Steps: 1120 | Train Loss: 0.6168438 Vali Loss: 0.6251668 Test Loss: 0.3275370
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.9694213
	speed: 0.5365s/iter; left time: 16770.2638s
	iters: 200, epoch: 3 | loss: 0.5994130
	speed: 0.0551s/iter; left time: 1716.2516s
	iters: 300, epoch: 3 | loss: 0.8924195
	speed: 0.0538s/iter; left time: 1669.6460s
	iters: 400, epoch: 3 | loss: 0.6200442
	speed: 0.0525s/iter; left time: 1624.2287s
	iters: 500, epoch: 3 | loss: 0.4522695
	speed: 0.0526s/iter; left time: 1624.7802s
	iters: 600, epoch: 3 | loss: 0.5195285
	speed: 0.0527s/iter; left time: 1622.5411s
	iters: 700, epoch: 3 | loss: 0.4493172
	speed: 0.0548s/iter; left time: 1680.4386s
	iters: 800, epoch: 3 | loss: 0.7549180
	speed: 0.0500s/iter; left time: 1527.5491s
	iters: 900, epoch: 3 | loss: 0.4094048
	speed: 0.0583s/iter; left time: 1776.9783s
	iters: 1000, epoch: 3 | loss: 0.6188866
	speed: 0.0461s/iter; left time: 1400.5503s
	iters: 1100, epoch: 3 | loss: 0.5715785
	speed: 0.0429s/iter; left time: 1299.3976s
Epoch: 3 cost time: 59.213993310928345
Epoch: 3, Steps: 1120 | Train Loss: 0.6099999 Vali Loss: 0.6237442 Test Loss: 0.3254451
Validation loss decreased (0.624664 --> 0.623744).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.7698615
	speed: 0.3932s/iter; left time: 11850.7334s
	iters: 200, epoch: 4 | loss: 0.5106444
	speed: 0.0365s/iter; left time: 1097.1373s
	iters: 300, epoch: 4 | loss: 0.4693286
	speed: 0.0378s/iter; left time: 1131.9410s
	iters: 400, epoch: 4 | loss: 0.5635695
	speed: 0.0419s/iter; left time: 1249.1318s
	iters: 500, epoch: 4 | loss: 0.6754263
	speed: 0.0381s/iter; left time: 1134.6035s
	iters: 600, epoch: 4 | loss: 0.5382298
	speed: 0.0356s/iter; left time: 1055.9419s
	iters: 700, epoch: 4 | loss: 0.5818256
	speed: 0.0417s/iter; left time: 1232.2595s
	iters: 800, epoch: 4 | loss: 0.4497360
	speed: 0.0418s/iter; left time: 1230.0263s
	iters: 900, epoch: 4 | loss: 0.5603220
	speed: 0.0445s/iter; left time: 1304.4238s
	iters: 1000, epoch: 4 | loss: 0.5373532
	speed: 0.0416s/iter; left time: 1217.2963s
	iters: 1100, epoch: 4 | loss: 0.5157001
	speed: 0.0422s/iter; left time: 1231.0355s
Epoch: 4 cost time: 46.02041840553284
Epoch: 4, Steps: 1120 | Train Loss: 0.6075370 Vali Loss: 0.6243966 Test Loss: 0.3252109
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5701063
	speed: 0.4575s/iter; left time: 13277.8968s
	iters: 200, epoch: 5 | loss: 0.6667460
	speed: 0.0429s/iter; left time: 1240.7889s
	iters: 300, epoch: 5 | loss: 0.6570131
	speed: 0.0432s/iter; left time: 1243.9893s
	iters: 400, epoch: 5 | loss: 0.4981275
	speed: 0.0492s/iter; left time: 1412.7215s
	iters: 500, epoch: 5 | loss: 0.6296926
	speed: 0.0484s/iter; left time: 1384.9601s
	iters: 600, epoch: 5 | loss: 0.5796111
	speed: 0.0480s/iter; left time: 1369.9119s
	iters: 700, epoch: 5 | loss: 0.6463389
	speed: 0.0479s/iter; left time: 1361.4407s
	iters: 800, epoch: 5 | loss: 0.8824971
	speed: 0.0475s/iter; left time: 1344.6861s
	iters: 900, epoch: 5 | loss: 0.6208845
	speed: 0.0498s/iter; left time: 1404.1340s
	iters: 1000, epoch: 5 | loss: 0.7702582
	speed: 0.0486s/iter; left time: 1367.3671s
	iters: 1100, epoch: 5 | loss: 0.4862981
	speed: 0.0479s/iter; left time: 1343.0165s
Epoch: 5 cost time: 53.53717613220215
Epoch: 5, Steps: 1120 | Train Loss: 0.6064312 Vali Loss: 0.6231700 Test Loss: 0.3245225
Validation loss decreased (0.623744 --> 0.623170).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.7716355
	speed: 0.4829s/iter; left time: 13472.4946s
	iters: 200, epoch: 6 | loss: 0.4953617
	speed: 0.0451s/iter; left time: 1254.0917s
	iters: 300, epoch: 6 | loss: 0.5125062
	speed: 0.0479s/iter; left time: 1326.2807s
	iters: 400, epoch: 6 | loss: 0.6114295
	speed: 0.0497s/iter; left time: 1371.7184s
	iters: 500, epoch: 6 | loss: 0.5365153
	speed: 0.0462s/iter; left time: 1271.7474s
	iters: 600, epoch: 6 | loss: 0.4674864
	speed: 0.0460s/iter; left time: 1260.7058s
	iters: 700, epoch: 6 | loss: 0.7209021
	speed: 0.0484s/iter; left time: 1321.3770s
	iters: 800, epoch: 6 | loss: 0.5117456
	speed: 0.0451s/iter; left time: 1227.9643s
	iters: 900, epoch: 6 | loss: 0.4804286
	speed: 0.0459s/iter; left time: 1242.7391s
	iters: 1000, epoch: 6 | loss: 0.6273307
	speed: 0.0463s/iter; left time: 1251.0091s
	iters: 1100, epoch: 6 | loss: 0.5769334
	speed: 0.0456s/iter; left time: 1225.7007s
Epoch: 6 cost time: 53.37110114097595
Epoch: 6, Steps: 1120 | Train Loss: 0.6058300 Vali Loss: 0.6223389 Test Loss: 0.3249490
Validation loss decreased (0.623170 --> 0.622339).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.5700571
	speed: 0.4723s/iter; left time: 12648.1844s
	iters: 200, epoch: 7 | loss: 0.6399435
	speed: 0.0430s/iter; left time: 1147.7456s
	iters: 300, epoch: 7 | loss: 0.5149124
	speed: 0.0392s/iter; left time: 1041.4231s
	iters: 400, epoch: 7 | loss: 0.6330423
	speed: 0.0410s/iter; left time: 1086.0336s
	iters: 500, epoch: 7 | loss: 0.5587606
	speed: 0.0401s/iter; left time: 1056.8670s
	iters: 600, epoch: 7 | loss: 0.5206481
	speed: 0.0402s/iter; left time: 1055.4673s
	iters: 700, epoch: 7 | loss: 0.6135153
	speed: 0.0394s/iter; left time: 1031.0168s
	iters: 800, epoch: 7 | loss: 0.6229186
	speed: 0.0402s/iter; left time: 1048.8744s
	iters: 900, epoch: 7 | loss: 0.6288902
	speed: 0.0391s/iter; left time: 1015.8442s
	iters: 1000, epoch: 7 | loss: 0.6811881
	speed: 0.0400s/iter; left time: 1034.7057s
	iters: 1100, epoch: 7 | loss: 0.9923187
	speed: 0.0375s/iter; left time: 965.5375s
Epoch: 7 cost time: 46.334437131881714
Epoch: 7, Steps: 1120 | Train Loss: 0.6055487 Vali Loss: 0.6232024 Test Loss: 0.3246957
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4389053
	speed: 0.3905s/iter; left time: 10021.0059s
	iters: 200, epoch: 8 | loss: 0.4509722
	speed: 0.0412s/iter; left time: 1052.7595s
	iters: 300, epoch: 8 | loss: 0.8029034
	speed: 0.0421s/iter; left time: 1073.0580s
	iters: 400, epoch: 8 | loss: 0.5832536
	speed: 0.0413s/iter; left time: 1047.8765s
	iters: 500, epoch: 8 | loss: 0.6679335
	speed: 0.0422s/iter; left time: 1066.1964s
	iters: 600, epoch: 8 | loss: 0.5196501
	speed: 0.0412s/iter; left time: 1036.9896s
	iters: 700, epoch: 8 | loss: 0.8242685
	speed: 0.0443s/iter; left time: 1109.4250s
	iters: 800, epoch: 8 | loss: 0.4705656
	speed: 0.0413s/iter; left time: 1030.7756s
	iters: 900, epoch: 8 | loss: 0.5700783
	speed: 0.0453s/iter; left time: 1126.0561s
	iters: 1000, epoch: 8 | loss: 0.5618647
	speed: 0.0463s/iter; left time: 1146.0537s
	iters: 1100, epoch: 8 | loss: 0.4802330
	speed: 0.0484s/iter; left time: 1192.6325s
Epoch: 8 cost time: 49.57924962043762
Epoch: 8, Steps: 1120 | Train Loss: 0.6054707 Vali Loss: 0.6238953 Test Loss: 0.3245999
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.4449013
	speed: 0.4833s/iter; left time: 11860.0431s
	iters: 200, epoch: 9 | loss: 0.4892635
	speed: 0.0525s/iter; left time: 1283.2005s
	iters: 300, epoch: 9 | loss: 0.6515625
	speed: 0.0549s/iter; left time: 1336.8349s
	iters: 400, epoch: 9 | loss: 0.6382036
	speed: 0.0567s/iter; left time: 1373.4011s
	iters: 500, epoch: 9 | loss: 0.5340271
	speed: 0.0604s/iter; left time: 1457.6811s
	iters: 600, epoch: 9 | loss: 0.4488378
	speed: 0.0574s/iter; left time: 1379.3492s
	iters: 700, epoch: 9 | loss: 0.5290409
	speed: 0.0614s/iter; left time: 1470.4652s
	iters: 800, epoch: 9 | loss: 0.4671170
	speed: 0.0598s/iter; left time: 1426.6847s
	iters: 900, epoch: 9 | loss: 0.5150923
	speed: 0.0575s/iter; left time: 1365.9170s
	iters: 1000, epoch: 9 | loss: 0.6233661
	speed: 0.0588s/iter; left time: 1391.1060s
	iters: 1100, epoch: 9 | loss: 0.9390888
	speed: 0.0568s/iter; left time: 1337.2551s
Epoch: 9 cost time: 65.24224042892456
Epoch: 9, Steps: 1120 | Train Loss: 0.6053345 Vali Loss: 0.6240336 Test Loss: 0.3245560
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : DLinear_weather_336_720_DLinear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
mse:0.32485371828079224, mae:0.36299917101860046
