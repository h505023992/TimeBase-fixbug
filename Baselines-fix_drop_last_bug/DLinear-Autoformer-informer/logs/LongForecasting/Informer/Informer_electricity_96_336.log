Args in experiment:
Namespace(is_training=1, train_only=False, model_id='Informer_electricity_96_336', model='Informer', data='custom', root_path='./dataset/', data_path='electricity.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=336, individual=False, embed_type=0, enc_in=321, dec_in=321, c_out=321, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : Informer_electricity_96_336_Informer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17981
val 2297
test 4925
	iters: 100, epoch: 1 | loss: 0.8213487
	speed: 0.4576s/iter; left time: 7669.0671s
	iters: 200, epoch: 1 | loss: 0.7796254
	speed: 0.4003s/iter; left time: 6669.2721s
	iters: 300, epoch: 1 | loss: 0.7126123
	speed: 0.3983s/iter; left time: 6595.6515s
	iters: 400, epoch: 1 | loss: 0.6675978
	speed: 0.3800s/iter; left time: 6255.2592s
	iters: 500, epoch: 1 | loss: 0.7317059
	speed: 0.3872s/iter; left time: 6334.4760s
Epoch: 1 cost time: 226.89611840248108
Epoch: 1, Steps: 562 | Train Loss: 0.7618505 Vali Loss: 0.6509061 Test Loss: 0.7789729
Validation loss decreased (inf --> 0.650906).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5900664
	speed: 1.3753s/iter; left time: 22277.7409s
	iters: 200, epoch: 2 | loss: 0.4558571
	speed: 0.3873s/iter; left time: 6234.4756s
	iters: 300, epoch: 2 | loss: 0.2995369
	speed: 0.3909s/iter; left time: 6253.9598s
	iters: 400, epoch: 2 | loss: 0.2632068
	speed: 0.3912s/iter; left time: 6219.7733s
	iters: 500, epoch: 2 | loss: 0.2289118
	speed: 0.4034s/iter; left time: 6373.3158s
Epoch: 2 cost time: 223.45887422561646
Epoch: 2, Steps: 562 | Train Loss: 0.3900342 Vali Loss: 0.2946915 Test Loss: 0.3630553
Validation loss decreased (0.650906 --> 0.294692).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2119193
	speed: 1.4157s/iter; left time: 22137.6706s
	iters: 200, epoch: 3 | loss: 0.2087997
	speed: 0.3990s/iter; left time: 6199.0764s
	iters: 300, epoch: 3 | loss: 0.2075483
	speed: 0.3890s/iter; left time: 6005.2509s
	iters: 400, epoch: 3 | loss: 0.2093799
	speed: 0.3972s/iter; left time: 6091.7314s
	iters: 500, epoch: 3 | loss: 0.2034333
	speed: 0.4163s/iter; left time: 6342.8187s
Epoch: 3 cost time: 228.02704739570618
Epoch: 3, Steps: 562 | Train Loss: 0.2165405 Vali Loss: 0.2767033 Test Loss: 0.3583574
Validation loss decreased (0.294692 --> 0.276703).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1943627
	speed: 1.4970s/iter; left time: 22567.3902s
	iters: 200, epoch: 4 | loss: 0.1976187
	speed: 0.4087s/iter; left time: 6119.9309s
	iters: 300, epoch: 4 | loss: 0.2051181
	speed: 0.3976s/iter; left time: 5913.9614s
	iters: 400, epoch: 4 | loss: 0.2155230
	speed: 0.3864s/iter; left time: 5709.0159s
	iters: 500, epoch: 4 | loss: 0.1913812
	speed: 0.3860s/iter; left time: 5664.6433s
Epoch: 4 cost time: 224.37548828125
Epoch: 4, Steps: 562 | Train Loss: 0.2003024 Vali Loss: 0.2714869 Test Loss: 0.3537423
Validation loss decreased (0.276703 --> 0.271487).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1931810
	speed: 1.4482s/iter; left time: 21017.0477s
	iters: 200, epoch: 5 | loss: 0.1936127
	speed: 0.3784s/iter; left time: 5453.4777s
	iters: 300, epoch: 5 | loss: 0.1997959
	speed: 0.3900s/iter; left time: 5581.7832s
	iters: 400, epoch: 5 | loss: 0.1960656
	speed: 0.3836s/iter; left time: 5451.6063s
	iters: 500, epoch: 5 | loss: 0.1850268
	speed: 0.4095s/iter; left time: 5778.6300s
Epoch: 5 cost time: 222.99448442459106
Epoch: 5, Steps: 562 | Train Loss: 0.1924884 Vali Loss: 0.2680018 Test Loss: 0.3463195
Validation loss decreased (0.271487 --> 0.268002).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1956969
	speed: 1.3959s/iter; left time: 19474.7317s
	iters: 200, epoch: 6 | loss: 0.1886420
	speed: 0.3996s/iter; left time: 5534.4546s
	iters: 300, epoch: 6 | loss: 0.1818525
	speed: 0.4038s/iter; left time: 5552.6759s
	iters: 400, epoch: 6 | loss: 0.1880293
	speed: 0.3758s/iter; left time: 5129.7988s
	iters: 500, epoch: 6 | loss: 0.1794470
	speed: 0.4005s/iter; left time: 5426.5490s
Epoch: 6 cost time: 224.05395674705505
Epoch: 6, Steps: 562 | Train Loss: 0.1882342 Vali Loss: 0.2649595 Test Loss: 0.3478292
Validation loss decreased (0.268002 --> 0.264960).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1781914
	speed: 1.4003s/iter; left time: 18748.7195s
	iters: 200, epoch: 7 | loss: 0.1830014
	speed: 0.3973s/iter; left time: 5279.5962s
	iters: 300, epoch: 7 | loss: 0.1795503
	speed: 0.4210s/iter; left time: 5552.0069s
	iters: 400, epoch: 7 | loss: 0.1870290
	speed: 0.4243s/iter; left time: 5553.4106s
	iters: 500, epoch: 7 | loss: 0.1909874
	speed: 0.4074s/iter; left time: 5291.7220s
Epoch: 7 cost time: 229.55440878868103
Epoch: 7, Steps: 562 | Train Loss: 0.1861492 Vali Loss: 0.2645512 Test Loss: 0.3478242
Validation loss decreased (0.264960 --> 0.264551).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1746766
	speed: 1.3336s/iter; left time: 17106.1188s
	iters: 200, epoch: 8 | loss: 0.1756305
	speed: 0.3768s/iter; left time: 4795.8892s
	iters: 300, epoch: 8 | loss: 0.1876043
	speed: 0.3856s/iter; left time: 4869.3276s
	iters: 400, epoch: 8 | loss: 0.1783061
	speed: 0.3860s/iter; left time: 4835.0120s
	iters: 500, epoch: 8 | loss: 0.1845694
	speed: 0.4032s/iter; left time: 5010.2006s
Epoch: 8 cost time: 219.38900423049927
Epoch: 8, Steps: 562 | Train Loss: 0.1851093 Vali Loss: 0.2637520 Test Loss: 0.3469792
Validation loss decreased (0.264551 --> 0.263752).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1883575
	speed: 1.3466s/iter; left time: 16515.8736s
	iters: 200, epoch: 9 | loss: 0.1853314
	speed: 0.4015s/iter; left time: 4883.6781s
	iters: 300, epoch: 9 | loss: 0.1995052
	speed: 0.4000s/iter; left time: 4825.6475s
	iters: 400, epoch: 9 | loss: 0.1847429
	speed: 0.3980s/iter; left time: 4762.5966s
	iters: 500, epoch: 9 | loss: 0.1816703
	speed: 0.3871s/iter; left time: 4592.4560s
Epoch: 9 cost time: 221.56633162498474
Epoch: 9, Steps: 562 | Train Loss: 0.1845734 Vali Loss: 0.2662770 Test Loss: 0.3495423
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1797060
	speed: 1.4027s/iter; left time: 16416.0379s
	iters: 200, epoch: 10 | loss: 0.1789629
	speed: 0.4040s/iter; left time: 4687.6136s
	iters: 300, epoch: 10 | loss: 0.1945739
	speed: 0.3993s/iter; left time: 4593.4358s
	iters: 400, epoch: 10 | loss: 0.1831490
	speed: 0.4016s/iter; left time: 4579.8030s
	iters: 500, epoch: 10 | loss: 0.1858714
	speed: 0.3948s/iter; left time: 4462.1991s
Epoch: 10 cost time: 223.19826364517212
Epoch: 10, Steps: 562 | Train Loss: 0.1842061 Vali Loss: 0.2642151 Test Loss: 0.3475263
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1846806
	speed: 1.4148s/iter; left time: 15762.2424s
	iters: 200, epoch: 11 | loss: 0.1864368
	speed: 0.3857s/iter; left time: 4258.2192s
	iters: 300, epoch: 11 | loss: 0.1841954
	speed: 0.3998s/iter; left time: 4373.6725s
	iters: 400, epoch: 11 | loss: 0.1786161
	speed: 0.4001s/iter; left time: 4336.9807s
	iters: 500, epoch: 11 | loss: 0.1924068
	speed: 0.3690s/iter; left time: 3963.2573s
Epoch: 11 cost time: 222.71697211265564
Epoch: 11, Steps: 562 | Train Loss: 0.1840962 Vali Loss: 0.2637204 Test Loss: 0.3479722
Validation loss decreased (0.263752 --> 0.263720).  Saving model ...
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1904293
	speed: 1.3982s/iter; left time: 14791.2989s
	iters: 200, epoch: 12 | loss: 0.1843274
	speed: 0.4156s/iter; left time: 4355.1953s
	iters: 300, epoch: 12 | loss: 0.1943859
	speed: 0.4016s/iter; left time: 4168.0658s
	iters: 400, epoch: 12 | loss: 0.1892105
	speed: 0.3744s/iter; left time: 3848.8197s
	iters: 500, epoch: 12 | loss: 0.1849425
	speed: 0.3822s/iter; left time: 3890.3872s
Epoch: 12 cost time: 220.60792231559753
Epoch: 12, Steps: 562 | Train Loss: 0.1840445 Vali Loss: 0.2627775 Test Loss: 0.3466215
Validation loss decreased (0.263720 --> 0.262777).  Saving model ...
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.1854740
	speed: 1.3996s/iter; left time: 14019.4092s
	iters: 200, epoch: 13 | loss: 0.1885131
	speed: 0.4238s/iter; left time: 4202.5294s
	iters: 300, epoch: 13 | loss: 0.1761378
	speed: 0.4202s/iter; left time: 4125.1115s
	iters: 400, epoch: 13 | loss: 0.1891516
	speed: 0.4071s/iter; left time: 3955.7783s
	iters: 500, epoch: 13 | loss: 0.1857522
	speed: 0.4199s/iter; left time: 4038.4456s
Epoch: 13 cost time: 233.6999921798706
Epoch: 13, Steps: 562 | Train Loss: 0.1840113 Vali Loss: 0.2639633 Test Loss: 0.3472370
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.1872208
	speed: 1.4501s/iter; left time: 13710.5911s
	iters: 200, epoch: 14 | loss: 0.1791712
	speed: 0.3818s/iter; left time: 3571.6072s
	iters: 300, epoch: 14 | loss: 0.1934025
	speed: 0.4219s/iter; left time: 3905.0932s
	iters: 400, epoch: 14 | loss: 0.1838209
	speed: 0.4230s/iter; left time: 3872.8391s
	iters: 500, epoch: 14 | loss: 0.1841510
	speed: 0.4186s/iter; left time: 3790.1986s
Epoch: 14 cost time: 230.19900727272034
Epoch: 14, Steps: 562 | Train Loss: 0.1840079 Vali Loss: 0.2637221 Test Loss: 0.3471213
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.220703125e-08
	iters: 100, epoch: 15 | loss: 0.1834085
	speed: 1.3707s/iter; left time: 12190.0632s
	iters: 200, epoch: 15 | loss: 0.1831072
	speed: 0.3946s/iter; left time: 3470.0188s
	iters: 300, epoch: 15 | loss: 0.1794287
	speed: 0.3935s/iter; left time: 3420.5367s
	iters: 400, epoch: 15 | loss: 0.1795280
	speed: 0.3879s/iter; left time: 3333.2046s
	iters: 500, epoch: 15 | loss: 0.1860793
	speed: 0.4219s/iter; left time: 3582.8988s
Epoch: 15 cost time: 223.87888884544373
Epoch: 15, Steps: 562 | Train Loss: 0.1840436 Vali Loss: 0.2643626 Test Loss: 0.3499667
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Informer_electricity_96_336_Informer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4925
mse:0.3465080261230469, mae:0.4305184781551361
