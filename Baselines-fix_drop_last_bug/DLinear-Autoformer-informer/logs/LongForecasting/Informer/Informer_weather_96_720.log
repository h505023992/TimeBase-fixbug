Args in experiment:
Namespace(is_training=1, train_only=False, model_id='Informer_weather_96_720', model='Informer', data='custom', root_path='./dataset/', data_path='weather.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=720, individual=False, embed_type=0, enc_in=21, dec_in=21, c_out=21, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : Informer_weather_96_720_Informer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36072
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.5023559
	speed: 0.4959s/iter; left time: 16731.2226s
	iters: 200, epoch: 1 | loss: 0.6499213
	speed: 0.4375s/iter; left time: 14718.8086s
	iters: 300, epoch: 1 | loss: 0.4640417
	speed: 0.4386s/iter; left time: 14709.5269s
	iters: 400, epoch: 1 | loss: 0.5173787
	speed: 0.4250s/iter; left time: 14212.3111s
	iters: 500, epoch: 1 | loss: 0.4658577
	speed: 0.4467s/iter; left time: 14894.3378s
	iters: 600, epoch: 1 | loss: 0.6919743
	speed: 0.4409s/iter; left time: 14654.3920s
	iters: 700, epoch: 1 | loss: 0.3805840
	speed: 0.4211s/iter; left time: 13954.3305s
	iters: 800, epoch: 1 | loss: 0.4560285
	speed: 0.4437s/iter; left time: 14658.8148s
	iters: 900, epoch: 1 | loss: 0.4852825
	speed: 0.4181s/iter; left time: 13771.7353s
	iters: 1000, epoch: 1 | loss: 0.5084966
	speed: 0.4194s/iter; left time: 13772.6870s
	iters: 1100, epoch: 1 | loss: 0.4544876
	speed: 0.4321s/iter; left time: 14148.8652s
Epoch: 1 cost time: 493.97091007232666
Epoch: 1, Steps: 1128 | Train Loss: 0.5189936 Vali Loss: 0.9517720 Test Loss: 1.4419352
Validation loss decreased (inf --> 0.951772).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3967416
	speed: 1.7761s/iter; left time: 57924.5796s
	iters: 200, epoch: 2 | loss: 0.4552672
	speed: 0.4440s/iter; left time: 14436.8973s
	iters: 300, epoch: 2 | loss: 0.3771434
	speed: 0.4443s/iter; left time: 14400.7071s
	iters: 400, epoch: 2 | loss: 0.4131519
	speed: 0.4324s/iter; left time: 13972.4721s
	iters: 500, epoch: 2 | loss: 0.2905416
	speed: 0.4423s/iter; left time: 14248.0259s
	iters: 600, epoch: 2 | loss: 0.2684115
	speed: 0.4409s/iter; left time: 14158.3637s
	iters: 700, epoch: 2 | loss: 0.5587438
	speed: 0.4189s/iter; left time: 13409.9204s
	iters: 800, epoch: 2 | loss: 0.3397129
	speed: 0.4205s/iter; left time: 13420.3963s
	iters: 900, epoch: 2 | loss: 0.2501718
	speed: 0.4286s/iter; left time: 13633.7853s
	iters: 1000, epoch: 2 | loss: 0.2538590
	speed: 0.4325s/iter; left time: 13715.7298s
	iters: 1100, epoch: 2 | loss: 0.2365273
	speed: 0.4290s/iter; left time: 13561.8200s
Epoch: 2 cost time: 488.82358598709106
Epoch: 2, Steps: 1128 | Train Loss: 0.3845214 Vali Loss: 0.8547648 Test Loss: 1.0451258
Validation loss decreased (0.951772 --> 0.854765).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3150470
	speed: 1.8288s/iter; left time: 57578.4327s
	iters: 200, epoch: 3 | loss: 0.4412177
	speed: 0.4387s/iter; left time: 13769.2199s
	iters: 300, epoch: 3 | loss: 0.4371591
	speed: 0.4380s/iter; left time: 13704.2678s
	iters: 400, epoch: 3 | loss: 0.2853167
	speed: 0.4188s/iter; left time: 13059.0930s
	iters: 500, epoch: 3 | loss: 0.2102771
	speed: 0.4500s/iter; left time: 13987.7332s
	iters: 600, epoch: 3 | loss: 0.2353675
	speed: 0.4373s/iter; left time: 13548.3353s
	iters: 700, epoch: 3 | loss: 0.4056621
	speed: 0.4371s/iter; left time: 13501.3040s
	iters: 800, epoch: 3 | loss: 0.3335815
	speed: 0.4427s/iter; left time: 13629.6045s
	iters: 900, epoch: 3 | loss: 0.1984031
	speed: 0.4251s/iter; left time: 13044.8441s
	iters: 1000, epoch: 3 | loss: 0.3989822
	speed: 0.4330s/iter; left time: 13243.1300s
	iters: 1100, epoch: 3 | loss: 0.2272321
	speed: 0.4316s/iter; left time: 13157.6966s
Epoch: 3 cost time: 492.6957709789276
Epoch: 3, Steps: 1128 | Train Loss: 0.3094538 Vali Loss: 0.8516279 Test Loss: 1.1164643
Validation loss decreased (0.854765 --> 0.851628).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2073796
	speed: 1.8060s/iter; left time: 54824.9965s
	iters: 200, epoch: 4 | loss: 0.2173531
	speed: 0.4343s/iter; left time: 13141.4649s
	iters: 300, epoch: 4 | loss: 0.1954324
	speed: 0.4489s/iter; left time: 13538.9516s
	iters: 400, epoch: 4 | loss: 0.2891802
	speed: 0.4339s/iter; left time: 13040.8612s
	iters: 500, epoch: 4 | loss: 0.2171995
	speed: 0.4295s/iter; left time: 12866.4451s
	iters: 600, epoch: 4 | loss: 0.2327243
	speed: 0.4591s/iter; left time: 13707.1895s
	iters: 700, epoch: 4 | loss: 0.1798170
	speed: 0.4504s/iter; left time: 13401.8536s
	iters: 800, epoch: 4 | loss: 0.2205025
	speed: 0.4346s/iter; left time: 12889.0525s
	iters: 900, epoch: 4 | loss: 0.2093055
	speed: 0.4272s/iter; left time: 12628.2184s
	iters: 1000, epoch: 4 | loss: 0.3793981
	speed: 0.4335s/iter; left time: 12769.0584s
	iters: 1100, epoch: 4 | loss: 0.2344620
	speed: 0.4318s/iter; left time: 12675.4691s
Epoch: 4 cost time: 493.646680355072
Epoch: 4, Steps: 1128 | Train Loss: 0.2793782 Vali Loss: 0.8486651 Test Loss: 1.0980736
Validation loss decreased (0.851628 --> 0.848665).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1922715
	speed: 1.8995s/iter; left time: 55521.4844s
	iters: 200, epoch: 5 | loss: 0.1805981
	speed: 0.4463s/iter; left time: 12999.9756s
	iters: 300, epoch: 5 | loss: 0.2147401
	speed: 0.4454s/iter; left time: 12929.5952s
	iters: 400, epoch: 5 | loss: 0.3533921
	speed: 0.4415s/iter; left time: 12772.7996s
	iters: 500, epoch: 5 | loss: 0.2289739
	speed: 0.4324s/iter; left time: 12466.5210s
	iters: 600, epoch: 5 | loss: 0.3145066
	speed: 0.4429s/iter; left time: 12723.2580s
	iters: 700, epoch: 5 | loss: 0.2931864
	speed: 0.4481s/iter; left time: 12827.5480s
	iters: 800, epoch: 5 | loss: 0.2569504
	speed: 0.4109s/iter; left time: 11721.3044s
	iters: 900, epoch: 5 | loss: 0.2990429
	speed: 0.4277s/iter; left time: 12157.8582s
	iters: 1000, epoch: 5 | loss: 0.2434953
	speed: 0.4196s/iter; left time: 11885.6701s
	iters: 1100, epoch: 5 | loss: 0.2082681
	speed: 0.4387s/iter; left time: 12384.8681s
Epoch: 5 cost time: 492.8658609390259
Epoch: 5, Steps: 1128 | Train Loss: 0.2667536 Vali Loss: 0.8484219 Test Loss: 1.0846453
Validation loss decreased (0.848665 --> 0.848422).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2325691
	speed: 1.8831s/iter; left time: 52916.6546s
	iters: 200, epoch: 6 | loss: 0.2434819
	speed: 0.4476s/iter; left time: 12532.4871s
	iters: 300, epoch: 6 | loss: 0.2223120
	speed: 0.4316s/iter; left time: 12041.1811s
	iters: 400, epoch: 6 | loss: 0.1911564
	speed: 0.4453s/iter; left time: 12378.8834s
	iters: 500, epoch: 6 | loss: 0.2970384
	speed: 0.4267s/iter; left time: 11819.2873s
	iters: 600, epoch: 6 | loss: 0.1805263
	speed: 0.4389s/iter; left time: 12114.5895s
	iters: 700, epoch: 6 | loss: 0.1993850
	speed: 0.4452s/iter; left time: 12244.2870s
	iters: 800, epoch: 6 | loss: 0.1757288
	speed: 0.4292s/iter; left time: 11760.0965s
	iters: 900, epoch: 6 | loss: 0.2436108
	speed: 0.4380s/iter; left time: 11957.0530s
	iters: 1000, epoch: 6 | loss: 0.2272314
	speed: 0.4358s/iter; left time: 11854.0405s
	iters: 1100, epoch: 6 | loss: 0.2021981
	speed: 0.4215s/iter; left time: 11422.9473s
Epoch: 6 cost time: 493.19278836250305
Epoch: 6, Steps: 1128 | Train Loss: 0.2601673 Vali Loss: 0.8372995 Test Loss: 1.0953934
Validation loss decreased (0.848422 --> 0.837300).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2312376
	speed: 1.7842s/iter; left time: 48124.1397s
	iters: 200, epoch: 7 | loss: 0.2646900
	speed: 0.4374s/iter; left time: 11755.5699s
	iters: 300, epoch: 7 | loss: 0.3116759
	speed: 0.4391s/iter; left time: 11756.6369s
	iters: 400, epoch: 7 | loss: 0.3074387
	speed: 0.4481s/iter; left time: 11951.9227s
	iters: 500, epoch: 7 | loss: 0.2235287
	speed: 0.4577s/iter; left time: 12162.2857s
	iters: 600, epoch: 7 | loss: 0.2755287
	speed: 0.4489s/iter; left time: 11884.7037s
	iters: 700, epoch: 7 | loss: 0.2729156
	speed: 0.4462s/iter; left time: 11767.2997s
	iters: 800, epoch: 7 | loss: 0.2018991
	speed: 0.4524s/iter; left time: 11885.5686s
	iters: 900, epoch: 7 | loss: 0.3109281
	speed: 0.4162s/iter; left time: 10894.5053s
	iters: 1000, epoch: 7 | loss: 0.2586788
	speed: 0.4372s/iter; left time: 11399.3424s
	iters: 1100, epoch: 7 | loss: 0.1978174
	speed: 0.4563s/iter; left time: 11850.4694s
Epoch: 7 cost time: 500.2496473789215
Epoch: 7, Steps: 1128 | Train Loss: 0.2572359 Vali Loss: 0.8410779 Test Loss: 1.0887486
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2718129
	speed: 1.8863s/iter; left time: 48751.7670s
	iters: 200, epoch: 8 | loss: 0.1613657
	speed: 0.4327s/iter; left time: 11139.8795s
	iters: 300, epoch: 8 | loss: 0.3025692
	speed: 0.4436s/iter; left time: 11375.9074s
	iters: 400, epoch: 8 | loss: 0.2847933
	speed: 0.4039s/iter; left time: 10316.8803s
	iters: 500, epoch: 8 | loss: 0.2923468
	speed: 0.4308s/iter; left time: 10960.9343s
	iters: 600, epoch: 8 | loss: 0.2218670
	speed: 0.4354s/iter; left time: 11036.2059s
	iters: 700, epoch: 8 | loss: 0.1772493
	speed: 0.4413s/iter; left time: 11140.9403s
	iters: 800, epoch: 8 | loss: 0.1915285
	speed: 0.4585s/iter; left time: 11528.8676s
	iters: 900, epoch: 8 | loss: 0.1876771
	speed: 0.4541s/iter; left time: 11371.8374s
	iters: 1000, epoch: 8 | loss: 0.1961291
	speed: 0.4638s/iter; left time: 11568.2531s
	iters: 1100, epoch: 8 | loss: 0.3503397
	speed: 0.4334s/iter; left time: 10768.1270s
Epoch: 8 cost time: 496.2885367870331
Epoch: 8, Steps: 1128 | Train Loss: 0.2556123 Vali Loss: 0.8336589 Test Loss: 1.0669705
Validation loss decreased (0.837300 --> 0.833659).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3611847
	speed: 1.8478s/iter; left time: 45671.6943s
	iters: 200, epoch: 9 | loss: 0.3272868
	speed: 0.4466s/iter; left time: 10993.3314s
	iters: 300, epoch: 9 | loss: 0.3512545
	speed: 0.4338s/iter; left time: 10634.7991s
	iters: 400, epoch: 9 | loss: 0.3487405
	speed: 0.4280s/iter; left time: 10450.7032s
	iters: 500, epoch: 9 | loss: 0.2677186
	speed: 0.4419s/iter; left time: 10746.1178s
	iters: 600, epoch: 9 | loss: 0.3688195
	speed: 0.4287s/iter; left time: 10382.8222s
	iters: 700, epoch: 9 | loss: 0.2715785
	speed: 0.4373s/iter; left time: 10546.4517s
	iters: 800, epoch: 9 | loss: 0.1898689
	speed: 0.4305s/iter; left time: 10338.9829s
	iters: 900, epoch: 9 | loss: 0.2272305
	speed: 0.4269s/iter; left time: 10211.2714s
	iters: 1000, epoch: 9 | loss: 0.2098379
	speed: 0.4364s/iter; left time: 10394.0915s
	iters: 1100, epoch: 9 | loss: 0.3511232
	speed: 0.4309s/iter; left time: 10220.8159s
Epoch: 9 cost time: 490.8168885707855
Epoch: 9, Steps: 1128 | Train Loss: 0.2547952 Vali Loss: 0.8337334 Test Loss: 1.0758327
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3741214
	speed: 1.8623s/iter; left time: 43929.1262s
	iters: 200, epoch: 10 | loss: 0.1903897
	speed: 0.4484s/iter; left time: 10532.5083s
	iters: 300, epoch: 10 | loss: 0.1935188
	speed: 0.4375s/iter; left time: 10233.6482s
	iters: 400, epoch: 10 | loss: 0.1978524
	speed: 0.4247s/iter; left time: 9890.8194s
	iters: 500, epoch: 10 | loss: 0.1871355
	speed: 0.4243s/iter; left time: 9838.5751s
	iters: 600, epoch: 10 | loss: 0.3540441
	speed: 0.4225s/iter; left time: 9755.5800s
	iters: 700, epoch: 10 | loss: 0.2611466
	speed: 0.4220s/iter; left time: 9702.1621s
	iters: 800, epoch: 10 | loss: 0.2145436
	speed: 0.4427s/iter; left time: 10132.8093s
	iters: 900, epoch: 10 | loss: 0.2814127
	speed: 0.4410s/iter; left time: 10050.5883s
	iters: 1000, epoch: 10 | loss: 0.2240772
	speed: 0.4337s/iter; left time: 9840.5691s
	iters: 1100, epoch: 10 | loss: 0.2081233
	speed: 0.4439s/iter; left time: 10026.6382s
Epoch: 10 cost time: 492.6829619407654
Epoch: 10, Steps: 1128 | Train Loss: 0.2543588 Vali Loss: 0.8401741 Test Loss: 1.0924400
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.3536089
	speed: 1.8842s/iter; left time: 42320.7296s
	iters: 200, epoch: 11 | loss: 0.3993593
	speed: 0.4343s/iter; left time: 9712.3660s
	iters: 300, epoch: 11 | loss: 0.1646862
	speed: 0.4441s/iter; left time: 9885.1406s
	iters: 400, epoch: 11 | loss: 0.3998117
	speed: 0.4373s/iter; left time: 9690.5883s
	iters: 500, epoch: 11 | loss: 0.2663717
	speed: 0.4295s/iter; left time: 9474.3366s
	iters: 600, epoch: 11 | loss: 0.3980889
	speed: 0.4512s/iter; left time: 9909.3425s
	iters: 700, epoch: 11 | loss: 0.2778467
	speed: 0.4235s/iter; left time: 9259.0821s
	iters: 800, epoch: 11 | loss: 0.4239627
	speed: 0.4596s/iter; left time: 10001.9127s
	iters: 900, epoch: 11 | loss: 0.3685900
	speed: 0.4493s/iter; left time: 9733.0348s
	iters: 1000, epoch: 11 | loss: 0.4581107
	speed: 0.4169s/iter; left time: 8989.1983s
	iters: 1100, epoch: 11 | loss: 0.2823959
	speed: 0.4442s/iter; left time: 9532.6689s
Epoch: 11 cost time: 497.2215168476105
Epoch: 11, Steps: 1128 | Train Loss: 0.2541482 Vali Loss: 0.8450933 Test Loss: 1.0908638
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Informer_weather_96_720_Informer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
mse:1.0668799877166748, mae:0.7714055180549622
