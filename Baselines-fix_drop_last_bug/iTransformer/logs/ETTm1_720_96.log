Args in experiment:
Namespace(is_training=1, model_id='ETTm1_720_96', model='iTransformer', data='ETTm1', root_path='./dataset/', data_path='ETTm1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=96, enc_in=7, dec_in=7, c_out=7, d_model=128, n_heads=8, e_layers=2, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='MSE', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', exp_name='MTSF', channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv', efficient_training=False, use_norm=True, partial_start_index=0)
Use GPU: cuda:0
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.dropout.Dropout'>.
[INFO] Register count_convNd() for <class 'torch.nn.modules.conv.Conv1d'>.
[INFO] Register count_normalization() for <class 'torch.nn.modules.normalization.LayerNorm'>.
MACs: 3947008.0
Params: 304096.0
3.95M MACs
>>>>>>>start training : ETTm1_720_96_iTransformer_ETTm1_M_ft720_sl48_ll96_pl128_dm8_nh2_el1_dl128_df1_fctimeF_ebTrue_dtExp_projection_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.3854804
	speed: 0.0363s/iter; left time: 378.6576s
	iters: 200, epoch: 1 | loss: 0.2729289
	speed: 0.0208s/iter; left time: 214.8410s
	iters: 300, epoch: 1 | loss: 0.3482797
	speed: 0.0207s/iter; left time: 211.7043s
	iters: 400, epoch: 1 | loss: 0.3306431
	speed: 0.0258s/iter; left time: 261.9198s
	iters: 500, epoch: 1 | loss: 0.2941183
	speed: 0.0236s/iter; left time: 237.3313s
	iters: 600, epoch: 1 | loss: 0.2550420
	speed: 0.0220s/iter; left time: 219.1796s
	iters: 700, epoch: 1 | loss: 0.2545594
	speed: 0.0225s/iter; left time: 221.4798s
	iters: 800, epoch: 1 | loss: 0.3660119
	speed: 0.0266s/iter; left time: 259.2910s
	iters: 900, epoch: 1 | loss: 0.2208185
	speed: 0.0231s/iter; left time: 223.1270s
	iters: 1000, epoch: 1 | loss: 0.2198832
	speed: 0.0215s/iter; left time: 205.5390s
Max Memory (MB): 16.080078125
Epoch: 1 cost time: 25.538952827453613
Epoch: 1, Steps: 1054 | Train Loss: 0.2974748 Vali Loss: 0.4049072 Test Loss: 0.3221417
Validation loss decreased (inf --> 0.404907).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2501014
	speed: 0.7819s/iter; left time: 7339.3441s
	iters: 200, epoch: 2 | loss: 0.2862383
	speed: 0.0253s/iter; left time: 235.4106s
	iters: 300, epoch: 2 | loss: 0.2204506
	speed: 0.0256s/iter; left time: 235.1203s
	iters: 400, epoch: 2 | loss: 0.2096350
	speed: 0.0240s/iter; left time: 218.3459s
	iters: 500, epoch: 2 | loss: 0.2452730
	speed: 0.0238s/iter; left time: 213.7776s
	iters: 600, epoch: 2 | loss: 0.1907597
	speed: 0.0223s/iter; left time: 198.5549s
	iters: 700, epoch: 2 | loss: 0.2367567
	speed: 0.0238s/iter; left time: 208.7834s
	iters: 800, epoch: 2 | loss: 0.2336746
	speed: 0.0256s/iter; left time: 222.8154s
	iters: 900, epoch: 2 | loss: 0.2210040
	speed: 0.0244s/iter; left time: 209.3497s
	iters: 1000, epoch: 2 | loss: 0.1935103
	speed: 0.0226s/iter; left time: 191.6341s
Max Memory (MB): 16.080078125
Epoch: 2 cost time: 26.1375629901886
Epoch: 2, Steps: 1054 | Train Loss: 0.2372319 Vali Loss: 0.3913366 Test Loss: 0.3173714
Validation loss decreased (0.404907 --> 0.391337).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2379442
	speed: 0.7303s/iter; left time: 6085.7028s
	iters: 200, epoch: 3 | loss: 0.2203229
	speed: 0.0205s/iter; left time: 168.8671s
	iters: 300, epoch: 3 | loss: 0.2143149
	speed: 0.0195s/iter; left time: 158.3443s
	iters: 400, epoch: 3 | loss: 0.2308994
	speed: 0.0189s/iter; left time: 151.7418s
	iters: 500, epoch: 3 | loss: 0.2499645
	speed: 0.0210s/iter; left time: 166.4516s
	iters: 600, epoch: 3 | loss: 0.2148571
	speed: 0.0204s/iter; left time: 159.5658s
	iters: 700, epoch: 3 | loss: 0.2085916
	speed: 0.0208s/iter; left time: 161.2012s
	iters: 800, epoch: 3 | loss: 0.2294891
	speed: 0.0184s/iter; left time: 140.4483s
	iters: 900, epoch: 3 | loss: 0.2053393
	speed: 0.0182s/iter; left time: 136.7315s
	iters: 1000, epoch: 3 | loss: 0.2124140
	speed: 0.0177s/iter; left time: 131.9340s
Max Memory (MB): 16.080078125
Epoch: 3 cost time: 21.526341676712036
Epoch: 3, Steps: 1054 | Train Loss: 0.2147335 Vali Loss: 0.3959539 Test Loss: 0.3145840
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2387149
	speed: 0.7018s/iter; left time: 5108.0461s
	iters: 200, epoch: 4 | loss: 0.2225507
	speed: 0.0219s/iter; left time: 157.2832s
	iters: 300, epoch: 4 | loss: 0.2013499
	speed: 0.0212s/iter; left time: 150.1647s
	iters: 400, epoch: 4 | loss: 0.1933096
	speed: 0.0219s/iter; left time: 152.6787s
	iters: 500, epoch: 4 | loss: 0.2142203
	speed: 0.0243s/iter; left time: 167.2374s
	iters: 600, epoch: 4 | loss: 0.2198573
	speed: 0.0227s/iter; left time: 153.9753s
	iters: 700, epoch: 4 | loss: 0.2125966
	speed: 0.0226s/iter; left time: 150.8949s
	iters: 800, epoch: 4 | loss: 0.1882427
	speed: 0.0237s/iter; left time: 155.9390s
	iters: 900, epoch: 4 | loss: 0.2203059
	speed: 0.0233s/iter; left time: 150.6700s
	iters: 1000, epoch: 4 | loss: 0.1886426
	speed: 0.0242s/iter; left time: 154.1564s
Max Memory (MB): 16.080078125
Epoch: 4 cost time: 25.082956075668335
Epoch: 4, Steps: 1054 | Train Loss: 0.2060870 Vali Loss: 0.3911385 Test Loss: 0.3154456
Validation loss decreased (0.391337 --> 0.391138).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1886228
	speed: 0.7676s/iter; left time: 4778.5377s
	iters: 200, epoch: 5 | loss: 0.1975069
	speed: 0.0209s/iter; left time: 128.0269s
	iters: 300, epoch: 5 | loss: 0.2147596
	speed: 0.0247s/iter; left time: 148.9364s
	iters: 400, epoch: 5 | loss: 0.2117717
	speed: 0.0222s/iter; left time: 131.5666s
	iters: 500, epoch: 5 | loss: 0.2007590
	speed: 0.0219s/iter; left time: 127.4683s
	iters: 600, epoch: 5 | loss: 0.1880293
	speed: 0.0216s/iter; left time: 123.4694s
	iters: 700, epoch: 5 | loss: 0.1868701
	speed: 0.0271s/iter; left time: 152.3643s
	iters: 800, epoch: 5 | loss: 0.1724830
	speed: 0.0259s/iter; left time: 143.0939s
	iters: 900, epoch: 5 | loss: 0.2060519
	speed: 0.0238s/iter; left time: 129.3544s
	iters: 1000, epoch: 5 | loss: 0.2048827
	speed: 0.0226s/iter; left time: 120.3360s
Max Memory (MB): 16.080078125
Epoch: 5 cost time: 25.084712982177734
Epoch: 5, Steps: 1054 | Train Loss: 0.2024188 Vali Loss: 0.3928471 Test Loss: 0.3150914
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2483066
	speed: 0.7692s/iter; left time: 3977.3931s
	iters: 200, epoch: 6 | loss: 0.1894263
	speed: 0.0235s/iter; left time: 119.2547s
	iters: 300, epoch: 6 | loss: 0.2022973
	speed: 0.0257s/iter; left time: 127.9576s
	iters: 400, epoch: 6 | loss: 0.2209267
	speed: 0.0289s/iter; left time: 140.8411s
	iters: 500, epoch: 6 | loss: 0.1978527
	speed: 0.0236s/iter; left time: 112.6530s
	iters: 600, epoch: 6 | loss: 0.1709891
	speed: 0.0244s/iter; left time: 113.8338s
	iters: 700, epoch: 6 | loss: 0.1795869
	speed: 0.0260s/iter; left time: 118.7120s
	iters: 800, epoch: 6 | loss: 0.2209530
	speed: 0.0248s/iter; left time: 110.8057s
	iters: 900, epoch: 6 | loss: 0.2004847
	speed: 0.0241s/iter; left time: 105.4736s
	iters: 1000, epoch: 6 | loss: 0.2083172
	speed: 0.0231s/iter; left time: 98.4924s
Max Memory (MB): 16.080078125
Epoch: 6 cost time: 26.71446704864502
Epoch: 6, Steps: 1054 | Train Loss: 0.2003115 Vali Loss: 0.3963577 Test Loss: 0.3146189
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2167657
	speed: 0.7986s/iter; left time: 3287.6456s
	iters: 200, epoch: 7 | loss: 0.2190547
	speed: 0.0248s/iter; left time: 99.7480s
	iters: 300, epoch: 7 | loss: 0.2182304
	speed: 0.0239s/iter; left time: 93.5162s
	iters: 400, epoch: 7 | loss: 0.1973168
	speed: 0.0235s/iter; left time: 89.7644s
	iters: 500, epoch: 7 | loss: 0.1614185
	speed: 0.0221s/iter; left time: 82.2257s
	iters: 600, epoch: 7 | loss: 0.1859986
	speed: 0.0215s/iter; left time: 77.6342s
	iters: 700, epoch: 7 | loss: 0.1886077
	speed: 0.0226s/iter; left time: 79.3971s
	iters: 800, epoch: 7 | loss: 0.2003384
	speed: 0.0253s/iter; left time: 86.3325s
	iters: 900, epoch: 7 | loss: 0.1927047
	speed: 0.0236s/iter; left time: 78.3304s
	iters: 1000, epoch: 7 | loss: 0.1845868
	speed: 0.0240s/iter; left time: 77.0712s
Max Memory (MB): 16.080078125
Epoch: 7 cost time: 25.71188712120056
Epoch: 7, Steps: 1054 | Train Loss: 0.1997928 Vali Loss: 0.3964463 Test Loss: 0.3144767
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm1_720_96_iTransformer_ETTm1_M_ft720_sl48_ll96_pl128_dm8_nh2_el1_dl128_df1_fctimeF_ebTrue_dtExp_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
test shape: (11425, 1, 96, 7) (11425, 1, 96, 7)
test shape: (11425, 96, 7) (11425, 96, 7)
mse:0.3154456913471222, mae:0.3689032196998596
