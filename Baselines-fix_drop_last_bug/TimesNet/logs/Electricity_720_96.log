True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ECL_720_96          Model:              TimesNet            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/          
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            720                 Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ECL_720_96_TimesNet_custom_ftM_sl720_ll48_pl96_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17597
val 2537
test 5165
	iters: 100, epoch: 1 | loss: 0.4490079
	speed: 0.3875s/iter; left time: 6355.5559s
	iters: 200, epoch: 1 | loss: 0.3372940
	speed: 0.3132s/iter; left time: 5104.8974s
	iters: 300, epoch: 1 | loss: 0.3221648
	speed: 0.3140s/iter; left time: 5087.1098s
	iters: 400, epoch: 1 | loss: 0.2850069
	speed: 0.3093s/iter; left time: 4980.1913s
	iters: 500, epoch: 1 | loss: 0.3011747
	speed: 0.3124s/iter; left time: 4997.9357s
Epoch: 1 cost time: 179.6395525932312
Epoch: 1, Steps: 550 | Train Loss: 0.3768602 Vali Loss: 0.2283750 Test Loss: 0.2713949
Validation loss decreased (inf --> 0.228375).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2661145
	speed: 1.0348s/iter; left time: 16402.9850s
	iters: 200, epoch: 2 | loss: 0.2510539
	speed: 0.3159s/iter; left time: 4976.3907s
	iters: 300, epoch: 2 | loss: 0.2297717
	speed: 0.3125s/iter; left time: 4890.1575s
	iters: 400, epoch: 2 | loss: 0.2362422
	speed: 0.3129s/iter; left time: 4865.3869s
	iters: 500, epoch: 2 | loss: 0.2155911
	speed: 0.3154s/iter; left time: 4872.9494s
Epoch: 2 cost time: 173.536465883255
Epoch: 2, Steps: 550 | Train Loss: 0.2422156 Vali Loss: 0.1825788 Test Loss: 0.2232958
Validation loss decreased (0.228375 --> 0.182579).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1742238
	speed: 1.0017s/iter; left time: 15326.3061s
	iters: 200, epoch: 3 | loss: 0.1778374
	speed: 0.3190s/iter; left time: 4849.7025s
	iters: 300, epoch: 3 | loss: 0.1945443
	speed: 0.3102s/iter; left time: 4684.4770s
	iters: 400, epoch: 3 | loss: 0.1875560
	speed: 0.3174s/iter; left time: 4761.9393s
	iters: 500, epoch: 3 | loss: 0.1613810
	speed: 0.3147s/iter; left time: 4688.6363s
Epoch: 3 cost time: 175.20595026016235
Epoch: 3, Steps: 550 | Train Loss: 0.1853094 Vali Loss: 0.1656281 Test Loss: 0.2071634
Validation loss decreased (0.182579 --> 0.165628).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1824427
	speed: 1.0124s/iter; left time: 14933.5201s
	iters: 200, epoch: 4 | loss: 0.1909616
	speed: 0.3174s/iter; left time: 4649.8013s
	iters: 300, epoch: 4 | loss: 0.1604866
	speed: 0.3163s/iter; left time: 4601.7590s
	iters: 400, epoch: 4 | loss: 0.1671908
	speed: 0.3120s/iter; left time: 4508.0266s
	iters: 500, epoch: 4 | loss: 0.1618773
	speed: 0.3172s/iter; left time: 4552.3290s
Epoch: 4 cost time: 175.45479345321655
Epoch: 4, Steps: 550 | Train Loss: 0.1698208 Vali Loss: 0.1614202 Test Loss: 0.2028442
Validation loss decreased (0.165628 --> 0.161420).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1513578
	speed: 0.9867s/iter; left time: 14011.8262s
	iters: 200, epoch: 5 | loss: 0.1692761
	speed: 0.3245s/iter; left time: 4575.2281s
	iters: 300, epoch: 5 | loss: 0.1939654
	speed: 0.3009s/iter; left time: 4213.3320s
	iters: 400, epoch: 5 | loss: 0.1579269
	speed: 0.3165s/iter; left time: 4399.5241s
	iters: 500, epoch: 5 | loss: 0.1752546
	speed: 0.3010s/iter; left time: 4153.4292s
Epoch: 5 cost time: 172.55676889419556
Epoch: 5, Steps: 550 | Train Loss: 0.1630303 Vali Loss: 0.1609135 Test Loss: 0.2021993
Validation loss decreased (0.161420 --> 0.160914).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1391391
	speed: 1.0220s/iter; left time: 13950.9084s
	iters: 200, epoch: 6 | loss: 0.1673539
	speed: 0.3140s/iter; left time: 4255.3672s
	iters: 300, epoch: 6 | loss: 0.1519766
	speed: 0.3001s/iter; left time: 4036.0346s
	iters: 400, epoch: 6 | loss: 0.1482618
	speed: 0.2888s/iter; left time: 3855.3760s
	iters: 500, epoch: 6 | loss: 0.1567072
	speed: 0.2951s/iter; left time: 3909.8688s
Epoch: 6 cost time: 170.35005807876587
Epoch: 6, Steps: 550 | Train Loss: 0.1596272 Vali Loss: 0.1607874 Test Loss: 0.2022795
Validation loss decreased (0.160914 --> 0.160787).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1609510
	speed: 1.0125s/iter; left time: 13264.6559s
	iters: 200, epoch: 7 | loss: 0.1774474
	speed: 0.3144s/iter; left time: 4087.7602s
	iters: 300, epoch: 7 | loss: 0.1561940
	speed: 0.3141s/iter; left time: 4052.0328s
	iters: 400, epoch: 7 | loss: 0.1563903
	speed: 0.3105s/iter; left time: 3974.3031s
	iters: 500, epoch: 7 | loss: 0.1508584
	speed: 0.3140s/iter; left time: 3987.8218s
Epoch: 7 cost time: 173.48121404647827
Epoch: 7, Steps: 550 | Train Loss: 0.1579089 Vali Loss: 0.1605469 Test Loss: 0.2019245
Validation loss decreased (0.160787 --> 0.160547).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1516155
	speed: 0.9908s/iter; left time: 12435.5034s
	iters: 200, epoch: 8 | loss: 0.1640454
	speed: 0.3182s/iter; left time: 3961.7898s
	iters: 300, epoch: 8 | loss: 0.1448934
	speed: 0.3131s/iter; left time: 3867.1044s
	iters: 400, epoch: 8 | loss: 0.1594380
	speed: 0.3175s/iter; left time: 3889.1317s
	iters: 500, epoch: 8 | loss: 0.1697972
	speed: 0.3142s/iter; left time: 3817.5446s
Epoch: 8 cost time: 174.88224625587463
Epoch: 8, Steps: 550 | Train Loss: 0.1570108 Vali Loss: 0.1600968 Test Loss: 0.2019911
Validation loss decreased (0.160547 --> 0.160097).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1523883
	speed: 1.0222s/iter; left time: 12267.9356s
	iters: 200, epoch: 9 | loss: 0.1715519
	speed: 0.3133s/iter; left time: 3728.3742s
	iters: 300, epoch: 9 | loss: 0.1601825
	speed: 0.3174s/iter; left time: 3745.9522s
	iters: 400, epoch: 9 | loss: 0.1597788
	speed: 0.3189s/iter; left time: 3731.6375s
	iters: 500, epoch: 9 | loss: 0.1578477
	speed: 0.3034s/iter; left time: 3519.6781s
Epoch: 9 cost time: 173.8004925251007
Epoch: 9, Steps: 550 | Train Loss: 0.1565363 Vali Loss: 0.1603833 Test Loss: 0.2018416
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1596011
	speed: 1.0247s/iter; left time: 11734.1212s
	iters: 200, epoch: 10 | loss: 0.1491961
	speed: 0.3139s/iter; left time: 3563.0786s
	iters: 300, epoch: 10 | loss: 0.1466725
	speed: 0.3088s/iter; left time: 3474.7530s
	iters: 400, epoch: 10 | loss: 0.1655318
	speed: 0.3102s/iter; left time: 3458.7779s
	iters: 500, epoch: 10 | loss: 0.1512215
	speed: 0.3109s/iter; left time: 3435.6346s
Epoch: 10 cost time: 173.7990128993988
Epoch: 10, Steps: 550 | Train Loss: 0.1562975 Vali Loss: 0.1604549 Test Loss: 0.2020593
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1577794
	speed: 0.9830s/iter; left time: 10715.7632s
	iters: 200, epoch: 11 | loss: 0.1599408
	speed: 0.3110s/iter; left time: 3359.4287s
	iters: 300, epoch: 11 | loss: 0.1456660
	speed: 0.3081s/iter; left time: 3296.9663s
	iters: 400, epoch: 11 | loss: 0.1519787
	speed: 0.3048s/iter; left time: 3231.6947s
	iters: 500, epoch: 11 | loss: 0.1588024
	speed: 0.3132s/iter; left time: 3288.9455s
Epoch: 11 cost time: 170.40303206443787
Epoch: 11, Steps: 550 | Train Loss: 0.1561705 Vali Loss: 0.1605264 Test Loss: 0.2019072
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ECL_720_96_TimesNet_custom_ftM_sl720_ll48_pl96_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
test shape: (5165, 96, 321) (5165, 96, 321)
test shape: (5165, 96, 321) (5165, 96, 321)
mse:0.20187585055828094, mae:0.30810821056365967, dtw:not calculated
