True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ECL_336_720         Model:              TimesNet            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/          
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            336                 Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ECL_336_720_TimesNet_custom_ftM_sl336_ll48_pl720_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17357
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.5080566
	speed: 0.8887s/iter; left time: 14389.1766s
	iters: 200, epoch: 1 | loss: 0.3666072
	speed: 1.0119s/iter; left time: 16282.7777s
	iters: 300, epoch: 1 | loss: 0.3233665
	speed: 0.9703s/iter; left time: 15516.7606s
	iters: 400, epoch: 1 | loss: 0.3177320
	speed: 1.0508s/iter; left time: 16698.4839s
	iters: 500, epoch: 1 | loss: 0.2680851
	speed: 0.9787s/iter; left time: 15454.1319s
Epoch: 1 cost time: 528.3538036346436
Epoch: 1, Steps: 543 | Train Loss: 0.4207109 Vali Loss: 0.2557999 Test Loss: 0.2955986
Validation loss decreased (inf --> 0.255800).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2628668
	speed: 2.7063s/iter; left time: 42348.2629s
	iters: 200, epoch: 2 | loss: 0.2474390
	speed: 0.9302s/iter; left time: 14462.3224s
	iters: 300, epoch: 2 | loss: 0.2549310
	speed: 1.1251s/iter; left time: 17380.8140s
	iters: 400, epoch: 2 | loss: 0.2508102
	speed: 1.1218s/iter; left time: 17217.7975s
	iters: 500, epoch: 2 | loss: 0.2579403
	speed: 1.1073s/iter; left time: 16884.0230s
Epoch: 2 cost time: 569.1798610687256
Epoch: 2, Steps: 543 | Train Loss: 0.2642202 Vali Loss: 0.2460805 Test Loss: 0.2804944
Validation loss decreased (0.255800 --> 0.246081).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2581492
	speed: 3.4919s/iter; left time: 52745.2426s
	iters: 200, epoch: 3 | loss: 0.2343233
	speed: 1.1072s/iter; left time: 16613.8114s
	iters: 300, epoch: 3 | loss: 0.2451847
	speed: 1.1243s/iter; left time: 16758.1411s
	iters: 400, epoch: 3 | loss: 0.2352577
	speed: 1.1774s/iter; left time: 17432.1458s
	iters: 500, epoch: 3 | loss: 0.2498823
	speed: 1.1901s/iter; left time: 17500.5300s
Epoch: 3 cost time: 630.1620628833771
Epoch: 3, Steps: 543 | Train Loss: 0.2434438 Vali Loss: 0.2376534 Test Loss: 0.2763145
Validation loss decreased (0.246081 --> 0.237653).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2220091
	speed: 3.7858s/iter; left time: 55128.2605s
	iters: 200, epoch: 4 | loss: 0.2215415
	speed: 1.3617s/iter; left time: 19693.2530s
	iters: 300, epoch: 4 | loss: 0.2065092
	speed: 1.3327s/iter; left time: 19140.1934s
	iters: 400, epoch: 4 | loss: 0.2078300
	speed: 1.3188s/iter; left time: 18809.1930s
	iters: 500, epoch: 4 | loss: 0.2050707
	speed: 1.3475s/iter; left time: 19083.1340s
Epoch: 4 cost time: 716.2594759464264
Epoch: 4, Steps: 543 | Train Loss: 0.2186634 Vali Loss: 0.2122431 Test Loss: 0.2453170
Validation loss decreased (0.237653 --> 0.212243).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1976394
	speed: 4.1492s/iter; left time: 58168.1792s
	iters: 200, epoch: 5 | loss: 0.1934096
	speed: 1.4024s/iter; left time: 19520.4510s
	iters: 300, epoch: 5 | loss: 0.1935391
	speed: 1.3881s/iter; left time: 19182.4792s
	iters: 400, epoch: 5 | loss: 0.1955062
	speed: 1.3591s/iter; left time: 18645.7222s
	iters: 500, epoch: 5 | loss: 0.1880358
	speed: 1.3436s/iter; left time: 18298.2372s
Epoch: 5 cost time: 746.6683731079102
Epoch: 5, Steps: 543 | Train Loss: 0.1989770 Vali Loss: 0.2075430 Test Loss: 0.2409221
Validation loss decreased (0.212243 --> 0.207543).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1939667
	speed: 4.2808s/iter; left time: 57688.4812s
	iters: 200, epoch: 6 | loss: 0.1845589
	speed: 1.3450s/iter; left time: 17990.7048s
	iters: 300, epoch: 6 | loss: 0.1849615
	speed: 1.3433s/iter; left time: 17833.5355s
	iters: 400, epoch: 6 | loss: 0.2044553
	speed: 1.3800s/iter; left time: 18182.9628s
	iters: 500, epoch: 6 | loss: 0.1933400
	speed: 1.3717s/iter; left time: 17936.0898s
Epoch: 6 cost time: 742.0602312088013
Epoch: 6, Steps: 543 | Train Loss: 0.1940308 Vali Loss: 0.2073806 Test Loss: 0.2399391
Validation loss decreased (0.207543 --> 0.207381).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1968975
	speed: 4.2954s/iter; left time: 55552.7275s
	iters: 200, epoch: 7 | loss: 0.1928936
	speed: 1.3694s/iter; left time: 17573.5385s
	iters: 300, epoch: 7 | loss: 0.1960419
	speed: 1.4206s/iter; left time: 18088.6688s
	iters: 400, epoch: 7 | loss: 0.1955595
	speed: 1.4194s/iter; left time: 17931.1023s
	iters: 500, epoch: 7 | loss: 0.1907247
	speed: 1.4303s/iter; left time: 17926.3625s
Epoch: 7 cost time: 763.0542883872986
Epoch: 7, Steps: 543 | Train Loss: 0.1918636 Vali Loss: 0.2062748 Test Loss: 0.2392933
Validation loss decreased (0.207381 --> 0.206275).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1893309
	speed: 4.2483s/iter; left time: 52636.6894s
	iters: 200, epoch: 8 | loss: 0.1897301
	speed: 1.4181s/iter; left time: 17428.3491s
	iters: 300, epoch: 8 | loss: 0.1971161
	speed: 1.4199s/iter; left time: 17308.0015s
	iters: 400, epoch: 8 | loss: 0.1889173
	speed: 1.2956s/iter; left time: 15663.5866s
	iters: 500, epoch: 8 | loss: 0.1955404
	speed: 1.2759s/iter; left time: 15297.9636s
Epoch: 8 cost time: 737.1812748908997
Epoch: 8, Steps: 543 | Train Loss: 0.1907618 Vali Loss: 0.2062707 Test Loss: 0.2390802
Validation loss decreased (0.206275 --> 0.206271).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1969947
	speed: 3.8988s/iter; left time: 46189.4470s
	iters: 200, epoch: 9 | loss: 0.1952198
	speed: 1.2673s/iter; left time: 14887.3617s
	iters: 300, epoch: 9 | loss: 0.1969232
	speed: 1.2521s/iter; left time: 14582.7158s
	iters: 400, epoch: 9 | loss: 0.2013616
	speed: 1.2177s/iter; left time: 14061.0123s
	iters: 500, epoch: 9 | loss: 0.1828185
	speed: 1.2353s/iter; left time: 14140.7461s
Epoch: 9 cost time: 676.2172706127167
Epoch: 9, Steps: 543 | Train Loss: 0.1901528 Vali Loss: 0.2059456 Test Loss: 0.2389012
Validation loss decreased (0.206271 --> 0.205946).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1867426
	speed: 3.8261s/iter; left time: 43249.8533s
	iters: 200, epoch: 10 | loss: 0.2021502
	speed: 1.2189s/iter; left time: 13656.9536s
	iters: 300, epoch: 10 | loss: 0.1964010
	speed: 1.2357s/iter; left time: 13721.3712s
	iters: 400, epoch: 10 | loss: 0.1769480
	speed: 1.2201s/iter; left time: 13426.1886s
	iters: 500, epoch: 10 | loss: 0.1807894
	speed: 1.1885s/iter; left time: 12959.1009s
Epoch: 10 cost time: 662.3946444988251
Epoch: 10, Steps: 543 | Train Loss: 0.1898607 Vali Loss: 0.2070818 Test Loss: 0.2387326
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1935538
	speed: 3.7238s/iter; left time: 40072.1976s
	iters: 200, epoch: 11 | loss: 0.1985718
	speed: 1.2565s/iter; left time: 13395.6338s
	iters: 300, epoch: 11 | loss: 0.1874436
	speed: 1.2407s/iter; left time: 13103.0277s
	iters: 400, epoch: 11 | loss: 0.1809253
	speed: 1.2291s/iter; left time: 12857.8132s
	iters: 500, epoch: 11 | loss: 0.1875233
	speed: 1.2452s/iter; left time: 12901.4878s
Epoch: 11 cost time: 671.6781921386719
Epoch: 11, Steps: 543 | Train Loss: 0.1897304 Vali Loss: 0.2063011 Test Loss: 0.2387942
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1935410
	speed: 3.8430s/iter; left time: 39268.0529s
	iters: 200, epoch: 12 | loss: 0.1795900
	speed: 1.2093s/iter; left time: 12235.7301s
	iters: 300, epoch: 12 | loss: 0.1836639
	speed: 1.2238s/iter; left time: 12260.0034s
	iters: 400, epoch: 12 | loss: 0.1832253
	speed: 1.1559s/iter; left time: 11463.9929s
	iters: 500, epoch: 12 | loss: 0.1983209
	speed: 1.2191s/iter; left time: 11969.0187s
Epoch: 12 cost time: 660.8955657482147
Epoch: 12, Steps: 543 | Train Loss: 0.1896183 Vali Loss: 0.2064442 Test Loss: 0.2387919
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ECL_336_720_TimesNet_custom_ftM_sl336_ll48_pl720_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
test shape: (4541, 720, 321) (4541, 720, 321)
test shape: (4541, 720, 321) (4541, 720, 321)
mse:0.23883406817913055, mae:0.33541956543922424, dtw:not calculated
