Args in experiment:
Namespace(is_training=1, train_only=False, model_id='DLinear_electricity_336_720', model='DLinear', data='custom', root_path='./dataset/', data_path='electricity.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=720, individual=False, embed_type=0, enc_in=321, dec_in=321, c_out=321, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DLinear_electricity_336_720_DLinear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17357
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.3831252
	speed: 0.1166s/iter; left time: 1887.4768s
	iters: 200, epoch: 1 | loss: 0.3228770
	speed: 0.0889s/iter; left time: 1431.2834s
	iters: 300, epoch: 1 | loss: 0.2720821
	speed: 0.0887s/iter; left time: 1418.3689s
	iters: 400, epoch: 1 | loss: 0.2900450
	speed: 0.0907s/iter; left time: 1441.4353s
	iters: 500, epoch: 1 | loss: 0.2848364
	speed: 0.0945s/iter; left time: 1491.6733s
Epoch: 1 cost time: 51.80602025985718
Epoch: 1, Steps: 543 | Train Loss: 0.3565248 Vali Loss: 0.2214052 Test Loss: 0.2551488
Validation loss decreased (inf --> 0.221405).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2447087
	speed: 0.5314s/iter; left time: 8315.1067s
	iters: 200, epoch: 2 | loss: 0.2387808
	speed: 0.0861s/iter; left time: 1338.2506s
	iters: 300, epoch: 2 | loss: 0.2805316
	speed: 0.0852s/iter; left time: 1316.0230s
	iters: 400, epoch: 2 | loss: 0.2538416
	speed: 0.0858s/iter; left time: 1316.9650s
	iters: 500, epoch: 2 | loss: 0.2320092
	speed: 0.0845s/iter; left time: 1288.7666s
Epoch: 2 cost time: 48.39597511291504
Epoch: 2, Steps: 543 | Train Loss: 0.2503338 Vali Loss: 0.1993390 Test Loss: 0.2318517
Validation loss decreased (0.221405 --> 0.199339).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2640996
	speed: 0.4881s/iter; left time: 7372.3659s
	iters: 200, epoch: 3 | loss: 0.2244604
	speed: 0.0811s/iter; left time: 1217.1558s
	iters: 300, epoch: 3 | loss: 0.2590844
	speed: 0.0804s/iter; left time: 1197.6402s
	iters: 400, epoch: 3 | loss: 0.2296425
	speed: 0.0869s/iter; left time: 1286.3026s
	iters: 500, epoch: 3 | loss: 0.2355659
	speed: 0.0882s/iter; left time: 1297.5077s
Epoch: 3 cost time: 47.97718262672424
Epoch: 3, Steps: 543 | Train Loss: 0.2373221 Vali Loss: 0.1934587 Test Loss: 0.2255387
Validation loss decreased (0.199339 --> 0.193459).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2368114
	speed: 0.6329s/iter; left time: 9216.5893s
	iters: 200, epoch: 4 | loss: 0.2309541
	speed: 0.0971s/iter; left time: 1404.8235s
	iters: 300, epoch: 4 | loss: 0.2250709
	speed: 0.0983s/iter; left time: 1411.9454s
	iters: 400, epoch: 4 | loss: 0.2350631
	speed: 0.0988s/iter; left time: 1408.7723s
	iters: 500, epoch: 4 | loss: 0.2305813
	speed: 0.1053s/iter; left time: 1490.6316s
Epoch: 4 cost time: 56.62869429588318
Epoch: 4, Steps: 543 | Train Loss: 0.2331536 Vali Loss: 0.1907604 Test Loss: 0.2226151
Validation loss decreased (0.193459 --> 0.190760).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2492031
	speed: 0.6209s/iter; left time: 8703.8305s
	iters: 200, epoch: 5 | loss: 0.2249383
	speed: 0.1008s/iter; left time: 1402.5429s
	iters: 300, epoch: 5 | loss: 0.2470226
	speed: 0.0981s/iter; left time: 1355.9963s
	iters: 400, epoch: 5 | loss: 0.2274090
	speed: 0.0962s/iter; left time: 1320.1826s
	iters: 500, epoch: 5 | loss: 0.2285269
	speed: 0.1020s/iter; left time: 1389.1817s
Epoch: 5 cost time: 56.20104360580444
Epoch: 5, Steps: 543 | Train Loss: 0.2313426 Vali Loss: 0.1894553 Test Loss: 0.2212901
Validation loss decreased (0.190760 --> 0.189455).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2012304
	speed: 0.5777s/iter; left time: 7785.7124s
	iters: 200, epoch: 6 | loss: 0.2265565
	speed: 0.0957s/iter; left time: 1280.2595s
	iters: 300, epoch: 6 | loss: 0.2385718
	speed: 0.0906s/iter; left time: 1203.0934s
	iters: 400, epoch: 6 | loss: 0.2335619
	speed: 0.0884s/iter; left time: 1164.8687s
	iters: 500, epoch: 6 | loss: 0.2156514
	speed: 0.0893s/iter; left time: 1167.7342s
Epoch: 6 cost time: 51.36725687980652
Epoch: 6, Steps: 543 | Train Loss: 0.2304140 Vali Loss: 0.1888261 Test Loss: 0.2203999
Validation loss decreased (0.189455 --> 0.188826).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2275896
	speed: 0.5370s/iter; left time: 6944.7365s
	iters: 200, epoch: 7 | loss: 0.2440373
	speed: 0.0829s/iter; left time: 1063.2708s
	iters: 300, epoch: 7 | loss: 0.2543510
	speed: 0.0800s/iter; left time: 1019.0316s
	iters: 400, epoch: 7 | loss: 0.2213733
	speed: 0.0794s/iter; left time: 1002.8544s
	iters: 500, epoch: 7 | loss: 0.2503847
	speed: 0.0851s/iter; left time: 1066.6782s
Epoch: 7 cost time: 46.47620868682861
Epoch: 7, Steps: 543 | Train Loss: 0.2299678 Vali Loss: 0.1885436 Test Loss: 0.2202103
Validation loss decreased (0.188826 --> 0.188544).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2347685
	speed: 0.5753s/iter; left time: 7128.0012s
	iters: 200, epoch: 8 | loss: 0.2562969
	speed: 0.0948s/iter; left time: 1165.6704s
	iters: 300, epoch: 8 | loss: 0.2487486
	speed: 0.0945s/iter; left time: 1152.5469s
	iters: 400, epoch: 8 | loss: 0.2629751
	speed: 0.0949s/iter; left time: 1147.2207s
	iters: 500, epoch: 8 | loss: 0.2165521
	speed: 0.0956s/iter; left time: 1145.7822s
Epoch: 8 cost time: 54.94970417022705
Epoch: 8, Steps: 543 | Train Loss: 0.2296979 Vali Loss: 0.1883206 Test Loss: 0.2199429
Validation loss decreased (0.188544 --> 0.188321).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2386594
	speed: 0.7012s/iter; left time: 8307.2842s
	iters: 200, epoch: 9 | loss: 0.2284575
	speed: 0.1120s/iter; left time: 1315.2119s
	iters: 300, epoch: 9 | loss: 0.2178023
	speed: 0.1096s/iter; left time: 1275.9450s
	iters: 400, epoch: 9 | loss: 0.2278897
	speed: 0.1091s/iter; left time: 1259.7649s
	iters: 500, epoch: 9 | loss: 0.2409780
	speed: 0.1036s/iter; left time: 1185.9402s
Epoch: 9 cost time: 61.19649624824524
Epoch: 9, Steps: 543 | Train Loss: 0.2295910 Vali Loss: 0.1882744 Test Loss: 0.2199168
Validation loss decreased (0.188321 --> 0.188274).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2269346
	speed: 0.5641s/iter; left time: 6376.2006s
	iters: 200, epoch: 10 | loss: 0.2476184
	speed: 0.1052s/iter; left time: 1178.3982s
	iters: 300, epoch: 10 | loss: 0.2606978
	speed: 0.1022s/iter; left time: 1134.5760s
	iters: 400, epoch: 10 | loss: 0.2299974
	speed: 0.0903s/iter; left time: 994.0675s
	iters: 500, epoch: 10 | loss: 0.2234698
	speed: 0.0908s/iter; left time: 990.4567s
Epoch: 10 cost time: 54.542561292648315
Epoch: 10, Steps: 543 | Train Loss: 0.2294636 Vali Loss: 0.1882115 Test Loss: 0.2198668
Validation loss decreased (0.188274 --> 0.188212).  Saving model ...
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.2354294
	speed: 0.5588s/iter; left time: 6013.0115s
	iters: 200, epoch: 11 | loss: 0.2315590
	speed: 0.0998s/iter; left time: 1063.6702s
	iters: 300, epoch: 11 | loss: 0.2439831
	speed: 0.1033s/iter; left time: 1090.4566s
	iters: 400, epoch: 11 | loss: 0.2285718
	speed: 0.0986s/iter; left time: 1031.4827s
	iters: 500, epoch: 11 | loss: 0.2190530
	speed: 0.0953s/iter; left time: 987.5983s
Epoch: 11 cost time: 56.222676277160645
Epoch: 11, Steps: 543 | Train Loss: 0.2294746 Vali Loss: 0.1882076 Test Loss: 0.2198486
Validation loss decreased (0.188212 --> 0.188208).  Saving model ...
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.2261626
	speed: 0.5269s/iter; left time: 5383.5979s
	iters: 200, epoch: 12 | loss: 0.2240337
	speed: 0.0899s/iter; left time: 909.1732s
	iters: 300, epoch: 12 | loss: 0.2283554
	speed: 0.0925s/iter; left time: 926.2285s
	iters: 400, epoch: 12 | loss: 0.2435594
	speed: 0.0865s/iter; left time: 858.1359s
	iters: 500, epoch: 12 | loss: 0.2352908
	speed: 0.0906s/iter; left time: 889.7427s
Epoch: 12 cost time: 51.391326665878296
Epoch: 12, Steps: 543 | Train Loss: 0.2294815 Vali Loss: 0.1882206 Test Loss: 0.2198390
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.2606141
	speed: 0.6431s/iter; left time: 6222.4458s
	iters: 200, epoch: 13 | loss: 0.2026176
	speed: 0.1102s/iter; left time: 1054.7470s
	iters: 300, epoch: 13 | loss: 0.2451997
	speed: 0.1066s/iter; left time: 1010.2644s
	iters: 400, epoch: 13 | loss: 0.2228546
	speed: 0.0978s/iter; left time: 917.1554s
	iters: 500, epoch: 13 | loss: 0.2245436
	speed: 0.0957s/iter; left time: 887.6031s
Epoch: 13 cost time: 58.66047263145447
Epoch: 13, Steps: 543 | Train Loss: 0.2294824 Vali Loss: 0.1882112 Test Loss: 0.2198344
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.2351589
	speed: 0.5686s/iter; left time: 5192.5191s
	iters: 200, epoch: 14 | loss: 0.2352746
	speed: 0.0991s/iter; left time: 895.4421s
	iters: 300, epoch: 14 | loss: 0.1989087
	speed: 0.0957s/iter; left time: 854.3839s
	iters: 400, epoch: 14 | loss: 0.2262364
	speed: 0.0924s/iter; left time: 816.4940s
	iters: 500, epoch: 14 | loss: 0.2251420
	speed: 0.0857s/iter; left time: 747.9216s
Epoch: 14 cost time: 53.604796171188354
Epoch: 14, Steps: 543 | Train Loss: 0.2294520 Vali Loss: 0.1882206 Test Loss: 0.2198318
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : DLinear_electricity_336_720_DLinear_custom_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
mse:0.219757542014122, mae:0.320558100938797
