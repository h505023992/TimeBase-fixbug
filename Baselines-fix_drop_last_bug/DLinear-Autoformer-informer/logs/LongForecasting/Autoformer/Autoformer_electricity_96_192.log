Args in experiment:
Namespace(is_training=1, train_only=False, model_id='Autoformer_electricity_96_192', model='Autoformer', data='custom', root_path='./dataset/', data_path='electricity.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=192, individual=False, embed_type=0, enc_in=321, dec_in=321, c_out=321, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : Autoformer_electricity_96_192_Autoformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18125
val 2441
test 5069
	iters: 100, epoch: 1 | loss: 0.3683066
	speed: 0.1565s/iter; left time: 2647.1935s
	iters: 200, epoch: 1 | loss: 0.2932252
	speed: 0.1169s/iter; left time: 1964.6767s
	iters: 300, epoch: 1 | loss: 0.2641746
	speed: 0.1126s/iter; left time: 1881.1694s
	iters: 400, epoch: 1 | loss: 0.2404000
	speed: 0.1155s/iter; left time: 1918.8930s
	iters: 500, epoch: 1 | loss: 0.2164406
	speed: 0.1137s/iter; left time: 1876.6447s
Epoch: 1 cost time: 69.52555990219116
Epoch: 1, Steps: 567 | Train Loss: 0.2990795 Vali Loss: 0.2370169 Test Loss: 0.3258144
Validation loss decreased (inf --> 0.237017).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1867435
	speed: 0.5064s/iter; left time: 8275.9410s
	iters: 200, epoch: 2 | loss: 0.1893885
	speed: 0.1283s/iter; left time: 2084.0152s
	iters: 300, epoch: 2 | loss: 0.1857999
	speed: 0.1266s/iter; left time: 2043.6189s
	iters: 400, epoch: 2 | loss: 0.1739190
	speed: 0.1239s/iter; left time: 1988.4624s
	iters: 500, epoch: 2 | loss: 0.1772894
	speed: 0.1180s/iter; left time: 1880.9933s
Epoch: 2 cost time: 70.99816083908081
Epoch: 2, Steps: 567 | Train Loss: 0.1924049 Vali Loss: 0.2040213 Test Loss: 0.2532343
Validation loss decreased (0.237017 --> 0.204021).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1730766
	speed: 0.5737s/iter; left time: 9050.6698s
	iters: 200, epoch: 3 | loss: 0.1721193
	speed: 0.1249s/iter; left time: 1958.2917s
	iters: 300, epoch: 3 | loss: 0.1680943
	speed: 0.1239s/iter; left time: 1930.1592s
	iters: 400, epoch: 3 | loss: 0.1578735
	speed: 0.1225s/iter; left time: 1896.2222s
	iters: 500, epoch: 3 | loss: 0.1749679
	speed: 0.1212s/iter; left time: 1863.2417s
Epoch: 3 cost time: 70.98888278007507
Epoch: 3, Steps: 567 | Train Loss: 0.1659300 Vali Loss: 0.1943941 Test Loss: 0.2283373
Validation loss decreased (0.204021 --> 0.194394).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1633854
	speed: 0.4747s/iter; left time: 7219.4873s
	iters: 200, epoch: 4 | loss: 0.1632008
	speed: 0.1197s/iter; left time: 1807.9822s
	iters: 300, epoch: 4 | loss: 0.1521715
	speed: 0.1192s/iter; left time: 1789.2003s
	iters: 400, epoch: 4 | loss: 0.1595601
	speed: 0.1262s/iter; left time: 1881.5873s
	iters: 500, epoch: 4 | loss: 0.1540004
	speed: 0.1324s/iter; left time: 1961.1950s
Epoch: 4 cost time: 71.33356976509094
Epoch: 4, Steps: 567 | Train Loss: 0.1568326 Vali Loss: 0.1836054 Test Loss: 0.2247375
Validation loss decreased (0.194394 --> 0.183605).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1451641
	speed: 0.6087s/iter; left time: 8913.3107s
	iters: 200, epoch: 5 | loss: 0.1476317
	speed: 0.1176s/iter; left time: 1710.4316s
	iters: 300, epoch: 5 | loss: 0.1498036
	speed: 0.1152s/iter; left time: 1663.5003s
	iters: 400, epoch: 5 | loss: 0.1633192
	speed: 0.1179s/iter; left time: 1691.3474s
	iters: 500, epoch: 5 | loss: 0.1323975
	speed: 0.1247s/iter; left time: 1775.6710s
Epoch: 5 cost time: 69.34861612319946
Epoch: 5, Steps: 567 | Train Loss: 0.1525197 Vali Loss: 0.1872613 Test Loss: 0.2256876
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1490245
	speed: 0.5485s/iter; left time: 7720.4081s
	iters: 200, epoch: 6 | loss: 0.1548945
	speed: 0.1255s/iter; left time: 1754.3475s
	iters: 300, epoch: 6 | loss: 0.1518777
	speed: 0.1377s/iter; left time: 1910.2660s
	iters: 400, epoch: 6 | loss: 0.1435323
	speed: 0.1233s/iter; left time: 1698.8210s
	iters: 500, epoch: 6 | loss: 0.1449805
	speed: 0.1259s/iter; left time: 1722.1264s
Epoch: 6 cost time: 73.23745155334473
Epoch: 6, Steps: 567 | Train Loss: 0.1503770 Vali Loss: 0.1849956 Test Loss: 0.2241388
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1591317
	speed: 0.5505s/iter; left time: 7436.4315s
	iters: 200, epoch: 7 | loss: 0.1565987
	speed: 0.1286s/iter; left time: 1723.9464s
	iters: 300, epoch: 7 | loss: 0.1444101
	speed: 0.1234s/iter; left time: 1642.9802s
	iters: 400, epoch: 7 | loss: 0.1613157
	speed: 0.1253s/iter; left time: 1655.0964s
	iters: 500, epoch: 7 | loss: 0.1470604
	speed: 0.1223s/iter; left time: 1602.7484s
Epoch: 7 cost time: 71.71924114227295
Epoch: 7, Steps: 567 | Train Loss: 0.1491756 Vali Loss: 0.1857061 Test Loss: 0.2244710
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Autoformer_electricity_96_192_Autoformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5069
mse:0.2236442118883133, mae:0.3331366777420044
