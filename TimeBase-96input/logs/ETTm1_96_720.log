Args in experiment:
Namespace(is_training=1, model_id='ETTm1_96_720', model='LightTimeBaseTST', data='ETTm1', root_path='./dataset/', data_path='ETTm1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=720, period_len=4, basis_num=30, use_period_norm=0, use_orthogonal=1, orthogonal_weight=0.04, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=7, individual=1, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=512, patience=5, learning_rate=0.1, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=1, use_multi_gpu=0, devices='0,1', test_flop=False)
Use GPU: cuda:1
44310
>>>>>>>start training : ETTm1_96_720_LightTimeBaseTST_ETTm1_ftM_sl96_pl720_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 10801
test 10801
Epoch: 1 cost time: 3.127189874649048
Epoch: 1, Steps: 66 | Train Loss: 0.5793240 Vali Loss: 1.0865583 Test Loss: 0.5898749
Validation loss decreased (inf --> 1.086558).  Saving model ...
Updating learning rate to 0.1
Epoch: 2 cost time: 2.6059794425964355
Epoch: 2, Steps: 66 | Train Loss: 0.5580391 Vali Loss: 1.0262946 Test Loss: 0.5397438
Validation loss decreased (1.086558 --> 1.026295).  Saving model ...
Updating learning rate to 0.1
Epoch: 3 cost time: 2.567800998687744
Epoch: 3, Steps: 66 | Train Loss: 0.4970684 Vali Loss: 1.0339876 Test Loss: 0.5295410
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.1
Epoch: 4 cost time: 2.566983938217163
Epoch: 4, Steps: 66 | Train Loss: 0.4936067 Vali Loss: 1.0193518 Test Loss: 0.5207566
Validation loss decreased (1.026295 --> 1.019352).  Saving model ...
Updating learning rate to 0.08000000000000002
Epoch: 5 cost time: 2.651175022125244
Epoch: 5, Steps: 66 | Train Loss: 0.4897956 Vali Loss: 1.0080631 Test Loss: 0.5240172
Validation loss decreased (1.019352 --> 1.008063).  Saving model ...
Updating learning rate to 0.06400000000000002
Epoch: 6 cost time: 2.676901340484619
Epoch: 6, Steps: 66 | Train Loss: 0.4862797 Vali Loss: 1.0281205 Test Loss: 0.5164772
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.051200000000000016
Epoch: 7 cost time: 2.649564504623413
Epoch: 7, Steps: 66 | Train Loss: 0.4849622 Vali Loss: 1.0210754 Test Loss: 0.5069389
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.04096000000000001
Epoch: 8 cost time: 2.5780088901519775
Epoch: 8, Steps: 66 | Train Loss: 0.4824469 Vali Loss: 1.0119681 Test Loss: 0.5095496
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.03276800000000001
Epoch: 9 cost time: 2.637568712234497
Epoch: 9, Steps: 66 | Train Loss: 0.4813841 Vali Loss: 1.0034873 Test Loss: 0.5030368
Validation loss decreased (1.008063 --> 1.003487).  Saving model ...
Updating learning rate to 0.026214400000000013
Epoch: 10 cost time: 2.5844521522521973
Epoch: 10, Steps: 66 | Train Loss: 0.4801992 Vali Loss: 1.0037192 Test Loss: 0.5035491
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.020971520000000007
Epoch: 11 cost time: 2.6146135330200195
Epoch: 11, Steps: 66 | Train Loss: 0.4792902 Vali Loss: 1.0087583 Test Loss: 0.5057630
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.016777216000000008
Epoch: 12 cost time: 2.617713451385498
Epoch: 12, Steps: 66 | Train Loss: 0.4790991 Vali Loss: 0.9999917 Test Loss: 0.5084754
Validation loss decreased (1.003487 --> 0.999992).  Saving model ...
Updating learning rate to 0.013421772800000007
Epoch: 13 cost time: 2.582132339477539
Epoch: 13, Steps: 66 | Train Loss: 0.4783061 Vali Loss: 1.0014138 Test Loss: 0.4998612
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.010737418240000006
Epoch: 14 cost time: 2.563981533050537
Epoch: 14, Steps: 66 | Train Loss: 0.4775586 Vali Loss: 1.0022000 Test Loss: 0.4998527
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.008589934592000005
Epoch: 15 cost time: 2.6345789432525635
Epoch: 15, Steps: 66 | Train Loss: 0.4773488 Vali Loss: 0.9994270 Test Loss: 0.5013294
Validation loss decreased (0.999992 --> 0.999427).  Saving model ...
Updating learning rate to 0.0068719476736000045
Epoch: 16 cost time: 2.5653953552246094
Epoch: 16, Steps: 66 | Train Loss: 0.4766825 Vali Loss: 1.0015025 Test Loss: 0.4988883
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005497558138880004
Epoch: 17 cost time: 2.6148767471313477
Epoch: 17, Steps: 66 | Train Loss: 0.4763860 Vali Loss: 0.9960383 Test Loss: 0.5010149
Validation loss decreased (0.999427 --> 0.996038).  Saving model ...
Updating learning rate to 0.004398046511104004
Epoch: 18 cost time: 2.619932174682617
Epoch: 18, Steps: 66 | Train Loss: 0.4762352 Vali Loss: 1.0012550 Test Loss: 0.4988959
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0035184372088832034
Epoch: 19 cost time: 2.610399007797241
Epoch: 19, Steps: 66 | Train Loss: 0.4760570 Vali Loss: 1.0040905 Test Loss: 0.4997069
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.0028147497671065624
Epoch: 20 cost time: 2.588832139968872
Epoch: 20, Steps: 66 | Train Loss: 0.4758433 Vali Loss: 1.0007647 Test Loss: 0.4990970
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.0022517998136852503
Epoch: 21 cost time: 2.6142406463623047
Epoch: 21, Steps: 66 | Train Loss: 0.4756550 Vali Loss: 0.9993342 Test Loss: 0.4991999
EarlyStopping counter: 4 out of 5
Updating learning rate to 0.0018014398509482003
Epoch: 22 cost time: 2.6881263256073
Epoch: 22, Steps: 66 | Train Loss: 0.4755379 Vali Loss: 0.9955408 Test Loss: 0.4991302
Validation loss decreased (0.996038 --> 0.995541).  Saving model ...
Updating learning rate to 0.0014411518807585604
Epoch: 23 cost time: 2.595224142074585
Epoch: 23, Steps: 66 | Train Loss: 0.4754167 Vali Loss: 1.0020267 Test Loss: 0.4985332
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0011529215046068484
Epoch: 24 cost time: 2.656035900115967
Epoch: 24, Steps: 66 | Train Loss: 0.4753945 Vali Loss: 0.9946255 Test Loss: 0.4987925
Validation loss decreased (0.995541 --> 0.994626).  Saving model ...
Updating learning rate to 0.0009223372036854787
Epoch: 25 cost time: 2.5584328174591064
Epoch: 25, Steps: 66 | Train Loss: 0.4752646 Vali Loss: 0.9949294 Test Loss: 0.4984730
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.000737869762948383
Epoch: 26 cost time: 2.585360288619995
Epoch: 26, Steps: 66 | Train Loss: 0.4751669 Vali Loss: 0.9946789 Test Loss: 0.4986400
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.0005902958103587065
Epoch: 27 cost time: 2.580386161804199
Epoch: 27, Steps: 66 | Train Loss: 0.4751632 Vali Loss: 0.9935013 Test Loss: 0.4971440
Validation loss decreased (0.994626 --> 0.993501).  Saving model ...
Updating learning rate to 0.0004722366482869652
Epoch: 28 cost time: 2.646104097366333
Epoch: 28, Steps: 66 | Train Loss: 0.4751541 Vali Loss: 0.9998519 Test Loss: 0.4978356
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0003777893186295722
Epoch: 29 cost time: 2.7680773735046387
Epoch: 29, Steps: 66 | Train Loss: 0.4750788 Vali Loss: 0.9936969 Test Loss: 0.4985110
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.00030223145490365774
Epoch: 30 cost time: 2.685706377029419
Epoch: 30, Steps: 66 | Train Loss: 0.4750373 Vali Loss: 0.9980734 Test Loss: 0.4982159
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.0002417851639229262
>>>>>>>testing : ETTm1_96_720_LightTimeBaseTST_ETTm1_ftM_sl96_pl720_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
mse:0.4823340177536011, mae:0.44872260093688965, rse:0.6607614755630493
