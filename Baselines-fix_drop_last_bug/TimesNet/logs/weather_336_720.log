True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_336_720     Model:              TimesNet            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/          
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            336                 Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_weather_336_720_TimesNet_custom_ftM_sl336_ll48_pl720_dm32_nh8_el2_dl1_df32_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35832
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.9056528
	speed: 0.7592s/iter; left time: 25432.7103s
	iters: 200, epoch: 1 | loss: 0.5147397
	speed: 0.7599s/iter; left time: 25380.1812s
	iters: 300, epoch: 1 | loss: 0.6017920
	speed: 0.7535s/iter; left time: 25090.9421s
	iters: 400, epoch: 1 | loss: 0.6663810
	speed: 0.7867s/iter; left time: 26119.8331s
	iters: 500, epoch: 1 | loss: 0.8499400
	speed: 0.7636s/iter; left time: 25274.3105s
	iters: 600, epoch: 1 | loss: 0.6517914
	speed: 0.7613s/iter; left time: 25123.0217s
	iters: 700, epoch: 1 | loss: 0.6030101
	speed: 0.7947s/iter; left time: 26147.1389s
	iters: 800, epoch: 1 | loss: 0.4990808
	speed: 0.8085s/iter; left time: 26519.8018s
	iters: 900, epoch: 1 | loss: 0.5995464
	speed: 0.7930s/iter; left time: 25931.0556s
	iters: 1000, epoch: 1 | loss: 0.6479210
	speed: 0.7631s/iter; left time: 24877.4565s
	iters: 1100, epoch: 1 | loss: 0.4538208
	speed: 0.7423s/iter; left time: 24126.0309s
Epoch: 1 cost time: 864.0112748146057
Epoch: 1, Steps: 1120 | Train Loss: 0.5993792 Vali Loss: 0.6433529 Test Loss: 0.3415668
Validation loss decreased (inf --> 0.643353).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5990400
	speed: 2.9758s/iter; left time: 96360.7557s
	iters: 200, epoch: 2 | loss: 0.5086784
	speed: 0.7293s/iter; left time: 23543.0269s
	iters: 300, epoch: 2 | loss: 0.4296670
	speed: 0.7117s/iter; left time: 22902.5228s
	iters: 400, epoch: 2 | loss: 0.3805317
	speed: 0.7155s/iter; left time: 22953.4445s
	iters: 500, epoch: 2 | loss: 0.5104196
	speed: 0.7249s/iter; left time: 23181.9762s
	iters: 600, epoch: 2 | loss: 0.6744110
	speed: 0.7114s/iter; left time: 22678.7021s
	iters: 700, epoch: 2 | loss: 0.6462833
	speed: 0.7165s/iter; left time: 22771.4873s
	iters: 800, epoch: 2 | loss: 0.4205642
	speed: 0.7288s/iter; left time: 23089.3243s
	iters: 900, epoch: 2 | loss: 0.4249479
	speed: 0.7382s/iter; left time: 23313.4207s
	iters: 1000, epoch: 2 | loss: 0.4348237
	speed: 0.7364s/iter; left time: 23181.7794s
	iters: 1100, epoch: 2 | loss: 0.5414643
	speed: 0.6969s/iter; left time: 21870.6807s
Epoch: 2 cost time: 807.6983072757721
Epoch: 2, Steps: 1120 | Train Loss: 0.5159559 Vali Loss: 0.6636983 Test Loss: 0.3642482
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.6444438
	speed: 2.9184s/iter; left time: 91232.7915s
	iters: 200, epoch: 3 | loss: 0.7383661
	speed: 0.7333s/iter; left time: 22851.6720s
	iters: 300, epoch: 3 | loss: 0.6401762
	speed: 0.7399s/iter; left time: 22980.9055s
	iters: 400, epoch: 3 | loss: 0.4183190
	speed: 0.7359s/iter; left time: 22784.2016s
	iters: 500, epoch: 3 | loss: 0.4829881
	speed: 0.7227s/iter; left time: 22302.6959s
	iters: 600, epoch: 3 | loss: 0.3788408
	speed: 0.7003s/iter; left time: 21542.6582s
	iters: 700, epoch: 3 | loss: 0.4927410
	speed: 0.7010s/iter; left time: 21493.9942s
	iters: 800, epoch: 3 | loss: 0.3404993
	speed: 0.7203s/iter; left time: 22011.7856s
	iters: 900, epoch: 3 | loss: 0.4396112
	speed: 0.7199s/iter; left time: 21929.7314s
	iters: 1000, epoch: 3 | loss: 0.3913218
	speed: 0.7253s/iter; left time: 22022.2091s
	iters: 1100, epoch: 3 | loss: 0.3878440
	speed: 0.7401s/iter; left time: 22395.3267s
Epoch: 3 cost time: 814.5643541812897
Epoch: 3, Steps: 1120 | Train Loss: 0.4717163 Vali Loss: 0.6882871 Test Loss: 0.3688436
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5197501
	speed: 2.9271s/iter; left time: 88225.5366s
	iters: 200, epoch: 4 | loss: 0.3345238
	speed: 0.7234s/iter; left time: 21732.8074s
	iters: 300, epoch: 4 | loss: 0.6615233
	speed: 0.7288s/iter; left time: 21819.7524s
	iters: 400, epoch: 4 | loss: 0.3748797
	speed: 0.7338s/iter; left time: 21895.9261s
	iters: 500, epoch: 4 | loss: 0.5075874
	speed: 0.7306s/iter; left time: 21730.0121s
	iters: 600, epoch: 4 | loss: 0.3447430
	speed: 0.7277s/iter; left time: 21570.1177s
	iters: 700, epoch: 4 | loss: 0.3545313
	speed: 0.7368s/iter; left time: 21765.4179s
	iters: 800, epoch: 4 | loss: 0.4159763
	speed: 0.7315s/iter; left time: 21536.9058s
	iters: 900, epoch: 4 | loss: 0.4909398
	speed: 0.7154s/iter; left time: 20989.6629s
	iters: 1000, epoch: 4 | loss: 0.3627737
	speed: 0.6935s/iter; left time: 20277.4299s
	iters: 1100, epoch: 4 | loss: 0.3201905
	speed: 0.6936s/iter; left time: 20211.0902s
Epoch: 4 cost time: 807.4046256542206
Epoch: 4, Steps: 1120 | Train Loss: 0.4518249 Vali Loss: 0.7051032 Test Loss: 0.3793253
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_weather_336_720_TimesNet_custom_ftM_sl336_ll48_pl720_dm32_nh8_el2_dl1_df32_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
test shape: (9820, 720, 21) (9820, 720, 21)
test shape: (9820, 720, 21) (9820, 720, 21)
mse:0.3414098918437958, mae:0.3518194854259491, dtw:not calculated
