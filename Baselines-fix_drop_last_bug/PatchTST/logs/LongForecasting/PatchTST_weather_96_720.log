Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='96_720', model='PatchTST', data='custom', root_path='./dataset/', data_path='weather.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=720, fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=21, dec_in=7, c_out=7, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=32, patience=5, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=1, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:1
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.dropout.Dropout'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.container.Sequential'>.
[INFO] Register count_normalization() for <class 'torch.nn.modules.batchnorm.BatchNorm1d'>.
MACs: 123604992.0
Params: 1506256.0
123.60M MACs
>>>>>>>start training : 96_720_PatchTST_custom_ftM_sl96_ll48_pl720_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36072
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.8856780
	speed: 0.0988s/iter; left time: 3333.0769s
	iters: 200, epoch: 1 | loss: 1.0166134
	speed: 0.0822s/iter; left time: 2766.3178s
	iters: 300, epoch: 1 | loss: 0.7461657
	speed: 0.0773s/iter; left time: 2591.1000s
	iters: 400, epoch: 1 | loss: 0.8006653
	speed: 0.0780s/iter; left time: 2608.5467s
	iters: 500, epoch: 1 | loss: 0.8701542
	speed: 0.0784s/iter; left time: 2614.8343s
	iters: 600, epoch: 1 | loss: 0.7362100
	speed: 0.0769s/iter; left time: 2555.3216s
	iters: 700, epoch: 1 | loss: 0.9293740
	speed: 0.0808s/iter; left time: 2678.4785s
	iters: 800, epoch: 1 | loss: 0.7870516
	speed: 0.0856s/iter; left time: 2827.9365s
	iters: 900, epoch: 1 | loss: 0.9566063
	speed: 0.0750s/iter; left time: 2471.5633s
	iters: 1000, epoch: 1 | loss: 0.5997583
	speed: 0.0751s/iter; left time: 2466.7878s
	iters: 1100, epoch: 1 | loss: 0.5759554
	speed: 0.0869s/iter; left time: 2845.6375s
Epoch: 1 cost time: 91.9565839767456
Epoch: 1, Steps: 1128 | Train Loss: 0.9087279 Vali Loss: 0.8196978 Test Loss: 0.3814572
Validation loss decreased (inf --> 0.819698).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6659070
	speed: 0.6147s/iter; left time: 20045.6609s
	iters: 200, epoch: 2 | loss: 0.5487315
	speed: 0.0701s/iter; left time: 2277.8516s
	iters: 300, epoch: 2 | loss: 0.9558650
	speed: 0.0746s/iter; left time: 2419.4941s
	iters: 400, epoch: 2 | loss: 0.8053551
	speed: 0.0848s/iter; left time: 2741.0794s
	iters: 500, epoch: 2 | loss: 0.6751497
	speed: 0.0802s/iter; left time: 2582.6343s
	iters: 600, epoch: 2 | loss: 0.9956008
	speed: 0.0803s/iter; left time: 2578.6826s
	iters: 700, epoch: 2 | loss: 0.8512569
	speed: 0.0797s/iter; left time: 2552.2463s
	iters: 800, epoch: 2 | loss: 0.7629764
	speed: 0.0792s/iter; left time: 2528.9849s
	iters: 900, epoch: 2 | loss: 0.6090649
	speed: 0.0746s/iter; left time: 2372.8686s
	iters: 1000, epoch: 2 | loss: 0.7599914
	speed: 0.0797s/iter; left time: 2528.4174s
	iters: 1100, epoch: 2 | loss: 0.6380904
	speed: 0.0843s/iter; left time: 2663.6796s
Epoch: 2 cost time: 90.43442869186401
Epoch: 2, Steps: 1128 | Train Loss: 0.7317720 Vali Loss: 0.7440255 Test Loss: 0.3627150
Validation loss decreased (0.819698 --> 0.744025).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.5232341
	speed: 0.6197s/iter; left time: 19511.3783s
	iters: 200, epoch: 3 | loss: 0.7299196
	speed: 0.0777s/iter; left time: 2439.2026s
	iters: 300, epoch: 3 | loss: 0.6723828
	speed: 0.0829s/iter; left time: 2593.6065s
	iters: 400, epoch: 3 | loss: 0.7373897
	speed: 0.0831s/iter; left time: 2592.6016s
	iters: 500, epoch: 3 | loss: 0.6193430
	speed: 0.0758s/iter; left time: 2355.6278s
	iters: 600, epoch: 3 | loss: 0.6820092
	speed: 0.0744s/iter; left time: 2305.8426s
	iters: 700, epoch: 3 | loss: 0.8230605
	speed: 0.0888s/iter; left time: 2742.5840s
	iters: 800, epoch: 3 | loss: 0.5631588
	speed: 0.0812s/iter; left time: 2500.8143s
	iters: 900, epoch: 3 | loss: 0.7304448
	speed: 0.0810s/iter; left time: 2484.1045s
	iters: 1000, epoch: 3 | loss: 0.7001878
	speed: 0.0766s/iter; left time: 2343.2208s
	iters: 1100, epoch: 3 | loss: 0.6605170
	speed: 0.0766s/iter; left time: 2336.5866s
Epoch: 3 cost time: 91.23172783851624
Epoch: 3, Steps: 1128 | Train Loss: 0.7105033 Vali Loss: 0.7376742 Test Loss: 0.3595611
Validation loss decreased (0.744025 --> 0.737674).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.7673915
	speed: 0.6051s/iter; left time: 18367.7495s
	iters: 200, epoch: 4 | loss: 0.5880646
	speed: 0.0798s/iter; left time: 2414.5048s
	iters: 300, epoch: 4 | loss: 0.8746935
	speed: 0.0797s/iter; left time: 2404.9801s
	iters: 400, epoch: 4 | loss: 0.5668818
	speed: 0.0789s/iter; left time: 2372.7453s
	iters: 500, epoch: 4 | loss: 0.5627115
	speed: 0.0817s/iter; left time: 2447.4381s
	iters: 600, epoch: 4 | loss: 0.5764326
	speed: 0.0783s/iter; left time: 2339.2693s
	iters: 700, epoch: 4 | loss: 0.5545903
	speed: 0.0778s/iter; left time: 2315.5281s
	iters: 800, epoch: 4 | loss: 0.6072751
	speed: 0.0848s/iter; left time: 2514.6222s
	iters: 900, epoch: 4 | loss: 0.5892071
	speed: 0.0742s/iter; left time: 2192.1554s
	iters: 1000, epoch: 4 | loss: 0.6524585
	speed: 0.0852s/iter; left time: 2508.6201s
	iters: 1100, epoch: 4 | loss: 0.7370706
	speed: 0.0745s/iter; left time: 2187.9130s
Epoch: 4 cost time: 91.16147327423096
Epoch: 4, Steps: 1128 | Train Loss: 0.7008144 Vali Loss: 0.7339973 Test Loss: 0.3591381
Validation loss decreased (0.737674 --> 0.733997).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.6177125
	speed: 0.5967s/iter; left time: 17441.1439s
	iters: 200, epoch: 5 | loss: 0.7544837
	speed: 0.0768s/iter; left time: 2235.9112s
	iters: 300, epoch: 5 | loss: 0.7686926
	speed: 0.0767s/iter; left time: 2225.9906s
	iters: 400, epoch: 5 | loss: 0.5281833
	speed: 0.0701s/iter; left time: 2028.8971s
	iters: 500, epoch: 5 | loss: 0.5731219
	speed: 0.0827s/iter; left time: 2385.3102s
	iters: 600, epoch: 5 | loss: 0.5473088
	speed: 0.0844s/iter; left time: 2424.5857s
	iters: 700, epoch: 5 | loss: 0.9033070
	speed: 0.0783s/iter; left time: 2242.2726s
	iters: 800, epoch: 5 | loss: 0.7035828
	speed: 0.0809s/iter; left time: 2307.8932s
	iters: 900, epoch: 5 | loss: 0.7717043
	speed: 0.0811s/iter; left time: 2306.4578s
	iters: 1000, epoch: 5 | loss: 0.6169850
	speed: 0.0799s/iter; left time: 2263.4662s
	iters: 1100, epoch: 5 | loss: 0.6780055
	speed: 0.0759s/iter; left time: 2142.2552s
Epoch: 5 cost time: 90.59576988220215
Epoch: 5, Steps: 1128 | Train Loss: 0.6919474 Vali Loss: 0.7361932 Test Loss: 0.3585766
EarlyStopping counter: 1 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.7666632
	speed: 0.5991s/iter; left time: 16835.9287s
	iters: 200, epoch: 6 | loss: 0.6376771
	speed: 0.0769s/iter; left time: 2152.0136s
	iters: 300, epoch: 6 | loss: 0.5648841
	speed: 0.0836s/iter; left time: 2331.1869s
	iters: 400, epoch: 6 | loss: 0.5262390
	speed: 0.0740s/iter; left time: 2058.4943s
	iters: 500, epoch: 6 | loss: 0.7868347
	speed: 0.0771s/iter; left time: 2134.5190s
	iters: 600, epoch: 6 | loss: 0.8150232
	speed: 0.0785s/iter; left time: 2166.7277s
	iters: 700, epoch: 6 | loss: 0.6565662
	speed: 0.0785s/iter; left time: 2159.2200s
	iters: 800, epoch: 6 | loss: 0.7455960
	speed: 0.0764s/iter; left time: 2092.8271s
	iters: 900, epoch: 6 | loss: 0.5180905
	speed: 0.0873s/iter; left time: 2383.6398s
	iters: 1000, epoch: 6 | loss: 0.6734055
	speed: 0.0812s/iter; left time: 2209.4119s
	iters: 1100, epoch: 6 | loss: 0.8020666
	speed: 0.0770s/iter; left time: 2087.5607s
Epoch: 6 cost time: 90.36431860923767
Epoch: 6, Steps: 1128 | Train Loss: 0.6850043 Vali Loss: 0.7270271 Test Loss: 0.3551792
Validation loss decreased (0.733997 --> 0.727027).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.4914683
	speed: 0.6001s/iter; left time: 16186.9938s
	iters: 200, epoch: 7 | loss: 0.6790698
	speed: 0.0852s/iter; left time: 2288.9540s
	iters: 300, epoch: 7 | loss: 0.6291493
	speed: 0.0785s/iter; left time: 2102.3093s
	iters: 400, epoch: 7 | loss: 0.6167109
	speed: 0.0813s/iter; left time: 2167.3224s
	iters: 500, epoch: 7 | loss: 0.6827868
	speed: 0.0813s/iter; left time: 2159.1285s
	iters: 600, epoch: 7 | loss: 0.7590132
	speed: 0.0824s/iter; left time: 2181.8009s
	iters: 700, epoch: 7 | loss: 0.5835555
	speed: 0.0807s/iter; left time: 2127.5073s
	iters: 800, epoch: 7 | loss: 0.5472789
	speed: 0.0782s/iter; left time: 2055.4036s
	iters: 900, epoch: 7 | loss: 0.5976197
	speed: 0.0798s/iter; left time: 2089.6461s
	iters: 1000, epoch: 7 | loss: 0.6461635
	speed: 0.0870s/iter; left time: 2268.7778s
	iters: 1100, epoch: 7 | loss: 0.7951623
	speed: 0.0824s/iter; left time: 2141.2944s
Epoch: 7 cost time: 92.73265600204468
Epoch: 7, Steps: 1128 | Train Loss: 0.6787289 Vali Loss: 0.7276949 Test Loss: 0.3547068
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.6086688
	speed: 0.6501s/iter; left time: 16801.9720s
	iters: 200, epoch: 8 | loss: 0.7911527
	speed: 0.0763s/iter; left time: 1964.5506s
	iters: 300, epoch: 8 | loss: 0.8034970
	speed: 0.0714s/iter; left time: 1831.4779s
	iters: 400, epoch: 8 | loss: 0.5867375
	speed: 0.0675s/iter; left time: 1723.0787s
	iters: 500, epoch: 8 | loss: 0.7016664
	speed: 0.0787s/iter; left time: 2001.4227s
	iters: 600, epoch: 8 | loss: 0.6155261
	speed: 0.0748s/iter; left time: 1895.8910s
	iters: 700, epoch: 8 | loss: 0.5304585
	speed: 0.0761s/iter; left time: 1920.9165s
	iters: 800, epoch: 8 | loss: 0.8760748
	speed: 0.0834s/iter; left time: 2097.4310s
	iters: 900, epoch: 8 | loss: 0.7708769
	speed: 0.0800s/iter; left time: 2003.7942s
	iters: 1000, epoch: 8 | loss: 0.7437500
	speed: 0.0771s/iter; left time: 1922.6805s
	iters: 1100, epoch: 8 | loss: 0.5314946
	speed: 0.0786s/iter; left time: 1952.9956s
Epoch: 8 cost time: 87.57569432258606
Epoch: 8, Steps: 1128 | Train Loss: 0.6748908 Vali Loss: 0.7217318 Test Loss: 0.3543874
Validation loss decreased (0.727027 --> 0.721732).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.5966838
	speed: 0.6323s/iter; left time: 15627.3387s
	iters: 200, epoch: 9 | loss: 0.7334527
	speed: 0.0831s/iter; left time: 2045.0982s
	iters: 300, epoch: 9 | loss: 0.5828380
	speed: 0.0769s/iter; left time: 1884.5405s
	iters: 400, epoch: 9 | loss: 0.6912114
	speed: 0.0818s/iter; left time: 1996.5470s
	iters: 500, epoch: 9 | loss: 0.6173565
	speed: 0.0842s/iter; left time: 2048.2119s
	iters: 600, epoch: 9 | loss: 0.6099852
	speed: 0.0779s/iter; left time: 1885.4610s
	iters: 700, epoch: 9 | loss: 0.5416012
	speed: 0.0885s/iter; left time: 2133.6745s
	iters: 800, epoch: 9 | loss: 0.8844779
	speed: 0.0788s/iter; left time: 1892.2914s
	iters: 900, epoch: 9 | loss: 0.5567905
	speed: 0.0830s/iter; left time: 1985.8307s
	iters: 1000, epoch: 9 | loss: 0.7471981
	speed: 0.0799s/iter; left time: 1903.3844s
	iters: 1100, epoch: 9 | loss: 0.6570802
	speed: 0.0798s/iter; left time: 1893.5584s
Epoch: 9 cost time: 93.20329093933105
Epoch: 9, Steps: 1128 | Train Loss: 0.6715902 Vali Loss: 0.7222587 Test Loss: 0.3533173
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.5468433
	speed: 0.6226s/iter; left time: 14686.9135s
	iters: 200, epoch: 10 | loss: 0.8230589
	speed: 0.0806s/iter; left time: 1892.3951s
	iters: 300, epoch: 10 | loss: 0.5624468
	speed: 0.0816s/iter; left time: 1907.8854s
	iters: 400, epoch: 10 | loss: 0.6214633
	speed: 0.0791s/iter; left time: 1841.3438s
	iters: 500, epoch: 10 | loss: 0.6336412
	speed: 0.0756s/iter; left time: 1752.9603s
	iters: 600, epoch: 10 | loss: 0.6992471
	speed: 0.0817s/iter; left time: 1887.2431s
	iters: 700, epoch: 10 | loss: 0.6435907
	speed: 0.0849s/iter; left time: 1952.3605s
	iters: 800, epoch: 10 | loss: 0.5707203
	speed: 0.0755s/iter; left time: 1727.9637s
	iters: 900, epoch: 10 | loss: 0.5861004
	speed: 0.0825s/iter; left time: 1880.7229s
	iters: 1000, epoch: 10 | loss: 0.8841495
	speed: 0.0853s/iter; left time: 1934.9701s
	iters: 1100, epoch: 10 | loss: 0.7245324
	speed: 0.0816s/iter; left time: 1842.4012s
Epoch: 10 cost time: 92.63126039505005
Epoch: 10, Steps: 1128 | Train Loss: 0.6688801 Vali Loss: 0.7189206 Test Loss: 0.3535295
Validation loss decreased (0.721732 --> 0.718921).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.6603241
	speed: 0.6162s/iter; left time: 13839.9240s
	iters: 200, epoch: 11 | loss: 0.6730176
	speed: 0.0882s/iter; left time: 1972.0958s
	iters: 300, epoch: 11 | loss: 0.5389615
	speed: 0.0803s/iter; left time: 1786.7811s
	iters: 400, epoch: 11 | loss: 0.6584026
	speed: 0.0801s/iter; left time: 1776.0845s
	iters: 500, epoch: 11 | loss: 0.7699084
	speed: 0.0807s/iter; left time: 1780.9500s
	iters: 600, epoch: 11 | loss: 0.7884955
	speed: 0.0840s/iter; left time: 1844.1488s
	iters: 700, epoch: 11 | loss: 0.6341186
	speed: 0.0778s/iter; left time: 1700.4954s
	iters: 800, epoch: 11 | loss: 0.7676322
	speed: 0.0854s/iter; left time: 1858.2216s
	iters: 900, epoch: 11 | loss: 0.6028887
	speed: 0.0783s/iter; left time: 1695.0753s
	iters: 1000, epoch: 11 | loss: 0.8481964
	speed: 0.0837s/iter; left time: 1805.7022s
	iters: 1100, epoch: 11 | loss: 0.5318365
	speed: 0.0764s/iter; left time: 1639.2889s
Epoch: 11 cost time: 92.32582378387451
Epoch: 11, Steps: 1128 | Train Loss: 0.6677624 Vali Loss: 0.7185769 Test Loss: 0.3536132
Validation loss decreased (0.718921 --> 0.718577).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.5420033
	speed: 0.6154s/iter; left time: 13127.5853s
	iters: 200, epoch: 12 | loss: 0.7475201
	speed: 0.0832s/iter; left time: 1766.7004s
	iters: 300, epoch: 12 | loss: 0.6243525
	speed: 0.0788s/iter; left time: 1666.0117s
	iters: 400, epoch: 12 | loss: 0.5531626
	speed: 0.0796s/iter; left time: 1674.6128s
	iters: 500, epoch: 12 | loss: 0.5213196
	speed: 0.0877s/iter; left time: 1836.3532s
	iters: 600, epoch: 12 | loss: 0.5422631
	speed: 0.0825s/iter; left time: 1717.7836s
	iters: 700, epoch: 12 | loss: 0.6816704
	speed: 0.0812s/iter; left time: 1683.8645s
	iters: 800, epoch: 12 | loss: 0.6730471
	speed: 0.0792s/iter; left time: 1634.3597s
	iters: 900, epoch: 12 | loss: 0.5362928
	speed: 0.0806s/iter; left time: 1654.2190s
	iters: 1000, epoch: 12 | loss: 0.6188464
	speed: 0.0734s/iter; left time: 1500.0831s
	iters: 1100, epoch: 12 | loss: 0.5125639
	speed: 0.0826s/iter; left time: 1678.6014s
Epoch: 12 cost time: 92.47380781173706
Epoch: 12, Steps: 1128 | Train Loss: 0.6656142 Vali Loss: 0.7196665 Test Loss: 0.3529679
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.5287290
	speed: 0.6315s/iter; left time: 12758.6635s
	iters: 200, epoch: 13 | loss: 0.7280404
	speed: 0.0813s/iter; left time: 1634.5939s
	iters: 300, epoch: 13 | loss: 0.6373862
	speed: 0.0792s/iter; left time: 1583.6687s
	iters: 400, epoch: 13 | loss: 0.5588642
	speed: 0.0787s/iter; left time: 1566.5408s
	iters: 500, epoch: 13 | loss: 0.6663947
	speed: 0.0844s/iter; left time: 1672.3632s
	iters: 600, epoch: 13 | loss: 0.6493165
	speed: 0.0777s/iter; left time: 1530.9747s
	iters: 700, epoch: 13 | loss: 0.9432821
	speed: 0.0841s/iter; left time: 1648.5108s
	iters: 800, epoch: 13 | loss: 0.6480892
	speed: 0.0821s/iter; left time: 1601.0495s
	iters: 900, epoch: 13 | loss: 0.5695562
	speed: 0.0815s/iter; left time: 1580.5578s
	iters: 1000, epoch: 13 | loss: 0.6646710
	speed: 0.0822s/iter; left time: 1586.6773s
	iters: 1100, epoch: 13 | loss: 0.8043557
	speed: 0.0795s/iter; left time: 1527.5900s
Epoch: 13 cost time: 92.71726155281067
Epoch: 13, Steps: 1128 | Train Loss: 0.6640625 Vali Loss: 0.7215204 Test Loss: 0.3534159
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.6834943
	speed: 0.6178s/iter; left time: 11786.3427s
	iters: 200, epoch: 14 | loss: 0.4899540
	speed: 0.0778s/iter; left time: 1476.5798s
	iters: 300, epoch: 14 | loss: 0.4637717
	speed: 0.0758s/iter; left time: 1430.1155s
	iters: 400, epoch: 14 | loss: 0.6007031
	speed: 0.0735s/iter; left time: 1379.4072s
	iters: 500, epoch: 14 | loss: 0.7343963
	speed: 0.0765s/iter; left time: 1428.6393s
	iters: 600, epoch: 14 | loss: 0.5488251
	speed: 0.0733s/iter; left time: 1360.8917s
	iters: 700, epoch: 14 | loss: 0.5630376
	speed: 0.0662s/iter; left time: 1222.4379s
	iters: 800, epoch: 14 | loss: 1.0040163
	speed: 0.0638s/iter; left time: 1173.1488s
	iters: 900, epoch: 14 | loss: 0.7222086
	speed: 0.0615s/iter; left time: 1123.1315s
	iters: 1000, epoch: 14 | loss: 0.6882397
	speed: 0.0615s/iter; left time: 1117.0893s
	iters: 1100, epoch: 14 | loss: 0.5619736
	speed: 0.0580s/iter; left time: 1048.9422s
Epoch: 14 cost time: 79.81097221374512
Epoch: 14, Steps: 1128 | Train Loss: 0.6627550 Vali Loss: 0.7179764 Test Loss: 0.3521442
Validation loss decreased (0.718577 --> 0.717976).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.5771171
	speed: 0.4402s/iter; left time: 7900.9617s
	iters: 200, epoch: 15 | loss: 0.7845711
	speed: 0.0718s/iter; left time: 1280.7439s
	iters: 300, epoch: 15 | loss: 0.6279453
	speed: 0.0684s/iter; left time: 1214.4564s
	iters: 400, epoch: 15 | loss: 0.7369612
	speed: 0.0731s/iter; left time: 1290.3964s
	iters: 500, epoch: 15 | loss: 0.6016697
	speed: 0.0727s/iter; left time: 1275.9797s
	iters: 600, epoch: 15 | loss: 0.5426373
	speed: 0.0658s/iter; left time: 1147.9259s
	iters: 700, epoch: 15 | loss: 0.6911100
	speed: 0.0643s/iter; left time: 1115.8816s
	iters: 800, epoch: 15 | loss: 0.5905388
	speed: 0.0677s/iter; left time: 1167.6022s
	iters: 900, epoch: 15 | loss: 0.5772817
	speed: 0.0737s/iter; left time: 1264.2072s
	iters: 1000, epoch: 15 | loss: 0.5126032
	speed: 0.0672s/iter; left time: 1146.0771s
	iters: 1100, epoch: 15 | loss: 0.7852196
	speed: 0.0649s/iter; left time: 1100.6410s
Epoch: 15 cost time: 79.56968808174133
Epoch: 15, Steps: 1128 | Train Loss: 0.6622837 Vali Loss: 0.7152067 Test Loss: 0.3521733
Validation loss decreased (0.717976 --> 0.715207).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.5069356
	speed: 0.5016s/iter; left time: 8437.8734s
	iters: 200, epoch: 16 | loss: 0.6256555
	speed: 0.0673s/iter; left time: 1125.8702s
	iters: 300, epoch: 16 | loss: 0.6316093
	speed: 0.0643s/iter; left time: 1069.4282s
	iters: 400, epoch: 16 | loss: 0.6729854
	speed: 0.0737s/iter; left time: 1218.1162s
	iters: 500, epoch: 16 | loss: 0.6403319
	speed: 0.0647s/iter; left time: 1061.9551s
	iters: 600, epoch: 16 | loss: 0.7493648
	speed: 0.0696s/iter; left time: 1135.4282s
	iters: 700, epoch: 16 | loss: 0.7396066
	speed: 0.0760s/iter; left time: 1232.1616s
	iters: 800, epoch: 16 | loss: 0.7325835
	speed: 0.0688s/iter; left time: 1108.9102s
	iters: 900, epoch: 16 | loss: 0.6008472
	speed: 0.0692s/iter; left time: 1108.8282s
	iters: 1000, epoch: 16 | loss: 0.5522930
	speed: 0.0680s/iter; left time: 1083.2498s
	iters: 1100, epoch: 16 | loss: 0.6921885
	speed: 0.0690s/iter; left time: 1092.3686s
Epoch: 16 cost time: 78.78475522994995
Epoch: 16, Steps: 1128 | Train Loss: 0.6607805 Vali Loss: 0.7159891 Test Loss: 0.3521119
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.6838267
	speed: 0.4750s/iter; left time: 7454.2828s
	iters: 200, epoch: 17 | loss: 0.6714061
	speed: 0.0786s/iter; left time: 1225.2019s
	iters: 300, epoch: 17 | loss: 0.6729460
	speed: 0.0703s/iter; left time: 1089.2719s
	iters: 400, epoch: 17 | loss: 0.5473066
	speed: 0.0720s/iter; left time: 1107.7004s
	iters: 500, epoch: 17 | loss: 0.5695270
	speed: 0.0693s/iter; left time: 1059.9403s
	iters: 600, epoch: 17 | loss: 0.8870876
	speed: 0.0695s/iter; left time: 1055.6690s
	iters: 700, epoch: 17 | loss: 0.6050922
	speed: 0.0673s/iter; left time: 1015.4992s
	iters: 800, epoch: 17 | loss: 0.7827216
	speed: 0.0658s/iter; left time: 987.1407s
	iters: 900, epoch: 17 | loss: 0.8257149
	speed: 0.0687s/iter; left time: 1022.9152s
	iters: 1000, epoch: 17 | loss: 0.5845282
	speed: 0.0660s/iter; left time: 975.8181s
	iters: 1100, epoch: 17 | loss: 0.6475281
	speed: 0.0721s/iter; left time: 1059.5925s
Epoch: 17 cost time: 79.56628704071045
Epoch: 17, Steps: 1128 | Train Loss: 0.6600636 Vali Loss: 0.7159040 Test Loss: 0.3524596
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.6470758
	speed: 0.4784s/iter; left time: 6968.1868s
	iters: 200, epoch: 18 | loss: 0.8569623
	speed: 0.0700s/iter; left time: 1012.7719s
	iters: 300, epoch: 18 | loss: 0.5784764
	speed: 0.0640s/iter; left time: 919.5806s
	iters: 400, epoch: 18 | loss: 0.6554095
	speed: 0.0665s/iter; left time: 948.1239s
	iters: 500, epoch: 18 | loss: 0.6390031
	speed: 0.0672s/iter; left time: 952.2681s
	iters: 600, epoch: 18 | loss: 0.6364302
	speed: 0.0717s/iter; left time: 1008.6723s
	iters: 700, epoch: 18 | loss: 0.7970209
	speed: 0.0659s/iter; left time: 920.4738s
	iters: 800, epoch: 18 | loss: 0.7770901
	speed: 0.0661s/iter; left time: 916.6831s
	iters: 900, epoch: 18 | loss: 0.7796202
	speed: 0.0713s/iter; left time: 981.8690s
	iters: 1000, epoch: 18 | loss: 0.7361616
	speed: 0.0699s/iter; left time: 955.2290s
	iters: 1100, epoch: 18 | loss: 0.5899486
	speed: 0.0704s/iter; left time: 954.7344s
Epoch: 18 cost time: 78.44403004646301
Epoch: 18, Steps: 1128 | Train Loss: 0.6590351 Vali Loss: 0.7172526 Test Loss: 0.3527781
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.5685741
	speed: 0.4721s/iter; left time: 6344.1894s
	iters: 200, epoch: 19 | loss: 0.6026406
	speed: 0.0735s/iter; left time: 979.9058s
	iters: 300, epoch: 19 | loss: 0.8206402
	speed: 0.0634s/iter; left time: 839.1399s
	iters: 400, epoch: 19 | loss: 0.8256758
	speed: 0.0684s/iter; left time: 898.9728s
	iters: 500, epoch: 19 | loss: 0.5438952
	speed: 0.0717s/iter; left time: 934.6961s
	iters: 600, epoch: 19 | loss: 0.5592152
	speed: 0.0637s/iter; left time: 824.3219s
	iters: 700, epoch: 19 | loss: 0.5357201
	speed: 0.0656s/iter; left time: 841.7825s
	iters: 800, epoch: 19 | loss: 0.6473454
	speed: 0.0691s/iter; left time: 880.2983s
	iters: 900, epoch: 19 | loss: 0.8287249
	speed: 0.0682s/iter; left time: 862.0603s
	iters: 1000, epoch: 19 | loss: 0.6558915
	speed: 0.0643s/iter; left time: 806.1720s
	iters: 1100, epoch: 19 | loss: 0.7436205
	speed: 0.0610s/iter; left time: 758.5274s
Epoch: 19 cost time: 76.89716410636902
Epoch: 19, Steps: 1128 | Train Loss: 0.6588659 Vali Loss: 0.7139848 Test Loss: 0.3523149
Validation loss decreased (0.715207 --> 0.713985).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.8816386
	speed: 0.4879s/iter; left time: 6005.9617s
	iters: 200, epoch: 20 | loss: 0.6480684
	speed: 0.0682s/iter; left time: 833.1695s
	iters: 300, epoch: 20 | loss: 0.6184129
	speed: 0.0725s/iter; left time: 877.5005s
	iters: 400, epoch: 20 | loss: 0.8825889
	speed: 0.0703s/iter; left time: 843.9153s
	iters: 500, epoch: 20 | loss: 0.6976616
	speed: 0.0678s/iter; left time: 807.6645s
	iters: 600, epoch: 20 | loss: 0.6571438
	speed: 0.0631s/iter; left time: 744.8302s
	iters: 700, epoch: 20 | loss: 0.5828962
	speed: 0.0675s/iter; left time: 790.0851s
	iters: 800, epoch: 20 | loss: 0.6903836
	speed: 0.0621s/iter; left time: 720.8012s
	iters: 900, epoch: 20 | loss: 0.7408739
	speed: 0.0774s/iter; left time: 890.7317s
	iters: 1000, epoch: 20 | loss: 0.5896861
	speed: 0.0651s/iter; left time: 743.1874s
	iters: 1100, epoch: 20 | loss: 0.6087605
	speed: 0.0709s/iter; left time: 802.2835s
Epoch: 20 cost time: 78.9078733921051
Epoch: 20, Steps: 1128 | Train Loss: 0.6581934 Vali Loss: 0.7160877 Test Loss: 0.3525108
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.7594026
	speed: 0.4772s/iter; left time: 5335.1226s
	iters: 200, epoch: 21 | loss: 0.5580032
	speed: 0.0670s/iter; left time: 742.5556s
	iters: 300, epoch: 21 | loss: 0.5610982
	speed: 0.0675s/iter; left time: 741.6104s
	iters: 400, epoch: 21 | loss: 0.5095459
	speed: 0.0731s/iter; left time: 795.5068s
	iters: 500, epoch: 21 | loss: 0.5580201
	speed: 0.0688s/iter; left time: 741.2588s
	iters: 600, epoch: 21 | loss: 0.5709859
	speed: 0.0690s/iter; left time: 736.9607s
	iters: 700, epoch: 21 | loss: 0.7043551
	speed: 0.0740s/iter; left time: 782.8653s
	iters: 800, epoch: 21 | loss: 0.6291155
	speed: 0.0681s/iter; left time: 713.6825s
	iters: 900, epoch: 21 | loss: 0.5156842
	speed: 0.0698s/iter; left time: 724.7093s
	iters: 1000, epoch: 21 | loss: 0.5398290
	speed: 0.0664s/iter; left time: 682.5529s
	iters: 1100, epoch: 21 | loss: 0.6506554
	speed: 0.0716s/iter; left time: 728.8289s
Epoch: 21 cost time: 79.15024018287659
Epoch: 21, Steps: 1128 | Train Loss: 0.6573967 Vali Loss: 0.7144793 Test Loss: 0.3522345
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.5475277
	speed: 0.4488s/iter; left time: 4511.7403s
	iters: 200, epoch: 22 | loss: 0.6278535
	speed: 0.0741s/iter; left time: 737.6973s
	iters: 300, epoch: 22 | loss: 0.6699342
	speed: 0.0690s/iter; left time: 679.5989s
	iters: 400, epoch: 22 | loss: 0.6211818
	speed: 0.0668s/iter; left time: 651.6466s
	iters: 500, epoch: 22 | loss: 0.7006017
	speed: 0.0682s/iter; left time: 657.8584s
	iters: 600, epoch: 22 | loss: 0.6737781
	speed: 0.0683s/iter; left time: 652.6921s
	iters: 700, epoch: 22 | loss: 0.5720024
	speed: 0.0688s/iter; left time: 650.4652s
	iters: 800, epoch: 22 | loss: 0.8778408
	speed: 0.0631s/iter; left time: 590.1278s
	iters: 900, epoch: 22 | loss: 0.6149729
	speed: 0.0648s/iter; left time: 599.5696s
	iters: 1000, epoch: 22 | loss: 0.7876286
	speed: 0.0645s/iter; left time: 590.4624s
	iters: 1100, epoch: 22 | loss: 0.5004266
	speed: 0.0757s/iter; left time: 685.5352s
Epoch: 22 cost time: 77.50893211364746
Epoch: 22, Steps: 1128 | Train Loss: 0.6568327 Vali Loss: 0.7164617 Test Loss: 0.3523988
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.5089752
	speed: 0.4369s/iter; left time: 3899.2901s
	iters: 200, epoch: 23 | loss: 0.6477813
	speed: 0.0623s/iter; left time: 550.0413s
	iters: 300, epoch: 23 | loss: 0.8550647
	speed: 0.0598s/iter; left time: 521.8942s
	iters: 400, epoch: 23 | loss: 0.8111346
	speed: 0.0558s/iter; left time: 480.8868s
	iters: 500, epoch: 23 | loss: 0.5753508
	speed: 0.0618s/iter; left time: 526.9924s
	iters: 600, epoch: 23 | loss: 0.7148683
	speed: 0.0591s/iter; left time: 497.5621s
	iters: 700, epoch: 23 | loss: 0.7343136
	speed: 0.0707s/iter; left time: 588.2121s
	iters: 800, epoch: 23 | loss: 0.6611315
	speed: 0.0665s/iter; left time: 546.8102s
	iters: 900, epoch: 23 | loss: 0.7431651
	speed: 0.0641s/iter; left time: 521.0779s
	iters: 1000, epoch: 23 | loss: 0.7235809
	speed: 0.0751s/iter; left time: 602.5057s
	iters: 1100, epoch: 23 | loss: 0.8073962
	speed: 0.0671s/iter; left time: 531.7587s
Epoch: 23 cost time: 73.55673813819885
Epoch: 23, Steps: 1128 | Train Loss: 0.6565743 Vali Loss: 0.7159770 Test Loss: 0.3523420
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.8508344
	speed: 0.4665s/iter; left time: 3636.9311s
	iters: 200, epoch: 24 | loss: 0.6514881
	speed: 0.0734s/iter; left time: 565.0805s
	iters: 300, epoch: 24 | loss: 0.6586065
	speed: 0.0682s/iter; left time: 518.3030s
	iters: 400, epoch: 24 | loss: 0.6425596
	speed: 0.0623s/iter; left time: 466.7827s
	iters: 500, epoch: 24 | loss: 0.6899874
	speed: 0.0714s/iter; left time: 528.1235s
	iters: 600, epoch: 24 | loss: 0.5286309
	speed: 0.0719s/iter; left time: 524.9308s
	iters: 700, epoch: 24 | loss: 0.6280237
	speed: 0.0671s/iter; left time: 483.0239s
	iters: 800, epoch: 24 | loss: 0.5695829
	speed: 0.0667s/iter; left time: 473.1321s
	iters: 900, epoch: 24 | loss: 0.5953364
	speed: 0.0717s/iter; left time: 501.3402s
	iters: 1000, epoch: 24 | loss: 0.7515746
	speed: 0.0707s/iter; left time: 487.4034s
	iters: 1100, epoch: 24 | loss: 0.7431786
	speed: 0.0677s/iter; left time: 460.0767s
Epoch: 24 cost time: 78.66008710861206
Epoch: 24, Steps: 1128 | Train Loss: 0.6563170 Vali Loss: 0.7153331 Test Loss: 0.3527984
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : 96_720_PatchTST_custom_ftM_sl96_ll48_pl720_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
mse:0.3521958589553833, mae:0.34604716300964355, rse:0.7809516787528992
