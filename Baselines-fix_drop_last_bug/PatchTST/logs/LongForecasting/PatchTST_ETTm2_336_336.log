Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='ETTm2', data_path='ETTm2.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='TST', model='PatchTST', model_id='336_336', moving_avg=25, n_heads=16, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.4, pred_len=336, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : 336_336_PatchTST_ETTm2_ftM_sl336_ll48_pl336_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33889
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.3690686
	speed: 0.1575s/iter; left time: 4142.5310s
	iters: 200, epoch: 1 | loss: 0.7412500
	speed: 0.1426s/iter; left time: 3736.4251s
Epoch: 1 cost time: 39.121187925338745
Epoch: 1, Steps: 264 | Train Loss: 0.4878930 Vali Loss: 0.2250797 Test Loss: 0.3015636
Validation loss decreased (inf --> 0.225080).  Saving model ...
Updating learning rate to 4.147995994617984e-06
	iters: 100, epoch: 2 | loss: 0.3872087
	speed: 0.7236s/iter; left time: 18839.8628s
	iters: 200, epoch: 2 | loss: 0.4801840
	speed: 0.1369s/iter; left time: 3549.5223s
Epoch: 2 cost time: 36.396666049957275
Epoch: 2, Steps: 264 | Train Loss: 0.4356920 Vali Loss: 0.2131642 Test Loss: 0.2884052
Validation loss decreased (0.225080 --> 0.213164).  Saving model ...
Updating learning rate to 4.591071361204269e-06
	iters: 100, epoch: 3 | loss: 0.4819899
	speed: 0.7321s/iter; left time: 18867.2167s
	iters: 200, epoch: 3 | loss: 0.5030326
	speed: 0.1283s/iter; left time: 3294.8435s
Epoch: 3 cost time: 35.716758728027344
Epoch: 3, Steps: 264 | Train Loss: 0.4209959 Vali Loss: 0.2085442 Test Loss: 0.2814142
Validation loss decreased (0.213164 --> 0.208544).  Saving model ...
Updating learning rate to 5.3264938756102174e-06
	iters: 100, epoch: 4 | loss: 0.3760225
	speed: 0.7142s/iter; left time: 18217.9251s
	iters: 200, epoch: 4 | loss: 0.3904726
	speed: 0.1347s/iter; left time: 3422.9486s
Epoch: 4 cost time: 36.2260103225708
Epoch: 4, Steps: 264 | Train Loss: 0.4114624 Vali Loss: 0.2058765 Test Loss: 0.2781315
Validation loss decreased (0.208544 --> 0.205876).  Saving model ...
Updating learning rate to 6.349728555065631e-06
	iters: 100, epoch: 5 | loss: 0.3451199
	speed: 0.8044s/iter; left time: 20307.9186s
	iters: 200, epoch: 5 | loss: 0.4545794
	speed: 0.1427s/iter; left time: 3587.8892s
Epoch: 5 cost time: 38.729841232299805
Epoch: 5, Steps: 264 | Train Loss: 0.4058245 Vali Loss: 0.2034403 Test Loss: 0.2764584
Validation loss decreased (0.205876 --> 0.203440).  Saving model ...
Updating learning rate to 7.654465623149092e-06
	iters: 100, epoch: 6 | loss: 0.2608812
	speed: 0.7505s/iter; left time: 18749.2352s
	iters: 200, epoch: 6 | loss: 0.5398480
	speed: 0.1424s/iter; left time: 3543.8896s
Epoch: 6 cost time: 38.03817367553711
Epoch: 6, Steps: 264 | Train Loss: 0.4008879 Vali Loss: 0.2033464 Test Loss: 0.2756532
Validation loss decreased (0.203440 --> 0.203346).  Saving model ...
Updating learning rate to 9.232659419022894e-06
	iters: 100, epoch: 7 | loss: 0.3689847
	speed: 0.7051s/iter; left time: 17428.8614s
	iters: 200, epoch: 7 | loss: 0.3223412
	speed: 0.1161s/iter; left time: 2857.6153s
Epoch: 7 cost time: 31.82169461250305
Epoch: 7, Steps: 264 | Train Loss: 0.3976200 Vali Loss: 0.2014389 Test Loss: 0.2755317
Validation loss decreased (0.203346 --> 0.201439).  Saving model ...
Updating learning rate to 1.1074578010998666e-05
	iters: 100, epoch: 8 | loss: 0.3887022
	speed: 0.7603s/iter; left time: 18590.8028s
	iters: 200, epoch: 8 | loss: 0.6441293
	speed: 0.1149s/iter; left time: 2799.3351s
Epoch: 8 cost time: 32.284053564071655
Epoch: 8, Steps: 264 | Train Loss: 0.3941163 Vali Loss: 0.2020858 Test Loss: 0.2731978
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.3168863208492038e-05
	iters: 100, epoch: 9 | loss: 0.5785064
	speed: 0.6790s/iter; left time: 16424.8246s
	iters: 200, epoch: 9 | loss: 0.3895341
	speed: 0.1391s/iter; left time: 3351.0044s
Epoch: 9 cost time: 37.737650871276855
Epoch: 9, Steps: 264 | Train Loss: 0.3897766 Vali Loss: 0.2033853 Test Loss: 0.2736387
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.5502600602302323e-05
	iters: 100, epoch: 10 | loss: 0.4210562
	speed: 0.7313s/iter; left time: 17497.2410s
	iters: 200, epoch: 10 | loss: 0.3691307
	speed: 0.1351s/iter; left time: 3219.2940s
Epoch: 10 cost time: 36.72143840789795
Epoch: 10, Steps: 264 | Train Loss: 0.3836813 Vali Loss: 0.2060322 Test Loss: 0.2724756
EarlyStopping counter: 3 out of 20
Updating learning rate to 1.8061399201313948e-05
	iters: 100, epoch: 11 | loss: 0.3004273
	speed: 0.7228s/iter; left time: 17102.3295s
	iters: 200, epoch: 11 | loss: 0.3839169
	speed: 0.1299s/iter; left time: 3061.2038s
Epoch: 11 cost time: 36.1786949634552
Epoch: 11, Steps: 264 | Train Loss: 0.3749886 Vali Loss: 0.2065999 Test Loss: 0.2773778
EarlyStopping counter: 4 out of 20
Updating learning rate to 2.08294801745399e-05
	iters: 100, epoch: 12 | loss: 0.5423893
	speed: 0.6882s/iter; left time: 16102.5629s
	iters: 200, epoch: 12 | loss: 0.4092419
	speed: 0.1137s/iter; left time: 2648.4941s
Epoch: 12 cost time: 32.32179546356201
Epoch: 12, Steps: 264 | Train Loss: 0.3640185 Vali Loss: 0.2139787 Test Loss: 0.2783866
EarlyStopping counter: 5 out of 20
Updating learning rate to 2.378977415127951e-05
	iters: 100, epoch: 13 | loss: 0.3826432
	speed: 0.7178s/iter; left time: 16605.7564s
	iters: 200, epoch: 13 | loss: 0.3761687
	speed: 0.1204s/iter; left time: 2774.0115s
Epoch: 13 cost time: 33.532856941223145
Epoch: 13, Steps: 264 | Train Loss: 0.3513596 Vali Loss: 0.2135248 Test Loss: 0.2873306
EarlyStopping counter: 6 out of 20
Updating learning rate to 2.6924026479389104e-05
	iters: 100, epoch: 14 | loss: 0.3447720
	speed: 0.7176s/iter; left time: 16410.5858s
	iters: 200, epoch: 14 | loss: 0.3426319
	speed: 0.1352s/iter; left time: 3079.1177s
Epoch: 14 cost time: 37.43586325645447
Epoch: 14, Steps: 264 | Train Loss: 0.3380535 Vali Loss: 0.2146821 Test Loss: 0.2853078
EarlyStopping counter: 7 out of 20
Updating learning rate to 3.0212909792590238e-05
	iters: 100, epoch: 15 | loss: 0.2561477
	speed: 0.7352s/iter; left time: 16618.2113s
	iters: 200, epoch: 15 | loss: 0.3674741
	speed: 0.1357s/iter; left time: 3053.1805s
Epoch: 15 cost time: 37.55402064323425
Epoch: 15, Steps: 264 | Train Loss: 0.3276455 Vali Loss: 0.2188013 Test Loss: 0.2920870
EarlyStopping counter: 8 out of 20
Updating learning rate to 3.363614319266957e-05
	iters: 100, epoch: 16 | loss: 0.3224050
	speed: 0.7143s/iter; left time: 15959.0317s
	iters: 200, epoch: 16 | loss: 0.2955629
	speed: 0.1402s/iter; left time: 3117.0914s
Epoch: 16 cost time: 37.66655778884888
Epoch: 16, Steps: 264 | Train Loss: 0.3206797 Vali Loss: 0.2236471 Test Loss: 0.2864132
EarlyStopping counter: 9 out of 20
Updating learning rate to 3.7172617311633196e-05
	iters: 100, epoch: 17 | loss: 0.3880082
	speed: 0.7388s/iter; left time: 16311.0449s
	iters: 200, epoch: 17 | loss: 0.2621930
	speed: 0.1282s/iter; left time: 2818.1709s
Epoch: 17 cost time: 34.543015241622925
Epoch: 17, Steps: 264 | Train Loss: 0.3143418 Vali Loss: 0.2197820 Test Loss: 0.2934947
EarlyStopping counter: 10 out of 20
Updating learning rate to 4.0800524482619576e-05
	iters: 100, epoch: 18 | loss: 0.3416961
	speed: 0.6210s/iter; left time: 13546.3548s
	iters: 200, epoch: 18 | loss: 0.4073777
	speed: 0.1319s/iter; left time: 2863.8055s
Epoch: 18 cost time: 35.11447358131409
Epoch: 18, Steps: 264 | Train Loss: 0.3075144 Vali Loss: 0.2236055 Test Loss: 0.2966690
EarlyStopping counter: 11 out of 20
Updating learning rate to 4.449749321687241e-05
	iters: 100, epoch: 19 | loss: 0.2271027
	speed: 0.6902s/iter; left time: 14873.6254s
	iters: 200, epoch: 19 | loss: 0.3067199
	speed: 0.1330s/iter; left time: 2852.0966s
Epoch: 19 cost time: 36.3922963142395
Epoch: 19, Steps: 264 | Train Loss: 0.3039516 Vali Loss: 0.2268752 Test Loss: 0.2896830
EarlyStopping counter: 12 out of 20
Updating learning rate to 4.824072615752094e-05
	iters: 100, epoch: 20 | loss: 0.3352780
	speed: 0.6421s/iter; left time: 13666.9236s
	iters: 200, epoch: 20 | loss: 0.2344323
	speed: 0.1153s/iter; left time: 2441.9064s
Epoch: 20 cost time: 31.661362886428833
Epoch: 20, Steps: 264 | Train Loss: 0.2982164 Vali Loss: 0.2232759 Test Loss: 0.2968594
EarlyStopping counter: 13 out of 20
Updating learning rate to 5.200714065947608e-05
	iters: 100, epoch: 21 | loss: 0.3143308
	speed: 0.6342s/iter; left time: 13331.1134s
	iters: 200, epoch: 21 | loss: 0.2979002
	speed: 0.1329s/iter; left time: 2780.0750s
Epoch: 21 cost time: 35.78466033935547
Epoch: 21, Steps: 264 | Train Loss: 0.2944994 Vali Loss: 0.2249746 Test Loss: 0.2980738
EarlyStopping counter: 14 out of 20
Updating learning rate to 5.577351112855618e-05
	iters: 100, epoch: 22 | loss: 0.3950002
	speed: 0.6999s/iter; left time: 14527.2439s
	iters: 200, epoch: 22 | loss: 0.2778268
	speed: 0.1356s/iter; left time: 2800.9912s
Epoch: 22 cost time: 36.29633808135986
Epoch: 22, Steps: 264 | Train Loss: 0.2907960 Vali Loss: 0.2245418 Test Loss: 0.3040037
EarlyStopping counter: 15 out of 20
Updating learning rate to 5.951661224210828e-05
	iters: 100, epoch: 23 | loss: 0.2948284
	speed: 0.6775s/iter; left time: 13883.2428s
	iters: 200, epoch: 23 | loss: 0.2394509
	speed: 0.1265s/iter; left time: 2579.1470s
Epoch: 23 cost time: 34.881044149398804
Epoch: 23, Steps: 264 | Train Loss: 0.2872398 Vali Loss: 0.2237858 Test Loss: 0.2966931
EarlyStopping counter: 16 out of 20
Updating learning rate to 6.321336216795497e-05
	iters: 100, epoch: 24 | loss: 0.2524155
	speed: 0.6568s/iter; left time: 13285.7239s
	iters: 200, epoch: 24 | loss: 0.2406238
	speed: 0.1302s/iter; left time: 2619.8401s
Epoch: 24 cost time: 35.310190200805664
Epoch: 24, Steps: 264 | Train Loss: 0.2842418 Vali Loss: 0.2276788 Test Loss: 0.3010535
EarlyStopping counter: 17 out of 20
Updating learning rate to 6.684096489850761e-05
	iters: 100, epoch: 25 | loss: 0.2531937
	speed: 0.7133s/iter; left time: 14240.2985s
	iters: 200, epoch: 25 | loss: 0.2572323
	speed: 0.1342s/iter; left time: 2666.1651s
Epoch: 25 cost time: 36.888943910598755
Epoch: 25, Steps: 264 | Train Loss: 0.2807415 Vali Loss: 0.2241115 Test Loss: 0.3048299
EarlyStopping counter: 18 out of 20
Updating learning rate to 7.03770508223417e-05
	iters: 100, epoch: 26 | loss: 0.2925779
	speed: 0.7321s/iter; left time: 14422.9448s
	iters: 200, epoch: 26 | loss: 0.3596892
	speed: 0.1362s/iter; left time: 2670.1266s
Epoch: 26 cost time: 37.022398710250854
Epoch: 26, Steps: 264 | Train Loss: 0.2765949 Vali Loss: 0.2262983 Test Loss: 0.3071290
EarlyStopping counter: 19 out of 20
Updating learning rate to 7.379981466640088e-05
	iters: 100, epoch: 27 | loss: 0.2758033
	speed: 0.7473s/iter; left time: 14524.4559s
	iters: 200, epoch: 27 | loss: 0.2984758
	speed: 0.1400s/iter; left time: 2707.8234s
Epoch: 27 cost time: 37.837929248809814
Epoch: 27, Steps: 264 | Train Loss: 0.2738157 Vali Loss: 0.2230899 Test Loss: 0.3047136
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : 336_336_PatchTST_ETTm2_ftM_sl336_ll48_pl336_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.27689129114151, mae:0.3287873864173889, rse:0.4250257909297943
