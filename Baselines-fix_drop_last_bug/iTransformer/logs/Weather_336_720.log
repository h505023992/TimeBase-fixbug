Args in experiment:
Namespace(is_training=1, model_id='weather_336_720', model='iTransformer', data='custom', root_path='./dataset/', data_path='weather.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=720, enc_in=21, dec_in=21, c_out=21, d_model=128, n_heads=8, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=10, batch_size=64, patience=3, learning_rate=0.0001, des='Exp', loss='MSE', lradj='type1', use_amp=False, use_gpu=True, gpu=2, use_multi_gpu=False, devices='0,1,2,3', exp_name='MTSF', channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv', efficient_training=False, use_norm=True, partial_start_index=0)
Use GPU: cuda:2
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.dropout.Dropout'>.
[INFO] Register count_convNd() for <class 'torch.nn.modules.conv.Conv1d'>.
[INFO] Register count_normalization() for <class 'torch.nn.modules.normalization.LayerNorm'>.
MACs: 11708928.0
Params: 435024.0
11.71M MACs
>>>>>>>start training : weather_336_720_iTransformer_custom_M_ft336_sl48_ll720_pl128_dm8_nh3_el1_dl128_df1_fctimeF_ebTrue_dtExp_projection_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35832
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.7844238
	speed: 0.1011s/iter; left time: 555.2394s
	iters: 200, epoch: 1 | loss: 0.7396114
	speed: 0.0850s/iter; left time: 458.4267s
	iters: 300, epoch: 1 | loss: 0.6818188
	speed: 0.0839s/iter; left time: 443.8023s
	iters: 400, epoch: 1 | loss: 0.5500327
	speed: 0.0757s/iter; left time: 393.1766s
	iters: 500, epoch: 1 | loss: 0.6213985
	speed: 0.0712s/iter; left time: 362.7042s
Max Memory (MB): 192.3369140625
Epoch: 1 cost time: 46.25358963012695
Epoch: 1, Steps: 559 | Train Loss: 0.6989053 Vali Loss: 0.6955133 Test Loss: 0.3395342
Validation loss decreased (inf --> 0.695513).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6990790
	speed: 1.2990s/iter; left time: 6406.7340s
	iters: 200, epoch: 2 | loss: 0.5727537
	speed: 0.0796s/iter; left time: 384.6691s
	iters: 300, epoch: 2 | loss: 0.7282025
	speed: 0.0747s/iter; left time: 353.3918s
	iters: 400, epoch: 2 | loss: 0.7456686
	speed: 0.0715s/iter; left time: 331.3122s
	iters: 500, epoch: 2 | loss: 0.7370154
	speed: 0.0755s/iter; left time: 342.1425s
Max Memory (MB): 192.3369140625
Epoch: 2 cost time: 43.64363193511963
Epoch: 2, Steps: 559 | Train Loss: 0.6254562 Vali Loss: 0.6680686 Test Loss: 0.3281779
Validation loss decreased (0.695513 --> 0.668069).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.6683532
	speed: 1.4062s/iter; left time: 6149.2995s
	iters: 200, epoch: 3 | loss: 0.5106577
	speed: 0.0741s/iter; left time: 316.8374s
	iters: 300, epoch: 3 | loss: 0.6908592
	speed: 0.0738s/iter; left time: 308.0652s
	iters: 400, epoch: 3 | loss: 0.6941146
	speed: 0.0754s/iter; left time: 306.9748s
	iters: 500, epoch: 3 | loss: 0.5870462
	speed: 0.0723s/iter; left time: 287.2826s
Max Memory (MB): 192.3369140625
Epoch: 3 cost time: 43.277063608169556
Epoch: 3, Steps: 559 | Train Loss: 0.6113264 Vali Loss: 0.6586919 Test Loss: 0.3259605
Validation loss decreased (0.668069 --> 0.658692).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.9363908
	speed: 1.5303s/iter; left time: 5836.4208s
	iters: 200, epoch: 4 | loss: 0.5565102
	speed: 0.0914s/iter; left time: 339.3703s
	iters: 300, epoch: 4 | loss: 0.5019730
	speed: 0.0952s/iter; left time: 344.1561s
	iters: 400, epoch: 4 | loss: 0.5450870
	speed: 0.0914s/iter; left time: 321.0290s
	iters: 500, epoch: 4 | loss: 0.7128375
	speed: 0.0871s/iter; left time: 297.2191s
Max Memory (MB): 192.3369140625
Epoch: 4 cost time: 51.95720386505127
Epoch: 4, Steps: 559 | Train Loss: 0.6056045 Vali Loss: 0.6542660 Test Loss: 0.3235548
Validation loss decreased (0.658692 --> 0.654266).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.6414917
	speed: 1.3617s/iter; left time: 4432.3928s
	iters: 200, epoch: 5 | loss: 0.5826796
	speed: 0.0706s/iter; left time: 222.8369s
	iters: 300, epoch: 5 | loss: 0.4843949
	speed: 0.0699s/iter; left time: 213.3965s
	iters: 400, epoch: 5 | loss: 0.6831526
	speed: 0.0712s/iter; left time: 210.2786s
	iters: 500, epoch: 5 | loss: 0.8085510
	speed: 0.0711s/iter; left time: 202.9292s
Max Memory (MB): 192.3369140625
Epoch: 5 cost time: 40.731125593185425
Epoch: 5, Steps: 559 | Train Loss: 0.6029746 Vali Loss: 0.6523236 Test Loss: 0.3231672
Validation loss decreased (0.654266 --> 0.652324).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5518843
	speed: 1.3451s/iter; left time: 3626.2899s
	iters: 200, epoch: 6 | loss: 0.5838906
	speed: 0.0740s/iter; left time: 192.0396s
	iters: 300, epoch: 6 | loss: 0.6856032
	speed: 0.0741s/iter; left time: 184.9273s
	iters: 400, epoch: 6 | loss: 0.6801106
	speed: 0.0746s/iter; left time: 178.6433s
	iters: 500, epoch: 6 | loss: 0.6152301
	speed: 0.0678s/iter; left time: 155.6066s
Max Memory (MB): 192.3369140625
Epoch: 6 cost time: 42.38400173187256
Epoch: 6, Steps: 559 | Train Loss: 0.6015036 Vali Loss: 0.6514009 Test Loss: 0.3228881
Validation loss decreased (0.652324 --> 0.651401).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.7259749
	speed: 1.4285s/iter; left time: 3052.6835s
	iters: 200, epoch: 7 | loss: 0.5396555
	speed: 0.0821s/iter; left time: 167.1589s
	iters: 300, epoch: 7 | loss: 0.5149747
	speed: 0.0802s/iter; left time: 155.3495s
	iters: 400, epoch: 7 | loss: 0.5642263
	speed: 0.0797s/iter; left time: 146.4966s
	iters: 500, epoch: 7 | loss: 0.6665404
	speed: 0.0785s/iter; left time: 136.4343s
Max Memory (MB): 192.3369140625
Epoch: 7 cost time: 46.22056531906128
Epoch: 7, Steps: 559 | Train Loss: 0.6010906 Vali Loss: 0.6511447 Test Loss: 0.3228543
Validation loss decreased (0.651401 --> 0.651145).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.6916071
	speed: 1.4696s/iter; left time: 2319.0539s
	iters: 200, epoch: 8 | loss: 0.6909443
	speed: 0.0707s/iter; left time: 104.4435s
	iters: 300, epoch: 8 | loss: 0.5327371
	speed: 0.0693s/iter; left time: 95.4931s
	iters: 400, epoch: 8 | loss: 0.6186955
	speed: 0.0704s/iter; left time: 89.9764s
	iters: 500, epoch: 8 | loss: 0.5595192
	speed: 0.0699s/iter; left time: 82.3757s
Max Memory (MB): 192.3369140625
Epoch: 8 cost time: 41.87064838409424
Epoch: 8, Steps: 559 | Train Loss: 0.6003894 Vali Loss: 0.6509311 Test Loss: 0.3228561
Validation loss decreased (0.651145 --> 0.650931).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.6434427
	speed: 1.3405s/iter; left time: 1365.9697s
	iters: 200, epoch: 9 | loss: 0.7168176
	speed: 0.0817s/iter; left time: 75.0657s
	iters: 300, epoch: 9 | loss: 0.5682814
	speed: 0.0802s/iter; left time: 65.7084s
	iters: 400, epoch: 9 | loss: 0.5919884
	speed: 0.0701s/iter; left time: 50.4178s
	iters: 500, epoch: 9 | loss: 0.6247690
	speed: 0.0673s/iter; left time: 41.6396s
Max Memory (MB): 192.3369140625
Epoch: 9 cost time: 43.253873348236084
Epoch: 9, Steps: 559 | Train Loss: 0.6005648 Vali Loss: 0.6511312 Test Loss: 0.3228311
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.6295967
	speed: 1.3694s/iter; left time: 629.9445s
	iters: 200, epoch: 10 | loss: 0.6473341
	speed: 0.0903s/iter; left time: 32.5025s
	iters: 300, epoch: 10 | loss: 0.5665113
	speed: 0.0878s/iter; left time: 22.8248s
	iters: 400, epoch: 10 | loss: 0.6677420
	speed: 0.0896s/iter; left time: 14.3299s
	iters: 500, epoch: 10 | loss: 0.5912054
	speed: 0.0874s/iter; left time: 5.2446s
Max Memory (MB): 192.3369140625
Epoch: 10 cost time: 51.68807935714722
Epoch: 10, Steps: 559 | Train Loss: 0.6005851 Vali Loss: 0.6501926 Test Loss: 0.3228042
Validation loss decreased (0.650931 --> 0.650193).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : weather_336_720_iTransformer_custom_M_ft336_sl48_ll720_pl128_dm8_nh3_el1_dl128_df1_fctimeF_ebTrue_dtExp_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
test shape: (9820, 1, 720, 21) (9820, 1, 720, 21)
test shape: (9820, 720, 21) (9820, 720, 21)
mse:0.32280418276786804, mae:0.3358979821205139
