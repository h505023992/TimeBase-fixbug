Args in experiment:
Namespace(is_training=1, model_id='ETTm2_336_96', model='LightTimeBaseTST', data='ETTm2', root_path='./dataset/', data_path='ETTm2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, period_len=4, basis_num=32, use_period_norm=1, use_orthogonal=1, orthogonal_weight=0.04, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=7, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=512, patience=5, learning_rate=0.01, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use GPU: cuda:0
3512
>>>>>>>start training : ETTm2_336_96_LightTimeBaseTST_ETTm2_ftM_sl336_pl96_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11425
test 11425
Epoch: 1 cost time: 5.530735015869141
Epoch: 1, Steps: 67 | Train Loss: 0.3907708 Vali Loss: 0.2001638 Test Loss: 0.2617025
Validation loss decreased (inf --> 0.200164).  Saving model ...
Updating learning rate to 0.01
Epoch: 2 cost time: 4.8069539070129395
Epoch: 2, Steps: 67 | Train Loss: 0.2748580 Vali Loss: 0.1368168 Test Loss: 0.1857870
Validation loss decreased (0.200164 --> 0.136817).  Saving model ...
Updating learning rate to 0.01
Epoch: 3 cost time: 4.926246166229248
Epoch: 3, Steps: 67 | Train Loss: 0.2387444 Vali Loss: 0.1303211 Test Loss: 0.1771926
Validation loss decreased (0.136817 --> 0.130321).  Saving model ...
Updating learning rate to 0.01
Epoch: 4 cost time: 4.746567010879517
Epoch: 4, Steps: 67 | Train Loss: 0.2358581 Vali Loss: 0.1318006 Test Loss: 0.1823061
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.008
Epoch: 5 cost time: 4.753911972045898
Epoch: 5, Steps: 67 | Train Loss: 0.2345056 Vali Loss: 0.1281929 Test Loss: 0.1784948
Validation loss decreased (0.130321 --> 0.128193).  Saving model ...
Updating learning rate to 0.006400000000000001
Epoch: 6 cost time: 4.699951887130737
Epoch: 6, Steps: 67 | Train Loss: 0.2301857 Vali Loss: 0.1274998 Test Loss: 0.1744886
Validation loss decreased (0.128193 --> 0.127500).  Saving model ...
Updating learning rate to 0.005120000000000001
Epoch: 7 cost time: 4.781178712844849
Epoch: 7, Steps: 67 | Train Loss: 0.2280858 Vali Loss: 0.1286499 Test Loss: 0.1732601
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.004096000000000001
Epoch: 8 cost time: 4.8460729122161865
Epoch: 8, Steps: 67 | Train Loss: 0.2274412 Vali Loss: 0.1252625 Test Loss: 0.1701187
Validation loss decreased (0.127500 --> 0.125262).  Saving model ...
Updating learning rate to 0.0032768000000000007
Epoch: 9 cost time: 4.930465459823608
Epoch: 9, Steps: 67 | Train Loss: 0.2304203 Vali Loss: 0.1246077 Test Loss: 0.1710381
Validation loss decreased (0.125262 --> 0.124608).  Saving model ...
Updating learning rate to 0.002621440000000001
Epoch: 10 cost time: 4.9637770652771
Epoch: 10, Steps: 67 | Train Loss: 0.2270677 Vali Loss: 0.1283331 Test Loss: 0.1735436
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.002097152000000001
Epoch: 11 cost time: 4.707022666931152
Epoch: 11, Steps: 67 | Train Loss: 0.2259256 Vali Loss: 0.1253777 Test Loss: 0.1693053
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.001677721600000001
Epoch: 12 cost time: 4.712641000747681
Epoch: 12, Steps: 67 | Train Loss: 0.2234238 Vali Loss: 0.1228386 Test Loss: 0.1690815
Validation loss decreased (0.124608 --> 0.122839).  Saving model ...
Updating learning rate to 0.0013421772800000006
Epoch: 13 cost time: 4.816749095916748
Epoch: 13, Steps: 67 | Train Loss: 0.2233378 Vali Loss: 0.1244363 Test Loss: 0.1697854
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0010737418240000006
Epoch: 14 cost time: 4.576617240905762
Epoch: 14, Steps: 67 | Train Loss: 0.2229144 Vali Loss: 0.1232217 Test Loss: 0.1686759
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.0008589934592000006
Epoch: 15 cost time: 4.535464525222778
Epoch: 15, Steps: 67 | Train Loss: 0.2232141 Vali Loss: 0.1234956 Test Loss: 0.1701206
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.0006871947673600004
Epoch: 16 cost time: 4.505696773529053
Epoch: 16, Steps: 67 | Train Loss: 0.2223914 Vali Loss: 0.1220943 Test Loss: 0.1673571
Validation loss decreased (0.122839 --> 0.122094).  Saving model ...
Updating learning rate to 0.0005497558138880004
Epoch: 17 cost time: 4.459182262420654
Epoch: 17, Steps: 67 | Train Loss: 0.2215811 Vali Loss: 0.1221421 Test Loss: 0.1683716
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00043980465111040037
Epoch: 18 cost time: 4.49589991569519
Epoch: 18, Steps: 67 | Train Loss: 0.2213710 Vali Loss: 0.1222934 Test Loss: 0.1683392
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.0003518437208883203
Epoch: 19 cost time: 4.407637119293213
Epoch: 19, Steps: 67 | Train Loss: 0.2213163 Vali Loss: 0.1233898 Test Loss: 0.1683487
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.00028147497671065624
Epoch: 20 cost time: 4.458683967590332
Epoch: 20, Steps: 67 | Train Loss: 0.2211872 Vali Loss: 0.1222809 Test Loss: 0.1687251
EarlyStopping counter: 4 out of 5
Updating learning rate to 0.00022517998136852504
Epoch: 21 cost time: 3.5654757022857666
Epoch: 21, Steps: 67 | Train Loss: 0.2209946 Vali Loss: 0.1225081 Test Loss: 0.1689890
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_96_LightTimeBaseTST_ETTm2_ftM_sl336_pl96_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.16786660659313202, mae:0.2560296437740326, rse:0.33415672183036804
