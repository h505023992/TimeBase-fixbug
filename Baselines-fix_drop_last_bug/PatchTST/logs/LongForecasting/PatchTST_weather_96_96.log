Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='96_96', model='PatchTST', data='custom', root_path='./dataset/', data_path='weather.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=96, fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=21, dec_in=7, c_out=7, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=32, patience=5, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=1, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:1
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.dropout.Dropout'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.container.Sequential'>.
[INFO] Register count_normalization() for <class 'torch.nn.modules.batchnorm.BatchNorm1d'>.
MACs: 103477248.0
Params: 547168.0
103.48M MACs
>>>>>>>start training : 96_96_PatchTST_custom_ftM_sl96_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36696
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.6702345
	speed: 0.0718s/iter; left time: 2463.1912s
	iters: 200, epoch: 1 | loss: 0.5301430
	speed: 0.0623s/iter; left time: 2131.4066s
	iters: 300, epoch: 1 | loss: 0.7144498
	speed: 0.0677s/iter; left time: 2310.8257s
	iters: 400, epoch: 1 | loss: 0.5594967
	speed: 0.0662s/iter; left time: 2252.3192s
	iters: 500, epoch: 1 | loss: 0.4244505
	speed: 0.0650s/iter; left time: 2204.6488s
	iters: 600, epoch: 1 | loss: 0.4703288
	speed: 0.0652s/iter; left time: 2206.0203s
	iters: 700, epoch: 1 | loss: 0.4488216
	speed: 0.0652s/iter; left time: 2196.7813s
	iters: 800, epoch: 1 | loss: 0.5404380
	speed: 0.0610s/iter; left time: 2051.8612s
	iters: 900, epoch: 1 | loss: 0.3780506
	speed: 0.0669s/iter; left time: 2241.5688s
	iters: 1000, epoch: 1 | loss: 0.3671389
	speed: 0.0662s/iter; left time: 2211.1433s
	iters: 1100, epoch: 1 | loss: 0.5260321
	speed: 0.0613s/iter; left time: 2043.3266s
Epoch: 1 cost time: 75.02255892753601
Epoch: 1, Steps: 1147 | Train Loss: 0.7143472 Vali Loss: 0.5471797 Test Loss: 0.2137213
Validation loss decreased (inf --> 0.547180).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3698737
	speed: 0.5345s/iter; left time: 17725.2850s
	iters: 200, epoch: 2 | loss: 0.3186924
	speed: 0.0647s/iter; left time: 2140.5022s
	iters: 300, epoch: 2 | loss: 0.4543265
	speed: 0.0656s/iter; left time: 2161.6863s
	iters: 400, epoch: 2 | loss: 0.9420338
	speed: 0.0570s/iter; left time: 1872.9026s
	iters: 500, epoch: 2 | loss: 0.4403647
	speed: 0.0633s/iter; left time: 2074.5037s
	iters: 600, epoch: 2 | loss: 0.3977971
	speed: 0.0640s/iter; left time: 2089.3910s
	iters: 700, epoch: 2 | loss: 0.5678493
	speed: 0.0621s/iter; left time: 2022.6891s
	iters: 800, epoch: 2 | loss: 0.5541494
	speed: 0.0617s/iter; left time: 2002.5930s
	iters: 900, epoch: 2 | loss: 0.3515317
	speed: 0.0646s/iter; left time: 2090.6237s
	iters: 1000, epoch: 2 | loss: 0.3673970
	speed: 0.0613s/iter; left time: 1977.6380s
	iters: 1100, epoch: 2 | loss: 0.3113270
	speed: 0.0589s/iter; left time: 1894.5864s
Epoch: 2 cost time: 72.85367918014526
Epoch: 2, Steps: 1147 | Train Loss: 0.5193204 Vali Loss: 0.4668070 Test Loss: 0.1932658
Validation loss decreased (0.547180 --> 0.466807).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.4361830
	speed: 0.5226s/iter; left time: 16731.3354s
	iters: 200, epoch: 3 | loss: 0.3033385
	speed: 0.0631s/iter; left time: 2012.5171s
	iters: 300, epoch: 3 | loss: 1.3854870
	speed: 0.0612s/iter; left time: 1947.9608s
	iters: 400, epoch: 3 | loss: 0.3832087
	speed: 0.0597s/iter; left time: 1892.5514s
	iters: 500, epoch: 3 | loss: 0.3424594
	speed: 0.0615s/iter; left time: 1943.1884s
	iters: 600, epoch: 3 | loss: 0.6059671
	speed: 0.0666s/iter; left time: 2098.0439s
	iters: 700, epoch: 3 | loss: 0.7385177
	speed: 0.0601s/iter; left time: 1888.0680s
	iters: 800, epoch: 3 | loss: 0.4146967
	speed: 0.0626s/iter; left time: 1959.0004s
	iters: 900, epoch: 3 | loss: 0.2829936
	speed: 0.0659s/iter; left time: 2058.5310s
	iters: 1000, epoch: 3 | loss: 0.4841700
	speed: 0.0632s/iter; left time: 1967.1966s
	iters: 1100, epoch: 3 | loss: 0.3854064
	speed: 0.0652s/iter; left time: 2022.5884s
Epoch: 3 cost time: 73.24138712882996
Epoch: 3, Steps: 1147 | Train Loss: 0.4902573 Vali Loss: 0.4481169 Test Loss: 0.1848029
Validation loss decreased (0.466807 --> 0.448117).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3983880
	speed: 0.5188s/iter; left time: 16015.0056s
	iters: 200, epoch: 4 | loss: 0.7491381
	speed: 0.0639s/iter; left time: 1966.8702s
	iters: 300, epoch: 4 | loss: 0.4643479
	speed: 0.0640s/iter; left time: 1961.5708s
	iters: 400, epoch: 4 | loss: 0.3465089
	speed: 0.0596s/iter; left time: 1821.9644s
	iters: 500, epoch: 4 | loss: 0.5981003
	speed: 0.0633s/iter; left time: 1927.9909s
	iters: 600, epoch: 4 | loss: 0.4467286
	speed: 0.0609s/iter; left time: 1848.7048s
	iters: 700, epoch: 4 | loss: 0.3489376
	speed: 0.0603s/iter; left time: 1824.6844s
	iters: 800, epoch: 4 | loss: 0.3641046
	speed: 0.0643s/iter; left time: 1940.1862s
	iters: 900, epoch: 4 | loss: 0.3740442
	speed: 0.0639s/iter; left time: 1922.0428s
	iters: 1000, epoch: 4 | loss: 0.4628413
	speed: 0.0601s/iter; left time: 1801.5146s
	iters: 1100, epoch: 4 | loss: 0.3065550
	speed: 0.0608s/iter; left time: 1815.6980s
Epoch: 4 cost time: 72.65936851501465
Epoch: 4, Steps: 1147 | Train Loss: 0.4808690 Vali Loss: 0.4492945 Test Loss: 0.1880592
EarlyStopping counter: 1 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.3415067
	speed: 0.5163s/iter; left time: 15344.5315s
	iters: 200, epoch: 5 | loss: 0.3642426
	speed: 0.0677s/iter; left time: 2004.3579s
	iters: 300, epoch: 5 | loss: 0.4006726
	speed: 0.0621s/iter; left time: 1834.0823s
	iters: 400, epoch: 5 | loss: 0.3454352
	speed: 0.0618s/iter; left time: 1817.1532s
	iters: 500, epoch: 5 | loss: 0.3669037
	speed: 0.0632s/iter; left time: 1853.2429s
	iters: 600, epoch: 5 | loss: 0.3574527
	speed: 0.0637s/iter; left time: 1861.7435s
	iters: 700, epoch: 5 | loss: 0.4944033
	speed: 0.0599s/iter; left time: 1743.2980s
	iters: 800, epoch: 5 | loss: 0.3680577
	speed: 0.0637s/iter; left time: 1848.8830s
	iters: 900, epoch: 5 | loss: 0.4039970
	speed: 0.0623s/iter; left time: 1802.5177s
	iters: 1000, epoch: 5 | loss: 0.4115603
	speed: 0.0589s/iter; left time: 1698.2873s
	iters: 1100, epoch: 5 | loss: 0.3652021
	speed: 0.0620s/iter; left time: 1780.9001s
Epoch: 5 cost time: 72.37115836143494
Epoch: 5, Steps: 1147 | Train Loss: 0.4731887 Vali Loss: 0.4386152 Test Loss: 0.1810577
Validation loss decreased (0.448117 --> 0.438615).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 1.4566673
	speed: 0.4808s/iter; left time: 13739.0439s
	iters: 200, epoch: 6 | loss: 0.2973665
	speed: 0.0656s/iter; left time: 1869.3620s
	iters: 300, epoch: 6 | loss: 0.4835737
	speed: 0.0607s/iter; left time: 1721.1579s
	iters: 400, epoch: 6 | loss: 0.6267939
	speed: 0.0622s/iter; left time: 1759.1152s
	iters: 500, epoch: 6 | loss: 0.2804110
	speed: 0.0670s/iter; left time: 1889.0643s
	iters: 600, epoch: 6 | loss: 0.3399148
	speed: 0.0636s/iter; left time: 1785.7195s
	iters: 700, epoch: 6 | loss: 0.4441020
	speed: 0.0609s/iter; left time: 1703.9928s
	iters: 800, epoch: 6 | loss: 0.3708883
	speed: 0.0688s/iter; left time: 1917.2769s
	iters: 900, epoch: 6 | loss: 0.3148795
	speed: 0.0664s/iter; left time: 1844.7502s
	iters: 1000, epoch: 6 | loss: 0.2694552
	speed: 0.0637s/iter; left time: 1761.6032s
	iters: 1100, epoch: 6 | loss: 0.3023273
	speed: 0.0649s/iter; left time: 1789.5365s
Epoch: 6 cost time: 74.72529125213623
Epoch: 6, Steps: 1147 | Train Loss: 0.4689094 Vali Loss: 0.4369019 Test Loss: 0.1806969
Validation loss decreased (0.438615 --> 0.436902).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.5695270
	speed: 0.4967s/iter; left time: 13624.4192s
	iters: 200, epoch: 7 | loss: 0.3996406
	speed: 0.0655s/iter; left time: 1789.4858s
	iters: 300, epoch: 7 | loss: 0.4642568
	speed: 0.0629s/iter; left time: 1713.8689s
	iters: 400, epoch: 7 | loss: 1.0251213
	speed: 0.0620s/iter; left time: 1682.0065s
	iters: 500, epoch: 7 | loss: 0.4550300
	speed: 0.0608s/iter; left time: 1643.7377s
	iters: 600, epoch: 7 | loss: 0.3305323
	speed: 0.0603s/iter; left time: 1624.6919s
	iters: 700, epoch: 7 | loss: 0.2930109
	speed: 0.0612s/iter; left time: 1642.5438s
	iters: 800, epoch: 7 | loss: 0.4043953
	speed: 0.0655s/iter; left time: 1751.8321s
	iters: 900, epoch: 7 | loss: 0.3387092
	speed: 0.0605s/iter; left time: 1612.1384s
	iters: 1000, epoch: 7 | loss: 0.4049556
	speed: 0.0616s/iter; left time: 1633.9434s
	iters: 1100, epoch: 7 | loss: 0.3402504
	speed: 0.0657s/iter; left time: 1735.2077s
Epoch: 7 cost time: 73.52286148071289
Epoch: 7, Steps: 1147 | Train Loss: 0.4619380 Vali Loss: 0.4348235 Test Loss: 0.1780754
Validation loss decreased (0.436902 --> 0.434824).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.4534868
	speed: 0.5096s/iter; left time: 13392.0894s
	iters: 200, epoch: 8 | loss: 0.5258791
	speed: 0.0617s/iter; left time: 1615.6844s
	iters: 300, epoch: 8 | loss: 0.3928295
	speed: 0.0617s/iter; left time: 1609.9531s
	iters: 400, epoch: 8 | loss: 0.3348028
	speed: 0.0645s/iter; left time: 1676.5363s
	iters: 500, epoch: 8 | loss: 0.6334336
	speed: 0.0641s/iter; left time: 1658.4115s
	iters: 600, epoch: 8 | loss: 0.2772405
	speed: 0.0655s/iter; left time: 1689.9665s
	iters: 700, epoch: 8 | loss: 1.3665663
	speed: 0.0615s/iter; left time: 1580.3863s
	iters: 800, epoch: 8 | loss: 0.3531716
	speed: 0.0642s/iter; left time: 1642.1617s
	iters: 900, epoch: 8 | loss: 0.2984583
	speed: 0.0606s/iter; left time: 1543.2881s
	iters: 1000, epoch: 8 | loss: 0.3384708
	speed: 0.0609s/iter; left time: 1545.1945s
	iters: 1100, epoch: 8 | loss: 0.4309005
	speed: 0.0613s/iter; left time: 1549.0879s
Epoch: 8 cost time: 73.3749611377716
Epoch: 8, Steps: 1147 | Train Loss: 0.4570228 Vali Loss: 0.4342061 Test Loss: 0.1766402
Validation loss decreased (0.434824 --> 0.434206).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 1.3338491
	speed: 0.5135s/iter; left time: 12907.6193s
	iters: 200, epoch: 9 | loss: 0.3026570
	speed: 0.0609s/iter; left time: 1524.5350s
	iters: 300, epoch: 9 | loss: 0.3043608
	speed: 0.0642s/iter; left time: 1600.8654s
	iters: 400, epoch: 9 | loss: 0.5014493
	speed: 0.0575s/iter; left time: 1429.1765s
	iters: 500, epoch: 9 | loss: 0.3132176
	speed: 0.0649s/iter; left time: 1605.5496s
	iters: 600, epoch: 9 | loss: 0.3207333
	speed: 0.0611s/iter; left time: 1505.4793s
	iters: 700, epoch: 9 | loss: 0.2386866
	speed: 0.0599s/iter; left time: 1470.8731s
	iters: 800, epoch: 9 | loss: 0.4116057
	speed: 0.0669s/iter; left time: 1633.7424s
	iters: 900, epoch: 9 | loss: 0.3554877
	speed: 0.0622s/iter; left time: 1513.0696s
	iters: 1000, epoch: 9 | loss: 0.3853075
	speed: 0.0626s/iter; left time: 1516.6654s
	iters: 1100, epoch: 9 | loss: 0.4508686
	speed: 0.0633s/iter; left time: 1528.8741s
Epoch: 9 cost time: 72.71327257156372
Epoch: 9, Steps: 1147 | Train Loss: 0.4544665 Vali Loss: 0.4309171 Test Loss: 0.1742707
Validation loss decreased (0.434206 --> 0.430917).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.3073582
	speed: 0.5093s/iter; left time: 12215.9741s
	iters: 200, epoch: 10 | loss: 0.4772792
	speed: 0.0642s/iter; left time: 1533.5610s
	iters: 300, epoch: 10 | loss: 0.4151526
	speed: 0.0635s/iter; left time: 1511.2541s
	iters: 400, epoch: 10 | loss: 0.3124467
	speed: 0.0602s/iter; left time: 1425.7003s
	iters: 500, epoch: 10 | loss: 0.3230245
	speed: 0.0618s/iter; left time: 1457.9080s
	iters: 600, epoch: 10 | loss: 0.4402718
	speed: 0.0621s/iter; left time: 1459.2941s
	iters: 700, epoch: 10 | loss: 0.3837593
	speed: 0.0601s/iter; left time: 1405.2814s
	iters: 800, epoch: 10 | loss: 0.2462799
	speed: 0.0679s/iter; left time: 1580.1862s
	iters: 900, epoch: 10 | loss: 0.3062288
	speed: 0.0628s/iter; left time: 1456.9212s
	iters: 1000, epoch: 10 | loss: 0.2753614
	speed: 0.0629s/iter; left time: 1451.6405s
	iters: 1100, epoch: 10 | loss: 0.3701749
	speed: 0.0653s/iter; left time: 1502.2019s
Epoch: 10 cost time: 73.40122771263123
Epoch: 10, Steps: 1147 | Train Loss: 0.4510059 Vali Loss: 0.4314652 Test Loss: 0.1757084
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.4030839
	speed: 0.4986s/iter; left time: 11387.5366s
	iters: 200, epoch: 11 | loss: 0.3210477
	speed: 0.0622s/iter; left time: 1414.3957s
	iters: 300, epoch: 11 | loss: 0.3658625
	speed: 0.0622s/iter; left time: 1409.2897s
	iters: 400, epoch: 11 | loss: 0.4292230
	speed: 0.0634s/iter; left time: 1429.5797s
	iters: 500, epoch: 11 | loss: 0.2963417
	speed: 0.0614s/iter; left time: 1376.9712s
	iters: 600, epoch: 11 | loss: 0.2986778
	speed: 0.0639s/iter; left time: 1427.0183s
	iters: 700, epoch: 11 | loss: 0.4267171
	speed: 0.0612s/iter; left time: 1361.3887s
	iters: 800, epoch: 11 | loss: 0.4286742
	speed: 0.0642s/iter; left time: 1420.9207s
	iters: 900, epoch: 11 | loss: 0.2835943
	speed: 0.0603s/iter; left time: 1328.9343s
	iters: 1000, epoch: 11 | loss: 1.3123053
	speed: 0.0624s/iter; left time: 1370.0154s
	iters: 1100, epoch: 11 | loss: 0.3902166
	speed: 0.0619s/iter; left time: 1351.6923s
Epoch: 11 cost time: 73.24511408805847
Epoch: 11, Steps: 1147 | Train Loss: 0.4489370 Vali Loss: 0.4318443 Test Loss: 0.1759189
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.4073613
	speed: 0.5205s/iter; left time: 11290.7573s
	iters: 200, epoch: 12 | loss: 0.3180948
	speed: 0.0615s/iter; left time: 1328.7501s
	iters: 300, epoch: 12 | loss: 0.3216838
	speed: 0.0634s/iter; left time: 1363.1793s
	iters: 400, epoch: 12 | loss: 0.3455807
	speed: 0.0637s/iter; left time: 1362.3822s
	iters: 500, epoch: 12 | loss: 0.4315923
	speed: 0.0578s/iter; left time: 1230.2100s
	iters: 600, epoch: 12 | loss: 0.3738814
	speed: 0.0608s/iter; left time: 1288.4036s
	iters: 700, epoch: 12 | loss: 0.4909943
	speed: 0.0632s/iter; left time: 1334.0749s
	iters: 800, epoch: 12 | loss: 1.3367461
	speed: 0.0659s/iter; left time: 1382.4912s
	iters: 900, epoch: 12 | loss: 0.4095641
	speed: 0.0641s/iter; left time: 1339.9882s
	iters: 1000, epoch: 12 | loss: 0.3319692
	speed: 0.0632s/iter; left time: 1313.8410s
	iters: 1100, epoch: 12 | loss: 0.3927712
	speed: 0.0660s/iter; left time: 1365.0379s
Epoch: 12 cost time: 73.2830183506012
Epoch: 12, Steps: 1147 | Train Loss: 0.4466716 Vali Loss: 0.4311586 Test Loss: 0.1761532
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 1.1606250
	speed: 0.5297s/iter; left time: 10883.4056s
	iters: 200, epoch: 13 | loss: 0.3110784
	speed: 0.0669s/iter; left time: 1367.8843s
	iters: 300, epoch: 13 | loss: 0.3016829
	speed: 0.0636s/iter; left time: 1294.7890s
	iters: 400, epoch: 13 | loss: 0.3765022
	speed: 0.0601s/iter; left time: 1216.0747s
	iters: 500, epoch: 13 | loss: 0.4910326
	speed: 0.0623s/iter; left time: 1254.9912s
	iters: 600, epoch: 13 | loss: 0.2775704
	speed: 0.0617s/iter; left time: 1236.7548s
	iters: 700, epoch: 13 | loss: 0.3634902
	speed: 0.0659s/iter; left time: 1314.4665s
	iters: 800, epoch: 13 | loss: 0.4500265
	speed: 0.0600s/iter; left time: 1191.4122s
	iters: 900, epoch: 13 | loss: 0.4155155
	speed: 0.0671s/iter; left time: 1325.3732s
	iters: 1000, epoch: 13 | loss: 0.6100048
	speed: 0.0648s/iter; left time: 1273.2232s
	iters: 1100, epoch: 13 | loss: 1.2552295
	speed: 0.0636s/iter; left time: 1243.5005s
Epoch: 13 cost time: 74.15553593635559
Epoch: 13, Steps: 1147 | Train Loss: 0.4449811 Vali Loss: 0.4299389 Test Loss: 0.1750302
Validation loss decreased (0.430917 --> 0.429939).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.2680140
	speed: 0.5004s/iter; left time: 9707.5042s
	iters: 200, epoch: 14 | loss: 0.3798584
	speed: 0.0672s/iter; left time: 1297.3931s
	iters: 300, epoch: 14 | loss: 0.3136359
	speed: 0.0618s/iter; left time: 1186.6175s
	iters: 400, epoch: 14 | loss: 0.4513606
	speed: 0.0620s/iter; left time: 1184.5004s
	iters: 500, epoch: 14 | loss: 0.3331863
	speed: 0.0615s/iter; left time: 1169.0953s
	iters: 600, epoch: 14 | loss: 0.3360490
	speed: 0.0611s/iter; left time: 1154.8725s
	iters: 700, epoch: 14 | loss: 0.4187932
	speed: 0.0588s/iter; left time: 1105.1892s
	iters: 800, epoch: 14 | loss: 0.3646244
	speed: 0.0602s/iter; left time: 1125.5894s
	iters: 900, epoch: 14 | loss: 0.3648453
	speed: 0.0599s/iter; left time: 1114.7482s
	iters: 1000, epoch: 14 | loss: 0.4084565
	speed: 0.0610s/iter; left time: 1129.4142s
	iters: 1100, epoch: 14 | loss: 0.3494152
	speed: 0.0574s/iter; left time: 1056.8122s
Epoch: 14 cost time: 70.71720695495605
Epoch: 14, Steps: 1147 | Train Loss: 0.4435207 Vali Loss: 0.4282140 Test Loss: 0.1745426
Validation loss decreased (0.429939 --> 0.428214).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.5407013
	speed: 0.5082s/iter; left time: 9276.4817s
	iters: 200, epoch: 15 | loss: 0.2769095
	speed: 0.0666s/iter; left time: 1208.6922s
	iters: 300, epoch: 15 | loss: 0.3439979
	speed: 0.0612s/iter; left time: 1105.2774s
	iters: 400, epoch: 15 | loss: 0.3606780
	speed: 0.0598s/iter; left time: 1073.1820s
	iters: 500, epoch: 15 | loss: 1.1591885
	speed: 0.0650s/iter; left time: 1159.8181s
	iters: 600, epoch: 15 | loss: 1.2731795
	speed: 0.0644s/iter; left time: 1143.3826s
	iters: 700, epoch: 15 | loss: 0.3546813
	speed: 0.0620s/iter; left time: 1093.6190s
	iters: 800, epoch: 15 | loss: 0.3621779
	speed: 0.0634s/iter; left time: 1113.3558s
	iters: 900, epoch: 15 | loss: 0.3615189
	speed: 0.0635s/iter; left time: 1107.7018s
	iters: 1000, epoch: 15 | loss: 0.2748473
	speed: 0.0598s/iter; left time: 1038.2463s
	iters: 1100, epoch: 15 | loss: 0.3624682
	speed: 0.0625s/iter; left time: 1079.1252s
Epoch: 15 cost time: 72.89221477508545
Epoch: 15, Steps: 1147 | Train Loss: 0.4424467 Vali Loss: 0.4295663 Test Loss: 0.1749634
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 1.2886437
	speed: 0.5169s/iter; left time: 8841.8373s
	iters: 200, epoch: 16 | loss: 0.4344584
	speed: 0.0639s/iter; left time: 1087.1983s
	iters: 300, epoch: 16 | loss: 0.3249726
	speed: 0.0603s/iter; left time: 1018.8321s
	iters: 400, epoch: 16 | loss: 0.2587485
	speed: 0.0586s/iter; left time: 985.2659s
	iters: 500, epoch: 16 | loss: 0.3623618
	speed: 0.0598s/iter; left time: 999.2040s
	iters: 600, epoch: 16 | loss: 0.7331924
	speed: 0.0632s/iter; left time: 1049.7644s
	iters: 700, epoch: 16 | loss: 0.5011267
	speed: 0.0590s/iter; left time: 973.6341s
	iters: 800, epoch: 16 | loss: 0.3046765
	speed: 0.0606s/iter; left time: 993.8756s
	iters: 900, epoch: 16 | loss: 0.4488724
	speed: 0.0672s/iter; left time: 1096.2752s
	iters: 1000, epoch: 16 | loss: 0.2957640
	speed: 0.0629s/iter; left time: 1019.8051s
	iters: 1100, epoch: 16 | loss: 0.3272483
	speed: 0.0616s/iter; left time: 992.7984s
Epoch: 16 cost time: 71.79529142379761
Epoch: 16, Steps: 1147 | Train Loss: 0.4415574 Vali Loss: 0.4304443 Test Loss: 0.1764046
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.2965804
	speed: 0.5137s/iter; left time: 8198.1067s
	iters: 200, epoch: 17 | loss: 0.3440327
	speed: 0.0644s/iter; left time: 1020.7358s
	iters: 300, epoch: 17 | loss: 0.3876861
	speed: 0.0599s/iter; left time: 944.4005s
	iters: 400, epoch: 17 | loss: 0.6339232
	speed: 0.0596s/iter; left time: 933.3134s
	iters: 500, epoch: 17 | loss: 0.3441932
	speed: 0.0613s/iter; left time: 953.9363s
	iters: 600, epoch: 17 | loss: 0.3004668
	speed: 0.0639s/iter; left time: 987.0906s
	iters: 700, epoch: 17 | loss: 0.2790907
	speed: 0.0583s/iter; left time: 896.0879s
	iters: 800, epoch: 17 | loss: 0.4638562
	speed: 0.0590s/iter; left time: 899.9629s
	iters: 900, epoch: 17 | loss: 0.3055116
	speed: 0.0662s/iter; left time: 1003.6940s
	iters: 1000, epoch: 17 | loss: 0.3575037
	speed: 0.0603s/iter; left time: 907.3071s
	iters: 1100, epoch: 17 | loss: 0.4722133
	speed: 0.0597s/iter; left time: 893.4019s
Epoch: 17 cost time: 71.51934862136841
Epoch: 17, Steps: 1147 | Train Loss: 0.4402801 Vali Loss: 0.4269036 Test Loss: 0.1733951
Validation loss decreased (0.428214 --> 0.426904).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.3516538
	speed: 0.5225s/iter; left time: 7739.3735s
	iters: 200, epoch: 18 | loss: 0.3422244
	speed: 0.0660s/iter; left time: 970.7922s
	iters: 300, epoch: 18 | loss: 0.2785419
	speed: 0.0610s/iter; left time: 891.5115s
	iters: 400, epoch: 18 | loss: 0.2969480
	speed: 0.0577s/iter; left time: 837.8745s
	iters: 500, epoch: 18 | loss: 0.4508760
	speed: 0.0674s/iter; left time: 971.2016s
	iters: 600, epoch: 18 | loss: 0.2641556
	speed: 0.0624s/iter; left time: 892.8994s
	iters: 700, epoch: 18 | loss: 0.3696309
	speed: 0.0622s/iter; left time: 884.3318s
	iters: 800, epoch: 18 | loss: 0.3383733
	speed: 0.0602s/iter; left time: 850.0637s
	iters: 900, epoch: 18 | loss: 0.2747492
	speed: 0.0628s/iter; left time: 879.7406s
	iters: 1000, epoch: 18 | loss: 0.2288476
	speed: 0.0605s/iter; left time: 841.0947s
	iters: 1100, epoch: 18 | loss: 0.3838917
	speed: 0.0604s/iter; left time: 833.9189s
Epoch: 18 cost time: 71.80750823020935
Epoch: 18, Steps: 1147 | Train Loss: 0.4394994 Vali Loss: 0.4259943 Test Loss: 0.1738945
Validation loss decreased (0.426904 --> 0.425994).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.2922149
	speed: 0.5090s/iter; left time: 6955.3047s
	iters: 200, epoch: 19 | loss: 0.3551584
	speed: 0.0639s/iter; left time: 867.2804s
	iters: 300, epoch: 19 | loss: 0.4260152
	speed: 0.0615s/iter; left time: 828.7537s
	iters: 400, epoch: 19 | loss: 0.3547703
	speed: 0.0594s/iter; left time: 794.3879s
	iters: 500, epoch: 19 | loss: 0.4587452
	speed: 0.0580s/iter; left time: 769.9098s
	iters: 600, epoch: 19 | loss: 0.3977344
	speed: 0.0618s/iter; left time: 813.2456s
	iters: 700, epoch: 19 | loss: 0.2830592
	speed: 0.0649s/iter; left time: 847.8267s
	iters: 800, epoch: 19 | loss: 0.3759096
	speed: 0.0596s/iter; left time: 773.2456s
	iters: 900, epoch: 19 | loss: 0.3371799
	speed: 0.0640s/iter; left time: 823.1320s
	iters: 1000, epoch: 19 | loss: 0.2425502
	speed: 0.0677s/iter; left time: 864.2126s
	iters: 1100, epoch: 19 | loss: 0.3246166
	speed: 0.0619s/iter; left time: 784.4186s
Epoch: 19 cost time: 72.34953236579895
Epoch: 19, Steps: 1147 | Train Loss: 0.4391483 Vali Loss: 0.4271368 Test Loss: 0.1751676
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.3023711
	speed: 0.5213s/iter; left time: 6525.8222s
	iters: 200, epoch: 20 | loss: 0.3673227
	speed: 0.0606s/iter; left time: 752.0596s
	iters: 300, epoch: 20 | loss: 0.2890158
	speed: 0.0656s/iter; left time: 808.4992s
	iters: 400, epoch: 20 | loss: 0.3482170
	speed: 0.0606s/iter; left time: 741.0191s
	iters: 500, epoch: 20 | loss: 0.3006336
	speed: 0.0633s/iter; left time: 767.6705s
	iters: 600, epoch: 20 | loss: 0.2936066
	speed: 0.0620s/iter; left time: 744.6664s
	iters: 700, epoch: 20 | loss: 1.4886098
	speed: 0.0644s/iter; left time: 767.6083s
	iters: 800, epoch: 20 | loss: 0.3101180
	speed: 0.0606s/iter; left time: 716.3420s
	iters: 900, epoch: 20 | loss: 0.2333262
	speed: 0.0645s/iter; left time: 755.8246s
	iters: 1000, epoch: 20 | loss: 0.2692056
	speed: 0.0645s/iter; left time: 748.9860s
	iters: 1100, epoch: 20 | loss: 0.2268721
	speed: 0.0622s/iter; left time: 716.5459s
Epoch: 20 cost time: 72.42311596870422
Epoch: 20, Steps: 1147 | Train Loss: 0.4385228 Vali Loss: 0.4265666 Test Loss: 0.1727307
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.5607029
	speed: 0.5269s/iter; left time: 5991.5882s
	iters: 200, epoch: 21 | loss: 0.2634099
	speed: 0.0612s/iter; left time: 689.7111s
	iters: 300, epoch: 21 | loss: 0.2712677
	speed: 0.0671s/iter; left time: 749.6731s
	iters: 400, epoch: 21 | loss: 0.3153633
	speed: 0.0577s/iter; left time: 638.7343s
	iters: 500, epoch: 21 | loss: 0.2925727
	speed: 0.0588s/iter; left time: 645.5017s
	iters: 600, epoch: 21 | loss: 0.3575734
	speed: 0.0629s/iter; left time: 684.1842s
	iters: 700, epoch: 21 | loss: 0.2873428
	speed: 0.0612s/iter; left time: 659.0925s
	iters: 800, epoch: 21 | loss: 0.4936776
	speed: 0.0604s/iter; left time: 644.9172s
	iters: 900, epoch: 21 | loss: 0.2875316
	speed: 0.0637s/iter; left time: 673.8104s
	iters: 1000, epoch: 21 | loss: 0.3711067
	speed: 0.0630s/iter; left time: 659.7502s
	iters: 1100, epoch: 21 | loss: 0.5209916
	speed: 0.0595s/iter; left time: 616.9716s
Epoch: 21 cost time: 71.26215171813965
Epoch: 21, Steps: 1147 | Train Loss: 0.4381161 Vali Loss: 0.4267087 Test Loss: 0.1746819
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.4101735
	speed: 0.5304s/iter; left time: 5423.0356s
	iters: 200, epoch: 22 | loss: 0.9698724
	speed: 0.0655s/iter; left time: 663.5374s
	iters: 300, epoch: 22 | loss: 0.3525930
	speed: 0.0612s/iter; left time: 613.3154s
	iters: 400, epoch: 22 | loss: 0.5791138
	speed: 0.0595s/iter; left time: 590.7980s
	iters: 500, epoch: 22 | loss: 0.2945206
	speed: 0.0621s/iter; left time: 609.5808s
	iters: 600, epoch: 22 | loss: 0.5067504
	speed: 0.0652s/iter; left time: 633.8556s
	iters: 700, epoch: 22 | loss: 0.2438843
	speed: 0.0602s/iter; left time: 579.1109s
	iters: 800, epoch: 22 | loss: 0.4319270
	speed: 0.0591s/iter; left time: 562.5692s
	iters: 900, epoch: 22 | loss: 0.4224116
	speed: 0.0643s/iter; left time: 606.2497s
	iters: 1000, epoch: 22 | loss: 0.3173496
	speed: 0.0596s/iter; left time: 555.6490s
	iters: 1100, epoch: 22 | loss: 0.2705305
	speed: 0.0588s/iter; left time: 542.8035s
Epoch: 22 cost time: 71.29055094718933
Epoch: 22, Steps: 1147 | Train Loss: 0.4373038 Vali Loss: 0.4265676 Test Loss: 0.1728070
EarlyStopping counter: 4 out of 5
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.4000894
	speed: 0.4859s/iter; left time: 4410.3459s
	iters: 200, epoch: 23 | loss: 0.2735489
	speed: 0.0563s/iter; left time: 505.6518s
	iters: 300, epoch: 23 | loss: 0.4621105
	speed: 0.0605s/iter; left time: 536.6890s
	iters: 400, epoch: 23 | loss: 0.3931886
	speed: 0.0576s/iter; left time: 505.2789s
	iters: 500, epoch: 23 | loss: 0.3017499
	speed: 0.0567s/iter; left time: 491.9578s
	iters: 600, epoch: 23 | loss: 0.2751507
	speed: 0.0586s/iter; left time: 502.9184s
	iters: 700, epoch: 23 | loss: 0.2566417
	speed: 0.0561s/iter; left time: 475.4983s
	iters: 800, epoch: 23 | loss: 0.3504768
	speed: 0.0551s/iter; left time: 461.4869s
	iters: 900, epoch: 23 | loss: 1.2277811
	speed: 0.0561s/iter; left time: 464.4744s
	iters: 1000, epoch: 23 | loss: 0.4002330
	speed: 0.0622s/iter; left time: 508.3210s
	iters: 1100, epoch: 23 | loss: 0.3470104
	speed: 0.0694s/iter; left time: 560.6489s
Epoch: 23 cost time: 68.50920176506042
Epoch: 23, Steps: 1147 | Train Loss: 0.4364526 Vali Loss: 0.4244604 Test Loss: 0.1734680
Validation loss decreased (0.425994 --> 0.424460).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.2462687
	speed: 0.5355s/iter; left time: 4246.3018s
	iters: 200, epoch: 24 | loss: 0.4497690
	speed: 0.0613s/iter; left time: 479.6052s
	iters: 300, epoch: 24 | loss: 1.2536466
	speed: 0.0631s/iter; left time: 487.4959s
	iters: 400, epoch: 24 | loss: 0.4610948
	speed: 0.0602s/iter; left time: 459.1879s
	iters: 500, epoch: 24 | loss: 0.2896951
	speed: 0.0558s/iter; left time: 420.2080s
	iters: 600, epoch: 24 | loss: 0.3261262
	speed: 0.0627s/iter; left time: 466.0638s
	iters: 700, epoch: 24 | loss: 0.3118911
	speed: 0.0654s/iter; left time: 479.2402s
	iters: 800, epoch: 24 | loss: 1.2401581
	speed: 0.0614s/iter; left time: 444.2513s
	iters: 900, epoch: 24 | loss: 1.2400661
	speed: 0.0626s/iter; left time: 446.0601s
	iters: 1000, epoch: 24 | loss: 0.3277425
	speed: 0.0612s/iter; left time: 430.3272s
	iters: 1100, epoch: 24 | loss: 0.2452581
	speed: 0.0611s/iter; left time: 423.2886s
Epoch: 24 cost time: 71.64880394935608
Epoch: 24, Steps: 1147 | Train Loss: 0.4364584 Vali Loss: 0.4259033 Test Loss: 0.1739803
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.3339657
	speed: 0.5349s/iter; left time: 3627.9992s
	iters: 200, epoch: 25 | loss: 0.3655186
	speed: 0.0642s/iter; left time: 428.9076s
	iters: 300, epoch: 25 | loss: 0.3669803
	speed: 0.0610s/iter; left time: 401.5896s
	iters: 400, epoch: 25 | loss: 0.3632647
	speed: 0.0612s/iter; left time: 396.8847s
	iters: 500, epoch: 25 | loss: 0.3985177
	speed: 0.0604s/iter; left time: 385.4560s
	iters: 600, epoch: 25 | loss: 0.2851544
	speed: 0.0645s/iter; left time: 405.4907s
	iters: 700, epoch: 25 | loss: 0.2638915
	speed: 0.0619s/iter; left time: 382.5797s
	iters: 800, epoch: 25 | loss: 0.2445531
	speed: 0.0589s/iter; left time: 358.5067s
	iters: 900, epoch: 25 | loss: 0.2652074
	speed: 0.0654s/iter; left time: 391.5132s
	iters: 1000, epoch: 25 | loss: 1.3716348
	speed: 0.0677s/iter; left time: 398.1113s
	iters: 1100, epoch: 25 | loss: 0.5134472
	speed: 0.0660s/iter; left time: 381.4299s
Epoch: 25 cost time: 73.311856508255
Epoch: 25, Steps: 1147 | Train Loss: 0.4364544 Vali Loss: 0.4252380 Test Loss: 0.1733156
EarlyStopping counter: 2 out of 5
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.5957371
	speed: 0.5204s/iter; left time: 2933.0644s
	iters: 200, epoch: 26 | loss: 0.2407240
	speed: 0.0620s/iter; left time: 343.4101s
	iters: 300, epoch: 26 | loss: 1.3033603
	speed: 0.0618s/iter; left time: 335.7295s
	iters: 400, epoch: 26 | loss: 0.3058483
	speed: 0.0677s/iter; left time: 361.1555s
	iters: 500, epoch: 26 | loss: 0.3915904
	speed: 0.0667s/iter; left time: 349.4637s
	iters: 600, epoch: 26 | loss: 0.2733800
	speed: 0.0620s/iter; left time: 318.3694s
	iters: 700, epoch: 26 | loss: 0.3429046
	speed: 0.0637s/iter; left time: 320.9277s
	iters: 800, epoch: 26 | loss: 0.4624330
	speed: 0.0651s/iter; left time: 321.5102s
	iters: 900, epoch: 26 | loss: 0.3726346
	speed: 0.0616s/iter; left time: 298.1305s
	iters: 1000, epoch: 26 | loss: 2.4505851
	speed: 0.0594s/iter; left time: 281.2224s
	iters: 1100, epoch: 26 | loss: 0.3212310
	speed: 0.0657s/iter; left time: 304.4827s
Epoch: 26 cost time: 74.06054735183716
Epoch: 26, Steps: 1147 | Train Loss: 0.4356933 Vali Loss: 0.4250341 Test Loss: 0.1739356
EarlyStopping counter: 3 out of 5
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.5493058
	speed: 0.5216s/iter; left time: 2341.2446s
	iters: 200, epoch: 27 | loss: 0.5272489
	speed: 0.0615s/iter; left time: 270.0038s
	iters: 300, epoch: 27 | loss: 0.2599044
	speed: 0.0611s/iter; left time: 262.1784s
	iters: 400, epoch: 27 | loss: 0.2925725
	speed: 0.0660s/iter; left time: 276.4613s
	iters: 500, epoch: 27 | loss: 0.3006810
	speed: 0.0638s/iter; left time: 260.7103s
	iters: 600, epoch: 27 | loss: 1.3523233
	speed: 0.0672s/iter; left time: 267.8926s
	iters: 700, epoch: 27 | loss: 0.5082986
	speed: 0.0676s/iter; left time: 262.7355s
	iters: 800, epoch: 27 | loss: 0.3288497
	speed: 0.0609s/iter; left time: 230.6353s
	iters: 900, epoch: 27 | loss: 0.3307028
	speed: 0.0592s/iter; left time: 218.5218s
	iters: 1000, epoch: 27 | loss: 0.3033721
	speed: 0.0647s/iter; left time: 232.2625s
	iters: 1100, epoch: 27 | loss: 0.2596143
	speed: 0.0643s/iter; left time: 224.4083s
Epoch: 27 cost time: 74.17821288108826
Epoch: 27, Steps: 1147 | Train Loss: 0.4356629 Vali Loss: 0.4247248 Test Loss: 0.1737260
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.4476956
	speed: 0.5273s/iter; left time: 1762.2777s
	iters: 200, epoch: 28 | loss: 0.2529576
	speed: 0.0608s/iter; left time: 197.0262s
	iters: 300, epoch: 28 | loss: 0.3526461
	speed: 0.0678s/iter; left time: 213.0046s
	iters: 400, epoch: 28 | loss: 0.3339587
	speed: 0.0616s/iter; left time: 187.4166s
	iters: 500, epoch: 28 | loss: 0.3738180
	speed: 0.0613s/iter; left time: 180.3362s
	iters: 600, epoch: 28 | loss: 0.4119782
	speed: 0.0589s/iter; left time: 167.3445s
	iters: 700, epoch: 28 | loss: 0.3239556
	speed: 0.0636s/iter; left time: 174.4108s
	iters: 800, epoch: 28 | loss: 0.5123719
	speed: 0.0596s/iter; left time: 157.3652s
	iters: 900, epoch: 28 | loss: 0.3419749
	speed: 0.0584s/iter; left time: 148.4096s
	iters: 1000, epoch: 28 | loss: 1.0398747
	speed: 0.0535s/iter; left time: 130.7412s
	iters: 1100, epoch: 28 | loss: 0.3950403
	speed: 0.0587s/iter; left time: 137.4929s
Epoch: 28 cost time: 70.17618918418884
Epoch: 28, Steps: 1147 | Train Loss: 0.4354964 Vali Loss: 0.4258997 Test Loss: 0.1738945
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : 96_96_PatchTST_custom_ftM_sl96_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
mse:0.17371618747711182, mae:0.21594764292240143, rse:0.5492528676986694
