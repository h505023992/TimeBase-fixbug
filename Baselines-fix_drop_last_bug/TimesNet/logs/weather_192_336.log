True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_192_336     Model:              TimesNet            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/          
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            192                 Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_weather_192_336_TimesNet_custom_ftM_sl192_ll48_pl336_dm32_nh8_el2_dl1_df32_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36360
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.5441494
	speed: 0.4787s/iter; left time: 16282.1132s
	iters: 200, epoch: 1 | loss: 0.4596707
	speed: 0.3608s/iter; left time: 12236.2681s
	iters: 300, epoch: 1 | loss: 0.4524871
	speed: 0.3482s/iter; left time: 11773.7841s
	iters: 400, epoch: 1 | loss: 0.5022271
	speed: 0.3529s/iter; left time: 11897.2836s
	iters: 500, epoch: 1 | loss: 0.7583609
	speed: 0.3421s/iter; left time: 11498.8519s
	iters: 600, epoch: 1 | loss: 0.6460199
	speed: 0.3472s/iter; left time: 11634.7063s
	iters: 700, epoch: 1 | loss: 0.4861733
	speed: 0.3488s/iter; left time: 11654.5388s
	iters: 800, epoch: 1 | loss: 0.5247778
	speed: 0.3525s/iter; left time: 11743.7241s
	iters: 900, epoch: 1 | loss: 0.7011659
	speed: 0.3590s/iter; left time: 11921.5601s
	iters: 1000, epoch: 1 | loss: 0.3727716
	speed: 0.3505s/iter; left time: 11604.8799s
	iters: 1100, epoch: 1 | loss: 0.6010280
	speed: 0.3488s/iter; left time: 11515.0636s
Epoch: 1 cost time: 411.38527488708496
Epoch: 1, Steps: 1137 | Train Loss: 0.5637536 Vali Loss: 0.5665222 Test Loss: 0.2789229
Validation loss decreased (inf --> 0.566522).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5148383
	speed: 1.5411s/iter; left time: 50661.6439s
	iters: 200, epoch: 2 | loss: 0.4870217
	speed: 0.3316s/iter; left time: 10869.2761s
	iters: 300, epoch: 2 | loss: 0.5849752
	speed: 0.3216s/iter; left time: 10507.8431s
	iters: 400, epoch: 2 | loss: 0.3683987
	speed: 0.3288s/iter; left time: 10709.4972s
	iters: 500, epoch: 2 | loss: 0.3662812
	speed: 0.3236s/iter; left time: 10509.6393s
	iters: 600, epoch: 2 | loss: 0.4687055
	speed: 0.3165s/iter; left time: 10246.2228s
	iters: 700, epoch: 2 | loss: 0.5104648
	speed: 0.3285s/iter; left time: 10603.1642s
	iters: 800, epoch: 2 | loss: 0.2932411
	speed: 0.3264s/iter; left time: 10502.2746s
	iters: 900, epoch: 2 | loss: 0.3708065
	speed: 0.3227s/iter; left time: 10351.7414s
	iters: 1000, epoch: 2 | loss: 0.3787500
	speed: 0.3293s/iter; left time: 10530.3203s
	iters: 1100, epoch: 2 | loss: 0.6575394
	speed: 0.3222s/iter; left time: 10270.2671s
Epoch: 2 cost time: 372.84999442100525
Epoch: 2, Steps: 1137 | Train Loss: 0.4811261 Vali Loss: 0.5698685 Test Loss: 0.2969016
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3748117
	speed: 1.5783s/iter; left time: 50089.8548s
	iters: 200, epoch: 3 | loss: 0.3622497
	speed: 0.3351s/iter; left time: 10600.6876s
	iters: 300, epoch: 3 | loss: 0.3039105
	speed: 0.3292s/iter; left time: 10382.8634s
	iters: 400, epoch: 3 | loss: 0.3009733
	speed: 0.3366s/iter; left time: 10580.9372s
	iters: 500, epoch: 3 | loss: 0.4523134
	speed: 0.3328s/iter; left time: 10428.0398s
	iters: 600, epoch: 3 | loss: 0.4119121
	speed: 0.3361s/iter; left time: 10499.8201s
	iters: 700, epoch: 3 | loss: 0.3652100
	speed: 0.3403s/iter; left time: 10596.8361s
	iters: 800, epoch: 3 | loss: 0.3278279
	speed: 0.3376s/iter; left time: 10479.4944s
	iters: 900, epoch: 3 | loss: 0.4261293
	speed: 0.3340s/iter; left time: 10332.2242s
	iters: 1000, epoch: 3 | loss: 0.4328566
	speed: 0.3225s/iter; left time: 9946.1720s
	iters: 1100, epoch: 3 | loss: 0.6557547
	speed: 0.3226s/iter; left time: 9914.3220s
Epoch: 3 cost time: 379.65967440605164
Epoch: 3, Steps: 1137 | Train Loss: 0.4493619 Vali Loss: 0.5773173 Test Loss: 0.2960743
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3738429
	speed: 1.5339s/iter; left time: 46938.6286s
	iters: 200, epoch: 4 | loss: 0.3995236
	speed: 0.3264s/iter; left time: 9956.4964s
	iters: 300, epoch: 4 | loss: 0.3710394
	speed: 0.3293s/iter; left time: 10011.0941s
	iters: 400, epoch: 4 | loss: 0.6130142
	speed: 0.3334s/iter; left time: 10101.1465s
	iters: 500, epoch: 4 | loss: 0.3194772
	speed: 0.3326s/iter; left time: 10043.7416s
	iters: 600, epoch: 4 | loss: 0.3151601
	speed: 0.3318s/iter; left time: 9985.9056s
	iters: 700, epoch: 4 | loss: 0.3902474
	speed: 0.3304s/iter; left time: 9911.1410s
	iters: 800, epoch: 4 | loss: 0.3685271
	speed: 0.3234s/iter; left time: 9668.9322s
	iters: 900, epoch: 4 | loss: 0.3891539
	speed: 0.3186s/iter; left time: 9494.5777s
	iters: 1000, epoch: 4 | loss: 0.3502705
	speed: 0.3244s/iter; left time: 9635.6753s
	iters: 1100, epoch: 4 | loss: 0.6915769
	speed: 0.3179s/iter; left time: 9409.6355s
Epoch: 4 cost time: 373.2390024662018
Epoch: 4, Steps: 1137 | Train Loss: 0.4352148 Vali Loss: 0.5884217 Test Loss: 0.3020051
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_weather_192_336_TimesNet_custom_ftM_sl192_ll48_pl336_dm32_nh8_el2_dl1_df32_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
test shape: (10204, 336, 21) (10204, 336, 21)
test shape: (10204, 336, 21) (10204, 336, 21)
mse:0.2789282202720642, mae:0.307486891746521, dtw:not calculated
