Args in experiment:
Namespace(is_training=1, train_only=False, model_id='DLinear_electricity_336_96', model='DLinear', data='custom', root_path='./dataset/', data_path='electricity.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, individual=False, embed_type=0, enc_in=321, dec_in=321, c_out=321, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DLinear_electricity_336_96_DLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17981
val 2537
test 5165
	iters: 100, epoch: 1 | loss: 0.3097699
	speed: 0.0708s/iter; left time: 1186.5900s
	iters: 200, epoch: 1 | loss: 0.2841454
	speed: 0.0488s/iter; left time: 812.7444s
	iters: 300, epoch: 1 | loss: 0.2125521
	speed: 0.0462s/iter; left time: 765.6414s
	iters: 400, epoch: 1 | loss: 0.2050519
	speed: 0.0405s/iter; left time: 667.2755s
	iters: 500, epoch: 1 | loss: 0.2190441
	speed: 0.0470s/iter; left time: 769.5490s
Epoch: 1 cost time: 28.21273374557495
Epoch: 1, Steps: 562 | Train Loss: 0.2876735 Vali Loss: 0.1729937 Test Loss: 0.1954375
Validation loss decreased (inf --> 0.172994).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1748321
	speed: 0.2679s/iter; left time: 4339.9183s
	iters: 200, epoch: 2 | loss: 0.1689369
	speed: 0.0471s/iter; left time: 758.4261s
	iters: 300, epoch: 2 | loss: 0.1682071
	speed: 0.0461s/iter; left time: 737.2215s
	iters: 400, epoch: 2 | loss: 0.1638615
	speed: 0.0441s/iter; left time: 701.0778s
	iters: 500, epoch: 2 | loss: 0.1493043
	speed: 0.0451s/iter; left time: 712.9448s
Epoch: 2 cost time: 26.46829581260681
Epoch: 2, Steps: 562 | Train Loss: 0.1799657 Vali Loss: 0.1479980 Test Loss: 0.1689511
Validation loss decreased (0.172994 --> 0.147998).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1477797
	speed: 0.3019s/iter; left time: 4720.2129s
	iters: 200, epoch: 3 | loss: 0.1508473
	speed: 0.0451s/iter; left time: 700.3114s
	iters: 300, epoch: 3 | loss: 0.1737218
	speed: 0.0417s/iter; left time: 643.3411s
	iters: 400, epoch: 3 | loss: 0.1577666
	speed: 0.0409s/iter; left time: 626.7119s
	iters: 500, epoch: 3 | loss: 0.2125560
	speed: 0.0403s/iter; left time: 613.8098s
Epoch: 3 cost time: 24.743051528930664
Epoch: 3, Steps: 562 | Train Loss: 0.1654574 Vali Loss: 0.1413337 Test Loss: 0.1621282
Validation loss decreased (0.147998 --> 0.141334).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1962578
	speed: 0.2834s/iter; left time: 4271.9877s
	iters: 200, epoch: 4 | loss: 0.1994597
	speed: 0.0500s/iter; left time: 748.1302s
	iters: 300, epoch: 4 | loss: 0.1574002
	speed: 0.0488s/iter; left time: 726.1686s
	iters: 400, epoch: 4 | loss: 0.1421838
	speed: 0.0500s/iter; left time: 738.5659s
	iters: 500, epoch: 4 | loss: 0.1571658
	speed: 0.0480s/iter; left time: 704.8557s
Epoch: 4 cost time: 28.967443227767944
Epoch: 4, Steps: 562 | Train Loss: 0.1607695 Vali Loss: 0.1387100 Test Loss: 0.1592024
Validation loss decreased (0.141334 --> 0.138710).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1781576
	speed: 0.3408s/iter; left time: 4946.6520s
	iters: 200, epoch: 5 | loss: 0.1445260
	speed: 0.0434s/iter; left time: 625.1250s
	iters: 300, epoch: 5 | loss: 0.1609283
	speed: 0.0411s/iter; left time: 588.0578s
	iters: 400, epoch: 5 | loss: 0.1520333
	speed: 0.0416s/iter; left time: 591.1584s
	iters: 500, epoch: 5 | loss: 0.1490083
	speed: 0.0406s/iter; left time: 573.5216s
Epoch: 5 cost time: 24.706406831741333
Epoch: 5, Steps: 562 | Train Loss: 0.1586591 Vali Loss: 0.1373382 Test Loss: 0.1577677
Validation loss decreased (0.138710 --> 0.137338).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1559662
	speed: 0.2845s/iter; left time: 3968.7480s
	iters: 200, epoch: 6 | loss: 0.1483635
	speed: 0.0418s/iter; left time: 578.4455s
	iters: 300, epoch: 6 | loss: 0.1822819
	speed: 0.0435s/iter; left time: 597.9517s
	iters: 400, epoch: 6 | loss: 0.1426983
	speed: 0.0413s/iter; left time: 564.1567s
	iters: 500, epoch: 6 | loss: 0.1575884
	speed: 0.0420s/iter; left time: 568.8042s
Epoch: 6 cost time: 24.56147599220276
Epoch: 6, Steps: 562 | Train Loss: 0.1575947 Vali Loss: 0.1366168 Test Loss: 0.1570405
Validation loss decreased (0.137338 --> 0.136617).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1362006
	speed: 0.2773s/iter; left time: 3712.3901s
	iters: 200, epoch: 7 | loss: 0.1778199
	speed: 0.0459s/iter; left time: 610.4134s
	iters: 300, epoch: 7 | loss: 0.1507806
	speed: 0.0452s/iter; left time: 595.9898s
	iters: 400, epoch: 7 | loss: 0.1626582
	speed: 0.0452s/iter; left time: 592.0306s
	iters: 500, epoch: 7 | loss: 0.1564845
	speed: 0.0445s/iter; left time: 578.0384s
Epoch: 7 cost time: 26.364546298980713
Epoch: 7, Steps: 562 | Train Loss: 0.1570397 Vali Loss: 0.1360535 Test Loss: 0.1566536
Validation loss decreased (0.136617 --> 0.136054).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1533527
	speed: 0.3494s/iter; left time: 4482.3485s
	iters: 200, epoch: 8 | loss: 0.1803281
	speed: 0.0544s/iter; left time: 692.0670s
	iters: 300, epoch: 8 | loss: 0.1492369
	speed: 0.0523s/iter; left time: 660.4995s
	iters: 400, epoch: 8 | loss: 0.1516631
	speed: 0.0561s/iter; left time: 702.3575s
	iters: 500, epoch: 8 | loss: 0.1525061
	speed: 0.0543s/iter; left time: 674.9160s
Epoch: 8 cost time: 32.16426634788513
Epoch: 8, Steps: 562 | Train Loss: 0.1567482 Vali Loss: 0.1360209 Test Loss: 0.1564457
Validation loss decreased (0.136054 --> 0.136021).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1460372
	speed: 0.3486s/iter; left time: 4275.7697s
	iters: 200, epoch: 9 | loss: 0.1482874
	speed: 0.0473s/iter; left time: 575.8376s
	iters: 300, epoch: 9 | loss: 0.1771149
	speed: 0.0466s/iter; left time: 561.9890s
	iters: 400, epoch: 9 | loss: 0.1298299
	speed: 0.0463s/iter; left time: 553.8325s
	iters: 500, epoch: 9 | loss: 0.1620072
	speed: 0.0420s/iter; left time: 498.4545s
Epoch: 9 cost time: 26.330445766448975
Epoch: 9, Steps: 562 | Train Loss: 0.1565887 Vali Loss: 0.1360123 Test Loss: 0.1563514
Validation loss decreased (0.136021 --> 0.136012).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1556589
	speed: 0.2661s/iter; left time: 3114.1502s
	iters: 200, epoch: 10 | loss: 0.1607615
	speed: 0.0408s/iter; left time: 472.9489s
	iters: 300, epoch: 10 | loss: 0.1656190
	speed: 0.0400s/iter; left time: 460.5302s
	iters: 400, epoch: 10 | loss: 0.1668338
	speed: 0.0409s/iter; left time: 466.3388s
	iters: 500, epoch: 10 | loss: 0.1555477
	speed: 0.0404s/iter; left time: 456.5297s
Epoch: 10 cost time: 23.81862998008728
Epoch: 10, Steps: 562 | Train Loss: 0.1565112 Vali Loss: 0.1360752 Test Loss: 0.1562803
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1936054
	speed: 0.2708s/iter; left time: 3016.6621s
	iters: 200, epoch: 11 | loss: 0.1644210
	speed: 0.0422s/iter; left time: 465.7761s
	iters: 300, epoch: 11 | loss: 0.1552296
	speed: 0.0402s/iter; left time: 440.2660s
	iters: 400, epoch: 11 | loss: 0.1550016
	speed: 0.0412s/iter; left time: 446.2832s
	iters: 500, epoch: 11 | loss: 0.1713640
	speed: 0.0419s/iter; left time: 450.3063s
Epoch: 11 cost time: 24.093294143676758
Epoch: 11, Steps: 562 | Train Loss: 0.1564679 Vali Loss: 0.1359487 Test Loss: 0.1562532
Validation loss decreased (0.136012 --> 0.135949).  Saving model ...
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1572506
	speed: 0.2659s/iter; left time: 2812.5362s
	iters: 200, epoch: 12 | loss: 0.1750095
	speed: 0.0456s/iter; left time: 477.8770s
	iters: 300, epoch: 12 | loss: 0.1678260
	speed: 0.0443s/iter; left time: 459.3454s
	iters: 400, epoch: 12 | loss: 0.1612129
	speed: 0.0436s/iter; left time: 448.0793s
	iters: 500, epoch: 12 | loss: 0.1515730
	speed: 0.0447s/iter; left time: 455.3797s
Epoch: 12 cost time: 25.785461902618408
Epoch: 12, Steps: 562 | Train Loss: 0.1564449 Vali Loss: 0.1357218 Test Loss: 0.1562369
Validation loss decreased (0.135949 --> 0.135722).  Saving model ...
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.1394259
	speed: 0.2925s/iter; left time: 2930.1792s
	iters: 200, epoch: 13 | loss: 0.1405135
	speed: 0.0453s/iter; left time: 449.3241s
	iters: 300, epoch: 13 | loss: 0.1564003
	speed: 0.0421s/iter; left time: 413.6731s
	iters: 400, epoch: 13 | loss: 0.1854889
	speed: 0.0401s/iter; left time: 389.8081s
	iters: 500, epoch: 13 | loss: 0.1430903
	speed: 0.0402s/iter; left time: 386.6209s
Epoch: 13 cost time: 24.67830801010132
Epoch: 13, Steps: 562 | Train Loss: 0.1564362 Vali Loss: 0.1358552 Test Loss: 0.1562301
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.1521566
	speed: 0.2665s/iter; left time: 2519.3850s
	iters: 200, epoch: 14 | loss: 0.1618044
	speed: 0.0400s/iter; left time: 374.4063s
	iters: 300, epoch: 14 | loss: 0.1639429
	speed: 0.0402s/iter; left time: 371.8522s
	iters: 400, epoch: 14 | loss: 0.1530685
	speed: 0.0388s/iter; left time: 355.1639s
	iters: 500, epoch: 14 | loss: 0.1606742
	speed: 0.0422s/iter; left time: 381.7704s
Epoch: 14 cost time: 23.704896926879883
Epoch: 14, Steps: 562 | Train Loss: 0.1564274 Vali Loss: 0.1357606 Test Loss: 0.1562265
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.220703125e-08
	iters: 100, epoch: 15 | loss: 0.1459182
	speed: 0.2585s/iter; left time: 2299.1924s
	iters: 200, epoch: 15 | loss: 0.1593576
	speed: 0.0427s/iter; left time: 375.0373s
	iters: 300, epoch: 15 | loss: 0.1878686
	speed: 0.0460s/iter; left time: 399.7079s
	iters: 400, epoch: 15 | loss: 0.1405033
	speed: 0.0448s/iter; left time: 384.6604s
	iters: 500, epoch: 15 | loss: 0.1753110
	speed: 0.0462s/iter; left time: 392.0170s
Epoch: 15 cost time: 25.608915328979492
Epoch: 15, Steps: 562 | Train Loss: 0.1564245 Vali Loss: 0.1357181 Test Loss: 0.1562247
Validation loss decreased (0.135722 --> 0.135718).  Saving model ...
Updating learning rate to 6.103515625e-09
	iters: 100, epoch: 16 | loss: 0.1651974
	speed: 0.3503s/iter; left time: 2918.0227s
	iters: 200, epoch: 16 | loss: 0.1376157
	speed: 0.0484s/iter; left time: 397.9720s
	iters: 300, epoch: 16 | loss: 0.1450310
	speed: 0.0453s/iter; left time: 368.3835s
	iters: 400, epoch: 16 | loss: 0.1577471
	speed: 0.0463s/iter; left time: 371.9720s
	iters: 500, epoch: 16 | loss: 0.1701841
	speed: 0.0488s/iter; left time: 387.1225s
Epoch: 16 cost time: 27.887224674224854
Epoch: 16, Steps: 562 | Train Loss: 0.1564255 Vali Loss: 0.1359149 Test Loss: 0.1562238
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.0517578125e-09
	iters: 100, epoch: 17 | loss: 0.1646415
	speed: 0.3243s/iter; left time: 2519.7615s
	iters: 200, epoch: 17 | loss: 0.1625632
	speed: 0.0519s/iter; left time: 397.8683s
	iters: 300, epoch: 17 | loss: 0.1625404
	speed: 0.0501s/iter; left time: 379.0114s
	iters: 400, epoch: 17 | loss: 0.1405832
	speed: 0.0498s/iter; left time: 371.9626s
	iters: 500, epoch: 17 | loss: 0.1397146
	speed: 0.0440s/iter; left time: 324.0578s
Epoch: 17 cost time: 28.156680583953857
Epoch: 17, Steps: 562 | Train Loss: 0.1564222 Vali Loss: 0.1358250 Test Loss: 0.1562234
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.52587890625e-09
	iters: 100, epoch: 18 | loss: 0.1526652
	speed: 0.2913s/iter; left time: 2099.4364s
	iters: 200, epoch: 18 | loss: 0.1565804
	speed: 0.0437s/iter; left time: 310.3504s
	iters: 300, epoch: 18 | loss: 0.1354728
	speed: 0.0402s/iter; left time: 281.8221s
	iters: 400, epoch: 18 | loss: 0.1561488
	speed: 0.0385s/iter; left time: 266.0223s
	iters: 500, epoch: 18 | loss: 0.1440912
	speed: 0.0390s/iter; left time: 265.3859s
Epoch: 18 cost time: 24.042818784713745
Epoch: 18, Steps: 562 | Train Loss: 0.1564241 Vali Loss: 0.1359465 Test Loss: 0.1562234
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : DLinear_electricity_336_96_DLinear_custom_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
mse:0.1561511904001236, mae:0.2604970335960388
