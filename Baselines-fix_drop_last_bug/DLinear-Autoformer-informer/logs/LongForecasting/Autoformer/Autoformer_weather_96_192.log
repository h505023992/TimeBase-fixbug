Args in experiment:
Namespace(is_training=1, train_only=False, model_id='Autoformer_weather_96_192', model='Autoformer', data='custom', root_path='./dataset/', data_path='weather.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=192, individual=False, embed_type=0, enc_in=21, dec_in=21, c_out=21, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : Autoformer_weather_96_192_Autoformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36600
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.6122313
	speed: 0.1228s/iter; left time: 4200.8781s
	iters: 200, epoch: 1 | loss: 0.6246231
	speed: 0.1005s/iter; left time: 3428.5235s
	iters: 300, epoch: 1 | loss: 0.6542799
	speed: 0.1014s/iter; left time: 3451.3894s
	iters: 400, epoch: 1 | loss: 0.7863237
	speed: 0.1029s/iter; left time: 3491.2182s
	iters: 500, epoch: 1 | loss: 0.5458469
	speed: 0.1017s/iter; left time: 3438.6972s
	iters: 600, epoch: 1 | loss: 0.6131371
	speed: 0.1035s/iter; left time: 3489.3660s
	iters: 700, epoch: 1 | loss: 0.6427167
	speed: 0.1105s/iter; left time: 3714.8763s
	iters: 800, epoch: 1 | loss: 0.4877813
	speed: 0.1097s/iter; left time: 3677.2945s
	iters: 900, epoch: 1 | loss: 0.9962976
	speed: 0.1095s/iter; left time: 3660.7108s
	iters: 1000, epoch: 1 | loss: 0.6129204
	speed: 0.1072s/iter; left time: 3570.4242s
	iters: 1100, epoch: 1 | loss: 0.5435947
	speed: 0.1092s/iter; left time: 3629.3745s
Epoch: 1 cost time: 122.78199195861816
Epoch: 1, Steps: 1144 | Train Loss: 0.6292522 Vali Loss: 0.6196652 Test Loss: 0.2955341
Validation loss decreased (inf --> 0.619665).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8221942
	speed: 0.6304s/iter; left time: 20851.6613s
	iters: 200, epoch: 2 | loss: 0.6012793
	speed: 0.1109s/iter; left time: 3658.3311s
	iters: 300, epoch: 2 | loss: 0.5563892
	speed: 0.1143s/iter; left time: 3757.2290s
	iters: 400, epoch: 2 | loss: 0.4839690
	speed: 0.1153s/iter; left time: 3778.7073s
	iters: 500, epoch: 2 | loss: 0.4948734
	speed: 0.1111s/iter; left time: 3631.9385s
	iters: 600, epoch: 2 | loss: 0.9171848
	speed: 0.1140s/iter; left time: 3713.9149s
	iters: 700, epoch: 2 | loss: 0.4761747
	speed: 0.1144s/iter; left time: 3715.2027s
	iters: 800, epoch: 2 | loss: 0.4758852
	speed: 0.1246s/iter; left time: 4034.1087s
	iters: 900, epoch: 2 | loss: 0.5070029
	speed: 0.1220s/iter; left time: 3938.2470s
	iters: 1000, epoch: 2 | loss: 0.4537278
	speed: 0.1178s/iter; left time: 3788.9847s
	iters: 1100, epoch: 2 | loss: 0.5725188
	speed: 0.1175s/iter; left time: 3768.2501s
Epoch: 2 cost time: 132.73964738845825
Epoch: 2, Steps: 1144 | Train Loss: 0.5727827 Vali Loss: 0.6042514 Test Loss: 0.2883740
Validation loss decreased (0.619665 --> 0.604251).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5964437
	speed: 0.6515s/iter; left time: 20804.2409s
	iters: 200, epoch: 3 | loss: 0.5827081
	speed: 0.1129s/iter; left time: 3593.8980s
	iters: 300, epoch: 3 | loss: 0.5460260
	speed: 0.1109s/iter; left time: 3518.9478s
	iters: 400, epoch: 3 | loss: 0.4877544
	speed: 0.1103s/iter; left time: 3489.5996s
	iters: 500, epoch: 3 | loss: 0.3769360
	speed: 0.1122s/iter; left time: 3537.7671s
	iters: 600, epoch: 3 | loss: 0.3826748
	speed: 0.1082s/iter; left time: 3401.4816s
	iters: 700, epoch: 3 | loss: 0.8573620
	speed: 0.1028s/iter; left time: 3221.1300s
	iters: 800, epoch: 3 | loss: 0.9519859
	speed: 0.1028s/iter; left time: 3210.1841s
	iters: 900, epoch: 3 | loss: 0.4987230
	speed: 0.1025s/iter; left time: 3190.5536s
	iters: 1000, epoch: 3 | loss: 0.6524718
	speed: 0.1049s/iter; left time: 3255.2540s
	iters: 1100, epoch: 3 | loss: 0.5122064
	speed: 0.1057s/iter; left time: 3270.9301s
Epoch: 3 cost time: 124.96256589889526
Epoch: 3, Steps: 1144 | Train Loss: 0.5411071 Vali Loss: 0.6079791 Test Loss: 0.2965288
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4208116
	speed: 0.6765s/iter; left time: 20827.6009s
	iters: 200, epoch: 4 | loss: 0.3660640
	speed: 0.1159s/iter; left time: 3557.7423s
	iters: 300, epoch: 4 | loss: 0.4186076
	speed: 0.1164s/iter; left time: 3561.8542s
	iters: 400, epoch: 4 | loss: 0.3908945
	speed: 0.1079s/iter; left time: 3289.4801s
	iters: 500, epoch: 4 | loss: 0.5703852
	speed: 0.1067s/iter; left time: 3243.7589s
	iters: 600, epoch: 4 | loss: 0.7337072
	speed: 0.1051s/iter; left time: 3182.2524s
	iters: 700, epoch: 4 | loss: 0.5174114
	speed: 0.1050s/iter; left time: 3170.6352s
	iters: 800, epoch: 4 | loss: 0.8069727
	speed: 0.1116s/iter; left time: 3359.1043s
	iters: 900, epoch: 4 | loss: 0.7868079
	speed: 0.1158s/iter; left time: 3474.1335s
	iters: 1000, epoch: 4 | loss: 0.4537854
	speed: 0.1119s/iter; left time: 3344.8647s
	iters: 1100, epoch: 4 | loss: 0.4626249
	speed: 0.1174s/iter; left time: 3498.0114s
Epoch: 4 cost time: 128.96986770629883
Epoch: 4, Steps: 1144 | Train Loss: 0.5203881 Vali Loss: 0.6091959 Test Loss: 0.3005362
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.4623571
	speed: 0.7235s/iter; left time: 21448.5987s
	iters: 200, epoch: 5 | loss: 0.4433841
	speed: 0.1122s/iter; left time: 3313.5641s
	iters: 300, epoch: 5 | loss: 0.3673753
	speed: 0.1164s/iter; left time: 3428.6141s
	iters: 400, epoch: 5 | loss: 0.4042104
	speed: 0.1103s/iter; left time: 3235.3448s
	iters: 500, epoch: 5 | loss: 1.1163507
	speed: 0.1116s/iter; left time: 3265.1773s
	iters: 600, epoch: 5 | loss: 0.4227085
	speed: 0.1113s/iter; left time: 3243.7676s
	iters: 700, epoch: 5 | loss: 0.3859359
	speed: 0.1204s/iter; left time: 3497.7373s
	iters: 800, epoch: 5 | loss: 0.3536971
	speed: 0.1165s/iter; left time: 3370.8395s
	iters: 900, epoch: 5 | loss: 0.5109245
	speed: 0.1190s/iter; left time: 3431.4642s
	iters: 1000, epoch: 5 | loss: 0.7961226
	speed: 0.1150s/iter; left time: 3305.7961s
	iters: 1100, epoch: 5 | loss: 0.3660818
	speed: 0.1156s/iter; left time: 3311.8861s
Epoch: 5 cost time: 132.0776813030243
Epoch: 5, Steps: 1144 | Train Loss: 0.5100392 Vali Loss: 0.6070430 Test Loss: 0.3014373
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Autoformer_weather_96_192_Autoformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
mse:0.28874194622039795, mae:0.3484165370464325
