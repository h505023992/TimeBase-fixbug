Args in experiment:
Namespace(is_training=1, model_id='traffic_336_720', model='SparseTSF', data='custom', root_path='./dataset/', data_path='traffic.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=720, period_len=24, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=862, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=128, patience=5, learning_rate=0.03, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=2, use_multi_gpu=0, devices='0,1', test_flop=False)
Use GPU: cuda:2
>>>>>>>start training : traffic_336_720_SparseTSF_custom_ftM_sl336_pl720_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11225
val 1037
test 2789
Epoch: 1 cost time: 57.36027765274048
Epoch: 1, Steps: 87 | Train Loss: 0.7748750 Vali Loss: 0.6456001 Test Loss: 0.7821573
Validation loss decreased (inf --> 0.645600).  Saving model ...
Updating learning rate to 0.03
Epoch: 2 cost time: 53.34286093711853
Epoch: 2, Steps: 87 | Train Loss: 0.3760782 Vali Loss: 0.4103977 Test Loss: 0.4767682
Validation loss decreased (0.645600 --> 0.410398).  Saving model ...
Updating learning rate to 0.03
Epoch: 3 cost time: 52.557785987854004
Epoch: 3, Steps: 87 | Train Loss: 0.2905001 Vali Loss: 0.4030090 Test Loss: 0.4685265
Validation loss decreased (0.410398 --> 0.403009).  Saving model ...
Updating learning rate to 0.03
Epoch: 4 cost time: 50.183403730392456
Epoch: 4, Steps: 87 | Train Loss: 0.2872688 Vali Loss: 0.4024950 Test Loss: 0.4680005
Validation loss decreased (0.403009 --> 0.402495).  Saving model ...
Updating learning rate to 0.024
Epoch: 5 cost time: 50.08708047866821
Epoch: 5, Steps: 87 | Train Loss: 0.2864428 Vali Loss: 0.4014257 Test Loss: 0.4655599
Validation loss decreased (0.402495 --> 0.401426).  Saving model ...
Updating learning rate to 0.019200000000000002
Epoch: 6 cost time: 50.64012408256531
Epoch: 6, Steps: 87 | Train Loss: 0.2862772 Vali Loss: 0.4013666 Test Loss: 0.4654977
Validation loss decreased (0.401426 --> 0.401367).  Saving model ...
Updating learning rate to 0.015360000000000004
Epoch: 7 cost time: 50.9303936958313
Epoch: 7, Steps: 87 | Train Loss: 0.2861656 Vali Loss: 0.4019943 Test Loss: 0.4666389
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.012288000000000002
Epoch: 8 cost time: 50.56430125236511
Epoch: 8, Steps: 87 | Train Loss: 0.2860767 Vali Loss: 0.4013819 Test Loss: 0.4648421
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.009830400000000001
Epoch: 9 cost time: 50.06324243545532
Epoch: 9, Steps: 87 | Train Loss: 0.2860158 Vali Loss: 0.4013206 Test Loss: 0.4663109
Validation loss decreased (0.401367 --> 0.401321).  Saving model ...
Updating learning rate to 0.007864320000000003
Epoch: 10 cost time: 50.02293539047241
Epoch: 10, Steps: 87 | Train Loss: 0.2860796 Vali Loss: 0.4022731 Test Loss: 0.4673661
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.006291456000000002
Epoch: 11 cost time: 50.16730189323425
Epoch: 11, Steps: 87 | Train Loss: 0.2861031 Vali Loss: 0.4014487 Test Loss: 0.4648988
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.005033164800000003
Epoch: 12 cost time: 50.83556389808655
Epoch: 12, Steps: 87 | Train Loss: 0.2860250 Vali Loss: 0.4016673 Test Loss: 0.4643538
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.004026531840000002
Epoch: 13 cost time: 50.883079528808594
Epoch: 13, Steps: 87 | Train Loss: 0.2859588 Vali Loss: 0.4018185 Test Loss: 0.4657654
EarlyStopping counter: 4 out of 5
Updating learning rate to 0.0032212254720000015
Epoch: 14 cost time: 50.94842553138733
Epoch: 14, Steps: 87 | Train Loss: 0.2859475 Vali Loss: 0.4007398 Test Loss: 0.4652533
Validation loss decreased (0.401321 --> 0.400740).  Saving model ...
Updating learning rate to 0.0025769803776000016
Epoch: 15 cost time: 50.29229378700256
Epoch: 15, Steps: 87 | Train Loss: 0.2859374 Vali Loss: 0.4009017 Test Loss: 0.4652208
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.002061584302080001
Epoch: 16 cost time: 50.55852270126343
Epoch: 16, Steps: 87 | Train Loss: 0.2858841 Vali Loss: 0.4013281 Test Loss: 0.4658648
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.001649267441664001
Epoch: 17 cost time: 50.39272499084473
Epoch: 17, Steps: 87 | Train Loss: 0.2859562 Vali Loss: 0.4013748 Test Loss: 0.4655518
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.001319413953331201
Epoch: 18 cost time: 50.470210552215576
Epoch: 18, Steps: 87 | Train Loss: 0.2859217 Vali Loss: 0.4020106 Test Loss: 0.4656583
EarlyStopping counter: 4 out of 5
Updating learning rate to 0.0010555311626649609
Epoch: 19 cost time: 50.89298605918884
Epoch: 19, Steps: 87 | Train Loss: 0.2859487 Vali Loss: 0.4012899 Test Loss: 0.4653655
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : traffic_336_720_SparseTSF_custom_ftM_sl336_pl720_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
mse:0.46453797817230225, mae:0.30533090233802795, rse:0.5573287010192871
