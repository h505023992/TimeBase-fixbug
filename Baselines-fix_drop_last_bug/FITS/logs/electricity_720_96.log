Args in experiment:
Namespace(is_training=1, model_id='electricity_720_96', model='FITS', data='custom', root_path='./dataset/', data_path='electricity.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=96, individual=False, embed_type=0, enc_in=321, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, ab=2, hidden_size=1, kernel=5, groups=1, levels=3, stacks=1, num_workers=10, itr=1, train_epochs=30, batch_size=128, patience=5, learning_rate=0.0005, des='Exp', loss='mse', lradj='type3', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False, aug_method='NA', aug_rate=0.5, in_batch_augmentation=False, in_dataset_augmentation=False, data_size=1, aug_data_size=1, seed=0, testset_div=2, test_time_train=False, train_mode=2, cut_freq=258, base_T=24, H_order=8)
Use GPU: cuda:0
>>>>>>>start training : electricity_720_96_FITS_custom_ftM_sl720_ll48_pl96_H8_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17597
val 2537
test 5165
Model(
  (freq_upsampler): Linear(in_features=258, out_features=292, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  3095405568.0
params:  75628.0
Trainable parameters:  75628
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.7744257
	speed: 0.2509s/iter; left time: 1006.5474s
Epoch: 1 cost time: 33.913883447647095
Epoch: 1, Steps: 137 | Train Loss: 0.8743441 Vali Loss: 0.6689003 Test Loss: 0.7600266
Validation loss decreased (inf --> 0.668900).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.6349057
	speed: 0.5374s/iter; left time: 2081.8167s
Epoch: 2 cost time: 33.40066695213318
Epoch: 2, Steps: 137 | Train Loss: 0.6637231 Vali Loss: 0.5929542 Test Loss: 0.6752440
Validation loss decreased (0.668900 --> 0.592954).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.5296993
	speed: 0.5282s/iter; left time: 1973.7941s
Epoch: 3 cost time: 35.11199998855591
Epoch: 3, Steps: 137 | Train Loss: 0.5670418 Vali Loss: 0.5320662 Test Loss: 0.6081327
Validation loss decreased (0.592954 --> 0.532066).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.4774964
	speed: 0.5549s/iter; left time: 1997.5293s
Epoch: 4 cost time: 33.949509143829346
Epoch: 4, Steps: 137 | Train Loss: 0.4894437 Vali Loss: 0.4802975 Test Loss: 0.5511104
Validation loss decreased (0.532066 --> 0.480298).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.4186373
	speed: 0.5373s/iter; left time: 1860.7469s
Epoch: 5 cost time: 34.8433575630188
Epoch: 5, Steps: 137 | Train Loss: 0.4247777 Vali Loss: 0.4304203 Test Loss: 0.4963636
Validation loss decreased (0.480298 --> 0.430420).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.3623978
	speed: 0.5523s/iter; left time: 1837.0862s
Epoch: 6 cost time: 35.03119778633118
Epoch: 6, Steps: 137 | Train Loss: 0.3705481 Vali Loss: 0.3892818 Test Loss: 0.4505074
Validation loss decreased (0.430420 --> 0.389282).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.3216558
	speed: 0.5432s/iter; left time: 1732.1194s
Epoch: 7 cost time: 34.21625757217407
Epoch: 7, Steps: 137 | Train Loss: 0.3245379 Vali Loss: 0.3554334 Test Loss: 0.4128751
Validation loss decreased (0.389282 --> 0.355433).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2805045
	speed: 0.5462s/iter; left time: 1667.0561s
Epoch: 8 cost time: 33.50478410720825
Epoch: 8, Steps: 137 | Train Loss: 0.2853562 Vali Loss: 0.3230113 Test Loss: 0.3767174
Validation loss decreased (0.355433 --> 0.323011).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.2430551
	speed: 0.5180s/iter; left time: 1510.0077s
Epoch: 9 cost time: 32.45252442359924
Epoch: 9, Steps: 137 | Train Loss: 0.2518922 Vali Loss: 0.2989501 Test Loss: 0.3498190
Validation loss decreased (0.323011 --> 0.298950).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.2119608
	speed: 0.5334s/iter; left time: 1481.6667s
Epoch: 10 cost time: 34.828386068344116
Epoch: 10, Steps: 137 | Train Loss: 0.2231200 Vali Loss: 0.2750808 Test Loss: 0.3232285
Validation loss decreased (0.298950 --> 0.275081).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1896170
	speed: 0.5381s/iter; left time: 1421.0642s
Epoch: 11 cost time: 34.25153708457947
Epoch: 11, Steps: 137 | Train Loss: 0.1983203 Vali Loss: 0.2585610 Test Loss: 0.3046106
Validation loss decreased (0.275081 --> 0.258561).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1747584
	speed: 0.5681s/iter; left time: 1422.5852s
Epoch: 12 cost time: 34.65590262413025
Epoch: 12, Steps: 137 | Train Loss: 0.1768562 Vali Loss: 0.2402220 Test Loss: 0.2835828
Validation loss decreased (0.258561 --> 0.240222).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.1526774
	speed: 0.5282s/iter; left time: 1250.3090s
Epoch: 13 cost time: 34.4887170791626
Epoch: 13, Steps: 137 | Train Loss: 0.1583095 Vali Loss: 0.2250217 Test Loss: 0.2669047
Validation loss decreased (0.240222 --> 0.225022).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.1472944
	speed: 0.5527s/iter; left time: 1232.4097s
Epoch: 14 cost time: 34.831029176712036
Epoch: 14, Steps: 137 | Train Loss: 0.1421884 Vali Loss: 0.2113340 Test Loss: 0.2510449
Validation loss decreased (0.225022 --> 0.211334).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.1251089
	speed: 0.5311s/iter; left time: 1111.4975s
Epoch: 15 cost time: 34.2635452747345
Epoch: 15, Steps: 137 | Train Loss: 0.1281391 Vali Loss: 0.2004775 Test Loss: 0.2385543
Validation loss decreased (0.211334 --> 0.200477).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.1130924
	speed: 0.5504s/iter; left time: 1076.6656s
Epoch: 16 cost time: 34.01011657714844
Epoch: 16, Steps: 137 | Train Loss: 0.1159110 Vali Loss: 0.1901544 Test Loss: 0.2273722
Validation loss decreased (0.200477 --> 0.190154).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.1026887
	speed: 0.5286s/iter; left time: 961.4553s
Epoch: 17 cost time: 34.5284264087677
Epoch: 17, Steps: 137 | Train Loss: 0.1052110 Vali Loss: 0.1819748 Test Loss: 0.2179368
Validation loss decreased (0.190154 --> 0.181975).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.0925051
	speed: 0.5498s/iter; left time: 924.8337s
Epoch: 18 cost time: 34.57028150558472
Epoch: 18, Steps: 137 | Train Loss: 0.0958517 Vali Loss: 0.1755026 Test Loss: 0.2100881
Validation loss decreased (0.181975 --> 0.175503).  Saving model ...
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.0848446
	speed: 0.5495s/iter; left time: 848.9773s
Epoch: 19 cost time: 35.01154565811157
Epoch: 19, Steps: 137 | Train Loss: 0.0876536 Vali Loss: 0.1680059 Test Loss: 0.2017999
Validation loss decreased (0.175503 --> 0.168006).  Saving model ...
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.0783386
	speed: 0.5385s/iter; left time: 758.1404s
Epoch: 20 cost time: 35.046266317367554
Epoch: 20, Steps: 137 | Train Loss: 0.0804596 Vali Loss: 0.1622148 Test Loss: 0.1949603
Validation loss decreased (0.168006 --> 0.162215).  Saving model ...
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.0737060
	speed: 0.5261s/iter; left time: 668.6732s
Epoch: 21 cost time: 33.19718027114868
Epoch: 21, Steps: 137 | Train Loss: 0.0741062 Vali Loss: 0.1567039 Test Loss: 0.1884964
Validation loss decreased (0.162215 --> 0.156704).  Saving model ...
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.0677946
	speed: 0.5366s/iter; left time: 608.5305s
Epoch: 22 cost time: 33.96600079536438
Epoch: 22, Steps: 137 | Train Loss: 0.0685558 Vali Loss: 0.1531143 Test Loss: 0.1845789
Validation loss decreased (0.156704 --> 0.153114).  Saving model ...
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.0641000
	speed: 0.5144s/iter; left time: 512.8209s
Epoch: 23 cost time: 32.92682909965515
Epoch: 23, Steps: 137 | Train Loss: 0.0636235 Vali Loss: 0.1487225 Test Loss: 0.1792835
Validation loss decreased (0.153114 --> 0.148722).  Saving model ...
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.0605328
	speed: 0.5540s/iter; left time: 476.4537s
Epoch: 24 cost time: 36.72619438171387
Epoch: 24, Steps: 137 | Train Loss: 0.0592931 Vali Loss: 0.1451790 Test Loss: 0.1750341
Validation loss decreased (0.148722 --> 0.145179).  Saving model ...
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.0534414
	speed: 0.5267s/iter; left time: 380.8366s
Epoch: 25 cost time: 32.73396968841553
Epoch: 25, Steps: 137 | Train Loss: 0.0554609 Vali Loss: 0.1424822 Test Loss: 0.1719304
Validation loss decreased (0.145179 --> 0.142482).  Saving model ...
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.0502203
	speed: 0.5414s/iter; left time: 317.2525s
Epoch: 26 cost time: 34.8498010635376
Epoch: 26, Steps: 137 | Train Loss: 0.0520803 Vali Loss: 0.1495314 Test Loss: 0.1685403
Validation loss decreased (0.142482 --> 0.149531).  Saving model ...
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.0485090
	speed: 0.5244s/iter; left time: 235.4360s
Epoch: 27 cost time: 32.79855251312256
Epoch: 27, Steps: 137 | Train Loss: 0.0490845 Vali Loss: 0.1471909 Test Loss: 0.1656620
Validation loss decreased (0.149531 --> 0.147191).  Saving model ...
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.0464375
	speed: 0.5265s/iter; left time: 164.2666s
Epoch: 28 cost time: 33.36647009849548
Epoch: 28, Steps: 137 | Train Loss: 0.0464255 Vali Loss: 0.1453112 Test Loss: 0.1633299
Validation loss decreased (0.147191 --> 0.145311).  Saving model ...
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.0432665
	speed: 0.5540s/iter; left time: 96.9433s
Epoch: 29 cost time: 35.895411014556885
Epoch: 29, Steps: 137 | Train Loss: 0.0440685 Vali Loss: 0.1431434 Test Loss: 0.1611797
Validation loss decreased (0.145311 --> 0.143143).  Saving model ...
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.0421354
	speed: 0.5322s/iter; left time: 20.2249s
Epoch: 30 cost time: 32.70025563240051
Epoch: 30, Steps: 137 | Train Loss: 0.0419860 Vali Loss: 0.1412873 Test Loss: 0.1586080
Validation loss decreased (0.143143 --> 0.141287).  Saving model ...
Updating learning rate to 0.00011296777049628277
train 17597
val 2537
test 5165
Model(
  (freq_upsampler): Linear(in_features=258, out_features=292, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  3095405568.0
params:  75628.0
Trainable parameters:  75628
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.1460315
	speed: 0.2633s/iter; left time: 1056.1105s
Epoch: 1 cost time: 36.3466477394104
Epoch: 1, Steps: 137 | Train Loss: 0.1498134 Vali Loss: 0.1160027 Test Loss: 0.1484696
Validation loss decreased (inf --> 0.116003).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1456352
	speed: 0.5434s/iter; left time: 2105.2630s
Epoch: 2 cost time: 33.652862548828125
Epoch: 2, Steps: 137 | Train Loss: 0.1476973 Vali Loss: 0.1156331 Test Loss: 0.1478995
Validation loss decreased (0.116003 --> 0.115633).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.1442702
	speed: 0.5482s/iter; left time: 2048.6214s
Epoch: 3 cost time: 35.08791732788086
Epoch: 3, Steps: 137 | Train Loss: 0.1474620 Vali Loss: 0.1155697 Test Loss: 0.1477972
Validation loss decreased (0.115633 --> 0.115570).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1489825
	speed: 0.5451s/iter; left time: 1962.3753s
Epoch: 4 cost time: 33.921746253967285
Epoch: 4, Steps: 137 | Train Loss: 0.1473200 Vali Loss: 0.1154883 Test Loss: 0.1476266
Validation loss decreased (0.115570 --> 0.115488).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.1298922
	speed: 0.5270s/iter; left time: 1825.0186s
Epoch: 5 cost time: 33.868900299072266
Epoch: 5, Steps: 137 | Train Loss: 0.1471924 Vali Loss: 0.1154682 Test Loss: 0.1476815
Validation loss decreased (0.115488 --> 0.115468).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1447247
	speed: 0.5599s/iter; left time: 1862.2901s
Epoch: 6 cost time: 34.713791608810425
Epoch: 6, Steps: 137 | Train Loss: 0.1471828 Vali Loss: 0.1155572 Test Loss: 0.1475297
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.1481929
	speed: 0.5280s/iter; left time: 1683.8481s
Epoch: 7 cost time: 32.53251385688782
Epoch: 7, Steps: 137 | Train Loss: 0.1471596 Vali Loss: 0.1154912 Test Loss: 0.1475289
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1415115
	speed: 0.5538s/iter; left time: 1690.1835s
Epoch: 8 cost time: 36.14382576942444
Epoch: 8, Steps: 137 | Train Loss: 0.1470792 Vali Loss: 0.1154200 Test Loss: 0.1475103
Validation loss decreased (0.115468 --> 0.115420).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1467838
	speed: 0.5378s/iter; left time: 1567.7057s
Epoch: 9 cost time: 33.75625014305115
Epoch: 9, Steps: 137 | Train Loss: 0.1470601 Vali Loss: 0.1154478 Test Loss: 0.1473889
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1472596
	speed: 0.5647s/iter; left time: 1568.6142s
Epoch: 10 cost time: 35.73051476478577
Epoch: 10, Steps: 137 | Train Loss: 0.1469891 Vali Loss: 0.1156065 Test Loss: 0.1473648
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1487431
	speed: 0.5290s/iter; left time: 1396.9707s
Epoch: 11 cost time: 33.62402057647705
Epoch: 11, Steps: 137 | Train Loss: 0.1470212 Vali Loss: 0.1155061 Test Loss: 0.1474782
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1400900
	speed: 0.5420s/iter; left time: 1357.1526s
Epoch: 12 cost time: 34.34537672996521
Epoch: 12, Steps: 137 | Train Loss: 0.1469962 Vali Loss: 0.1155289 Test Loss: 0.1473586
EarlyStopping counter: 4 out of 5
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.1413524
	speed: 0.5423s/iter; left time: 1283.5234s
Epoch: 13 cost time: 33.87377381324768
Epoch: 13, Steps: 137 | Train Loss: 0.1469119 Vali Loss: 0.1149691 Test Loss: 0.1472742
Validation loss decreased (0.115420 --> 0.114969).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.1274386
	speed: 0.5288s/iter; left time: 1179.2778s
Epoch: 14 cost time: 33.58437895774841
Epoch: 14, Steps: 137 | Train Loss: 0.1469912 Vali Loss: 0.1152771 Test Loss: 0.1472412
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.1453264
	speed: 0.5483s/iter; left time: 1147.6612s
Epoch: 15 cost time: 34.86002159118652
Epoch: 15, Steps: 137 | Train Loss: 0.1469505 Vali Loss: 0.1152425 Test Loss: 0.1473128
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.1417516
	speed: 0.5388s/iter; left time: 1053.8353s
Epoch: 16 cost time: 33.220163106918335
Epoch: 16, Steps: 137 | Train Loss: 0.1468977 Vali Loss: 0.1153811 Test Loss: 0.1473191
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.1425776
	speed: 0.5546s/iter; left time: 1008.7384s
Epoch: 17 cost time: 34.755127906799316
Epoch: 17, Steps: 137 | Train Loss: 0.1468759 Vali Loss: 0.1151281 Test Loss: 0.1472498
EarlyStopping counter: 4 out of 5
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.1407248
	speed: 0.5371s/iter; left time: 903.4372s
Epoch: 18 cost time: 33.384838819503784
Epoch: 18, Steps: 137 | Train Loss: 0.1468907 Vali Loss: 0.1153273 Test Loss: 0.1472608
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : electricity_720_96_FITS_custom_ftM_sl720_ll48_pl96_H8_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
mse:0.14670511543750763, mae:0.2352035492658615, rse:0.36748218536376953, corr:[0.4656626  0.46925914 0.47073206 0.4709846  0.4713243  0.47141346
 0.4715008  0.4715687  0.471128   0.4711318  0.4709784  0.47050756
 0.47053325 0.47060698 0.47052515 0.47045004 0.47036391 0.47050163
 0.4705989  0.47047088 0.47050574 0.47056335 0.47056028 0.4708454
 0.47104195 0.4712344  0.47127306 0.47116187 0.47120067 0.4710818
 0.47077614 0.4706773  0.47057962 0.4705136  0.47052342 0.47036234
 0.47021925 0.47018802 0.47009036 0.47002167 0.47002655 0.4700466
 0.47005796 0.46988428 0.46964127 0.46950087 0.4695198  0.4697728
 0.46998572 0.47011214 0.47030628 0.47035995 0.47022077 0.4701677
 0.47012728 0.47001082 0.46991453 0.46991    0.46994567 0.46983954
 0.46973965 0.469786   0.4697469  0.46970734 0.46976158 0.46968922
 0.46967342 0.4696661  0.46946627 0.46935904 0.46937513 0.46935087
 0.46937358 0.46941608 0.46937805 0.4693431  0.46920183 0.4690145
 0.46880367 0.46866572 0.46876884 0.4687326  0.46861017 0.46867746
 0.46856695 0.46850246 0.46854404 0.46840945 0.4686506  0.46878612
 0.4685361  0.46861193 0.46837297 0.46836525 0.46848166 0.46874988]
