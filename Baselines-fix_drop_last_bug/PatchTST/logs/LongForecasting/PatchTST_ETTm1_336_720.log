Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='ETTm1', data_path='ETTm1.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='TST', model='PatchTST', model_id='336_720', moving_avg=25, n_heads=16, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.4, pred_len=720, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : 336_720_PatchTST_ETTm1_ftM_sl336_ll48_pl720_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33505
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.5275346
	speed: 0.1050s/iter; left time: 2730.8734s
	iters: 200, epoch: 1 | loss: 0.5143183
	speed: 0.0879s/iter; left time: 2277.0212s
Epoch: 1 cost time: 25.326756238937378
Epoch: 1, Steps: 261 | Train Loss: 0.5553763 Vali Loss: 1.0185059 Test Loss: 0.4817162
Validation loss decreased (inf --> 1.018506).  Saving model ...
Updating learning rate to 4.147996316662011e-06
	iters: 100, epoch: 2 | loss: 0.4812536
	speed: 0.7198s/iter; left time: 18528.9019s
	iters: 200, epoch: 2 | loss: 0.4867122
	speed: 0.1311s/iter; left time: 3362.1435s
Epoch: 2 cost time: 34.646358013153076
Epoch: 2, Steps: 261 | Train Loss: 0.4717082 Vali Loss: 0.9810855 Test Loss: 0.4527153
Validation loss decreased (1.018506 --> 0.981085).  Saving model ...
Updating learning rate to 4.591072645408634e-06
	iters: 100, epoch: 3 | loss: 0.4320683
	speed: 0.6290s/iter; left time: 16025.6217s
	iters: 200, epoch: 3 | loss: 0.4512843
	speed: 0.1372s/iter; left time: 3481.6661s
Epoch: 3 cost time: 36.86240863800049
Epoch: 3, Steps: 261 | Train Loss: 0.4494220 Vali Loss: 0.9662845 Test Loss: 0.4429416
Validation loss decreased (0.981085 --> 0.966285).  Saving model ...
Updating learning rate to 5.326496750212602e-06
	iters: 100, epoch: 4 | loss: 0.4487696
	speed: 0.7773s/iter; left time: 19601.4026s
	iters: 200, epoch: 4 | loss: 0.4417039
	speed: 0.1275s/iter; left time: 3203.5514s
Epoch: 4 cost time: 35.32349705696106
Epoch: 4, Steps: 261 | Train Loss: 0.4385977 Vali Loss: 0.9642735 Test Loss: 0.4384021
Validation loss decreased (0.966285 --> 0.964273).  Saving model ...
Updating learning rate to 6.349733628628268e-06
	iters: 100, epoch: 5 | loss: 0.4154954
	speed: 0.6930s/iter; left time: 17296.3834s
	iters: 200, epoch: 5 | loss: 0.4624048
	speed: 0.1308s/iter; left time: 3252.2914s
Epoch: 5 cost time: 35.16283655166626
Epoch: 5, Steps: 261 | Train Loss: 0.4328275 Vali Loss: 0.9646799 Test Loss: 0.4355029
EarlyStopping counter: 1 out of 20
Updating learning rate to 7.654473476944045e-06
	iters: 100, epoch: 6 | loss: 0.4564934
	speed: 0.6259s/iter; left time: 15456.3343s
	iters: 200, epoch: 6 | loss: 0.4284861
	speed: 0.1293s/iter; left time: 3180.2432s
Epoch: 6 cost time: 35.03433871269226
Epoch: 6, Steps: 261 | Train Loss: 0.4292304 Vali Loss: 0.9604472 Test Loss: 0.4334039
Validation loss decreased (0.964273 --> 0.960447).  Saving model ...
Updating learning rate to 9.232670599670218e-06
	iters: 100, epoch: 7 | loss: 0.4308772
	speed: 0.7163s/iter; left time: 17502.9767s
	iters: 200, epoch: 7 | loss: 0.4287737
	speed: 0.1323s/iter; left time: 3219.5139s
Epoch: 7 cost time: 34.87877130508423
Epoch: 7, Steps: 261 | Train Loss: 0.4266445 Vali Loss: 0.9610348 Test Loss: 0.4316508
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.1074593023426382e-05
	iters: 100, epoch: 8 | loss: 0.4163188
	speed: 0.6602s/iter; left time: 15960.6608s
	iters: 200, epoch: 8 | loss: 0.3777026
	speed: 0.1320s/iter; left time: 3178.2394s
Epoch: 8 cost time: 34.93190407752991
Epoch: 8, Steps: 261 | Train Loss: 0.4241658 Vali Loss: 0.9567057 Test Loss: 0.4297989
Validation loss decreased (0.960447 --> 0.956706).  Saving model ...
Updating learning rate to 1.3168882509283648e-05
	iters: 100, epoch: 9 | loss: 0.4320642
	speed: 0.6718s/iter; left time: 16065.8331s
	iters: 200, epoch: 9 | loss: 0.3865951
	speed: 0.1088s/iter; left time: 2590.8261s
Epoch: 9 cost time: 28.74727511405945
Epoch: 9, Steps: 261 | Train Loss: 0.4214758 Vali Loss: 0.9506720 Test Loss: 0.4266505
Validation loss decreased (0.956706 --> 0.950672).  Saving model ...
Updating learning rate to 1.5502624593494887e-05
	iters: 100, epoch: 10 | loss: 0.4242887
	speed: 0.4781s/iter; left time: 11307.4730s
	iters: 200, epoch: 10 | loss: 0.4340458
	speed: 0.0860s/iter; left time: 2025.6509s
Epoch: 10 cost time: 23.1534161567688
Epoch: 10, Steps: 261 | Train Loss: 0.4176288 Vali Loss: 0.9564004 Test Loss: 0.4210830
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.806142822470586e-05
	iters: 100, epoch: 11 | loss: 0.3936320
	speed: 0.6133s/iter; left time: 14344.6042s
	iters: 200, epoch: 11 | loss: 0.4421805
	speed: 0.1249s/iter; left time: 2908.1590s
Epoch: 11 cost time: 34.18782043457031
Epoch: 11, Steps: 261 | Train Loss: 0.4136058 Vali Loss: 0.9503807 Test Loss: 0.4166190
Validation loss decreased (0.950672 --> 0.950381).  Saving model ...
Updating learning rate to 2.0829514506563195e-05
	iters: 100, epoch: 12 | loss: 0.3959425
	speed: 0.6978s/iter; left time: 16139.4409s
	iters: 200, epoch: 12 | loss: 0.4215536
	speed: 0.1160s/iter; left time: 2672.6183s
Epoch: 12 cost time: 31.85372042655945
Epoch: 12, Steps: 261 | Train Loss: 0.4101477 Vali Loss: 0.9494895 Test Loss: 0.4149141
Validation loss decreased (0.950381 --> 0.949489).  Saving model ...
Updating learning rate to 2.3789813998487008e-05
	iters: 100, epoch: 13 | loss: 0.4150920
	speed: 0.6280s/iter; left time: 14360.9494s
	iters: 200, epoch: 13 | loss: 0.3972218
	speed: 0.1109s/iter; left time: 2524.7773s
Epoch: 13 cost time: 30.46890878677368
Epoch: 13, Steps: 261 | Train Loss: 0.4068097 Vali Loss: 0.9459605 Test Loss: 0.4139130
Validation loss decreased (0.949489 --> 0.945961).  Saving model ...
Updating learning rate to 2.6924071974601397e-05
	iters: 100, epoch: 14 | loss: 0.4131837
	speed: 0.7117s/iter; left time: 16089.8429s
	iters: 200, epoch: 14 | loss: 0.4110183
	speed: 0.1305s/iter; left time: 2936.5328s
Epoch: 14 cost time: 34.72981595993042
Epoch: 14, Steps: 261 | Train Loss: 0.4037683 Vali Loss: 0.9589325 Test Loss: 0.4155798
EarlyStopping counter: 1 out of 20
Updating learning rate to 3.0212960991742456e-05
	iters: 100, epoch: 15 | loss: 0.3589090
	speed: 0.6514s/iter; left time: 14557.0263s
	iters: 200, epoch: 15 | loss: 0.3832163
	speed: 0.0905s/iter; left time: 2013.4323s
Epoch: 15 cost time: 25.879781246185303
Epoch: 15, Steps: 261 | Train Loss: 0.4007127 Vali Loss: 0.9464656 Test Loss: 0.4155635
EarlyStopping counter: 2 out of 20
Updating learning rate to 3.363620007239161e-05
	iters: 100, epoch: 16 | loss: 0.3865490
	speed: 0.3201s/iter; left time: 7070.8296s
	iters: 200, epoch: 16 | loss: 0.4391501
	speed: 0.0730s/iter; left time: 1604.1172s
Epoch: 16 cost time: 19.18201518058777
Epoch: 16, Steps: 261 | Train Loss: 0.3977904 Vali Loss: 0.9455223 Test Loss: 0.4178982
Validation loss decreased (0.945961 --> 0.945522).  Saving model ...
Updating learning rate to 3.717267976759092e-05
	iters: 100, epoch: 17 | loss: 0.4132484
	speed: 0.6319s/iter; left time: 13790.3623s
	iters: 200, epoch: 17 | loss: 0.3710919
	speed: 0.1407s/iter; left time: 3057.0155s
Epoch: 17 cost time: 38.24271893501282
Epoch: 17, Steps: 261 | Train Loss: 0.3951197 Vali Loss: 0.9439021 Test Loss: 0.4195441
Validation loss decreased (0.945522 --> 0.943902).  Saving model ...
Updating learning rate to 4.0800592328638756e-05
	iters: 100, epoch: 18 | loss: 0.3572130
	speed: 0.7003s/iter; left time: 15101.7487s
	iters: 200, epoch: 18 | loss: 0.3886709
	speed: 0.1254s/iter; left time: 2691.8067s
Epoch: 18 cost time: 33.0120415687561
Epoch: 18, Steps: 261 | Train Loss: 0.3924875 Vali Loss: 0.9490960 Test Loss: 0.4211574
EarlyStopping counter: 1 out of 20
Updating learning rate to 4.449756618485984e-05
	iters: 100, epoch: 19 | loss: 0.3916698
	speed: 0.5630s/iter; left time: 11994.5954s
	iters: 200, epoch: 19 | loss: 0.3758058
	speed: 0.1027s/iter; left time: 2177.0065s
Epoch: 19 cost time: 27.765094995498657
Epoch: 19, Steps: 261 | Train Loss: 0.3895243 Vali Loss: 0.9573168 Test Loss: 0.4204397
EarlyStopping counter: 2 out of 20
Updating learning rate to 4.824080389819096e-05
	iters: 100, epoch: 20 | loss: 0.3774812
	speed: 0.5236s/iter; left time: 11017.1269s
	iters: 200, epoch: 20 | loss: 0.3814356
	speed: 0.1286s/iter; left time: 2693.0223s
Epoch: 20 cost time: 32.37608098983765
Epoch: 20, Steps: 261 | Train Loss: 0.3864058 Vali Loss: 0.9597177 Test Loss: 0.4233656
EarlyStopping counter: 3 out of 20
Updating learning rate to 5.2007222743883666e-05
	iters: 100, epoch: 21 | loss: 0.4191751
	speed: 0.6614s/iter; left time: 13743.8859s
	iters: 200, epoch: 21 | loss: 0.4346372
	speed: 0.1063s/iter; left time: 2198.0885s
Epoch: 21 cost time: 29.563318729400635
Epoch: 21, Steps: 261 | Train Loss: 0.3829042 Vali Loss: 0.9625800 Test Loss: 0.4210964
EarlyStopping counter: 4 out of 20
Updating learning rate to 5.577359705043091e-05
	iters: 100, epoch: 22 | loss: 0.3753912
	speed: 0.5330s/iter; left time: 10936.6120s
	iters: 200, epoch: 22 | loss: 0.3817935
	speed: 0.1028s/iter; left time: 2098.5468s
Epoch: 22 cost time: 28.45913052558899
Epoch: 22, Steps: 261 | Train Loss: 0.3792287 Vali Loss: 0.9548461 Test Loss: 0.4264047
EarlyStopping counter: 5 out of 20
Updating learning rate to 5.951670142097692e-05
	iters: 100, epoch: 23 | loss: 0.3636037
	speed: 0.6822s/iter; left time: 13820.8161s
	iters: 200, epoch: 23 | loss: 0.3355734
	speed: 0.1307s/iter; left time: 2634.8614s
Epoch: 23 cost time: 34.955026626586914
Epoch: 23, Steps: 261 | Train Loss: 0.3757053 Vali Loss: 0.9669551 Test Loss: 0.4300590
EarlyStopping counter: 6 out of 20
Updating learning rate to 6.321345395303321e-05
	iters: 100, epoch: 24 | loss: 0.3850843
	speed: 0.6329s/iter; left time: 12656.1770s
	iters: 200, epoch: 24 | loss: 0.3620352
	speed: 0.1216s/iter; left time: 2418.9842s
Epoch: 24 cost time: 32.49109482765198
Epoch: 24, Steps: 261 | Train Loss: 0.3720377 Vali Loss: 0.9798834 Test Loss: 0.4271018
EarlyStopping counter: 7 out of 20
Updating learning rate to 6.6841058573335e-05
	iters: 100, epoch: 25 | loss: 0.3811295
	speed: 0.6778s/iter; left time: 13377.0156s
	iters: 200, epoch: 25 | loss: 0.3681088
	speed: 0.1370s/iter; left time: 2690.3397s
Epoch: 25 cost time: 37.170594215393066
Epoch: 25, Steps: 261 | Train Loss: 0.3684391 Vali Loss: 0.9876097 Test Loss: 0.4295007
EarlyStopping counter: 8 out of 20
Updating learning rate to 7.037714561012768e-05
	iters: 100, epoch: 26 | loss: 0.3567944
	speed: 0.6540s/iter; left time: 12736.7418s
	iters: 200, epoch: 26 | loss: 0.3560425
	speed: 0.1198s/iter; left time: 2321.6105s
Epoch: 26 cost time: 32.096147537231445
Epoch: 26, Steps: 261 | Train Loss: 0.3643577 Vali Loss: 0.9887998 Test Loss: 0.4317475
EarlyStopping counter: 9 out of 20
Updating learning rate to 7.379990973604285e-05
	iters: 100, epoch: 27 | loss: 0.3351373
	speed: 0.6460s/iter; left time: 12412.0341s
	iters: 200, epoch: 27 | loss: 0.3557805
	speed: 0.1349s/iter; left time: 2579.0360s
Epoch: 27 cost time: 36.294105529785156
Epoch: 27, Steps: 261 | Train Loss: 0.3606538 Vali Loss: 0.9907462 Test Loss: 0.4286948
EarlyStopping counter: 10 out of 20
Updating learning rate to 7.708824443093723e-05
	iters: 100, epoch: 28 | loss: 0.3717182
	speed: 0.7000s/iter; left time: 13268.5354s
	iters: 200, epoch: 28 | loss: 0.3565194
	speed: 0.1376s/iter; left time: 2594.4402s
Epoch: 28 cost time: 38.42715811729431
Epoch: 28, Steps: 261 | Train Loss: 0.3562659 Vali Loss: 0.9820071 Test Loss: 0.4358398
EarlyStopping counter: 11 out of 20
Updating learning rate to 8.022187213552767e-05
	iters: 100, epoch: 29 | loss: 0.3378652
	speed: 0.7072s/iter; left time: 13218.8947s
	iters: 200, epoch: 29 | loss: 0.3590125
	speed: 0.1335s/iter; left time: 2481.3446s
Epoch: 29 cost time: 34.94127130508423
Epoch: 29, Steps: 261 | Train Loss: 0.3526657 Vali Loss: 0.9920564 Test Loss: 0.4379398
EarlyStopping counter: 12 out of 20
Updating learning rate to 8.318146929322795e-05
	iters: 100, epoch: 30 | loss: 0.3457681
	speed: 0.6117s/iter; left time: 11275.6319s
	iters: 200, epoch: 30 | loss: 0.3762019
	speed: 0.1224s/iter; left time: 2244.3742s
Epoch: 30 cost time: 32.442604541778564
Epoch: 30, Steps: 261 | Train Loss: 0.3480432 Vali Loss: 1.0137496 Test Loss: 0.4395480
EarlyStopping counter: 13 out of 20
Updating learning rate to 8.59487855091154e-05
	iters: 100, epoch: 31 | loss: 0.3655002
	speed: 0.6850s/iter; left time: 12447.3832s
	iters: 200, epoch: 31 | loss: 0.3343573
	speed: 0.1337s/iter; left time: 2416.4677s
Epoch: 31 cost time: 35.77297759056091
Epoch: 31, Steps: 261 | Train Loss: 0.3441283 Vali Loss: 0.9974095 Test Loss: 0.4421954
EarlyStopping counter: 14 out of 20
Updating learning rate to 8.850675609123214e-05
	iters: 100, epoch: 32 | loss: 0.3478088
	speed: 0.6141s/iter; left time: 10998.2329s
	iters: 200, epoch: 32 | loss: 0.3232834
	speed: 0.1199s/iter; left time: 2134.8118s
Epoch: 32 cost time: 32.114805459976196
Epoch: 32, Steps: 261 | Train Loss: 0.3402867 Vali Loss: 1.0023172 Test Loss: 0.4456348
EarlyStopping counter: 15 out of 20
Updating learning rate to 9.083960728023302e-05
	iters: 100, epoch: 33 | loss: 0.3045778
	speed: 0.7051s/iter; left time: 12443.4508s
	iters: 200, epoch: 33 | loss: 0.3376756
	speed: 0.1456s/iter; left time: 2555.9975s
Epoch: 33 cost time: 38.463852882385254
Epoch: 33, Steps: 261 | Train Loss: 0.3365050 Vali Loss: 0.9911892 Test Loss: 0.4447955
EarlyStopping counter: 16 out of 20
Updating learning rate to 9.293295351848083e-05
	iters: 100, epoch: 34 | loss: 0.3267502
	speed: 0.6573s/iter; left time: 11428.5429s
	iters: 200, epoch: 34 | loss: 0.3074545
	speed: 0.1051s/iter; left time: 1817.5773s
Epoch: 34 cost time: 28.908031702041626
Epoch: 34, Steps: 261 | Train Loss: 0.3325032 Vali Loss: 1.0145928 Test Loss: 0.4478252
EarlyStopping counter: 17 out of 20
Updating learning rate to 9.47738861587773e-05
	iters: 100, epoch: 35 | loss: 0.3320439
	speed: 0.2691s/iter; left time: 4608.2500s
	iters: 200, epoch: 35 | loss: 0.3213235
	speed: 0.0569s/iter; left time: 968.2860s
Epoch: 35 cost time: 14.782218933105469
Epoch: 35, Steps: 261 | Train Loss: 0.3289066 Vali Loss: 1.0161417 Test Loss: 0.4485388
EarlyStopping counter: 18 out of 20
Updating learning rate to 9.635105306570629e-05
	iters: 100, epoch: 36 | loss: 0.3228537
	speed: 0.5545s/iter; left time: 9351.4944s
	iters: 200, epoch: 36 | loss: 0.3356067
	speed: 0.1452s/iter; left time: 2433.6786s
Epoch: 36 cost time: 39.60900044441223
Epoch: 36, Steps: 261 | Train Loss: 0.3253439 Vali Loss: 1.0203605 Test Loss: 0.4463963
EarlyStopping counter: 19 out of 20
Updating learning rate to 9.765472861872672e-05
	iters: 100, epoch: 37 | loss: 0.3050668
	speed: 0.7792s/iter; left time: 12939.1420s
	iters: 200, epoch: 37 | loss: 0.3105877
	speed: 0.1448s/iter; left time: 2390.6567s
Epoch: 37 cost time: 38.48044514656067
Epoch: 37, Steps: 261 | Train Loss: 0.3213089 Vali Loss: 1.0267346 Test Loss: 0.4472161
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : 336_720_PatchTST_ETTm1_ftM_sl336_ll48_pl720_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
mse:0.41949403285980225, mae:0.4245733320713043, rse:0.6162169575691223
