Args in experiment:
Namespace(is_training=1, train_only=False, model_id='Autoformer_weather_96_336', model='Autoformer', data='custom', root_path='./dataset/', data_path='weather.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=336, individual=False, embed_type=0, enc_in=21, dec_in=21, c_out=21, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : Autoformer_weather_96_336_Autoformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36456
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.7005050
	speed: 0.1515s/iter; left time: 5167.0101s
	iters: 200, epoch: 1 | loss: 0.5935317
	speed: 0.1203s/iter; left time: 4090.3575s
	iters: 300, epoch: 1 | loss: 0.5018339
	speed: 0.1224s/iter; left time: 4150.6809s
	iters: 400, epoch: 1 | loss: 0.4816575
	speed: 0.1199s/iter; left time: 4051.7839s
	iters: 500, epoch: 1 | loss: 0.4849082
	speed: 0.1219s/iter; left time: 4107.4591s
	iters: 600, epoch: 1 | loss: 0.5112881
	speed: 0.1195s/iter; left time: 4016.0011s
	iters: 700, epoch: 1 | loss: 0.7318485
	speed: 0.1228s/iter; left time: 4115.3687s
	iters: 800, epoch: 1 | loss: 0.5081711
	speed: 0.1186s/iter; left time: 3961.8343s
	iters: 900, epoch: 1 | loss: 0.4891647
	speed: 0.1233s/iter; left time: 4106.9709s
	iters: 1000, epoch: 1 | loss: 0.4598772
	speed: 0.1188s/iter; left time: 3942.6848s
	iters: 1100, epoch: 1 | loss: 0.8507057
	speed: 0.1242s/iter; left time: 4112.6640s
Epoch: 1 cost time: 141.1761531829834
Epoch: 1, Steps: 1140 | Train Loss: 0.6604426 Vali Loss: 0.6746811 Test Loss: 0.3412854
Validation loss decreased (inf --> 0.674681).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5017104
	speed: 0.6219s/iter; left time: 20497.8179s
	iters: 200, epoch: 2 | loss: 0.7964809
	speed: 0.1214s/iter; left time: 3988.5498s
	iters: 300, epoch: 2 | loss: 0.7592120
	speed: 0.1210s/iter; left time: 3964.8866s
	iters: 400, epoch: 2 | loss: 0.8542150
	speed: 0.1210s/iter; left time: 3950.6396s
	iters: 500, epoch: 2 | loss: 0.7795069
	speed: 0.1213s/iter; left time: 3948.0296s
	iters: 600, epoch: 2 | loss: 0.5716672
	speed: 0.1234s/iter; left time: 4005.4245s
	iters: 700, epoch: 2 | loss: 1.0607589
	speed: 0.1215s/iter; left time: 3932.5438s
	iters: 800, epoch: 2 | loss: 0.7609199
	speed: 0.1248s/iter; left time: 4026.1518s
	iters: 900, epoch: 2 | loss: 0.5482898
	speed: 0.1229s/iter; left time: 3954.0814s
	iters: 1000, epoch: 2 | loss: 0.5196066
	speed: 0.1285s/iter; left time: 4119.8211s
	iters: 1100, epoch: 2 | loss: 0.6830662
	speed: 0.1215s/iter; left time: 3882.4704s
Epoch: 2 cost time: 140.39802050590515
Epoch: 2, Steps: 1140 | Train Loss: 0.6164958 Vali Loss: 0.6763437 Test Loss: 0.3574162
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5167869
	speed: 0.6506s/iter; left time: 20703.2558s
	iters: 200, epoch: 3 | loss: 0.5699051
	speed: 0.1193s/iter; left time: 3785.3112s
	iters: 300, epoch: 3 | loss: 0.4321373
	speed: 0.1200s/iter; left time: 3795.5375s
	iters: 400, epoch: 3 | loss: 0.7857729
	speed: 0.1209s/iter; left time: 3812.2599s
	iters: 500, epoch: 3 | loss: 1.0395149
	speed: 0.1227s/iter; left time: 3855.1349s
	iters: 600, epoch: 3 | loss: 0.5377290
	speed: 0.1191s/iter; left time: 3730.7444s
	iters: 700, epoch: 3 | loss: 0.5469787
	speed: 0.1221s/iter; left time: 3811.4041s
	iters: 800, epoch: 3 | loss: 0.4359754
	speed: 0.1213s/iter; left time: 3775.5687s
	iters: 900, epoch: 3 | loss: 0.7498912
	speed: 0.1207s/iter; left time: 3745.2692s
	iters: 1000, epoch: 3 | loss: 0.4723026
	speed: 0.1228s/iter; left time: 3797.3566s
	iters: 1100, epoch: 3 | loss: 0.5033632
	speed: 0.1222s/iter; left time: 3767.1433s
Epoch: 3 cost time: 138.9324140548706
Epoch: 3, Steps: 1140 | Train Loss: 0.6004743 Vali Loss: 0.6740635 Test Loss: 0.3577824
Validation loss decreased (0.674681 --> 0.674064).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4488648
	speed: 0.6451s/iter; left time: 19793.7758s
	iters: 200, epoch: 4 | loss: 0.4901752
	speed: 0.1242s/iter; left time: 3799.6076s
	iters: 300, epoch: 4 | loss: 0.5870619
	speed: 0.1270s/iter; left time: 3869.8184s
	iters: 400, epoch: 4 | loss: 0.4200568
	speed: 0.1423s/iter; left time: 4322.9604s
	iters: 500, epoch: 4 | loss: 0.5312983
	speed: 0.1307s/iter; left time: 3956.5570s
	iters: 600, epoch: 4 | loss: 0.4329004
	speed: 0.1277s/iter; left time: 3855.5475s
	iters: 700, epoch: 4 | loss: 0.6950318
	speed: 0.1315s/iter; left time: 3955.5809s
	iters: 800, epoch: 4 | loss: 0.8362998
	speed: 0.1239s/iter; left time: 3713.6503s
	iters: 900, epoch: 4 | loss: 0.6856907
	speed: 0.1243s/iter; left time: 3713.0829s
	iters: 1000, epoch: 4 | loss: 0.6306274
	speed: 0.1210s/iter; left time: 3604.4766s
	iters: 1100, epoch: 4 | loss: 0.4202524
	speed: 0.1229s/iter; left time: 3649.0038s
Epoch: 4 cost time: 145.43034434318542
Epoch: 4, Steps: 1140 | Train Loss: 0.5906158 Vali Loss: 0.6723126 Test Loss: 0.3627860
Validation loss decreased (0.674064 --> 0.672313).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5081173
	speed: 0.6317s/iter; left time: 18661.0476s
	iters: 200, epoch: 5 | loss: 0.6919719
	speed: 0.1202s/iter; left time: 3537.9061s
	iters: 300, epoch: 5 | loss: 0.5477663
	speed: 0.1226s/iter; left time: 3596.9480s
	iters: 400, epoch: 5 | loss: 0.4903331
	speed: 0.1204s/iter; left time: 3521.5554s
	iters: 500, epoch: 5 | loss: 0.4327912
	speed: 0.1213s/iter; left time: 3535.7600s
	iters: 600, epoch: 5 | loss: 0.5095302
	speed: 0.1198s/iter; left time: 3479.1873s
	iters: 700, epoch: 5 | loss: 0.4681382
	speed: 0.1208s/iter; left time: 3496.4686s
	iters: 800, epoch: 5 | loss: 0.4368708
	speed: 0.1211s/iter; left time: 3493.4448s
	iters: 900, epoch: 5 | loss: 0.6293185
	speed: 0.1217s/iter; left time: 3496.7823s
	iters: 1000, epoch: 5 | loss: 0.4742119
	speed: 0.1216s/iter; left time: 3484.0241s
	iters: 1100, epoch: 5 | loss: 0.5169770
	speed: 0.1209s/iter; left time: 3449.8046s
Epoch: 5 cost time: 138.66220712661743
Epoch: 5, Steps: 1140 | Train Loss: 0.5840613 Vali Loss: 0.6778675 Test Loss: 0.3556381
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.4644365
	speed: 0.6610s/iter; left time: 18773.6527s
	iters: 200, epoch: 6 | loss: 0.4660584
	speed: 0.1262s/iter; left time: 3571.9516s
	iters: 300, epoch: 6 | loss: 0.6866149
	speed: 0.1253s/iter; left time: 3534.6364s
	iters: 400, epoch: 6 | loss: 0.5010709
	speed: 0.1255s/iter; left time: 3526.5432s
	iters: 500, epoch: 6 | loss: 0.4548388
	speed: 0.1208s/iter; left time: 3382.2172s
	iters: 600, epoch: 6 | loss: 0.5939441
	speed: 0.1215s/iter; left time: 3389.5958s
	iters: 700, epoch: 6 | loss: 0.4933192
	speed: 0.1240s/iter; left time: 3447.4247s
	iters: 800, epoch: 6 | loss: 0.5340904
	speed: 0.1224s/iter; left time: 3391.3751s
	iters: 900, epoch: 6 | loss: 0.7400004
	speed: 0.1190s/iter; left time: 3284.2971s
	iters: 1000, epoch: 6 | loss: 0.5308216
	speed: 0.1253s/iter; left time: 3446.1449s
	iters: 1100, epoch: 6 | loss: 0.4286201
	speed: 0.1192s/iter; left time: 3266.7300s
Epoch: 6 cost time: 141.2158920764923
Epoch: 6, Steps: 1140 | Train Loss: 0.5820219 Vali Loss: 0.6807389 Test Loss: 0.3620829
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4986205
	speed: 0.6409s/iter; left time: 17471.3713s
	iters: 200, epoch: 7 | loss: 0.4649302
	speed: 0.1203s/iter; left time: 3267.6459s
	iters: 300, epoch: 7 | loss: 0.4273539
	speed: 0.1236s/iter; left time: 3345.0079s
	iters: 400, epoch: 7 | loss: 0.4327576
	speed: 0.1195s/iter; left time: 3221.7418s
	iters: 500, epoch: 7 | loss: 0.5256907
	speed: 0.1216s/iter; left time: 3266.0388s
	iters: 600, epoch: 7 | loss: 0.5100043
	speed: 0.1190s/iter; left time: 3185.4575s
	iters: 700, epoch: 7 | loss: 0.5153981
	speed: 0.1229s/iter; left time: 3276.4271s
	iters: 800, epoch: 7 | loss: 0.4264947
	speed: 0.1181s/iter; left time: 3137.4713s
	iters: 900, epoch: 7 | loss: 0.5170559
	speed: 0.1189s/iter; left time: 3146.2180s
	iters: 1000, epoch: 7 | loss: 0.5922799
	speed: 0.1203s/iter; left time: 3171.1934s
	iters: 1100, epoch: 7 | loss: 0.5293456
	speed: 0.1213s/iter; left time: 3184.5196s
Epoch: 7 cost time: 138.25466203689575
Epoch: 7, Steps: 1140 | Train Loss: 0.5809224 Vali Loss: 0.6792145 Test Loss: 0.3605625
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Autoformer_weather_96_336_Autoformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
mse:0.36279910802841187, mae:0.4025634527206421
