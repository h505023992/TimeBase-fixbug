Args in experiment:
Namespace(is_training=1, model_id='ETTm2_96_96', model='FITS', data='ETTm2', root_path='./dataset/', data_path='ETTm2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=96, individual=False, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, ab=2, hidden_size=1, kernel=5, groups=1, levels=3, stacks=1, num_workers=10, itr=1, train_epochs=30, batch_size=128, patience=5, learning_rate=0.0005, des='Exp', loss='mse', lradj='type3', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False, aug_method='NA', aug_rate=0.5, in_batch_augmentation=False, in_dataset_augmentation=False, data_size=1, aug_data_size=1, seed=0, testset_div=2, test_time_train=False, train_mode=2, cut_freq=40, base_T=24, H_order=6)
Use GPU: cuda:0
>>>>>>>start training : ETTm2_96_96_FITS_ETTm2_ftM_sl96_ll48_pl96_H6_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=40, out_features=80, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  2867200.0
params:  3280.0
Trainable parameters:  3280
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2170637
	speed: 0.0485s/iter; left time: 385.4338s
	iters: 200, epoch: 1 | loss: 0.2124984
	speed: 0.0424s/iter; left time: 332.2205s
Epoch: 1 cost time: 12.304810285568237
Epoch: 1, Steps: 268 | Train Loss: 0.2123903 Vali Loss: 0.1520078 Test Loss: 0.2142212
Validation loss decreased (inf --> 0.152008).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2095609
	speed: 0.2302s/iter; left time: 1766.0447s
	iters: 200, epoch: 2 | loss: 0.1242579
	speed: 0.0441s/iter; left time: 334.0582s
Epoch: 2 cost time: 12.817956447601318
Epoch: 2, Steps: 268 | Train Loss: 0.1532672 Vali Loss: 0.1415232 Test Loss: 0.1993120
Validation loss decreased (0.152008 --> 0.141523).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.1242304
	speed: 0.2022s/iter; left time: 1497.1732s
	iters: 200, epoch: 3 | loss: 0.1112102
	speed: 0.0435s/iter; left time: 317.7335s
Epoch: 3 cost time: 12.335858345031738
Epoch: 3, Steps: 268 | Train Loss: 0.1379435 Vali Loss: 0.1372031 Test Loss: 0.1934360
Validation loss decreased (0.141523 --> 0.137203).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1337476
	speed: 0.2037s/iter; left time: 1453.6363s
	iters: 200, epoch: 4 | loss: 0.1257847
	speed: 0.0415s/iter; left time: 291.8096s
Epoch: 4 cost time: 12.106913566589355
Epoch: 4, Steps: 268 | Train Loss: 0.1307457 Vali Loss: 0.1339659 Test Loss: 0.1895074
Validation loss decreased (0.137203 --> 0.133966).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.1648691
	speed: 0.2163s/iter; left time: 1485.6551s
	iters: 200, epoch: 5 | loss: 0.1242986
	speed: 0.0458s/iter; left time: 310.2696s
Epoch: 5 cost time: 13.1395902633667
Epoch: 5, Steps: 268 | Train Loss: 0.1267117 Vali Loss: 0.1318147 Test Loss: 0.1868510
Validation loss decreased (0.133966 --> 0.131815).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.0904148
	speed: 0.2118s/iter; left time: 1398.2483s
	iters: 200, epoch: 6 | loss: 0.1584356
	speed: 0.0435s/iter; left time: 282.5096s
Epoch: 6 cost time: 12.675029039382935
Epoch: 6, Steps: 268 | Train Loss: 0.1243575 Vali Loss: 0.1303849 Test Loss: 0.1850629
Validation loss decreased (0.131815 --> 0.130385).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.1344285
	speed: 0.2219s/iter; left time: 1405.1653s
	iters: 200, epoch: 7 | loss: 0.1259493
	speed: 0.0446s/iter; left time: 278.2749s
Epoch: 7 cost time: 12.597906112670898
Epoch: 7, Steps: 268 | Train Loss: 0.1227636 Vali Loss: 0.1293213 Test Loss: 0.1838136
Validation loss decreased (0.130385 --> 0.129321).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1539884
	speed: 0.2173s/iter; left time: 1318.0052s
	iters: 200, epoch: 8 | loss: 0.0973443
	speed: 0.0431s/iter; left time: 256.9136s
Epoch: 8 cost time: 12.615370035171509
Epoch: 8, Steps: 268 | Train Loss: 0.1221610 Vali Loss: 0.1286555 Test Loss: 0.1831447
Validation loss decreased (0.129321 --> 0.128655).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1262512
	speed: 0.1990s/iter; left time: 1153.4946s
	iters: 200, epoch: 9 | loss: 0.1382991
	speed: 0.0317s/iter; left time: 180.3456s
Epoch: 9 cost time: 10.365135669708252
Epoch: 9, Steps: 268 | Train Loss: 0.1215973 Vali Loss: 0.1282904 Test Loss: 0.1826909
Validation loss decreased (0.128655 --> 0.128290).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.0872117
	speed: 0.1728s/iter; left time: 955.1644s
	iters: 200, epoch: 10 | loss: 0.1226557
	speed: 0.0320s/iter; left time: 173.9668s
Epoch: 10 cost time: 9.502887725830078
Epoch: 10, Steps: 268 | Train Loss: 0.1214017 Vali Loss: 0.1281778 Test Loss: 0.1824735
Validation loss decreased (0.128290 --> 0.128178).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.0740399
	speed: 0.1635s/iter; left time: 860.0335s
	iters: 200, epoch: 11 | loss: 0.1126878
	speed: 0.0326s/iter; left time: 168.2188s
Epoch: 11 cost time: 9.491002082824707
Epoch: 11, Steps: 268 | Train Loss: 0.1212980 Vali Loss: 0.1280434 Test Loss: 0.1823052
Validation loss decreased (0.128178 --> 0.128043).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1066239
	speed: 0.1526s/iter; left time: 762.1787s
	iters: 200, epoch: 12 | loss: 0.1162289
	speed: 0.0332s/iter; left time: 162.4346s
Epoch: 12 cost time: 9.892216444015503
Epoch: 12, Steps: 268 | Train Loss: 0.1212251 Vali Loss: 0.1280611 Test Loss: 0.1822661
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.1036035
	speed: 0.2019s/iter; left time: 953.9275s
	iters: 200, epoch: 13 | loss: 0.0926148
	speed: 0.0451s/iter; left time: 208.8001s
Epoch: 13 cost time: 12.546029567718506
Epoch: 13, Steps: 268 | Train Loss: 0.1211217 Vali Loss: 0.1281011 Test Loss: 0.1822220
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.1640556
	speed: 0.2013s/iter; left time: 897.0998s
	iters: 200, epoch: 14 | loss: 0.1209505
	speed: 0.0406s/iter; left time: 176.7838s
Epoch: 14 cost time: 11.772046089172363
Epoch: 14, Steps: 268 | Train Loss: 0.1211311 Vali Loss: 0.1280644 Test Loss: 0.1822107
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.1538863
	speed: 0.2104s/iter; left time: 881.3062s
	iters: 200, epoch: 15 | loss: 0.1247861
	speed: 0.0431s/iter; left time: 176.2428s
Epoch: 15 cost time: 12.251049995422363
Epoch: 15, Steps: 268 | Train Loss: 0.1210063 Vali Loss: 0.1279489 Test Loss: 0.1821703
Validation loss decreased (0.128043 --> 0.127949).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.0973241
	speed: 0.2016s/iter; left time: 790.4916s
	iters: 200, epoch: 16 | loss: 0.1179740
	speed: 0.0391s/iter; left time: 149.3691s
Epoch: 16 cost time: 11.878873109817505
Epoch: 16, Steps: 268 | Train Loss: 0.1211335 Vali Loss: 0.1280250 Test Loss: 0.1821194
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.1539864
	speed: 0.2037s/iter; left time: 744.2297s
	iters: 200, epoch: 17 | loss: 0.1288555
	speed: 0.0432s/iter; left time: 153.4024s
Epoch: 17 cost time: 11.960283517837524
Epoch: 17, Steps: 268 | Train Loss: 0.1210023 Vali Loss: 0.1279397 Test Loss: 0.1820627
Validation loss decreased (0.127949 --> 0.127940).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.0942164
	speed: 0.2022s/iter; left time: 684.4827s
	iters: 200, epoch: 18 | loss: 0.0966966
	speed: 0.0401s/iter; left time: 131.7413s
Epoch: 18 cost time: 12.119203567504883
Epoch: 18, Steps: 268 | Train Loss: 0.1210654 Vali Loss: 0.1280778 Test Loss: 0.1821383
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.1282295
	speed: 0.2043s/iter; left time: 636.8936s
	iters: 200, epoch: 19 | loss: 0.1652841
	speed: 0.0421s/iter; left time: 127.0325s
Epoch: 19 cost time: 11.787911653518677
Epoch: 19, Steps: 268 | Train Loss: 0.1210690 Vali Loss: 0.1280133 Test Loss: 0.1821535
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.0909017
	speed: 0.2004s/iter; left time: 570.8076s
	iters: 200, epoch: 20 | loss: 0.1908256
	speed: 0.0387s/iter; left time: 106.3535s
Epoch: 20 cost time: 11.964446544647217
Epoch: 20, Steps: 268 | Train Loss: 0.1210480 Vali Loss: 0.1280209 Test Loss: 0.1821264
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.1205137
	speed: 0.2155s/iter; left time: 556.2644s
	iters: 200, epoch: 21 | loss: 0.1320218
	speed: 0.0452s/iter; left time: 112.1140s
Epoch: 21 cost time: 13.423732280731201
Epoch: 21, Steps: 268 | Train Loss: 0.1209237 Vali Loss: 0.1280911 Test Loss: 0.1821178
EarlyStopping counter: 4 out of 5
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.0933623
	speed: 0.2176s/iter; left time: 503.2680s
	iters: 200, epoch: 22 | loss: 0.1322336
	speed: 0.0414s/iter; left time: 91.6915s
Epoch: 22 cost time: 12.68726396560669
Epoch: 22, Steps: 268 | Train Loss: 0.1210706 Vali Loss: 0.1282158 Test Loss: 0.1821850
EarlyStopping counter: 5 out of 5
Early stopping
train 34369
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=40, out_features=80, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  2867200.0
params:  3280.0
Trainable parameters:  3280
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.1881613
	speed: 0.0518s/iter; left time: 411.7221s
	iters: 200, epoch: 1 | loss: 0.1921703
	speed: 0.0372s/iter; left time: 291.4134s
Epoch: 1 cost time: 11.965743064880371
Epoch: 1, Steps: 268 | Train Loss: 0.2385295 Vali Loss: 0.1279334 Test Loss: 0.1818654
Validation loss decreased (inf --> 0.127933).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2099586
	speed: 0.2006s/iter; left time: 1539.1195s
	iters: 200, epoch: 2 | loss: 0.2125469
	speed: 0.0438s/iter; left time: 331.4124s
Epoch: 2 cost time: 12.304489135742188
Epoch: 2, Steps: 268 | Train Loss: 0.2381691 Vali Loss: 0.1276202 Test Loss: 0.1815591
Validation loss decreased (0.127933 --> 0.127620).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2133936
	speed: 0.2037s/iter; left time: 1508.7468s
	iters: 200, epoch: 3 | loss: 0.1960420
	speed: 0.0381s/iter; left time: 278.1540s
Epoch: 3 cost time: 11.934831380844116
Epoch: 3, Steps: 268 | Train Loss: 0.2381594 Vali Loss: 0.1278814 Test Loss: 0.1817080
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.3153027
	speed: 0.1999s/iter; left time: 1426.5977s
	iters: 200, epoch: 4 | loss: 0.1582103
	speed: 0.0419s/iter; left time: 295.1520s
Epoch: 4 cost time: 12.106671333312988
Epoch: 4, Steps: 268 | Train Loss: 0.2380303 Vali Loss: 0.1279190 Test Loss: 0.1817095
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2472650
	speed: 0.2108s/iter; left time: 1447.7898s
	iters: 200, epoch: 5 | loss: 0.2751633
	speed: 0.0386s/iter; left time: 260.9757s
Epoch: 5 cost time: 11.996713638305664
Epoch: 5, Steps: 268 | Train Loss: 0.2379144 Vali Loss: 0.1281570 Test Loss: 0.1818662
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2649199
	speed: 0.1987s/iter; left time: 1311.4837s
	iters: 200, epoch: 6 | loss: 0.2406400
	speed: 0.0441s/iter; left time: 286.8233s
Epoch: 6 cost time: 12.127887964248657
Epoch: 6, Steps: 268 | Train Loss: 0.2377952 Vali Loss: 0.1280614 Test Loss: 0.1818114
EarlyStopping counter: 4 out of 5
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2765813
	speed: 0.2078s/iter; left time: 1316.1188s
	iters: 200, epoch: 7 | loss: 0.2193006
	speed: 0.0367s/iter; left time: 229.0380s
Epoch: 7 cost time: 11.674503087997437
Epoch: 7, Steps: 268 | Train Loss: 0.2378179 Vali Loss: 0.1281935 Test Loss: 0.1817949
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_96_96_FITS_ETTm2_ftM_sl96_ll48_pl96_H6_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.1823738068342209, mae:0.26560264825820923, rse:0.34624016284942627, corr:[0.57720906 0.571327   0.56920993 0.567546   0.5646169  0.56463814
 0.5620302  0.56185293 0.5602941  0.5597879  0.55828196 0.55713916
 0.5572153  0.5557571  0.55588055 0.5549454  0.55408955 0.55340415
 0.55206937 0.5510535  0.5493991  0.5488648  0.5483255  0.5478573
 0.54739714 0.5464096  0.545978   0.54520357 0.54507256 0.5443984
 0.54301745 0.54232323 0.5413486  0.5411642  0.54083645 0.5401958
 0.5398405  0.539252   0.53864294 0.5378381  0.537159   0.5364135
 0.53604835 0.53608775 0.535751   0.53526837 0.5345084  0.53383785
 0.53313166 0.53183526 0.53083766 0.53009915 0.5293573  0.52861875
 0.5278305  0.5273313  0.52673197 0.5264666  0.52618325 0.52580845
 0.52558327 0.5251245  0.52520394 0.5252315  0.52494645 0.5247993
 0.5245223  0.5245744  0.5245795  0.5246604  0.52488095 0.52489185
 0.5249866  0.52514607 0.5252787  0.5253205  0.52548426 0.5256599
 0.52555597 0.5255584  0.52566034 0.5255153  0.5255015  0.52539426
 0.5252401  0.5251511  0.5249685  0.52482384 0.52460015 0.5244808
 0.5241977  0.52417135 0.52449363 0.52404416 0.5239638  0.5227718 ]
