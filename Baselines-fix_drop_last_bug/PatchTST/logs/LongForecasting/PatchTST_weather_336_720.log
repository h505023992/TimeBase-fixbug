Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='custom', data_path='weather.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=21, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='type3', model='PatchTST', model_id='336_720', moving_avg=25, n_heads=16, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.3, pred_len=720, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : 336_720_PatchTST_custom_ftM_sl336_ll48_pl720_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35832
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.7673959
	speed: 0.2034s/iter; left time: 5654.0418s
	iters: 200, epoch: 1 | loss: 0.7284613
	speed: 0.1913s/iter; left time: 5298.6031s
Epoch: 1 cost time: 55.09312319755554
Epoch: 1, Steps: 279 | Train Loss: 0.8817784 Vali Loss: 0.7661568 Test Loss: 0.3664261
Validation loss decreased (inf --> 0.766157).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7214434
	speed: 0.7396s/iter; left time: 20356.2153s
	iters: 200, epoch: 2 | loss: 0.6154068
	speed: 0.1904s/iter; left time: 5222.4345s
Epoch: 2 cost time: 53.6157500743866
Epoch: 2, Steps: 279 | Train Loss: 0.6557384 Vali Loss: 0.6771212 Test Loss: 0.3324777
Validation loss decreased (0.766157 --> 0.677121).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.5376844
	speed: 0.7509s/iter; left time: 20455.5316s
	iters: 200, epoch: 3 | loss: 0.5977229
	speed: 0.1932s/iter; left time: 5242.6975s
Epoch: 3 cost time: 54.87355852127075
Epoch: 3, Steps: 279 | Train Loss: 0.6283350 Vali Loss: 0.6652746 Test Loss: 0.3277190
Validation loss decreased (0.677121 --> 0.665275).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.6210296
	speed: 0.7391s/iter; left time: 19928.5832s
	iters: 200, epoch: 4 | loss: 0.6657719
	speed: 0.1951s/iter; left time: 5242.4335s
Epoch: 4 cost time: 55.96003723144531
Epoch: 4, Steps: 279 | Train Loss: 0.6216927 Vali Loss: 0.6591929 Test Loss: 0.3248022
Validation loss decreased (0.665275 --> 0.659193).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.6962512
	speed: 0.7229s/iter; left time: 19291.0423s
	iters: 200, epoch: 5 | loss: 0.4881588
	speed: 0.1936s/iter; left time: 5146.7380s
Epoch: 5 cost time: 55.381059885025024
Epoch: 5, Steps: 279 | Train Loss: 0.6164307 Vali Loss: 0.6588855 Test Loss: 0.3238440
Validation loss decreased (0.659193 --> 0.658886).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.5891397
	speed: 0.7534s/iter; left time: 19894.5789s
	iters: 200, epoch: 6 | loss: 0.6013945
	speed: 0.1957s/iter; left time: 5148.0067s
Epoch: 6 cost time: 56.24023175239563
Epoch: 6, Steps: 279 | Train Loss: 0.6136512 Vali Loss: 0.6554448 Test Loss: 0.3224558
Validation loss decreased (0.658886 --> 0.655445).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.5650911
	speed: 0.7389s/iter; left time: 19306.2420s
	iters: 200, epoch: 7 | loss: 0.5896531
	speed: 0.1949s/iter; left time: 5072.7028s
Epoch: 7 cost time: 55.75374913215637
Epoch: 7, Steps: 279 | Train Loss: 0.6112187 Vali Loss: 0.6535264 Test Loss: 0.3216612
Validation loss decreased (0.655445 --> 0.653526).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.5666617
	speed: 0.7294s/iter; left time: 18853.5331s
	iters: 200, epoch: 8 | loss: 0.6055372
	speed: 0.1856s/iter; left time: 4778.0548s
Epoch: 8 cost time: 52.723732709884644
Epoch: 8, Steps: 279 | Train Loss: 0.6095152 Vali Loss: 0.6578217 Test Loss: 0.3220408
EarlyStopping counter: 1 out of 20
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.6264063
	speed: 0.6884s/iter; left time: 17600.8249s
	iters: 200, epoch: 9 | loss: 0.6855682
	speed: 0.1953s/iter; left time: 4974.3989s
Epoch: 9 cost time: 55.28182530403137
Epoch: 9, Steps: 279 | Train Loss: 0.6071946 Vali Loss: 0.6587202 Test Loss: 0.3219120
EarlyStopping counter: 2 out of 20
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.5977318
	speed: 0.7211s/iter; left time: 18237.6752s
	iters: 200, epoch: 10 | loss: 0.7271160
	speed: 0.1934s/iter; left time: 4872.6016s
Epoch: 10 cost time: 55.313655853271484
Epoch: 10, Steps: 279 | Train Loss: 0.6048837 Vali Loss: 0.6591106 Test Loss: 0.3221098
EarlyStopping counter: 3 out of 20
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.5893235
	speed: 0.7254s/iter; left time: 18142.9964s
	iters: 200, epoch: 11 | loss: 0.6513118
	speed: 0.1924s/iter; left time: 4791.7786s
Epoch: 11 cost time: 55.34787178039551
Epoch: 11, Steps: 279 | Train Loss: 0.6027366 Vali Loss: 0.6588457 Test Loss: 0.3223078
EarlyStopping counter: 4 out of 20
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.5069901
	speed: 0.7158s/iter; left time: 17703.5104s
	iters: 200, epoch: 12 | loss: 0.6285700
	speed: 0.1925s/iter; left time: 4741.8796s
Epoch: 12 cost time: 55.08654808998108
Epoch: 12, Steps: 279 | Train Loss: 0.6010319 Vali Loss: 0.6594712 Test Loss: 0.3226315
EarlyStopping counter: 5 out of 20
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.6407533
	speed: 0.7320s/iter; left time: 17899.8666s
	iters: 200, epoch: 13 | loss: 0.5718051
	speed: 0.1982s/iter; left time: 4825.9694s
Epoch: 13 cost time: 55.980626583099365
Epoch: 13, Steps: 279 | Train Loss: 0.5993681 Vali Loss: 0.6555052 Test Loss: 0.3223703
EarlyStopping counter: 6 out of 20
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.7051094
	speed: 0.7426s/iter; left time: 17950.9989s
	iters: 200, epoch: 14 | loss: 0.5340883
	speed: 0.1979s/iter; left time: 4763.1118s
Epoch: 14 cost time: 56.50150465965271
Epoch: 14, Steps: 279 | Train Loss: 0.5979082 Vali Loss: 0.6569171 Test Loss: 0.3218755
EarlyStopping counter: 7 out of 20
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.7044777
	speed: 0.7246s/iter; left time: 17313.4262s
	iters: 200, epoch: 15 | loss: 0.5338886
	speed: 0.2002s/iter; left time: 4763.8942s
Epoch: 15 cost time: 56.51107907295227
Epoch: 15, Steps: 279 | Train Loss: 0.5966317 Vali Loss: 0.6539633 Test Loss: 0.3222440
EarlyStopping counter: 8 out of 20
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.5925318
	speed: 0.7328s/iter; left time: 17305.0399s
	iters: 200, epoch: 16 | loss: 0.6246847
	speed: 0.1920s/iter; left time: 4514.4127s
Epoch: 16 cost time: 55.25418448448181
Epoch: 16, Steps: 279 | Train Loss: 0.5956841 Vali Loss: 0.6570938 Test Loss: 0.3234452
EarlyStopping counter: 9 out of 20
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.5885909
	speed: 0.7286s/iter; left time: 17004.1301s
	iters: 200, epoch: 17 | loss: 0.6206097
	speed: 0.1930s/iter; left time: 4485.5823s
Epoch: 17 cost time: 54.70436477661133
Epoch: 17, Steps: 279 | Train Loss: 0.5949404 Vali Loss: 0.6549906 Test Loss: 0.3231758
EarlyStopping counter: 10 out of 20
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.5520703
	speed: 0.7019s/iter; left time: 16183.5424s
	iters: 200, epoch: 18 | loss: 0.6234140
	speed: 0.1959s/iter; left time: 4497.8797s
Epoch: 18 cost time: 56.04563593864441
Epoch: 18, Steps: 279 | Train Loss: 0.5943232 Vali Loss: 0.6557855 Test Loss: 0.3226581
EarlyStopping counter: 11 out of 20
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.5080776
	speed: 0.7233s/iter; left time: 16476.0376s
	iters: 200, epoch: 19 | loss: 0.5865029
	speed: 0.1941s/iter; left time: 4400.9487s
Epoch: 19 cost time: 55.620540380477905
Epoch: 19, Steps: 279 | Train Loss: 0.5936189 Vali Loss: 0.6551441 Test Loss: 0.3236294
EarlyStopping counter: 12 out of 20
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.5725950
	speed: 0.7201s/iter; left time: 16202.0364s
	iters: 200, epoch: 20 | loss: 0.6691848
	speed: 0.1932s/iter; left time: 4327.6493s
Epoch: 20 cost time: 54.98250150680542
Epoch: 20, Steps: 279 | Train Loss: 0.5928292 Vali Loss: 0.6576551 Test Loss: 0.3231145
EarlyStopping counter: 13 out of 20
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.6791773
	speed: 0.7238s/iter; left time: 16082.8255s
	iters: 200, epoch: 21 | loss: 0.5709105
	speed: 0.1906s/iter; left time: 4215.8187s
Epoch: 21 cost time: 55.47450256347656
Epoch: 21, Steps: 279 | Train Loss: 0.5923297 Vali Loss: 0.6589748 Test Loss: 0.3238460
EarlyStopping counter: 14 out of 20
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.5838637
	speed: 0.6859s/iter; left time: 15050.6201s
	iters: 200, epoch: 22 | loss: 0.5893176
	speed: 0.1963s/iter; left time: 4288.4231s
Epoch: 22 cost time: 55.79787993431091
Epoch: 22, Steps: 279 | Train Loss: 0.5920649 Vali Loss: 0.6576916 Test Loss: 0.3238219
EarlyStopping counter: 15 out of 20
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.6201315
	speed: 0.7079s/iter; left time: 15336.0908s
	iters: 200, epoch: 23 | loss: 0.6185581
	speed: 0.1995s/iter; left time: 4301.4299s
Epoch: 23 cost time: 56.36845254898071
Epoch: 23, Steps: 279 | Train Loss: 0.5911905 Vali Loss: 0.6582168 Test Loss: 0.3239586
EarlyStopping counter: 16 out of 20
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.5528947
	speed: 0.7409s/iter; left time: 15843.9463s
	iters: 200, epoch: 24 | loss: 0.5783516
	speed: 0.1957s/iter; left time: 4165.2775s
Epoch: 24 cost time: 55.84832692146301
Epoch: 24, Steps: 279 | Train Loss: 0.5908217 Vali Loss: 0.6597934 Test Loss: 0.3241359
EarlyStopping counter: 17 out of 20
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.8125313
	speed: 0.7239s/iter; left time: 15278.4161s
	iters: 200, epoch: 25 | loss: 0.5675669
	speed: 0.1969s/iter; left time: 4136.2473s
Epoch: 25 cost time: 56.27566194534302
Epoch: 25, Steps: 279 | Train Loss: 0.5906245 Vali Loss: 0.6588996 Test Loss: 0.3240771
EarlyStopping counter: 18 out of 20
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.5946633
	speed: 0.6662s/iter; left time: 13874.7588s
	iters: 200, epoch: 26 | loss: 0.6226152
	speed: 0.1888s/iter; left time: 3913.1028s
Epoch: 26 cost time: 53.12093544006348
Epoch: 26, Steps: 279 | Train Loss: 0.5903448 Vali Loss: 0.6592009 Test Loss: 0.3241822
EarlyStopping counter: 19 out of 20
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.6331227
	speed: 0.6400s/iter; left time: 13150.8650s
	iters: 200, epoch: 27 | loss: 0.5495015
	speed: 0.1995s/iter; left time: 4079.0198s
Epoch: 27 cost time: 54.73606634140015
Epoch: 27, Steps: 279 | Train Loss: 0.5898468 Vali Loss: 0.6596386 Test Loss: 0.3247747
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : 336_720_PatchTST_custom_ftM_sl336_ll48_pl720_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
mse:0.3210086524486542, mae:0.33470985293388367, rse:0.7455734014511108
