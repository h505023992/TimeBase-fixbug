Args in experiment:
Namespace(is_training=1, train_only=False, model_id='Autoformer_weather_336_336', model='Autoformer', data='custom', root_path='./dataset/', data_path='weather.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=336, individual=False, embed_type=0, enc_in=21, dec_in=21, c_out=21, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : Autoformer_weather_336_336_Autoformer_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36216
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.6181939
	speed: 0.2514s/iter; left time: 8512.4481s
	iters: 200, epoch: 1 | loss: 0.5502012
	speed: 0.2277s/iter; left time: 7686.7398s
	iters: 300, epoch: 1 | loss: 0.7460551
	speed: 0.2248s/iter; left time: 7567.5700s
	iters: 400, epoch: 1 | loss: 0.4451860
	speed: 0.2265s/iter; left time: 7600.9382s
	iters: 500, epoch: 1 | loss: 0.5704982
	speed: 0.2253s/iter; left time: 7539.9540s
	iters: 600, epoch: 1 | loss: 0.5680902
	speed: 0.2144s/iter; left time: 7152.0198s
	iters: 700, epoch: 1 | loss: 0.5669745
	speed: 0.2159s/iter; left time: 7181.1539s
	iters: 800, epoch: 1 | loss: 0.5253442
	speed: 0.2085s/iter; left time: 6912.4748s
	iters: 900, epoch: 1 | loss: 0.6434324
	speed: 0.2093s/iter; left time: 6919.1766s
	iters: 1000, epoch: 1 | loss: 0.4295034
	speed: 0.2108s/iter; left time: 6948.5772s
	iters: 1100, epoch: 1 | loss: 0.7346937
	speed: 0.2106s/iter; left time: 6921.2424s
Epoch: 1 cost time: 249.42509984970093
Epoch: 1, Steps: 1132 | Train Loss: 0.6343691 Vali Loss: 0.7129443 Test Loss: 0.3896192
Validation loss decreased (inf --> 0.712944).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7683170
	speed: 1.1316s/iter; left time: 37036.8984s
	iters: 200, epoch: 2 | loss: 0.7540246
	speed: 0.1988s/iter; left time: 6486.3157s
	iters: 300, epoch: 2 | loss: 0.5750688
	speed: 0.2024s/iter; left time: 6584.0035s
	iters: 400, epoch: 2 | loss: 0.7642792
	speed: 0.2112s/iter; left time: 6849.1104s
	iters: 500, epoch: 2 | loss: 0.4479577
	speed: 0.2170s/iter; left time: 7015.1685s
	iters: 600, epoch: 2 | loss: 0.4226386
	speed: 0.2341s/iter; left time: 7544.5347s
	iters: 700, epoch: 2 | loss: 0.4441820
	speed: 0.2281s/iter; left time: 7327.0280s
	iters: 800, epoch: 2 | loss: 0.4500507
	speed: 0.2240s/iter; left time: 7173.8414s
	iters: 900, epoch: 2 | loss: 0.4618953
	speed: 0.2079s/iter; left time: 6637.0836s
	iters: 1000, epoch: 2 | loss: 0.5619185
	speed: 0.2081s/iter; left time: 6623.0016s
	iters: 1100, epoch: 2 | loss: 0.4892812
	speed: 0.2040s/iter; left time: 6471.7412s
Epoch: 2 cost time: 240.62631607055664
Epoch: 2, Steps: 1132 | Train Loss: 0.5536482 Vali Loss: 0.7436048 Test Loss: 0.4248123
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5545884
	speed: 1.3201s/iter; left time: 41712.3192s
	iters: 200, epoch: 3 | loss: 0.4435186
	speed: 0.2066s/iter; left time: 6508.8008s
	iters: 300, epoch: 3 | loss: 0.4306455
	speed: 0.2069s/iter; left time: 6496.5228s
	iters: 400, epoch: 3 | loss: 0.3938802
	speed: 0.2050s/iter; left time: 6416.1157s
	iters: 500, epoch: 3 | loss: 0.4648840
	speed: 0.2110s/iter; left time: 6582.1713s
	iters: 600, epoch: 3 | loss: 0.6672617
	speed: 0.2180s/iter; left time: 6777.6645s
	iters: 700, epoch: 3 | loss: 0.4178151
	speed: 0.2212s/iter; left time: 6857.1907s
	iters: 800, epoch: 3 | loss: 0.6295706
	speed: 0.2223s/iter; left time: 6868.5923s
	iters: 900, epoch: 3 | loss: 0.4203987
	speed: 0.2232s/iter; left time: 6875.2120s
	iters: 1000, epoch: 3 | loss: 0.4595180
	speed: 0.2278s/iter; left time: 6993.6936s
	iters: 1100, epoch: 3 | loss: 0.8730339
	speed: 0.2292s/iter; left time: 7011.8559s
Epoch: 3 cost time: 246.98735070228577
Epoch: 3, Steps: 1132 | Train Loss: 0.5005869 Vali Loss: 0.7547190 Test Loss: 0.4273319
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3743826
	speed: 1.3568s/iter; left time: 41333.6661s
	iters: 200, epoch: 4 | loss: 0.3714887
	speed: 0.2182s/iter; left time: 6626.9413s
	iters: 300, epoch: 4 | loss: 0.4865653
	speed: 0.2150s/iter; left time: 6508.3038s
	iters: 400, epoch: 4 | loss: 0.5742698
	speed: 0.2161s/iter; left time: 6519.7421s
	iters: 500, epoch: 4 | loss: 0.3665125
	speed: 0.2166s/iter; left time: 6512.1633s
	iters: 600, epoch: 4 | loss: 0.3990466
	speed: 0.2071s/iter; left time: 6206.0260s
	iters: 700, epoch: 4 | loss: 0.7121305
	speed: 0.2094s/iter; left time: 6253.6198s
	iters: 800, epoch: 4 | loss: 0.4517835
	speed: 0.2155s/iter; left time: 6413.4538s
	iters: 900, epoch: 4 | loss: 0.4507128
	speed: 0.2137s/iter; left time: 6340.0230s
	iters: 1000, epoch: 4 | loss: 0.4266422
	speed: 0.2185s/iter; left time: 6461.3651s
	iters: 1100, epoch: 4 | loss: 0.4258655
	speed: 0.2205s/iter; left time: 6497.3824s
Epoch: 4 cost time: 244.9229507446289
Epoch: 4, Steps: 1132 | Train Loss: 0.4690636 Vali Loss: 0.7526157 Test Loss: 0.4386299
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Autoformer_weather_336_336_Autoformer_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
mse:0.3896355926990509, mae:0.42462846636772156
