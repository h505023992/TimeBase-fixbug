Args in experiment:
Namespace(is_training=1, train_only=False, model_id='electricity_720_336', model='Informer', data='custom', root_path='./dataset/', data_path='electricity.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=336, individual=False, embed_type=0, enc_in=321, dec_in=321, c_out=321, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : electricity_720_336_Informer_custom_ftM_sl720_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17357
val 2297
test 4925
	iters: 100, epoch: 1 | loss: 0.8281037
	speed: 0.5687s/iter; left time: 9207.7080s
	iters: 200, epoch: 1 | loss: 0.8288684
	speed: 0.5250s/iter; left time: 8447.3902s
	iters: 300, epoch: 1 | loss: 0.7442629
	speed: 0.5038s/iter; left time: 8056.3456s
	iters: 400, epoch: 1 | loss: 0.7541795
	speed: 0.5106s/iter; left time: 8113.3390s
	iters: 500, epoch: 1 | loss: 0.7165316
	speed: 0.5195s/iter; left time: 8202.7718s
Epoch: 1 cost time: 285.9836883544922
Epoch: 1, Steps: 543 | Train Loss: 0.8004956 Vali Loss: 0.7338054 Test Loss: 0.9021820
Validation loss decreased (inf --> 0.733805).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7062135
	speed: 1.5320s/iter; left time: 23972.5798s
	iters: 200, epoch: 2 | loss: 0.6099183
	speed: 0.5236s/iter; left time: 8140.7293s
	iters: 300, epoch: 2 | loss: 0.6018979
	speed: 0.5133s/iter; left time: 7929.5317s
	iters: 400, epoch: 2 | loss: 0.4076140
	speed: 0.5029s/iter; left time: 7719.1701s
	iters: 500, epoch: 2 | loss: 0.3193797
	speed: 0.5290s/iter; left time: 8066.0573s
Epoch: 2 cost time: 283.4138536453247
Epoch: 2, Steps: 543 | Train Loss: 0.5435728 Vali Loss: 0.4210953 Test Loss: 0.5197852
Validation loss decreased (0.733805 --> 0.421095).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2766091
	speed: 1.5582s/iter; left time: 23536.5598s
	iters: 200, epoch: 3 | loss: 0.2683147
	speed: 0.5163s/iter; left time: 7746.6900s
	iters: 300, epoch: 3 | loss: 0.2571692
	speed: 0.5143s/iter; left time: 7665.1798s
	iters: 400, epoch: 3 | loss: 0.2414721
	speed: 0.5340s/iter; left time: 7905.8264s
	iters: 500, epoch: 3 | loss: 0.2534989
	speed: 0.5258s/iter; left time: 7732.0168s
Epoch: 3 cost time: 285.2548348903656
Epoch: 3, Steps: 543 | Train Loss: 0.2672556 Vali Loss: 0.3456052 Test Loss: 0.4192817
Validation loss decreased (0.421095 --> 0.345605).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2303380
	speed: 1.5409s/iter; left time: 22438.5761s
	iters: 200, epoch: 4 | loss: 0.2393111
	speed: 0.5229s/iter; left time: 7562.6056s
	iters: 300, epoch: 4 | loss: 0.2301197
	speed: 0.5375s/iter; left time: 7719.4589s
	iters: 400, epoch: 4 | loss: 0.2131347
	speed: 0.5289s/iter; left time: 7543.3196s
	iters: 500, epoch: 4 | loss: 0.2251795
	speed: 0.5389s/iter; left time: 7632.5716s
Epoch: 4 cost time: 289.24714636802673
Epoch: 4, Steps: 543 | Train Loss: 0.2326088 Vali Loss: 0.3224534 Test Loss: 0.4169619
Validation loss decreased (0.345605 --> 0.322453).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2114588
	speed: 1.5233s/iter; left time: 21354.9093s
	iters: 200, epoch: 5 | loss: 0.2240615
	speed: 0.5176s/iter; left time: 7204.5875s
	iters: 300, epoch: 5 | loss: 0.2034975
	speed: 0.5266s/iter; left time: 7277.3819s
	iters: 400, epoch: 5 | loss: 0.2262543
	speed: 0.5401s/iter; left time: 7409.0118s
	iters: 500, epoch: 5 | loss: 0.2267504
	speed: 0.5316s/iter; left time: 7239.7896s
Epoch: 5 cost time: 286.8720750808716
Epoch: 5, Steps: 543 | Train Loss: 0.2207524 Vali Loss: 0.3146545 Test Loss: 0.4024699
Validation loss decreased (0.322453 --> 0.314654).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2056623
	speed: 1.5223s/iter; left time: 20514.5991s
	iters: 200, epoch: 6 | loss: 0.2386093
	speed: 0.5270s/iter; left time: 7048.8166s
	iters: 300, epoch: 6 | loss: 0.2098465
	speed: 0.5362s/iter; left time: 7118.8627s
	iters: 400, epoch: 6 | loss: 0.2100108
	speed: 0.5207s/iter; left time: 6860.5770s
	iters: 500, epoch: 6 | loss: 0.2100282
	speed: 0.5295s/iter; left time: 6923.5651s
Epoch: 6 cost time: 288.0941095352173
Epoch: 6, Steps: 543 | Train Loss: 0.2158707 Vali Loss: 0.3065625 Test Loss: 0.4047972
Validation loss decreased (0.314654 --> 0.306563).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2033388
	speed: 1.4911s/iter; left time: 19284.2815s
	iters: 200, epoch: 7 | loss: 0.2107259
	speed: 0.5134s/iter; left time: 6588.1694s
	iters: 300, epoch: 7 | loss: 0.2131640
	speed: 0.5153s/iter; left time: 6560.7900s
	iters: 400, epoch: 7 | loss: 0.2110389
	speed: 0.5091s/iter; left time: 6431.0253s
	iters: 500, epoch: 7 | loss: 0.2168532
	speed: 0.5034s/iter; left time: 6309.6289s
Epoch: 7 cost time: 277.6904225349426
Epoch: 7, Steps: 543 | Train Loss: 0.2126929 Vali Loss: 0.3096313 Test Loss: 0.4073372
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2061381
	speed: 1.4986s/iter; left time: 18567.2139s
	iters: 200, epoch: 8 | loss: 0.2055757
	speed: 0.5272s/iter; left time: 6479.7507s
	iters: 300, epoch: 8 | loss: 0.2104860
	speed: 0.5219s/iter; left time: 6361.4220s
	iters: 400, epoch: 8 | loss: 0.2158016
	speed: 0.5300s/iter; left time: 6407.8037s
	iters: 500, epoch: 8 | loss: 0.2108610
	speed: 0.5076s/iter; left time: 6085.8445s
Epoch: 8 cost time: 284.0425205230713
Epoch: 8, Steps: 543 | Train Loss: 0.2115977 Vali Loss: 0.3055239 Test Loss: 0.4067826
Validation loss decreased (0.306563 --> 0.305524).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2226861
	speed: 1.5148s/iter; left time: 17945.6298s
	iters: 200, epoch: 9 | loss: 0.2070272
	speed: 0.5356s/iter; left time: 6291.2566s
	iters: 300, epoch: 9 | loss: 0.2185039
	speed: 0.5318s/iter; left time: 6193.9116s
	iters: 400, epoch: 9 | loss: 0.2131528
	speed: 0.5221s/iter; left time: 6029.0007s
	iters: 500, epoch: 9 | loss: 0.2165471
	speed: 0.5295s/iter; left time: 6061.6528s
Epoch: 9 cost time: 288.6808772087097
Epoch: 9, Steps: 543 | Train Loss: 0.2108239 Vali Loss: 0.3075365 Test Loss: 0.4059067
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2189520
	speed: 1.5413s/iter; left time: 17422.6587s
	iters: 200, epoch: 10 | loss: 0.2112280
	speed: 0.5258s/iter; left time: 5891.4480s
	iters: 300, epoch: 10 | loss: 0.2088325
	speed: 0.5343s/iter; left time: 5932.7998s
	iters: 400, epoch: 10 | loss: 0.2104182
	speed: 0.5286s/iter; left time: 5816.2679s
	iters: 500, epoch: 10 | loss: 0.2134187
	speed: 0.5225s/iter; left time: 5697.7658s
Epoch: 10 cost time: 287.38682198524475
Epoch: 10, Steps: 543 | Train Loss: 0.2103846 Vali Loss: 0.3048399 Test Loss: 0.4042996
Validation loss decreased (0.305524 --> 0.304840).  Saving model ...
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.2087697
	speed: 1.4820s/iter; left time: 15947.5074s
	iters: 200, epoch: 11 | loss: 0.2142073
	speed: 0.5177s/iter; left time: 5519.6222s
	iters: 300, epoch: 11 | loss: 0.2111206
	speed: 0.5190s/iter; left time: 5480.8857s
	iters: 400, epoch: 11 | loss: 0.2091461
	speed: 0.5340s/iter; left time: 5585.7288s
	iters: 500, epoch: 11 | loss: 0.2241847
	speed: 0.5206s/iter; left time: 5393.8778s
Epoch: 11 cost time: 283.30079340934753
Epoch: 11, Steps: 543 | Train Loss: 0.2101944 Vali Loss: 0.3052378 Test Loss: 0.4059086
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.2205106
	speed: 1.5583s/iter; left time: 15922.7607s
	iters: 200, epoch: 12 | loss: 0.2061237
	speed: 0.5307s/iter; left time: 5369.3585s
	iters: 300, epoch: 12 | loss: 0.2246336
	speed: 0.5292s/iter; left time: 5301.9023s
	iters: 400, epoch: 12 | loss: 0.2084480
	speed: 0.5250s/iter; left time: 5206.6496s
	iters: 500, epoch: 12 | loss: 0.2116275
	speed: 0.5369s/iter; left time: 5271.5718s
Epoch: 12 cost time: 288.38709020614624
Epoch: 12, Steps: 543 | Train Loss: 0.2101563 Vali Loss: 0.3063665 Test Loss: 0.4048859
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.2052834
	speed: 1.5302s/iter; left time: 14804.7831s
	iters: 200, epoch: 13 | loss: 0.2058297
	speed: 0.5286s/iter; left time: 5061.3729s
	iters: 300, epoch: 13 | loss: 0.2157820
	speed: 0.5268s/iter; left time: 4991.7744s
	iters: 400, epoch: 13 | loss: 0.2132666
	speed: 0.5321s/iter; left time: 4988.8176s
	iters: 500, epoch: 13 | loss: 0.2056569
	speed: 0.5249s/iter; left time: 4868.8758s
Epoch: 13 cost time: 285.80187821388245
Epoch: 13, Steps: 543 | Train Loss: 0.2100568 Vali Loss: 0.3071343 Test Loss: 0.4064451
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : electricity_720_336_Informer_custom_ftM_sl720_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4925
mse:0.40412062406539917, mae:0.4595276117324829
