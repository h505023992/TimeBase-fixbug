Args in experiment:
Namespace(is_training=1, model_id='weather_192_192', model='SparseTSF', data='custom', root_path='./dataset/', data_path='weather.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=192, label_len=48, pred_len=192, period_len=4, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=21, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=256, patience=5, learning_rate=0.02, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=2, use_multi_gpu=0, devices='0,1', test_flop=False)
Use GPU: cuda:2
>>>>>>>start training : weather_192_192_SparseTSF_custom_ftM_sl192_pl192_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36504
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.5828956
	speed: 0.1319s/iter; left time: 548.9987s
Epoch: 1 cost time: 16.247268199920654
Epoch: 1, Steps: 142 | Train Loss: 0.6848566 Vali Loss: 0.5732207 Test Loss: 0.2501330
Validation loss decreased (inf --> 0.573221).  Saving model ...
Updating learning rate to 0.02
	iters: 100, epoch: 2 | loss: 0.5048156
	speed: 0.2456s/iter; left time: 986.8828s
Epoch: 2 cost time: 13.337270498275757
Epoch: 2, Steps: 142 | Train Loss: 0.5564234 Vali Loss: 0.5324569 Test Loss: 0.2338956
Validation loss decreased (0.573221 --> 0.532457).  Saving model ...
Updating learning rate to 0.02
	iters: 100, epoch: 3 | loss: 0.6646500
	speed: 0.2397s/iter; left time: 929.5061s
Epoch: 3 cost time: 12.427446842193604
Epoch: 3, Steps: 142 | Train Loss: 0.5463980 Vali Loss: 0.5300596 Test Loss: 0.2310030
Validation loss decreased (0.532457 --> 0.530060).  Saving model ...
Updating learning rate to 0.02
	iters: 100, epoch: 4 | loss: 0.5090206
	speed: 0.2434s/iter; left time: 908.9327s
Epoch: 4 cost time: 11.993474006652832
Epoch: 4, Steps: 142 | Train Loss: 0.5437278 Vali Loss: 0.5324405 Test Loss: 0.2319277
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.016
	iters: 100, epoch: 5 | loss: 0.6675687
	speed: 0.2353s/iter; left time: 845.2771s
Epoch: 5 cost time: 12.522359371185303
Epoch: 5, Steps: 142 | Train Loss: 0.5421483 Vali Loss: 0.5303400 Test Loss: 0.2291846
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.012800000000000002
	iters: 100, epoch: 6 | loss: 0.6578431
	speed: 0.2346s/iter; left time: 809.4325s
Epoch: 6 cost time: 10.843506574630737
Epoch: 6, Steps: 142 | Train Loss: 0.5419126 Vali Loss: 0.5239671 Test Loss: 0.2292584
Validation loss decreased (0.530060 --> 0.523967).  Saving model ...
Updating learning rate to 0.010240000000000003
	iters: 100, epoch: 7 | loss: 0.6229930
	speed: 0.2244s/iter; left time: 742.3994s
Epoch: 7 cost time: 12.009480476379395
Epoch: 7, Steps: 142 | Train Loss: 0.5424887 Vali Loss: 0.5317098 Test Loss: 0.2327399
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.008192000000000001
	iters: 100, epoch: 8 | loss: 0.6853903
	speed: 0.2219s/iter; left time: 702.6023s
Epoch: 8 cost time: 11.586593627929688
Epoch: 8, Steps: 142 | Train Loss: 0.5410680 Vali Loss: 0.5267792 Test Loss: 0.2291527
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.0065536000000000014
	iters: 100, epoch: 9 | loss: 0.6542412
	speed: 0.2558s/iter; left time: 773.7796s
Epoch: 9 cost time: 13.087846279144287
Epoch: 9, Steps: 142 | Train Loss: 0.5408350 Vali Loss: 0.5238004 Test Loss: 0.2305316
Validation loss decreased (0.523967 --> 0.523800).  Saving model ...
Updating learning rate to 0.005242880000000002
	iters: 100, epoch: 10 | loss: 0.5528514
	speed: 0.2304s/iter; left time: 664.3650s
Epoch: 10 cost time: 11.15927243232727
Epoch: 10, Steps: 142 | Train Loss: 0.5411726 Vali Loss: 0.5250201 Test Loss: 0.2293874
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.004194304000000002
	iters: 100, epoch: 11 | loss: 0.5371892
	speed: 0.2319s/iter; left time: 635.6744s
Epoch: 11 cost time: 12.391489505767822
Epoch: 11, Steps: 142 | Train Loss: 0.5416369 Vali Loss: 0.5309078 Test Loss: 0.2298478
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.003355443200000002
	iters: 100, epoch: 12 | loss: 0.6742359
	speed: 0.2557s/iter; left time: 664.5847s
Epoch: 12 cost time: 13.151607036590576
Epoch: 12, Steps: 142 | Train Loss: 0.5398682 Vali Loss: 0.5277169 Test Loss: 0.2304898
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.002684354560000001
	iters: 100, epoch: 13 | loss: 0.5008951
	speed: 0.2249s/iter; left time: 552.4787s
Epoch: 13 cost time: 12.037354469299316
Epoch: 13, Steps: 142 | Train Loss: 0.5404025 Vali Loss: 0.5315364 Test Loss: 0.2292739
EarlyStopping counter: 4 out of 5
Updating learning rate to 0.0021474836480000013
	iters: 100, epoch: 14 | loss: 0.5126824
	speed: 0.2515s/iter; left time: 582.2980s
Epoch: 14 cost time: 13.092156887054443
Epoch: 14, Steps: 142 | Train Loss: 0.5404813 Vali Loss: 0.5275113 Test Loss: 0.2304831
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : weather_192_192_SparseTSF_custom_ftM_sl192_pl192_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
mse:0.23202994465827942, mae:0.2683778703212738, rse:0.634074330329895
