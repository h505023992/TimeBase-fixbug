Args in experiment:
Namespace(is_training=1, train_only=False, model_id='DLinear_electricity_96_192', model='DLinear', data='custom', root_path='./dataset/', data_path='electricity.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=192, individual=False, embed_type=0, enc_in=321, dec_in=321, c_out=321, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DLinear_electricity_96_192_DLinear_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18125
val 2441
test 5069
	iters: 100, epoch: 1 | loss: 0.6861503
	speed: 0.0527s/iter; left time: 892.0410s
	iters: 200, epoch: 1 | loss: 0.4527112
	speed: 0.0320s/iter; left time: 538.3925s
	iters: 300, epoch: 1 | loss: 0.3561955
	speed: 0.0315s/iter; left time: 525.8025s
	iters: 400, epoch: 1 | loss: 0.3058574
	speed: 0.0318s/iter; left time: 527.4698s
	iters: 500, epoch: 1 | loss: 0.2810782
	speed: 0.0313s/iter; left time: 516.3056s
Epoch: 1 cost time: 20.093300819396973
Epoch: 1, Steps: 567 | Train Loss: 0.4851243 Vali Loss: 0.2579446 Test Loss: 0.2855394
Validation loss decreased (inf --> 0.257945).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2854148
	speed: 0.2249s/iter; left time: 3676.1388s
	iters: 200, epoch: 2 | loss: 0.2493829
	speed: 0.0323s/iter; left time: 524.1167s
	iters: 300, epoch: 2 | loss: 0.2661141
	speed: 0.0318s/iter; left time: 513.7333s
	iters: 400, epoch: 2 | loss: 0.2342994
	speed: 0.0332s/iter; left time: 532.9100s
	iters: 500, epoch: 2 | loss: 0.2388274
	speed: 0.0308s/iter; left time: 491.3724s
Epoch: 2 cost time: 19.201948165893555
Epoch: 2, Steps: 567 | Train Loss: 0.2606766 Vali Loss: 0.2190666 Test Loss: 0.2461272
Validation loss decreased (0.257945 --> 0.219067).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2149312
	speed: 0.2619s/iter; left time: 4131.2243s
	iters: 200, epoch: 3 | loss: 0.2204565
	speed: 0.0407s/iter; left time: 637.9645s
	iters: 300, epoch: 3 | loss: 0.2144995
	speed: 0.0399s/iter; left time: 621.5506s
	iters: 400, epoch: 3 | loss: 0.2642310
	speed: 0.0455s/iter; left time: 704.5280s
	iters: 500, epoch: 3 | loss: 0.2407145
	speed: 0.0404s/iter; left time: 621.8910s
Epoch: 3 cost time: 24.18925929069519
Epoch: 3, Steps: 567 | Train Loss: 0.2383393 Vali Loss: 0.2088295 Test Loss: 0.2354057
Validation loss decreased (0.219067 --> 0.208830).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2284413
	speed: 0.3835s/iter; left time: 5833.6931s
	iters: 200, epoch: 4 | loss: 0.2083162
	speed: 0.0471s/iter; left time: 711.8298s
	iters: 300, epoch: 4 | loss: 0.2292665
	speed: 0.0461s/iter; left time: 691.2109s
	iters: 400, epoch: 4 | loss: 0.2335875
	speed: 0.0466s/iter; left time: 695.0160s
	iters: 500, epoch: 4 | loss: 0.2098419
	speed: 0.0446s/iter; left time: 660.0455s
Epoch: 4 cost time: 27.857548713684082
Epoch: 4, Steps: 567 | Train Loss: 0.2307351 Vali Loss: 0.2041004 Test Loss: 0.2305136
Validation loss decreased (0.208830 --> 0.204100).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2250107
	speed: 0.3431s/iter; left time: 5024.4984s
	iters: 200, epoch: 5 | loss: 0.2163638
	speed: 0.0428s/iter; left time: 622.8655s
	iters: 300, epoch: 5 | loss: 0.2213114
	speed: 0.0368s/iter; left time: 531.9964s
	iters: 400, epoch: 5 | loss: 0.2434334
	speed: 0.0360s/iter; left time: 516.8109s
	iters: 500, epoch: 5 | loss: 0.2264671
	speed: 0.0397s/iter; left time: 565.7312s
Epoch: 5 cost time: 23.82782244682312
Epoch: 5, Steps: 567 | Train Loss: 0.2271581 Vali Loss: 0.2017159 Test Loss: 0.2281795
Validation loss decreased (0.204100 --> 0.201716).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2413547
	speed: 0.3315s/iter; left time: 4665.4903s
	iters: 200, epoch: 6 | loss: 0.2419432
	speed: 0.0353s/iter; left time: 493.9336s
	iters: 300, epoch: 6 | loss: 0.2313295
	speed: 0.0350s/iter; left time: 485.3542s
	iters: 400, epoch: 6 | loss: 0.2271156
	speed: 0.0353s/iter; left time: 485.9516s
	iters: 500, epoch: 6 | loss: 0.2111636
	speed: 0.0352s/iter; left time: 480.9606s
Epoch: 6 cost time: 21.327375411987305
Epoch: 6, Steps: 567 | Train Loss: 0.2252803 Vali Loss: 0.2003663 Test Loss: 0.2268775
Validation loss decreased (0.201716 --> 0.200366).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2237150
	speed: 0.2504s/iter; left time: 3382.4460s
	iters: 200, epoch: 7 | loss: 0.2326820
	speed: 0.0310s/iter; left time: 415.2979s
	iters: 300, epoch: 7 | loss: 0.2141074
	speed: 0.0315s/iter; left time: 418.7872s
	iters: 400, epoch: 7 | loss: 0.2497177
	speed: 0.0299s/iter; left time: 395.2962s
	iters: 500, epoch: 7 | loss: 0.2259594
	speed: 0.0304s/iter; left time: 398.3589s
Epoch: 7 cost time: 18.78968334197998
Epoch: 7, Steps: 567 | Train Loss: 0.2242873 Vali Loss: 0.1997786 Test Loss: 0.2262053
Validation loss decreased (0.200366 --> 0.199779).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2076442
	speed: 0.2821s/iter; left time: 3650.4419s
	iters: 200, epoch: 8 | loss: 0.2119450
	speed: 0.0370s/iter; left time: 475.6202s
	iters: 300, epoch: 8 | loss: 0.2396972
	speed: 0.0366s/iter; left time: 466.1359s
	iters: 400, epoch: 8 | loss: 0.2043093
	speed: 0.0352s/iter; left time: 444.6838s
	iters: 500, epoch: 8 | loss: 0.2066043
	speed: 0.0370s/iter; left time: 464.2812s
Epoch: 8 cost time: 21.9479022026062
Epoch: 8, Steps: 567 | Train Loss: 0.2237584 Vali Loss: 0.1995993 Test Loss: 0.2258219
Validation loss decreased (0.199779 --> 0.199599).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2456818
	speed: 0.2782s/iter; left time: 3443.3321s
	iters: 200, epoch: 9 | loss: 0.2179589
	speed: 0.0330s/iter; left time: 405.1858s
	iters: 300, epoch: 9 | loss: 0.1995637
	speed: 0.0340s/iter; left time: 413.4819s
	iters: 400, epoch: 9 | loss: 0.2071786
	speed: 0.0337s/iter; left time: 406.5160s
	iters: 500, epoch: 9 | loss: 0.2364901
	speed: 0.0353s/iter; left time: 422.5182s
Epoch: 9 cost time: 20.249083757400513
Epoch: 9, Steps: 567 | Train Loss: 0.2234820 Vali Loss: 0.1994856 Test Loss: 0.2256216
Validation loss decreased (0.199599 --> 0.199486).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2386063
	speed: 0.2569s/iter; left time: 3033.2090s
	iters: 200, epoch: 10 | loss: 0.2165338
	speed: 0.0377s/iter; left time: 440.9689s
	iters: 300, epoch: 10 | loss: 0.2261769
	speed: 0.0359s/iter; left time: 417.1757s
	iters: 400, epoch: 10 | loss: 0.2243528
	speed: 0.0365s/iter; left time: 420.0144s
	iters: 500, epoch: 10 | loss: 0.2241473
	speed: 0.0391s/iter; left time: 446.2471s
Epoch: 10 cost time: 22.139343738555908
Epoch: 10, Steps: 567 | Train Loss: 0.2232961 Vali Loss: 0.1993218 Test Loss: 0.2255163
Validation loss decreased (0.199486 --> 0.199322).  Saving model ...
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.2280675
	speed: 0.2944s/iter; left time: 3309.7768s
	iters: 200, epoch: 11 | loss: 0.2294542
	speed: 0.0374s/iter; left time: 416.8856s
	iters: 300, epoch: 11 | loss: 0.2243072
	speed: 0.0364s/iter; left time: 401.3576s
	iters: 400, epoch: 11 | loss: 0.2315158
	speed: 0.0362s/iter; left time: 395.5263s
	iters: 500, epoch: 11 | loss: 0.2388333
	speed: 0.0356s/iter; left time: 385.5766s
Epoch: 11 cost time: 21.89916706085205
Epoch: 11, Steps: 567 | Train Loss: 0.2232208 Vali Loss: 0.1989529 Test Loss: 0.2254619
Validation loss decreased (0.199322 --> 0.198953).  Saving model ...
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.2057083
	speed: 0.3336s/iter; left time: 3560.7450s
	iters: 200, epoch: 12 | loss: 0.2292189
	speed: 0.0411s/iter; left time: 434.6329s
	iters: 300, epoch: 12 | loss: 0.2318240
	speed: 0.0391s/iter; left time: 409.8315s
	iters: 400, epoch: 12 | loss: 0.2104968
	speed: 0.0387s/iter; left time: 401.2128s
	iters: 500, epoch: 12 | loss: 0.2227343
	speed: 0.0392s/iter; left time: 402.4856s
Epoch: 12 cost time: 24.373146533966064
Epoch: 12, Steps: 567 | Train Loss: 0.2231845 Vali Loss: 0.1991078 Test Loss: 0.2254342
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.2254129
	speed: 0.3248s/iter; left time: 3282.3295s
	iters: 200, epoch: 13 | loss: 0.2314985
	speed: 0.0362s/iter; left time: 361.9012s
	iters: 300, epoch: 13 | loss: 0.2279166
	speed: 0.0339s/iter; left time: 335.5927s
	iters: 400, epoch: 13 | loss: 0.2245774
	speed: 0.0354s/iter; left time: 346.7228s
	iters: 500, epoch: 13 | loss: 0.2279444
	speed: 0.0370s/iter; left time: 359.3747s
Epoch: 13 cost time: 21.67972731590271
Epoch: 13, Steps: 567 | Train Loss: 0.2231317 Vali Loss: 0.1991171 Test Loss: 0.2254200
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.2399856
	speed: 0.2958s/iter; left time: 2822.2194s
	iters: 200, epoch: 14 | loss: 0.2344231
	speed: 0.0369s/iter; left time: 348.3752s
	iters: 300, epoch: 14 | loss: 0.2292289
	speed: 0.0368s/iter; left time: 344.0598s
	iters: 400, epoch: 14 | loss: 0.2444357
	speed: 0.0363s/iter; left time: 335.1425s
	iters: 500, epoch: 14 | loss: 0.2186263
	speed: 0.0363s/iter; left time: 331.9394s
Epoch: 14 cost time: 21.869500875473022
Epoch: 14, Steps: 567 | Train Loss: 0.2231530 Vali Loss: 0.1990315 Test Loss: 0.2254128
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : DLinear_electricity_96_192_DLinear_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5069
mse:0.22451342642307281, mae:0.31946831941604614
