True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ECL_192_96          Model:              TimesNet            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/          
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            192                 Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ECL_192_96_TimesNet_custom_ftM_sl192_ll48_pl96_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18125
val 2537
test 5165
	iters: 100, epoch: 1 | loss: 0.4611124
	speed: 0.4109s/iter; left time: 6949.4813s
	iters: 200, epoch: 1 | loss: 0.3474010
	speed: 0.3004s/iter; left time: 5050.6076s
	iters: 300, epoch: 1 | loss: 0.2828172
	speed: 0.3146s/iter; left time: 5258.0159s
	iters: 400, epoch: 1 | loss: 0.2611198
	speed: 0.3193s/iter; left time: 5304.3228s
	iters: 500, epoch: 1 | loss: 0.2177151
	speed: 0.3257s/iter; left time: 5378.2140s
Epoch: 1 cost time: 187.91140389442444
Epoch: 1, Steps: 567 | Train Loss: 0.3601833 Vali Loss: 0.2168442 Test Loss: 0.2505896
Validation loss decreased (inf --> 0.216844).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2344687
	speed: 1.2497s/iter; left time: 20424.5815s
	iters: 200, epoch: 2 | loss: 0.2361670
	speed: 0.3074s/iter; left time: 4992.6849s
	iters: 300, epoch: 2 | loss: 0.2256512
	speed: 0.3352s/iter; left time: 5411.3185s
	iters: 400, epoch: 2 | loss: 0.2367072
	speed: 0.3369s/iter; left time: 5405.8566s
	iters: 500, epoch: 2 | loss: 0.2064534
	speed: 0.3390s/iter; left time: 5405.0851s
Epoch: 2 cost time: 188.94365644454956
Epoch: 2, Steps: 567 | Train Loss: 0.2315640 Vali Loss: 0.2052005 Test Loss: 0.2388113
Validation loss decreased (0.216844 --> 0.205201).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2596974
	speed: 1.3587s/iter; left time: 21436.2583s
	iters: 200, epoch: 3 | loss: 0.2212828
	speed: 0.3555s/iter; left time: 5573.9558s
	iters: 300, epoch: 3 | loss: 0.2173204
	speed: 0.3661s/iter; left time: 5702.8055s
	iters: 400, epoch: 3 | loss: 0.2089680
	speed: 0.3550s/iter; left time: 5494.6614s
	iters: 500, epoch: 3 | loss: 0.2221575
	speed: 0.3749s/iter; left time: 5764.8994s
Epoch: 3 cost time: 207.97694897651672
Epoch: 3, Steps: 567 | Train Loss: 0.2239358 Vali Loss: 0.2027275 Test Loss: 0.2346583
Validation loss decreased (0.205201 --> 0.202728).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2086354
	speed: 1.3863s/iter; left time: 21086.2705s
	iters: 200, epoch: 4 | loss: 0.2168006
	speed: 0.3839s/iter; left time: 5801.0918s
	iters: 300, epoch: 4 | loss: 0.2286559
	speed: 0.3791s/iter; left time: 5690.6535s
	iters: 400, epoch: 4 | loss: 0.2166990
	speed: 0.3905s/iter; left time: 5823.0143s
	iters: 500, epoch: 4 | loss: 0.2015752
	speed: 0.3985s/iter; left time: 5902.3020s
Epoch: 4 cost time: 221.67169952392578
Epoch: 4, Steps: 567 | Train Loss: 0.2184001 Vali Loss: 0.1952625 Test Loss: 0.2248749
Validation loss decreased (0.202728 --> 0.195263).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2188261
	speed: 1.5285s/iter; left time: 22381.6187s
	iters: 200, epoch: 5 | loss: 0.1993507
	speed: 0.4013s/iter; left time: 5836.1688s
	iters: 300, epoch: 5 | loss: 0.1999938
	speed: 0.3997s/iter; left time: 5773.5334s
	iters: 400, epoch: 5 | loss: 0.1840468
	speed: 0.3818s/iter; left time: 5475.5711s
	iters: 500, epoch: 5 | loss: 0.1980746
	speed: 0.3967s/iter; left time: 5650.2738s
Epoch: 5 cost time: 223.9725935459137
Epoch: 5, Steps: 567 | Train Loss: 0.1979632 Vali Loss: 0.1706230 Test Loss: 0.2004982
Validation loss decreased (0.195263 --> 0.170623).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1893362
	speed: 1.4475s/iter; left time: 20374.9566s
	iters: 200, epoch: 6 | loss: 0.1705252
	speed: 0.3968s/iter; left time: 5546.1974s
	iters: 300, epoch: 6 | loss: 0.1673071
	speed: 0.3905s/iter; left time: 5418.0761s
	iters: 400, epoch: 6 | loss: 0.1768508
	speed: 0.3847s/iter; left time: 5299.2240s
	iters: 500, epoch: 6 | loss: 0.1644790
	speed: 0.3881s/iter; left time: 5307.9686s
Epoch: 6 cost time: 221.84916138648987
Epoch: 6, Steps: 567 | Train Loss: 0.1828159 Vali Loss: 0.1648699 Test Loss: 0.1943903
Validation loss decreased (0.170623 --> 0.164870).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1899390
	speed: 1.4001s/iter; left time: 18914.4166s
	iters: 200, epoch: 7 | loss: 0.1866349
	speed: 0.3880s/iter; left time: 5202.8281s
	iters: 300, epoch: 7 | loss: 0.1766185
	speed: 0.3814s/iter; left time: 5075.7320s
	iters: 400, epoch: 7 | loss: 0.1686759
	speed: 0.3935s/iter; left time: 5197.7024s
	iters: 500, epoch: 7 | loss: 0.1652316
	speed: 0.4002s/iter; left time: 5246.3896s
Epoch: 7 cost time: 222.12557125091553
Epoch: 7, Steps: 567 | Train Loss: 0.1786918 Vali Loss: 0.1633714 Test Loss: 0.1927321
Validation loss decreased (0.164870 --> 0.163371).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1842027
	speed: 1.4575s/iter; left time: 18862.4217s
	iters: 200, epoch: 8 | loss: 0.1778357
	speed: 0.3811s/iter; left time: 4894.5905s
	iters: 300, epoch: 8 | loss: 0.1707366
	speed: 0.3851s/iter; left time: 4907.2752s
	iters: 400, epoch: 8 | loss: 0.1871025
	speed: 0.3732s/iter; left time: 4718.6041s
	iters: 500, epoch: 8 | loss: 0.1605662
	speed: 0.3805s/iter; left time: 4772.6042s
Epoch: 8 cost time: 217.8018593788147
Epoch: 8, Steps: 567 | Train Loss: 0.1771598 Vali Loss: 0.1625361 Test Loss: 0.1917904
Validation loss decreased (0.163371 --> 0.162536).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1588333
	speed: 1.4241s/iter; left time: 17623.8351s
	iters: 200, epoch: 9 | loss: 0.1813844
	speed: 0.3884s/iter; left time: 4767.6876s
	iters: 300, epoch: 9 | loss: 0.1659150
	speed: 0.3890s/iter; left time: 4736.6054s
	iters: 400, epoch: 9 | loss: 0.1880721
	speed: 0.3764s/iter; left time: 4545.5335s
	iters: 500, epoch: 9 | loss: 0.1654221
	speed: 0.3916s/iter; left time: 4689.0898s
Epoch: 9 cost time: 220.05511784553528
Epoch: 9, Steps: 567 | Train Loss: 0.1764875 Vali Loss: 0.1618204 Test Loss: 0.1915530
Validation loss decreased (0.162536 --> 0.161820).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1749132
	speed: 1.4450s/iter; left time: 17062.0105s
	iters: 200, epoch: 10 | loss: 0.2016422
	speed: 0.3892s/iter; left time: 4556.8664s
	iters: 300, epoch: 10 | loss: 0.1604825
	speed: 0.3759s/iter; left time: 4363.7145s
	iters: 400, epoch: 10 | loss: 0.1889693
	speed: 0.3858s/iter; left time: 4440.2081s
	iters: 500, epoch: 10 | loss: 0.2105824
	speed: 0.3904s/iter; left time: 4454.0132s
Epoch: 10 cost time: 218.85942244529724
Epoch: 10, Steps: 567 | Train Loss: 0.1761139 Vali Loss: 0.1620776 Test Loss: 0.1912791
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1734908
	speed: 1.4461s/iter; left time: 16256.0167s
	iters: 200, epoch: 11 | loss: 0.1973818
	speed: 0.3782s/iter; left time: 4213.9197s
	iters: 300, epoch: 11 | loss: 0.1723372
	speed: 0.3842s/iter; left time: 4241.4702s
	iters: 400, epoch: 11 | loss: 0.1957482
	speed: 0.3789s/iter; left time: 4145.0433s
	iters: 500, epoch: 11 | loss: 0.1978694
	speed: 0.3861s/iter; left time: 4185.2210s
Epoch: 11 cost time: 219.39256811141968
Epoch: 11, Steps: 567 | Train Loss: 0.1759440 Vali Loss: 0.1616427 Test Loss: 0.1911933
Validation loss decreased (0.161820 --> 0.161643).  Saving model ...
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1862742
	speed: 1.4645s/iter; left time: 15631.8284s
	iters: 200, epoch: 12 | loss: 0.1697778
	speed: 0.3696s/iter; left time: 3907.9549s
	iters: 300, epoch: 12 | loss: 0.1627451
	speed: 0.3848s/iter; left time: 4030.3320s
	iters: 400, epoch: 12 | loss: 0.1610388
	speed: 0.3951s/iter; left time: 4098.2899s
	iters: 500, epoch: 12 | loss: 0.1488890
	speed: 0.3920s/iter; left time: 4027.2413s
Epoch: 12 cost time: 218.52895092964172
Epoch: 12, Steps: 567 | Train Loss: 0.1758985 Vali Loss: 0.1617448 Test Loss: 0.1911274
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.1654357
	speed: 1.4296s/iter; left time: 14449.2890s
	iters: 200, epoch: 13 | loss: 0.1890154
	speed: 0.3778s/iter; left time: 3780.5604s
	iters: 300, epoch: 13 | loss: 0.1654275
	speed: 0.3756s/iter; left time: 3721.5376s
	iters: 400, epoch: 13 | loss: 0.1564618
	speed: 0.3846s/iter; left time: 3771.3621s
	iters: 500, epoch: 13 | loss: 0.1620547
	speed: 0.3776s/iter; left time: 3665.2678s
Epoch: 13 cost time: 218.0203001499176
Epoch: 13, Steps: 567 | Train Loss: 0.1758967 Vali Loss: 0.1618012 Test Loss: 0.1911075
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.1779145
	speed: 1.4638s/iter; left time: 13964.6104s
	iters: 200, epoch: 14 | loss: 0.1953503
	speed: 0.3774s/iter; left time: 3563.0053s
	iters: 300, epoch: 14 | loss: 0.2029371
	speed: 0.3701s/iter; left time: 3456.7981s
	iters: 400, epoch: 14 | loss: 0.1712057
	speed: 0.3813s/iter; left time: 3523.4431s
	iters: 500, epoch: 14 | loss: 0.1573427
	speed: 0.3742s/iter; left time: 3420.2352s
Epoch: 14 cost time: 217.83786535263062
Epoch: 14, Steps: 567 | Train Loss: 0.1758256 Vali Loss: 0.1615247 Test Loss: 0.1911027
Validation loss decreased (0.161643 --> 0.161525).  Saving model ...
Updating learning rate to 1.220703125e-08
	iters: 100, epoch: 15 | loss: 0.1884744
	speed: 1.4949s/iter; left time: 13414.1542s
	iters: 200, epoch: 15 | loss: 0.1661485
	speed: 0.3987s/iter; left time: 3537.5968s
	iters: 300, epoch: 15 | loss: 0.1514262
	speed: 0.3881s/iter; left time: 3405.0874s
	iters: 400, epoch: 15 | loss: 0.1658067
	speed: 0.3813s/iter; left time: 3306.7430s
	iters: 500, epoch: 15 | loss: 0.1637242
	speed: 0.3751s/iter; left time: 3215.7497s
Epoch: 15 cost time: 221.692715883255
Epoch: 15, Steps: 567 | Train Loss: 0.1758356 Vali Loss: 0.1615710 Test Loss: 0.1910952
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.103515625e-09
	iters: 100, epoch: 16 | loss: 0.1619470
	speed: 1.4220s/iter; left time: 11953.5538s
	iters: 200, epoch: 16 | loss: 0.1511637
	speed: 0.3815s/iter; left time: 3169.1403s
	iters: 300, epoch: 16 | loss: 0.1915134
	speed: 0.3920s/iter; left time: 3216.5515s
	iters: 400, epoch: 16 | loss: 0.2005465
	speed: 0.3857s/iter; left time: 3126.1886s
	iters: 500, epoch: 16 | loss: 0.1787699
	speed: 0.3878s/iter; left time: 3104.7645s
Epoch: 16 cost time: 221.21209979057312
Epoch: 16, Steps: 567 | Train Loss: 0.1758366 Vali Loss: 0.1618938 Test Loss: 0.1910919
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.0517578125e-09
	iters: 100, epoch: 17 | loss: 0.1784323
	speed: 1.5165s/iter; left time: 11888.0360s
	iters: 200, epoch: 17 | loss: 0.1834407
	speed: 0.3927s/iter; left time: 3039.0041s
	iters: 300, epoch: 17 | loss: 0.1933017
	speed: 0.3887s/iter; left time: 2969.0073s
	iters: 400, epoch: 17 | loss: 0.1787651
	speed: 0.3899s/iter; left time: 2939.5395s
	iters: 500, epoch: 17 | loss: 0.1660428
	speed: 0.3892s/iter; left time: 2895.1656s
Epoch: 17 cost time: 224.55265617370605
Epoch: 17, Steps: 567 | Train Loss: 0.1758381 Vali Loss: 0.1615603 Test Loss: 0.1910907
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ECL_192_96_TimesNet_custom_ftM_sl192_ll48_pl96_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
test shape: (5165, 96, 321) (5165, 96, 321)
test shape: (5165, 96, 321) (5165, 96, 321)
mse:0.19091078639030457, mae:0.2961914539337158, dtw:not calculated
