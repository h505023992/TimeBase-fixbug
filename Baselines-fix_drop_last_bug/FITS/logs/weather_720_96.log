Args in experiment:
Namespace(is_training=1, model_id='weather_720_96', model='FITS', data='custom', root_path='./dataset/', data_path='weather.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=96, individual=False, embed_type=0, enc_in=21, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, ab=2, hidden_size=1, kernel=5, groups=1, levels=3, stacks=1, num_workers=10, itr=1, train_epochs=30, batch_size=128, patience=3, learning_rate=0.0005, des='Exp', loss='mse', lradj='type3', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False, aug_method='NA', aug_rate=0.5, in_batch_augmentation=False, in_dataset_augmentation=False, data_size=1, aug_data_size=1, seed=0, testset_div=2, test_time_train=False, train_mode=2, cut_freq=82, base_T=144, H_order=12)
Use GPU: cuda:0
>>>>>>>start training : weather_720_96_FITS_custom_ftM_sl720_ll48_pl96_H12_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36072
val 5175
test 10444
Model(
  (freq_upsampler): Linear(in_features=82, out_features=92, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  20278272.0
params:  7636.0
Trainable parameters:  7636
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.6500879
	speed: 0.0951s/iter; left time: 792.2839s
	iters: 200, epoch: 1 | loss: 0.4696200
	speed: 0.0904s/iter; left time: 743.7879s
Epoch: 1 cost time: 27.19631266593933
Epoch: 1, Steps: 281 | Train Loss: 0.5535212 Vali Loss: 0.5658988 Test Loss: 0.2457349
Validation loss decreased (inf --> 0.565899).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3432201
	speed: 0.3768s/iter; left time: 3033.1127s
	iters: 200, epoch: 2 | loss: 0.3246674
	speed: 0.0959s/iter; left time: 762.1371s
Epoch: 2 cost time: 27.748046159744263
Epoch: 2, Steps: 281 | Train Loss: 0.3482008 Vali Loss: 0.5365461 Test Loss: 0.2276105
Validation loss decreased (0.565899 --> 0.536546).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.3439682
	speed: 0.3484s/iter; left time: 2706.9501s
	iters: 200, epoch: 3 | loss: 0.2677665
	speed: 0.1013s/iter; left time: 777.2220s
Epoch: 3 cost time: 27.681344985961914
Epoch: 3, Steps: 281 | Train Loss: 0.2635999 Vali Loss: 0.5097716 Test Loss: 0.2139485
Validation loss decreased (0.536546 --> 0.509772).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2054791
	speed: 0.3589s/iter; left time: 2687.7223s
	iters: 200, epoch: 4 | loss: 0.2233856
	speed: 0.0991s/iter; left time: 732.2647s
Epoch: 4 cost time: 29.608942985534668
Epoch: 4, Steps: 281 | Train Loss: 0.2144658 Vali Loss: 0.4884710 Test Loss: 0.2030384
Validation loss decreased (0.509772 --> 0.488471).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.1966293
	speed: 0.3652s/iter; left time: 2631.6817s
	iters: 200, epoch: 5 | loss: 0.2318137
	speed: 0.0924s/iter; left time: 656.4919s
Epoch: 5 cost time: 27.35321807861328
Epoch: 5, Steps: 281 | Train Loss: 0.1847618 Vali Loss: 0.4706019 Test Loss: 0.1958972
Validation loss decreased (0.488471 --> 0.470602).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1539750
	speed: 0.3598s/iter; left time: 2491.7618s
	iters: 200, epoch: 6 | loss: 0.1962616
	speed: 0.0894s/iter; left time: 610.4826s
Epoch: 6 cost time: 27.28627848625183
Epoch: 6, Steps: 281 | Train Loss: 0.1665040 Vali Loss: 0.4582628 Test Loss: 0.1895320
Validation loss decreased (0.470602 --> 0.458263).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.1406751
	speed: 0.3788s/iter; left time: 2517.2352s
	iters: 200, epoch: 7 | loss: 0.1683090
	speed: 0.0948s/iter; left time: 620.4870s
Epoch: 7 cost time: 27.760326385498047
Epoch: 7, Steps: 281 | Train Loss: 0.1552851 Vali Loss: 0.4479267 Test Loss: 0.1864915
Validation loss decreased (0.458263 --> 0.447927).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1900323
	speed: 0.3303s/iter; left time: 2101.9343s
	iters: 200, epoch: 8 | loss: 0.1405150
	speed: 0.0839s/iter; left time: 525.6445s
Epoch: 8 cost time: 24.789262294769287
Epoch: 8, Steps: 281 | Train Loss: 0.1486506 Vali Loss: 0.4411941 Test Loss: 0.1824078
Validation loss decreased (0.447927 --> 0.441194).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.0910394
	speed: 0.3348s/iter; left time: 2036.8614s
	iters: 200, epoch: 9 | loss: 0.1021407
	speed: 0.0976s/iter; left time: 584.0113s
Epoch: 9 cost time: 27.869637966156006
Epoch: 9, Steps: 281 | Train Loss: 0.1443181 Vali Loss: 0.4367624 Test Loss: 0.1801589
Validation loss decreased (0.441194 --> 0.436762).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1327664
	speed: 0.3545s/iter; left time: 2056.7290s
	iters: 200, epoch: 10 | loss: 0.1017543
	speed: 0.0860s/iter; left time: 490.2375s
Epoch: 10 cost time: 26.007323026657104
Epoch: 10, Steps: 281 | Train Loss: 0.1420677 Vali Loss: 0.4365748 Test Loss: 0.1798682
Validation loss decreased (0.436762 --> 0.436575).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1566614
	speed: 0.3516s/iter; left time: 1941.2154s
	iters: 200, epoch: 11 | loss: 0.1168454
	speed: 0.0872s/iter; left time: 472.9071s
Epoch: 11 cost time: 26.62292790412903
Epoch: 11, Steps: 281 | Train Loss: 0.1405252 Vali Loss: 0.4330762 Test Loss: 0.1781471
Validation loss decreased (0.436575 --> 0.433076).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1280064
	speed: 0.3772s/iter; left time: 1976.6775s
	iters: 200, epoch: 12 | loss: 0.1342452
	speed: 0.0947s/iter; left time: 486.8168s
Epoch: 12 cost time: 28.789090633392334
Epoch: 12, Steps: 281 | Train Loss: 0.1394830 Vali Loss: 0.4343539 Test Loss: 0.1774144
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.1618646
	speed: 0.3322s/iter; left time: 1647.5808s
	iters: 200, epoch: 13 | loss: 0.1033679
	speed: 0.0896s/iter; left time: 435.4607s
Epoch: 13 cost time: 24.66346573829651
Epoch: 13, Steps: 281 | Train Loss: 0.1389488 Vali Loss: 0.4329447 Test Loss: 0.1768488
Validation loss decreased (0.433076 --> 0.432945).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.1598086
	speed: 0.3580s/iter; left time: 1674.7304s
	iters: 200, epoch: 14 | loss: 0.1379749
	speed: 0.1130s/iter; left time: 517.2954s
Epoch: 14 cost time: 29.72492003440857
Epoch: 14, Steps: 281 | Train Loss: 0.1387862 Vali Loss: 0.4313618 Test Loss: 0.1765307
Validation loss decreased (0.432945 --> 0.431362).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.1218713
	speed: 0.3775s/iter; left time: 1660.0407s
	iters: 200, epoch: 15 | loss: 0.1109765
	speed: 0.0947s/iter; left time: 407.0705s
Epoch: 15 cost time: 27.381598234176636
Epoch: 15, Steps: 281 | Train Loss: 0.1385819 Vali Loss: 0.4325671 Test Loss: 0.1763790
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.1236932
	speed: 0.3347s/iter; left time: 1377.5128s
	iters: 200, epoch: 16 | loss: 0.1461288
	speed: 0.0818s/iter; left time: 328.6706s
Epoch: 16 cost time: 23.568464756011963
Epoch: 16, Steps: 281 | Train Loss: 0.1384853 Vali Loss: 0.4311090 Test Loss: 0.1760367
Validation loss decreased (0.431362 --> 0.431109).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.1386072
	speed: 0.3507s/iter; left time: 1344.7462s
	iters: 200, epoch: 17 | loss: 0.1028545
	speed: 0.0964s/iter; left time: 360.2387s
Epoch: 17 cost time: 28.17995524406433
Epoch: 17, Steps: 281 | Train Loss: 0.1384469 Vali Loss: 0.4324752 Test Loss: 0.1763775
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.1142522
	speed: 0.3410s/iter; left time: 1211.9870s
	iters: 200, epoch: 18 | loss: 0.0824844
	speed: 0.0864s/iter; left time: 298.4238s
Epoch: 18 cost time: 25.217676639556885
Epoch: 18, Steps: 281 | Train Loss: 0.1384309 Vali Loss: 0.4313863 Test Loss: 0.1764661
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.1947030
	speed: 0.3370s/iter; left time: 1103.1322s
	iters: 200, epoch: 19 | loss: 0.1168316
	speed: 0.0825s/iter; left time: 261.8015s
Epoch: 19 cost time: 24.149055004119873
Epoch: 19, Steps: 281 | Train Loss: 0.1384760 Vali Loss: 0.4289430 Test Loss: 0.1761623
Validation loss decreased (0.431109 --> 0.428943).  Saving model ...
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.1485378
	speed: 0.3640s/iter; left time: 1089.1735s
	iters: 200, epoch: 20 | loss: 0.1361333
	speed: 0.0934s/iter; left time: 270.1938s
Epoch: 20 cost time: 27.209966897964478
Epoch: 20, Steps: 281 | Train Loss: 0.1383760 Vali Loss: 0.4288391 Test Loss: 0.1761771
Validation loss decreased (0.428943 --> 0.428839).  Saving model ...
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.1240371
	speed: 0.3399s/iter; left time: 921.5904s
	iters: 200, epoch: 21 | loss: 0.1594524
	speed: 0.0931s/iter; left time: 243.1861s
Epoch: 21 cost time: 26.08136534690857
Epoch: 21, Steps: 281 | Train Loss: 0.1383006 Vali Loss: 0.4240834 Test Loss: 0.1759079
Validation loss decreased (0.428839 --> 0.424083).  Saving model ...
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.1095481
	speed: 0.3512s/iter; left time: 853.4467s
	iters: 200, epoch: 22 | loss: 0.1003852
	speed: 0.0998s/iter; left time: 232.6475s
Epoch: 22 cost time: 27.561002254486084
Epoch: 22, Steps: 281 | Train Loss: 0.1383879 Vali Loss: 0.4274073 Test Loss: 0.1757725
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.1448681
	speed: 0.3742s/iter; left time: 804.1420s
	iters: 200, epoch: 23 | loss: 0.1637570
	speed: 0.0954s/iter; left time: 195.5546s
Epoch: 23 cost time: 27.327725887298584
Epoch: 23, Steps: 281 | Train Loss: 0.1382389 Vali Loss: 0.4288148 Test Loss: 0.1761807
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.1506173
	speed: 0.3505s/iter; left time: 654.7097s
	iters: 200, epoch: 24 | loss: 0.1631410
	speed: 0.0981s/iter; left time: 173.4411s
Epoch: 24 cost time: 28.029280424118042
Epoch: 24, Steps: 281 | Train Loss: 0.1384313 Vali Loss: 0.4300016 Test Loss: 0.1757004
EarlyStopping counter: 3 out of 3
Early stopping
train 36072
val 5175
test 10444
Model(
  (freq_upsampler): Linear(in_features=82, out_features=92, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  20278272.0
params:  7636.0
Trainable parameters:  7636
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.4151381
	speed: 0.1106s/iter; left time: 921.0927s
	iters: 200, epoch: 1 | loss: 0.5074588
	speed: 0.1016s/iter; left time: 836.2131s
Epoch: 1 cost time: 29.385213136672974
Epoch: 1, Steps: 281 | Train Loss: 0.4421817 Vali Loss: 0.4166020 Test Loss: 0.1758196
Validation loss decreased (inf --> 0.416602).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.6087698
	speed: 0.3578s/iter; left time: 2880.5334s
	iters: 200, epoch: 2 | loss: 0.3143544
	speed: 0.0880s/iter; left time: 699.5691s
Epoch: 2 cost time: 25.79540252685547
Epoch: 2, Steps: 281 | Train Loss: 0.4392893 Vali Loss: 0.4136365 Test Loss: 0.1740027
Validation loss decreased (0.416602 --> 0.413637).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.3146693
	speed: 0.3559s/iter; left time: 2764.8986s
	iters: 200, epoch: 3 | loss: 0.3309466
	speed: 0.0865s/iter; left time: 663.3109s
Epoch: 3 cost time: 26.351130485534668
Epoch: 3, Steps: 281 | Train Loss: 0.4380426 Vali Loss: 0.4137987 Test Loss: 0.1746997
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.4192336
	speed: 0.3585s/iter; left time: 2684.7555s
	iters: 200, epoch: 4 | loss: 0.3294204
	speed: 0.0910s/iter; left time: 672.5707s
Epoch: 4 cost time: 26.315378189086914
Epoch: 4, Steps: 281 | Train Loss: 0.4377389 Vali Loss: 0.4155669 Test Loss: 0.1748004
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.3198182
	speed: 0.3255s/iter; left time: 2346.0525s
	iters: 200, epoch: 5 | loss: 0.4295573
	speed: 0.0904s/iter; left time: 642.3457s
Epoch: 5 cost time: 27.207079887390137
Epoch: 5, Steps: 281 | Train Loss: 0.4364377 Vali Loss: 0.4131089 Test Loss: 0.1740062
Validation loss decreased (0.413637 --> 0.413109).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.3446527
	speed: 0.3791s/iter; left time: 2625.4979s
	iters: 200, epoch: 6 | loss: 0.3672209
	speed: 0.0935s/iter; left time: 638.4964s
Epoch: 6 cost time: 28.07265281677246
Epoch: 6, Steps: 281 | Train Loss: 0.4368863 Vali Loss: 0.4134932 Test Loss: 0.1737800
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.4023198
	speed: 0.3731s/iter; left time: 2479.5288s
	iters: 200, epoch: 7 | loss: 0.2924442
	speed: 0.0947s/iter; left time: 620.0705s
Epoch: 7 cost time: 27.273348093032837
Epoch: 7, Steps: 281 | Train Loss: 0.4372077 Vali Loss: 0.4135975 Test Loss: 0.1741756
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.3631207
	speed: 0.3104s/iter; left time: 1975.2600s
	iters: 200, epoch: 8 | loss: 0.3667404
	speed: 0.0880s/iter; left time: 550.9950s
Epoch: 8 cost time: 25.73955750465393
Epoch: 8, Steps: 281 | Train Loss: 0.4357863 Vali Loss: 0.4142989 Test Loss: 0.1738975
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_720_96_FITS_custom_ftM_sl720_ll48_pl96_H12_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
mse:0.17567578434944153, mae:0.23245555233955383, rse:0.5444251298904419, corr:[0.4830319  0.48660734 0.48730364 0.48658305 0.4855833  0.4850228
 0.48501804 0.4852961  0.4854426  0.4852425  0.48476157 0.48421487
 0.48372436 0.4833464  0.4830207  0.4826421  0.4822516  0.48165807
 0.48107597 0.48050478 0.4800245  0.47959593 0.4791635  0.47854048
 0.4777339  0.47679144 0.47583258 0.47486797 0.47405842 0.47333917
 0.47272933 0.47207332 0.47136477 0.4704859  0.46959418 0.46870768
 0.46799785 0.46734866 0.46673012 0.46606004 0.4653581  0.46467626
 0.46393675 0.46317768 0.4624689  0.4618073  0.46126315 0.46080157
 0.46019992 0.45956388 0.4589608  0.45833933 0.45785663 0.4574476
 0.45706472 0.45660394 0.45611176 0.45552558 0.45490962 0.45430365
 0.4538013  0.4533759  0.45308414 0.45283312 0.45257303 0.4523069
 0.4518703  0.45135716 0.45082724 0.4504218  0.4502264  0.45009744
 0.4500554  0.44992816 0.44952556 0.44888183 0.44812125 0.4474693
 0.44699726 0.44671774 0.44674078 0.44694453 0.44702876 0.4468692
 0.44647914 0.44591826 0.44553328 0.44531134 0.4452951  0.44525513
 0.4451315  0.44487005 0.44443613 0.44390848 0.44321188 0.44197142]
