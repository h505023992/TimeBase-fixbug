Args in experiment:
Namespace(is_training=1, model_id='ETTm2_96_192', model='LightTimeBaseTST', data='ETTm2', root_path='./dataset/', data_path='ETTm2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=192, period_len=4, basis_num=40, use_period_norm=1, use_orthogonal=1, orthogonal_weight=0.04, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=7, individual=1, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=512, patience=5, learning_rate=0.05, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use GPU: cuda:0
20776
>>>>>>>start training : ETTm2_96_192_LightTimeBaseTST_ETTm2_ftM_sl96_pl192_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34273
val 11329
test 11329
Epoch: 1 cost time: 9.784818649291992
Epoch: 1, Steps: 67 | Train Loss: 0.3791100 Vali Loss: 0.1891590 Test Loss: 0.2613339
Validation loss decreased (inf --> 0.189159).  Saving model ...
Updating learning rate to 0.05
Epoch: 2 cost time: 8.9309663772583
Epoch: 2, Steps: 67 | Train Loss: 0.3690741 Vali Loss: 0.1813515 Test Loss: 0.2525497
Validation loss decreased (0.189159 --> 0.181352).  Saving model ...
Updating learning rate to 0.05
Epoch: 3 cost time: 7.128167152404785
Epoch: 3, Steps: 67 | Train Loss: 0.3467249 Vali Loss: 0.1798924 Test Loss: 0.2482835
Validation loss decreased (0.181352 --> 0.179892).  Saving model ...
Updating learning rate to 0.05
Epoch: 4 cost time: 8.673796653747559
Epoch: 4, Steps: 67 | Train Loss: 0.3435584 Vali Loss: 0.1800944 Test Loss: 0.2489899
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.04000000000000001
Epoch: 5 cost time: 8.639842987060547
Epoch: 5, Steps: 67 | Train Loss: 0.3407709 Vali Loss: 0.1758076 Test Loss: 0.2450233
Validation loss decreased (0.179892 --> 0.175808).  Saving model ...
Updating learning rate to 0.03200000000000001
Epoch: 6 cost time: 9.235154867172241
Epoch: 6, Steps: 67 | Train Loss: 0.3393423 Vali Loss: 0.1770021 Test Loss: 0.2460943
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.025600000000000008
Epoch: 7 cost time: 6.836153984069824
Epoch: 7, Steps: 67 | Train Loss: 0.3383498 Vali Loss: 0.1759450 Test Loss: 0.2436615
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.020480000000000005
Epoch: 8 cost time: 7.329646110534668
Epoch: 8, Steps: 67 | Train Loss: 0.3372667 Vali Loss: 0.1736862 Test Loss: 0.2422141
Validation loss decreased (0.175808 --> 0.173686).  Saving model ...
Updating learning rate to 0.016384000000000006
Epoch: 9 cost time: 6.450074911117554
Epoch: 9, Steps: 67 | Train Loss: 0.3362745 Vali Loss: 0.1732476 Test Loss: 0.2420086
Validation loss decreased (0.173686 --> 0.173248).  Saving model ...
Updating learning rate to 0.013107200000000006
Epoch: 10 cost time: 6.787333011627197
Epoch: 10, Steps: 67 | Train Loss: 0.3363227 Vali Loss: 0.1742660 Test Loss: 0.2429439
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.010485760000000004
Epoch: 11 cost time: 8.89432430267334
Epoch: 11, Steps: 67 | Train Loss: 0.3356152 Vali Loss: 0.1733015 Test Loss: 0.2416440
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.008388608000000004
Epoch: 12 cost time: 9.127416133880615
Epoch: 12, Steps: 67 | Train Loss: 0.3353565 Vali Loss: 0.1731408 Test Loss: 0.2411135
Validation loss decreased (0.173248 --> 0.173141).  Saving model ...
Updating learning rate to 0.006710886400000004
Epoch: 13 cost time: 7.096076011657715
Epoch: 13, Steps: 67 | Train Loss: 0.3349514 Vali Loss: 0.1744033 Test Loss: 0.2418567
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005368709120000003
Epoch: 14 cost time: 6.48107123374939
Epoch: 14, Steps: 67 | Train Loss: 0.3348224 Vali Loss: 0.1733321 Test Loss: 0.2415049
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.0042949672960000025
Epoch: 15 cost time: 8.375443935394287
Epoch: 15, Steps: 67 | Train Loss: 0.3341078 Vali Loss: 0.1712717 Test Loss: 0.2404188
Validation loss decreased (0.173141 --> 0.171272).  Saving model ...
Updating learning rate to 0.0034359738368000023
Epoch: 16 cost time: 9.120057344436646
Epoch: 16, Steps: 67 | Train Loss: 0.3342619 Vali Loss: 0.1730051 Test Loss: 0.2410375
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.002748779069440002
Epoch: 17 cost time: 8.798549890518188
Epoch: 17, Steps: 67 | Train Loss: 0.3340089 Vali Loss: 0.1728561 Test Loss: 0.2408735
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.002199023255552002
Epoch: 18 cost time: 8.900089979171753
Epoch: 18, Steps: 67 | Train Loss: 0.3338330 Vali Loss: 0.1730184 Test Loss: 0.2411399
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.0017592186044416017
Epoch: 19 cost time: 9.065046310424805
Epoch: 19, Steps: 67 | Train Loss: 0.3337166 Vali Loss: 0.1734965 Test Loss: 0.2409579
EarlyStopping counter: 4 out of 5
Updating learning rate to 0.0014073748835532812
Epoch: 20 cost time: 7.272639036178589
Epoch: 20, Steps: 67 | Train Loss: 0.3335182 Vali Loss: 0.1740834 Test Loss: 0.2404803
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_96_192_LightTimeBaseTST_ETTm2_ftM_sl96_pl192_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.2459212988615036, mae:0.303198903799057, rse:0.4014146029949188
