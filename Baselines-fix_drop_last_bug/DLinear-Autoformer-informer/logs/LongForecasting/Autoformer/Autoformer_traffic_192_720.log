Args in experiment:
Namespace(is_training=1, train_only=False, model_id='Autoformer_traffic_192_720', model='Autoformer', data='custom', root_path='./dataset/', data_path='traffic.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=192, label_len=48, pred_len=720, individual=False, embed_type=0, enc_in=862, dec_in=862, c_out=862, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : Autoformer_traffic_192_720_Autoformer_custom_ftM_sl192_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11369
val 1037
test 2789
	iters: 100, epoch: 1 | loss: 0.4422016
	speed: 0.3780s/iter; left time: 4000.0411s
	iters: 200, epoch: 1 | loss: 0.3536649
	speed: 0.3598s/iter; left time: 3771.0964s
	iters: 300, epoch: 1 | loss: 0.3328168
	speed: 0.3511s/iter; left time: 3644.6063s
Epoch: 1 cost time: 128.50844025611877
Epoch: 1, Steps: 356 | Train Loss: 0.4248472 Vali Loss: 0.5214612 Test Loss: 0.6702213
Validation loss decreased (inf --> 0.521461).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3086206
	speed: 1.1019s/iter; left time: 11266.9591s
	iters: 200, epoch: 2 | loss: 0.2985209
	speed: 0.3449s/iter; left time: 3492.4729s
	iters: 300, epoch: 2 | loss: 0.3009866
	speed: 0.3430s/iter; left time: 3438.3965s
Epoch: 2 cost time: 124.2005033493042
Epoch: 2, Steps: 356 | Train Loss: 0.3112845 Vali Loss: 0.5065143 Test Loss: 0.6832057
Validation loss decreased (0.521461 --> 0.506514).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2933447
	speed: 0.9849s/iter; left time: 9720.0965s
	iters: 200, epoch: 3 | loss: 0.2861711
	speed: 0.3505s/iter; left time: 3423.7168s
	iters: 300, epoch: 3 | loss: 0.2873741
	speed: 0.3560s/iter; left time: 3441.9011s
Epoch: 3 cost time: 124.8176965713501
Epoch: 3, Steps: 356 | Train Loss: 0.2913380 Vali Loss: 0.5003462 Test Loss: 0.6779839
Validation loss decreased (0.506514 --> 0.500346).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2915396
	speed: 1.1688s/iter; left time: 11119.1981s
	iters: 200, epoch: 4 | loss: 0.2799347
	speed: 0.3677s/iter; left time: 3461.1996s
	iters: 300, epoch: 4 | loss: 0.2884335
	speed: 0.3578s/iter; left time: 3331.7973s
Epoch: 4 cost time: 131.76171827316284
Epoch: 4, Steps: 356 | Train Loss: 0.2846421 Vali Loss: 0.4979452 Test Loss: 0.6738459
Validation loss decreased (0.500346 --> 0.497945).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2834880
	speed: 1.1486s/iter; left time: 10517.6667s
	iters: 200, epoch: 5 | loss: 0.2824728
	speed: 0.3695s/iter; left time: 3346.2036s
	iters: 300, epoch: 5 | loss: 0.2847312
	speed: 0.3800s/iter; left time: 3404.0457s
Epoch: 5 cost time: 134.89470076560974
Epoch: 5, Steps: 356 | Train Loss: 0.2810209 Vali Loss: 0.4966832 Test Loss: 0.6701788
Validation loss decreased (0.497945 --> 0.496683).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2845525
	speed: 1.1911s/iter; left time: 10482.4756s
	iters: 200, epoch: 6 | loss: 0.2828779
	speed: 0.3704s/iter; left time: 3222.8127s
	iters: 300, epoch: 6 | loss: 0.2844002
	speed: 0.3758s/iter; left time: 3231.9291s
Epoch: 6 cost time: 133.8678593635559
Epoch: 6, Steps: 356 | Train Loss: 0.2792532 Vali Loss: 0.4973412 Test Loss: 0.6743575
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2842689
	speed: 1.1876s/iter; left time: 10028.8995s
	iters: 200, epoch: 7 | loss: 0.2683428
	speed: 0.3693s/iter; left time: 3082.0230s
	iters: 300, epoch: 7 | loss: 0.2755327
	speed: 0.3747s/iter; left time: 3089.4799s
Epoch: 7 cost time: 132.7049217224121
Epoch: 7, Steps: 356 | Train Loss: 0.2782878 Vali Loss: 0.4974236 Test Loss: 0.6770048
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2846895
	speed: 1.1602s/iter; left time: 9385.2396s
	iters: 200, epoch: 8 | loss: 0.2746750
	speed: 0.3749s/iter; left time: 2994.8845s
	iters: 300, epoch: 8 | loss: 0.2834670
	speed: 0.3824s/iter; left time: 3016.7707s
Epoch: 8 cost time: 134.16657280921936
Epoch: 8, Steps: 356 | Train Loss: 0.2777163 Vali Loss: 0.4980082 Test Loss: 0.6806732
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Autoformer_traffic_192_720_Autoformer_custom_ftM_sl192_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
mse:0.6706240773200989, mae:0.41053321957588196
