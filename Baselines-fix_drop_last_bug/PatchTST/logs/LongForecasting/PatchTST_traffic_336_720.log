Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=24, c_out=7, checkpoints='./new_check/', d_ff=256, d_layers=1, d_model=128, data='custom', data_path='traffic.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=862, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='TST', model='PatchTST', model_id='336_720', moving_avg=25, n_heads=16, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=10, pct_start=0.2, pred_len=720, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : 336_720_PatchTST_custom_ftM_sl336_ll48_pl720_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11225
val 1037
test 2789
	iters: 100, epoch: 1 | loss: 0.7641447
	speed: 0.9648s/iter; left time: 44959.1073s
	iters: 200, epoch: 1 | loss: 0.6341507
	speed: 0.9476s/iter; left time: 44062.3712s
	iters: 300, epoch: 1 | loss: 0.5495178
	speed: 0.9528s/iter; left time: 44212.4782s
	iters: 400, epoch: 1 | loss: 0.5006488
	speed: 0.9508s/iter; left time: 44024.1336s
Epoch: 1 cost time: 446.17543601989746
Epoch: 1, Steps: 467 | Train Loss: 0.6634493 Vali Loss: 0.5573775 Test Loss: 0.6752416
Validation loss decreased (inf --> 0.557377).  Saving model ...
Updating learning rate to 4.591085955181866e-06
	iters: 100, epoch: 2 | loss: 0.4767954
	speed: 3.1020s/iter; left time: 143105.9842s
	iters: 200, epoch: 2 | loss: 0.4410107
	speed: 1.0656s/iter; left time: 49054.5796s
	iters: 300, epoch: 2 | loss: 0.4285710
	speed: 1.0538s/iter; left time: 48406.9920s
	iters: 400, epoch: 2 | loss: 0.3954589
	speed: 1.0591s/iter; left time: 48542.9371s
Epoch: 2 cost time: 489.87276697158813
Epoch: 2, Steps: 467 | Train Loss: 0.4348569 Vali Loss: 0.4666362 Test Loss: 0.5527054
Validation loss decreased (0.557377 --> 0.466636).  Saving model ...
Updating learning rate to 6.349786212126899e-06
	iters: 100, epoch: 3 | loss: 0.3792067
	speed: 3.5084s/iter; left time: 160217.1819s
	iters: 200, epoch: 3 | loss: 0.3895456
	speed: 1.0506s/iter; left time: 47871.4389s
	iters: 300, epoch: 3 | loss: 0.3733021
	speed: 1.0765s/iter; left time: 48947.1133s
	iters: 400, epoch: 3 | loss: 0.3590695
	speed: 1.0755s/iter; left time: 48792.8252s
Epoch: 3 cost time: 499.30170917510986
Epoch: 3, Steps: 467 | Train Loss: 0.3692032 Vali Loss: 0.4316712 Test Loss: 0.5048408
Validation loss decreased (0.466636 --> 0.431671).  Saving model ...
Updating learning rate to 9.232786478282804e-06
	iters: 100, epoch: 4 | loss: 0.3457943
	speed: 3.4407s/iter; left time: 155521.7753s
	iters: 200, epoch: 4 | loss: 0.3638505
	speed: 1.0558s/iter; left time: 47618.7480s
	iters: 300, epoch: 4 | loss: 0.3438215
	speed: 1.0496s/iter; left time: 47231.1581s
	iters: 400, epoch: 4 | loss: 0.3394752
	speed: 1.0511s/iter; left time: 47194.1043s
Epoch: 4 cost time: 492.48432898521423
Epoch: 4, Steps: 467 | Train Loss: 0.3381063 Vali Loss: 0.4166930 Test Loss: 0.4832842
Validation loss decreased (0.431671 --> 0.416693).  Saving model ...
Updating learning rate to 1.3169082546728305e-05
	iters: 100, epoch: 5 | loss: 0.3196683
	speed: 3.3853s/iter; left time: 151435.9329s
	iters: 200, epoch: 5 | loss: 0.3118514
	speed: 1.0537s/iter; left time: 47029.5156s
	iters: 300, epoch: 5 | loss: 0.3090019
	speed: 1.0562s/iter; left time: 47036.6765s
	iters: 400, epoch: 5 | loss: 0.3199386
	speed: 1.0492s/iter; left time: 46619.1237s
Epoch: 5 cost time: 491.032071352005
Epoch: 5, Steps: 467 | Train Loss: 0.3227363 Vali Loss: 0.4105871 Test Loss: 0.4744897
Validation loss decreased (0.416693 --> 0.410587).  Saving model ...
Updating learning rate to 1.8061729029067802e-05
	iters: 100, epoch: 6 | loss: 0.3211191
	speed: 3.4067s/iter; left time: 150800.3687s
	iters: 200, epoch: 6 | loss: 0.3161409
	speed: 1.0406s/iter; left time: 45961.1321s
	iters: 300, epoch: 6 | loss: 0.3102664
	speed: 1.0646s/iter; left time: 46911.7453s
	iters: 400, epoch: 6 | loss: 0.3150446
	speed: 1.0452s/iter; left time: 45951.1006s
Epoch: 6 cost time: 491.18217301368713
Epoch: 6, Steps: 467 | Train Loss: 0.3142054 Vali Loss: 0.4084035 Test Loss: 0.4694401
Validation loss decreased (0.410587 --> 0.408404).  Saving model ...
Updating learning rate to 2.379022698282704e-05
	iters: 100, epoch: 7 | loss: 0.3130949
	speed: 3.3968s/iter; left time: 148774.7362s
	iters: 200, epoch: 7 | loss: 0.3239066
	speed: 1.0552s/iter; left time: 46112.0943s
	iters: 300, epoch: 7 | loss: 0.3167382
	speed: 1.0555s/iter; left time: 46018.4052s
	iters: 400, epoch: 7 | loss: 0.2929539
	speed: 1.0601s/iter; left time: 46113.1706s
Epoch: 7 cost time: 493.8582224845886
Epoch: 7, Steps: 467 | Train Loss: 0.3086956 Vali Loss: 0.4051706 Test Loss: 0.4649704
Validation loss decreased (0.408404 --> 0.405171).  Saving model ...
Updating learning rate to 3.0213491629474574e-05
	iters: 100, epoch: 8 | loss: 0.3228343
	speed: 3.2349s/iter; left time: 140176.7189s
	iters: 200, epoch: 8 | loss: 0.3262149
	speed: 1.0521s/iter; left time: 45482.9829s
	iters: 300, epoch: 8 | loss: 0.3035164
	speed: 1.0543s/iter; left time: 45472.0951s
	iters: 400, epoch: 8 | loss: 0.2965444
	speed: 1.0522s/iter; left time: 45276.2584s
Epoch: 8 cost time: 491.0489981174469
Epoch: 8, Steps: 467 | Train Loss: 0.3043886 Vali Loss: 0.4051137 Test Loss: 0.4642286
Validation loss decreased (0.405171 --> 0.405114).  Saving model ...
Updating learning rate to 3.717332707238334e-05
	iters: 100, epoch: 9 | loss: 0.3139085
	speed: 3.4856s/iter; left time: 149408.7392s
	iters: 200, epoch: 9 | loss: 0.2931141
	speed: 1.0548s/iter; left time: 45109.8947s
	iters: 300, epoch: 9 | loss: 0.2909006
	speed: 1.0545s/iter; left time: 44988.9575s
	iters: 400, epoch: 9 | loss: 0.3254399
	speed: 1.0611s/iter; left time: 45164.5579s
Epoch: 9 cost time: 497.1102509498596
Epoch: 9, Steps: 467 | Train Loss: 0.3011497 Vali Loss: 0.4039536 Test Loss: 0.4596005
Validation loss decreased (0.405114 --> 0.403954).  Saving model ...
Updating learning rate to 4.449832243735834e-05
	iters: 100, epoch: 10 | loss: 0.2963909
	speed: 3.7945s/iter; left time: 160880.1639s
	iters: 200, epoch: 10 | loss: 0.2969080
	speed: 1.0621s/iter; left time: 44922.9377s
	iters: 300, epoch: 10 | loss: 0.3098657
	speed: 1.0593s/iter; left time: 44700.0808s
	iters: 400, epoch: 10 | loss: 0.2895158
	speed: 1.0689s/iter; left time: 44997.3905s
Epoch: 10 cost time: 499.4062514305115
Epoch: 10, Steps: 467 | Train Loss: 0.2981844 Vali Loss: 0.4033825 Test Loss: 0.4600604
Validation loss decreased (0.403954 --> 0.403383).  Saving model ...
Updating learning rate to 5.2008073479315854e-05
	iters: 100, epoch: 11 | loss: 0.2861355
	speed: 3.7391s/iter; left time: 156786.0113s
	iters: 200, epoch: 11 | loss: 0.3006665
	speed: 1.0744s/iter; left time: 44944.8723s
	iters: 300, epoch: 11 | loss: 0.3090032
	speed: 1.0742s/iter; left time: 44827.0530s
	iters: 400, epoch: 11 | loss: 0.2930899
	speed: 1.0653s/iter; left time: 44350.2258s
Epoch: 11 cost time: 501.2929894924164
Epoch: 11, Steps: 467 | Train Loss: 0.2952842 Vali Loss: 0.4035364 Test Loss: 0.4592305
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.951762568293031e-05
	iters: 100, epoch: 12 | loss: 0.2992977
	speed: 3.4386s/iter; left time: 142579.7583s
	iters: 200, epoch: 12 | loss: 0.2908662
	speed: 1.0679s/iter; left time: 44170.7181s
	iters: 300, epoch: 12 | loss: 0.2933503
	speed: 1.0631s/iter; left time: 43866.7214s
	iters: 400, epoch: 12 | loss: 0.2882533
	speed: 1.0686s/iter; left time: 43989.4391s
Epoch: 12 cost time: 498.40959429740906
Epoch: 12, Steps: 467 | Train Loss: 0.2929260 Vali Loss: 0.4026415 Test Loss: 0.4574430
Validation loss decreased (0.403383 --> 0.402642).  Saving model ...
Updating learning rate to 6.68420294299825e-05
	iters: 100, epoch: 13 | loss: 0.2888740
	speed: 3.5078s/iter; left time: 143810.7215s
	iters: 200, epoch: 13 | loss: 0.2827232
	speed: 1.0543s/iter; left time: 43117.4125s
	iters: 300, epoch: 13 | loss: 0.2947191
	speed: 1.0627s/iter; left time: 43354.7782s
	iters: 400, epoch: 13 | loss: 0.2906157
	speed: 1.0589s/iter; left time: 43094.2640s
Epoch: 13 cost time: 497.3384482860565
Epoch: 13, Steps: 467 | Train Loss: 0.2906431 Vali Loss: 0.4037969 Test Loss: 0.4582604
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.380089504609891e-05
	iters: 100, epoch: 14 | loss: 0.2934358
	speed: 3.4690s/iter; left time: 140596.7374s
	iters: 200, epoch: 14 | loss: 0.2825834
	speed: 1.0538s/iter; left time: 42603.7905s
	iters: 300, epoch: 14 | loss: 0.2725371
	speed: 1.0565s/iter; left time: 42606.8221s
	iters: 400, epoch: 14 | loss: 0.3044539
	speed: 1.0658s/iter; left time: 42878.9189s
Epoch: 14 cost time: 495.12371373176575
Epoch: 14, Steps: 467 | Train Loss: 0.2884851 Vali Loss: 0.4036497 Test Loss: 0.4563249
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.022283554254271e-05
	iters: 100, epoch: 15 | loss: 0.2729310
	speed: 3.4272s/iter; left time: 137303.1670s
	iters: 200, epoch: 15 | loss: 0.2919016
	speed: 1.0518s/iter; left time: 42033.3694s
	iters: 300, epoch: 15 | loss: 0.2841021
	speed: 1.0430s/iter; left time: 41578.5215s
	iters: 400, epoch: 15 | loss: 0.2789103
	speed: 1.0513s/iter; left time: 41802.5398s
Epoch: 15 cost time: 490.52034854888916
Epoch: 15, Steps: 467 | Train Loss: 0.2868816 Vali Loss: 0.4026516 Test Loss: 0.4552882
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.594968763462802e-05
	iters: 100, epoch: 16 | loss: 0.2784801
	speed: 3.4230s/iter; left time: 135536.7134s
	iters: 200, epoch: 16 | loss: 0.2790874
	speed: 1.0550s/iter; left time: 41670.2069s
	iters: 300, epoch: 16 | loss: 0.2809461
	speed: 1.0365s/iter; left time: 40834.2083s
	iters: 400, epoch: 16 | loss: 0.2884781
	speed: 1.0344s/iter; left time: 40645.8796s
Epoch: 16 cost time: 488.0576899051666
Epoch: 16, Steps: 467 | Train Loss: 0.2851054 Vali Loss: 0.4049488 Test Loss: 0.4588633
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.084040707906164e-05
	iters: 100, epoch: 17 | loss: 0.2778654
	speed: 3.4617s/iter; left time: 135452.7217s
	iters: 200, epoch: 17 | loss: 0.3100769
	speed: 1.0636s/iter; left time: 41512.4922s
	iters: 300, epoch: 17 | loss: 0.2833707
	speed: 1.0677s/iter; left time: 41565.1359s
	iters: 400, epoch: 17 | loss: 0.2852103
	speed: 1.0712s/iter; left time: 41595.3720s
Epoch: 17 cost time: 499.7295196056366
Epoch: 17, Steps: 467 | Train Loss: 0.2835711 Vali Loss: 0.4028897 Test Loss: 0.4509267
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.477454239357946e-05
	iters: 100, epoch: 18 | loss: 0.2683448
	speed: 3.5790s/iter; left time: 138370.0495s
	iters: 200, epoch: 18 | loss: 0.2701202
	speed: 1.0609s/iter; left time: 40909.6780s
	iters: 300, epoch: 18 | loss: 0.2898950
	speed: 1.0537s/iter; left time: 40528.5434s
	iters: 400, epoch: 18 | loss: 0.2760308
	speed: 1.0602s/iter; left time: 40672.0951s
Epoch: 18 cost time: 497.048189163208
Epoch: 18, Steps: 467 | Train Loss: 0.2820560 Vali Loss: 0.4032775 Test Loss: 0.4513660
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.765520140608994e-05
	iters: 100, epoch: 19 | loss: 0.2805490
	speed: 3.6085s/iter; left time: 137826.4311s
	iters: 200, epoch: 19 | loss: 0.2750204
	speed: 1.0658s/iter; left time: 40601.4630s
	iters: 300, epoch: 19 | loss: 0.2781205
	speed: 1.0621s/iter; left time: 40355.5042s
	iters: 400, epoch: 19 | loss: 0.2841174
	speed: 1.0557s/iter; left time: 40004.7078s
Epoch: 19 cost time: 496.3213243484497
Epoch: 19, Steps: 467 | Train Loss: 0.2806881 Vali Loss: 0.4045044 Test Loss: 0.4539990
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.941143757142799e-05
	iters: 100, epoch: 20 | loss: 0.2547948
	speed: 3.4109s/iter; left time: 128685.6647s
	iters: 200, epoch: 20 | loss: 0.2718902
	speed: 1.0709s/iter; left time: 40297.6335s
	iters: 300, epoch: 20 | loss: 0.2806551
	speed: 1.0506s/iter; left time: 39428.1535s
	iters: 400, epoch: 20 | loss: 0.2702855
	speed: 1.0660s/iter; left time: 39899.6375s
Epoch: 20 cost time: 497.39830446243286
Epoch: 20, Steps: 467 | Train Loss: 0.2796465 Vali Loss: 0.4030172 Test Loss: 0.4511334
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.99999998232236e-05
	iters: 100, epoch: 21 | loss: 0.2959855
	speed: 3.2521s/iter; left time: 121174.8127s
	iters: 200, epoch: 21 | loss: 0.2670300
	speed: 1.0068s/iter; left time: 37412.6380s
	iters: 300, epoch: 21 | loss: 0.2728933
	speed: 0.9937s/iter; left time: 36827.3499s
	iters: 400, epoch: 21 | loss: 0.2814969
	speed: 0.9616s/iter; left time: 35540.9627s
Epoch: 21 cost time: 462.2248215675354
Epoch: 21, Steps: 467 | Train Loss: 0.2781004 Vali Loss: 0.4038269 Test Loss: 0.4507568
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.996128672286599e-05
	iters: 100, epoch: 22 | loss: 0.2655471
	speed: 3.2032s/iter; left time: 117857.4265s
	iters: 200, epoch: 22 | loss: 0.2608106
	speed: 0.9662s/iter; left time: 35454.4564s
	iters: 300, epoch: 22 | loss: 0.2818926
	speed: 0.9764s/iter; left time: 35730.5001s
	iters: 400, epoch: 22 | loss: 0.2677507
	speed: 0.9824s/iter; left time: 35852.7920s
Epoch: 22 cost time: 455.81623101234436
Epoch: 22, Steps: 467 | Train Loss: 0.2769408 Vali Loss: 0.4036124 Test Loss: 0.4507321
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : 336_720_PatchTST_custom_ftM_sl336_ll48_pl720_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
mse:0.4572030305862427, mae:0.31118127703666687, rse:0.5529111623764038
