True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTh1_96_96         Model:              TimesNet            

[1mData Loader[0m
  Data:               ETTh1               Root Path:          ./dataset/          
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTh1_96_96_TimesNet_ETTh1_ftM_sl96_ll48_pl96_dm16_nh8_el2_dl1_df32_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 8449
val 2785
test 2785
	iters: 100, epoch: 1 | loss: 0.4701943
	speed: 0.1611s/iter; left time: 1264.9352s
	iters: 200, epoch: 1 | loss: 0.4496157
	speed: 0.1211s/iter; left time: 938.9364s
Epoch: 1 cost time: 36.199761390686035
Epoch: 1, Steps: 265 | Train Loss: 0.4959874 Vali Loss: 0.8364528 Test Loss: 0.4290542
Validation loss decreased (inf --> 0.836453).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4116424
	speed: 0.3062s/iter; left time: 2322.9143s
	iters: 200, epoch: 2 | loss: 0.3622120
	speed: 0.1147s/iter; left time: 858.5034s
Epoch: 2 cost time: 31.374107837677002
Epoch: 2, Steps: 265 | Train Loss: 0.3978577 Vali Loss: 0.7995810 Test Loss: 0.3951928
Validation loss decreased (0.836453 --> 0.799581).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3447229
	speed: 0.2970s/iter; left time: 2174.0828s
	iters: 200, epoch: 3 | loss: 0.3353912
	speed: 0.1164s/iter; left time: 840.1884s
Epoch: 3 cost time: 31.838061332702637
Epoch: 3, Steps: 265 | Train Loss: 0.3822121 Vali Loss: 0.7974539 Test Loss: 0.3907483
Validation loss decreased (0.799581 --> 0.797454).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3837188
	speed: 0.3123s/iter; left time: 2203.8096s
	iters: 200, epoch: 4 | loss: 0.3903299
	speed: 0.1204s/iter; left time: 837.8288s
Epoch: 4 cost time: 32.98573708534241
Epoch: 4, Steps: 265 | Train Loss: 0.3702961 Vali Loss: 0.7780071 Test Loss: 0.3900800
Validation loss decreased (0.797454 --> 0.778007).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3561079
	speed: 0.3197s/iter; left time: 2171.1376s
	iters: 200, epoch: 5 | loss: 0.3755690
	speed: 0.1221s/iter; left time: 816.9106s
Epoch: 5 cost time: 33.28881502151489
Epoch: 5, Steps: 265 | Train Loss: 0.3669597 Vali Loss: 0.7741366 Test Loss: 0.3897427
Validation loss decreased (0.778007 --> 0.774137).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3746693
	speed: 0.3231s/iter; left time: 2108.2731s
	iters: 200, epoch: 6 | loss: 0.3763593
	speed: 0.1256s/iter; left time: 807.0591s
Epoch: 6 cost time: 33.88119101524353
Epoch: 6, Steps: 265 | Train Loss: 0.3652782 Vali Loss: 0.7786247 Test Loss: 0.3897142
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.4123016
	speed: 0.3250s/iter; left time: 2035.1246s
	iters: 200, epoch: 7 | loss: 0.3213045
	speed: 0.1221s/iter; left time: 751.9946s
Epoch: 7 cost time: 33.3097779750824
Epoch: 7, Steps: 265 | Train Loss: 0.3641839 Vali Loss: 0.7710117 Test Loss: 0.3896174
Validation loss decreased (0.774137 --> 0.771012).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3260432
	speed: 0.3226s/iter; left time: 1934.1184s
	iters: 200, epoch: 8 | loss: 0.3211804
	speed: 0.1216s/iter; left time: 717.1226s
Epoch: 8 cost time: 33.279205560684204
Epoch: 8, Steps: 265 | Train Loss: 0.3635003 Vali Loss: 0.7736003 Test Loss: 0.3896147
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3801203
	speed: 0.3226s/iter; left time: 1848.5793s
	iters: 200, epoch: 9 | loss: 0.3627937
	speed: 0.1259s/iter; left time: 708.6715s
Epoch: 9 cost time: 34.0651113986969
Epoch: 9, Steps: 265 | Train Loss: 0.3640491 Vali Loss: 0.7818900 Test Loss: 0.3895886
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3817531
	speed: 0.3288s/iter; left time: 1797.4384s
	iters: 200, epoch: 10 | loss: 0.4601940
	speed: 0.1275s/iter; left time: 684.3169s
Epoch: 10 cost time: 34.199126958847046
Epoch: 10, Steps: 265 | Train Loss: 0.3632836 Vali Loss: 0.7706807 Test Loss: 0.3895726
Validation loss decreased (0.771012 --> 0.770681).  Saving model ...
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.5027817
	speed: 0.3317s/iter; left time: 1725.0485s
	iters: 200, epoch: 11 | loss: 0.3342822
	speed: 0.1260s/iter; left time: 642.9645s
Epoch: 11 cost time: 34.17316746711731
Epoch: 11, Steps: 265 | Train Loss: 0.3634687 Vali Loss: 0.7697111 Test Loss: 0.3895688
Validation loss decreased (0.770681 --> 0.769711).  Saving model ...
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.3469493
	speed: 0.3240s/iter; left time: 1599.2534s
	iters: 200, epoch: 12 | loss: 0.4146436
	speed: 0.1217s/iter; left time: 588.3291s
Epoch: 12 cost time: 33.368244647979736
Epoch: 12, Steps: 265 | Train Loss: 0.3635457 Vali Loss: 0.7781980 Test Loss: 0.3895661
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.3616107
	speed: 0.3210s/iter; left time: 1499.2068s
	iters: 200, epoch: 13 | loss: 0.2757846
	speed: 0.1220s/iter; left time: 557.5238s
Epoch: 13 cost time: 33.168477296829224
Epoch: 13, Steps: 265 | Train Loss: 0.3628212 Vali Loss: 0.7742483 Test Loss: 0.3895656
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.3616500
	speed: 0.3129s/iter; left time: 1378.8243s
	iters: 200, epoch: 14 | loss: 0.3742937
	speed: 0.1215s/iter; left time: 523.2327s
Epoch: 14 cost time: 32.93484807014465
Epoch: 14, Steps: 265 | Train Loss: 0.3636402 Vali Loss: 0.7773824 Test Loss: 0.3895645
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTh1_96_96_TimesNet_ETTh1_ftM_sl96_ll48_pl96_dm16_nh8_el2_dl1_df32_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
test shape: (2785, 96, 7) (2785, 96, 7)
test shape: (2785, 96, 7) (2785, 96, 7)
mse:0.3890670835971832, mae:0.41200587153434753, dtw:not calculated
