True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ECL_96_192          Model:              TimesNet            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/          
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ECL_96_192_TimesNet_custom_ftM_sl96_ll48_pl192_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18125
val 2441
test 5069
	iters: 100, epoch: 1 | loss: 0.5278569
	speed: 0.4314s/iter; left time: 7296.2001s
	iters: 200, epoch: 1 | loss: 0.3378384
	speed: 0.3358s/iter; left time: 5645.9621s
	iters: 300, epoch: 1 | loss: 0.2823338
	speed: 0.3375s/iter; left time: 5640.3364s
	iters: 400, epoch: 1 | loss: 0.2836441
	speed: 0.3360s/iter; left time: 5580.8013s
	iters: 500, epoch: 1 | loss: 0.2767625
	speed: 0.3427s/iter; left time: 5658.6797s
Epoch: 1 cost time: 201.79389357566833
Epoch: 1, Steps: 567 | Train Loss: 0.4002245 Vali Loss: 0.2337925 Test Loss: 0.2710688
Validation loss decreased (inf --> 0.233793).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2681032
	speed: 1.2714s/iter; left time: 20779.9773s
	iters: 200, epoch: 2 | loss: 0.2365860
	speed: 0.3347s/iter; left time: 5437.5229s
	iters: 300, epoch: 2 | loss: 0.2477296
	speed: 0.3285s/iter; left time: 5302.8379s
	iters: 400, epoch: 2 | loss: 0.2349515
	speed: 0.3328s/iter; left time: 5339.7265s
	iters: 500, epoch: 2 | loss: 0.2597024
	speed: 0.3238s/iter; left time: 5162.0836s
Epoch: 2 cost time: 188.90328097343445
Epoch: 2, Steps: 567 | Train Loss: 0.2541537 Vali Loss: 0.2233069 Test Loss: 0.2617911
Validation loss decreased (0.233793 --> 0.223307).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2541336
	speed: 1.1643s/iter; left time: 18369.2034s
	iters: 200, epoch: 3 | loss: 0.2475240
	speed: 0.3171s/iter; left time: 4970.4721s
	iters: 300, epoch: 3 | loss: 0.2418669
	speed: 0.3215s/iter; left time: 5008.1652s
	iters: 400, epoch: 3 | loss: 0.2668239
	speed: 0.3234s/iter; left time: 5005.3933s
	iters: 500, epoch: 3 | loss: 0.2598695
	speed: 0.3194s/iter; left time: 4911.6287s
Epoch: 3 cost time: 182.71662664413452
Epoch: 3, Steps: 567 | Train Loss: 0.2465819 Vali Loss: 0.2189748 Test Loss: 0.2568823
Validation loss decreased (0.223307 --> 0.218975).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2721624
	speed: 1.2036s/iter; left time: 18306.1489s
	iters: 200, epoch: 4 | loss: 0.2403706
	speed: 0.3082s/iter; left time: 4656.8913s
	iters: 300, epoch: 4 | loss: 0.2639143
	speed: 0.3094s/iter; left time: 4643.5493s
	iters: 400, epoch: 4 | loss: 0.2464042
	speed: 0.3070s/iter; left time: 4577.9836s
	iters: 500, epoch: 4 | loss: 0.2352995
	speed: 0.3112s/iter; left time: 4608.5700s
Epoch: 4 cost time: 177.42101526260376
Epoch: 4, Steps: 567 | Train Loss: 0.2437877 Vali Loss: 0.2175636 Test Loss: 0.2545506
Validation loss decreased (0.218975 --> 0.217564).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2576783
	speed: 1.1479s/iter; left time: 16808.5230s
	iters: 200, epoch: 5 | loss: 0.2410811
	speed: 0.3170s/iter; left time: 4610.1540s
	iters: 300, epoch: 5 | loss: 0.2426045
	speed: 0.3229s/iter; left time: 4663.5420s
	iters: 400, epoch: 5 | loss: 0.2339604
	speed: 0.3193s/iter; left time: 4579.6090s
	iters: 500, epoch: 5 | loss: 0.2308134
	speed: 0.3171s/iter; left time: 4516.0293s
Epoch: 5 cost time: 181.13449931144714
Epoch: 5, Steps: 567 | Train Loss: 0.2421457 Vali Loss: 0.2165318 Test Loss: 0.2537071
Validation loss decreased (0.217564 --> 0.216532).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2379913
	speed: 1.0758s/iter; left time: 15143.6456s
	iters: 200, epoch: 6 | loss: 0.2457243
	speed: 0.3112s/iter; left time: 4349.6019s
	iters: 300, epoch: 6 | loss: 0.2424284
	speed: 0.3113s/iter; left time: 4320.0419s
	iters: 400, epoch: 6 | loss: 0.2488344
	speed: 0.3107s/iter; left time: 4280.1039s
	iters: 500, epoch: 6 | loss: 0.2425743
	speed: 0.3172s/iter; left time: 4338.1565s
Epoch: 6 cost time: 178.74672770500183
Epoch: 6, Steps: 567 | Train Loss: 0.2408969 Vali Loss: 0.2162873 Test Loss: 0.2525056
Validation loss decreased (0.216532 --> 0.216287).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2246947
	speed: 1.1136s/iter; left time: 15043.4165s
	iters: 200, epoch: 7 | loss: 0.2413399
	speed: 0.3095s/iter; left time: 4150.2623s
	iters: 300, epoch: 7 | loss: 0.2483055
	speed: 0.3197s/iter; left time: 4255.2647s
	iters: 400, epoch: 7 | loss: 0.2411373
	speed: 0.3163s/iter; left time: 4178.2857s
	iters: 500, epoch: 7 | loss: 0.2628798
	speed: 0.3169s/iter; left time: 4154.5281s
Epoch: 7 cost time: 179.43783593177795
Epoch: 7, Steps: 567 | Train Loss: 0.2400391 Vali Loss: 0.2160172 Test Loss: 0.2520279
Validation loss decreased (0.216287 --> 0.216017).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2245231
	speed: 1.0850s/iter; left time: 14041.5589s
	iters: 200, epoch: 8 | loss: 0.2493570
	speed: 0.3167s/iter; left time: 4067.4378s
	iters: 300, epoch: 8 | loss: 0.2623620
	speed: 0.3179s/iter; left time: 4050.7202s
	iters: 400, epoch: 8 | loss: 0.2486004
	speed: 0.3159s/iter; left time: 3993.9882s
	iters: 500, epoch: 8 | loss: 0.2505939
	speed: 0.3044s/iter; left time: 3818.3180s
Epoch: 8 cost time: 178.3580343723297
Epoch: 8, Steps: 567 | Train Loss: 0.2395274 Vali Loss: 0.2156024 Test Loss: 0.2518924
Validation loss decreased (0.216017 --> 0.215602).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2730234
	speed: 1.1071s/iter; left time: 13700.3096s
	iters: 200, epoch: 9 | loss: 0.2525240
	speed: 0.3145s/iter; left time: 3859.8882s
	iters: 300, epoch: 9 | loss: 0.2363276
	speed: 0.3156s/iter; left time: 3842.3349s
	iters: 400, epoch: 9 | loss: 0.2464690
	speed: 0.3130s/iter; left time: 3779.3787s
	iters: 500, epoch: 9 | loss: 0.2555508
	speed: 0.3118s/iter; left time: 3734.1954s
Epoch: 9 cost time: 178.98256587982178
Epoch: 9, Steps: 567 | Train Loss: 0.2392836 Vali Loss: 0.2158047 Test Loss: 0.2516272
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2309421
	speed: 1.1338s/iter; left time: 13388.4423s
	iters: 200, epoch: 10 | loss: 0.2335894
	speed: 0.3132s/iter; left time: 3666.4557s
	iters: 300, epoch: 10 | loss: 0.2240819
	speed: 0.3167s/iter; left time: 3676.7174s
	iters: 400, epoch: 10 | loss: 0.2269156
	speed: 0.3130s/iter; left time: 3601.5485s
	iters: 500, epoch: 10 | loss: 0.2369945
	speed: 0.3210s/iter; left time: 3661.5654s
Epoch: 10 cost time: 180.3259825706482
Epoch: 10, Steps: 567 | Train Loss: 0.2392164 Vali Loss: 0.2156904 Test Loss: 0.2516465
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.2447904
	speed: 1.1882s/iter; left time: 13356.6579s
	iters: 200, epoch: 11 | loss: 0.2539888
	speed: 0.3144s/iter; left time: 3502.3463s
	iters: 300, epoch: 11 | loss: 0.2205495
	speed: 0.3154s/iter; left time: 3482.2567s
	iters: 400, epoch: 11 | loss: 0.2461666
	speed: 0.3123s/iter; left time: 3417.0075s
	iters: 500, epoch: 11 | loss: 0.2287187
	speed: 0.3210s/iter; left time: 3479.7182s
Epoch: 11 cost time: 180.43812537193298
Epoch: 11, Steps: 567 | Train Loss: 0.2391211 Vali Loss: 0.2157246 Test Loss: 0.2516548
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ECL_96_192_TimesNet_custom_ftM_sl96_ll48_pl192_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5069
test shape: (5069, 192, 321) (5069, 192, 321)
test shape: (5069, 192, 321) (5069, 192, 321)
mse:0.2509767413139343, mae:0.3342670798301697, dtw:not calculated
