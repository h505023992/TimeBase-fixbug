Args in experiment:
Namespace(is_training=1, train_only=False, model_id='traffic_720_336', model='DLinear', data='custom', root_path='./dataset/', data_path='traffic.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=336, individual=False, embed_type=0, enc_in=862, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=10, batch_size=16, patience=3, learning_rate=0.001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=7, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:7
>>>>>>>start training : traffic_720_336_DLinear_custom_ftM_sl720_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11225
val 1421
test 3173
	iters: 100, epoch: 1 | loss: 0.2936726
	speed: 0.0710s/iter; left time: 490.4547s
	iters: 200, epoch: 1 | loss: 0.2627638
	speed: 0.0590s/iter; left time: 401.8466s
	iters: 300, epoch: 1 | loss: 0.2609244
	speed: 0.0580s/iter; left time: 389.5072s
	iters: 400, epoch: 1 | loss: 0.2548882
	speed: 0.0585s/iter; left time: 386.7050s
	iters: 500, epoch: 1 | loss: 0.2624620
	speed: 0.0579s/iter; left time: 376.9774s
	iters: 600, epoch: 1 | loss: 0.2712422
	speed: 0.0590s/iter; left time: 378.5085s
	iters: 700, epoch: 1 | loss: 0.2654385
	speed: 0.0591s/iter; left time: 373.0507s
Epoch: 1 cost time: 42.39278697967529
Epoch: 1, Steps: 701 | Train Loss: 0.2882685 Vali Loss: 0.3655435 Test Loss: 0.4366976
Validation loss decreased (inf --> 0.365544).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2508432
	speed: 0.3007s/iter; left time: 1867.3586s
	iters: 200, epoch: 2 | loss: 0.2525676
	speed: 0.0597s/iter; left time: 364.6449s
	iters: 300, epoch: 2 | loss: 0.2752560
	speed: 0.0606s/iter; left time: 364.2064s
	iters: 400, epoch: 2 | loss: 0.2484940
	speed: 0.0577s/iter; left time: 340.9883s
	iters: 500, epoch: 2 | loss: 0.2612249
	speed: 0.0567s/iter; left time: 329.5278s
	iters: 600, epoch: 2 | loss: 0.2525321
	speed: 0.0559s/iter; left time: 319.2786s
	iters: 700, epoch: 2 | loss: 0.2613181
	speed: 0.0545s/iter; left time: 305.5377s
Epoch: 2 cost time: 41.6726348400116
Epoch: 2, Steps: 701 | Train Loss: 0.2610371 Vali Loss: 0.3586102 Test Loss: 0.4314739
Validation loss decreased (0.365544 --> 0.358610).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2600283
	speed: 0.3458s/iter; left time: 1905.1982s
	iters: 200, epoch: 3 | loss: 0.2514998
	speed: 0.0595s/iter; left time: 321.8406s
	iters: 300, epoch: 3 | loss: 0.2604985
	speed: 0.0598s/iter; left time: 317.4048s
	iters: 400, epoch: 3 | loss: 0.2626684
	speed: 0.0570s/iter; left time: 296.9818s
	iters: 500, epoch: 3 | loss: 0.2747240
	speed: 0.0574s/iter; left time: 293.2124s
	iters: 600, epoch: 3 | loss: 0.2321766
	speed: 0.0580s/iter; left time: 290.5424s
	iters: 700, epoch: 3 | loss: 0.2442848
	speed: 0.0579s/iter; left time: 284.2466s
Epoch: 3 cost time: 42.94521141052246
Epoch: 3, Steps: 701 | Train Loss: 0.2527609 Vali Loss: 0.3521713 Test Loss: 0.4214185
Validation loss decreased (0.358610 --> 0.352171).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2551723
	speed: 0.3589s/iter; left time: 1725.5649s
	iters: 200, epoch: 4 | loss: 0.2493381
	speed: 0.0577s/iter; left time: 271.4208s
	iters: 300, epoch: 4 | loss: 0.2553581
	speed: 0.0597s/iter; left time: 275.1334s
	iters: 400, epoch: 4 | loss: 0.2314270
	speed: 0.0573s/iter; left time: 258.4074s
	iters: 500, epoch: 4 | loss: 0.2459674
	speed: 0.0563s/iter; left time: 247.9993s
	iters: 600, epoch: 4 | loss: 0.2563263
	speed: 0.0552s/iter; left time: 237.6894s
	iters: 700, epoch: 4 | loss: 0.2369977
	speed: 0.0529s/iter; left time: 222.8005s
Epoch: 4 cost time: 41.90900373458862
Epoch: 4, Steps: 701 | Train Loss: 0.2490992 Vali Loss: 0.3468637 Test Loss: 0.4205020
Validation loss decreased (0.352171 --> 0.346864).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2266991
	speed: 0.3580s/iter; left time: 1470.1777s
	iters: 200, epoch: 5 | loss: 0.2584880
	speed: 0.0652s/iter; left time: 261.3772s
	iters: 300, epoch: 5 | loss: 0.2584959
	speed: 0.0612s/iter; left time: 238.9799s
	iters: 400, epoch: 5 | loss: 0.2565755
	speed: 0.0591s/iter; left time: 224.9619s
	iters: 500, epoch: 5 | loss: 0.2313074
	speed: 0.0628s/iter; left time: 232.7733s
	iters: 600, epoch: 5 | loss: 0.2635501
	speed: 0.0600s/iter; left time: 216.2472s
	iters: 700, epoch: 5 | loss: 0.2444086
	speed: 0.0579s/iter; left time: 203.0538s
Epoch: 5 cost time: 44.61733603477478
Epoch: 5, Steps: 701 | Train Loss: 0.2473658 Vali Loss: 0.3458901 Test Loss: 0.4191376
Validation loss decreased (0.346864 --> 0.345890).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2672709
	speed: 0.3572s/iter; left time: 1216.7658s
	iters: 200, epoch: 6 | loss: 0.2659093
	speed: 0.0597s/iter; left time: 197.2214s
	iters: 300, epoch: 6 | loss: 0.2554606
	speed: 0.0637s/iter; left time: 204.2178s
	iters: 400, epoch: 6 | loss: 0.2431053
	speed: 0.0596s/iter; left time: 185.2644s
	iters: 500, epoch: 6 | loss: 0.2358277
	speed: 0.0600s/iter; left time: 180.3349s
	iters: 600, epoch: 6 | loss: 0.2462268
	speed: 0.0589s/iter; left time: 171.0493s
	iters: 700, epoch: 6 | loss: 0.2380396
	speed: 0.0569s/iter; left time: 159.8003s
Epoch: 6 cost time: 43.8860137462616
Epoch: 6, Steps: 701 | Train Loss: 0.2463863 Vali Loss: 0.3446771 Test Loss: 0.4184996
Validation loss decreased (0.345890 --> 0.344677).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2427106
	speed: 0.3722s/iter; left time: 1006.7157s
	iters: 200, epoch: 7 | loss: 0.2616844
	speed: 0.0615s/iter; left time: 160.1405s
	iters: 300, epoch: 7 | loss: 0.2548754
	speed: 0.0626s/iter; left time: 156.8222s
	iters: 400, epoch: 7 | loss: 0.2455907
	speed: 0.0645s/iter; left time: 155.1749s
	iters: 500, epoch: 7 | loss: 0.2704792
	speed: 0.0650s/iter; left time: 149.9387s
	iters: 600, epoch: 7 | loss: 0.2711370
	speed: 0.0638s/iter; left time: 140.5724s
	iters: 700, epoch: 7 | loss: 0.2625059
	speed: 0.0597s/iter; left time: 125.7702s
Epoch: 7 cost time: 46.53572607040405
Epoch: 7, Steps: 701 | Train Loss: 0.2458567 Vali Loss: 0.3440487 Test Loss: 0.4182446
Validation loss decreased (0.344677 --> 0.344049).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2458343
	speed: 0.3695s/iter; left time: 740.4575s
	iters: 200, epoch: 8 | loss: 0.2773767
	speed: 0.0681s/iter; left time: 129.6614s
	iters: 300, epoch: 8 | loss: 0.2566539
	speed: 0.0602s/iter; left time: 108.6419s
	iters: 400, epoch: 8 | loss: 0.2630694
	speed: 0.0600s/iter; left time: 102.1845s
	iters: 500, epoch: 8 | loss: 0.2474651
	speed: 0.0615s/iter; left time: 98.5924s
	iters: 600, epoch: 8 | loss: 0.2618955
	speed: 0.0647s/iter; left time: 97.3560s
	iters: 700, epoch: 8 | loss: 0.2553129
	speed: 0.0587s/iter; left time: 82.3681s
Epoch: 8 cost time: 45.623892068862915
Epoch: 8, Steps: 701 | Train Loss: 0.2455747 Vali Loss: 0.3439567 Test Loss: 0.4173846
Validation loss decreased (0.344049 --> 0.343957).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2520603
	speed: 0.3445s/iter; left time: 448.8674s
	iters: 200, epoch: 9 | loss: 0.2302865
	speed: 0.0578s/iter; left time: 69.4852s
	iters: 300, epoch: 9 | loss: 0.2806459
	speed: 0.0652s/iter; left time: 71.9490s
	iters: 400, epoch: 9 | loss: 0.2266560
	speed: 0.0582s/iter; left time: 58.3966s
	iters: 500, epoch: 9 | loss: 0.2218839
	speed: 0.0605s/iter; left time: 54.6746s
	iters: 600, epoch: 9 | loss: 0.2534855
	speed: 0.0594s/iter; left time: 47.7233s
	iters: 700, epoch: 9 | loss: 0.2404835
	speed: 0.0635s/iter; left time: 44.6495s
Epoch: 9 cost time: 43.949525594711304
Epoch: 9, Steps: 701 | Train Loss: 0.2454388 Vali Loss: 0.3437769 Test Loss: 0.4170623
Validation loss decreased (0.343957 --> 0.343777).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2333871
	speed: 0.3495s/iter; left time: 210.4178s
	iters: 200, epoch: 10 | loss: 0.2397974
	speed: 0.0564s/iter; left time: 28.2888s
	iters: 300, epoch: 10 | loss: 0.2404005
	speed: 0.0591s/iter; left time: 23.7739s
	iters: 400, epoch: 10 | loss: 0.2535963
	speed: 0.0640s/iter; left time: 19.3403s
	iters: 500, epoch: 10 | loss: 0.2483507
	speed: 0.0610s/iter; left time: 12.3253s
	iters: 600, epoch: 10 | loss: 0.2518909
	speed: 0.0590s/iter; left time: 6.0213s
	iters: 700, epoch: 10 | loss: 0.2556345
	speed: 0.0592s/iter; left time: 0.1184s
Epoch: 10 cost time: 43.43600511550903
Epoch: 10, Steps: 701 | Train Loss: 0.2453395 Vali Loss: 0.3437719 Test Loss: 0.4169799
Validation loss decreased (0.343777 --> 0.343772).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : traffic_720_336_DLinear_custom_ftM_sl720_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3173
mse:0.41988225083351135, mae:0.28319369053840637
