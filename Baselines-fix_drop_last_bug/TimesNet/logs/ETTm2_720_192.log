True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm2_720_96        Model:              TimesNet            

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/          
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            720                 Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm2_720_96_TimesNet_ETTm2_ftM_sl720_ll48_pl192_dm16_nh8_el2_dl1_df32_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33649
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.5919304
	speed: 0.3172s/iter; left time: 9979.7668s
	iters: 200, epoch: 1 | loss: 0.4146662
	speed: 0.2651s/iter; left time: 8312.6033s
	iters: 300, epoch: 1 | loss: 0.2833919
	speed: 0.2746s/iter; left time: 8584.4772s
	iters: 400, epoch: 1 | loss: 0.3555180
	speed: 0.2602s/iter; left time: 8107.4889s
	iters: 500, epoch: 1 | loss: 0.2070501
	speed: 0.2911s/iter; left time: 9042.7073s
	iters: 600, epoch: 1 | loss: 0.3407528
	speed: 0.2812s/iter; left time: 8706.9559s
	iters: 700, epoch: 1 | loss: 0.2107262
	speed: 0.2824s/iter; left time: 8714.7528s
	iters: 800, epoch: 1 | loss: 0.2229400
	speed: 0.3125s/iter; left time: 9613.5653s
	iters: 900, epoch: 1 | loss: 0.2280016
	speed: 0.2682s/iter; left time: 8224.1642s
	iters: 1000, epoch: 1 | loss: 0.1673758
	speed: 0.2878s/iter; left time: 8794.6029s
Epoch: 1 cost time: 299.39208912849426
Epoch: 1, Steps: 1052 | Train Loss: 0.3059001 Vali Loss: 0.1966062 Test Loss: 0.2741110
Validation loss decreased (inf --> 0.196606).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2764546
	speed: 1.8601s/iter; left time: 56564.9884s
	iters: 200, epoch: 2 | loss: 0.1517559
	speed: 0.2569s/iter; left time: 7787.6063s
	iters: 300, epoch: 2 | loss: 0.2732653
	speed: 0.2872s/iter; left time: 8675.9687s
	iters: 400, epoch: 2 | loss: 0.2856666
	speed: 0.2684s/iter; left time: 8079.9153s
	iters: 500, epoch: 2 | loss: 0.2958740
	speed: 0.2642s/iter; left time: 7928.9952s
	iters: 600, epoch: 2 | loss: 0.2412785
	speed: 0.2927s/iter; left time: 8753.8004s
	iters: 700, epoch: 2 | loss: 0.1722359
	speed: 0.2568s/iter; left time: 7654.4591s
	iters: 800, epoch: 2 | loss: 0.1821517
	speed: 0.2699s/iter; left time: 8019.2064s
	iters: 900, epoch: 2 | loss: 0.2080437
	speed: 0.2743s/iter; left time: 8121.9534s
	iters: 1000, epoch: 2 | loss: 0.2382683
	speed: 0.2649s/iter; left time: 7816.7149s
Epoch: 2 cost time: 286.237441778183
Epoch: 2, Steps: 1052 | Train Loss: 0.2268441 Vali Loss: 0.2017559 Test Loss: 0.2823801
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1995033
	speed: 1.7524s/iter; left time: 51445.3492s
	iters: 200, epoch: 3 | loss: 0.2122272
	speed: 0.2795s/iter; left time: 8176.2932s
	iters: 300, epoch: 3 | loss: 0.1607625
	speed: 0.2587s/iter; left time: 7542.7724s
	iters: 400, epoch: 3 | loss: 0.1728436
	speed: 0.2672s/iter; left time: 7765.0254s
	iters: 500, epoch: 3 | loss: 0.1583447
	speed: 0.2637s/iter; left time: 7636.2999s
	iters: 600, epoch: 3 | loss: 0.2229942
	speed: 0.2687s/iter; left time: 7753.5584s
	iters: 700, epoch: 3 | loss: 0.1873338
	speed: 0.2853s/iter; left time: 8205.7446s
	iters: 800, epoch: 3 | loss: 0.1405915
	speed: 0.2740s/iter; left time: 7852.2874s
	iters: 900, epoch: 3 | loss: 0.1192149
	speed: 0.2588s/iter; left time: 7389.3027s
	iters: 1000, epoch: 3 | loss: 0.1431044
	speed: 0.2849s/iter; left time: 8106.7573s
Epoch: 3 cost time: 286.15012550354004
Epoch: 3, Steps: 1052 | Train Loss: 0.1947223 Vali Loss: 0.2039643 Test Loss: 0.2707089
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1501276
	speed: 1.7045s/iter; left time: 48246.7782s
	iters: 200, epoch: 4 | loss: 0.2039522
	speed: 0.2371s/iter; left time: 6688.3342s
	iters: 300, epoch: 4 | loss: 0.2604440
	speed: 0.2504s/iter; left time: 7037.9329s
	iters: 400, epoch: 4 | loss: 0.2063862
	speed: 0.2561s/iter; left time: 7171.5436s
	iters: 500, epoch: 4 | loss: 0.2028825
	speed: 0.2672s/iter; left time: 7457.1228s
	iters: 600, epoch: 4 | loss: 0.2881437
	speed: 0.2832s/iter; left time: 7874.8042s
	iters: 700, epoch: 4 | loss: 0.1298183
	speed: 0.2714s/iter; left time: 7518.1027s
	iters: 800, epoch: 4 | loss: 0.1581998
	speed: 0.2784s/iter; left time: 7684.0355s
	iters: 900, epoch: 4 | loss: 0.1277795
	speed: 0.2684s/iter; left time: 7383.6915s
	iters: 1000, epoch: 4 | loss: 0.1800031
	speed: 0.2640s/iter; left time: 7233.5766s
Epoch: 4 cost time: 277.3638126850128
Epoch: 4, Steps: 1052 | Train Loss: 0.1801050 Vali Loss: 0.2118965 Test Loss: 0.2775482
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm2_720_96_TimesNet_ETTm2_ftM_sl720_ll48_pl192_dm16_nh8_el2_dl1_df32_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
test shape: (11329, 192, 7) (11329, 192, 7)
test shape: (11329, 192, 7) (11329, 192, 7)
mse:0.27413663268089294, mae:0.3371597230434418, dtw:not calculated
