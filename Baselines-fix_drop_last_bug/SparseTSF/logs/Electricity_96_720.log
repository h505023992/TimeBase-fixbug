Args in experiment:
Namespace(is_training=1, model_id='Electricity_96_720', model='SparseTSF', data='custom', root_path='./dataset/', data_path='electricity.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=720, period_len=24, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=321, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=128, patience=5, learning_rate=0.02, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=2, use_multi_gpu=0, devices='0,1', test_flop=False)
Use GPU: cuda:2
>>>>>>>start training : Electricity_96_720_SparseTSF_custom_ftM_sl96_pl720_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17597
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.7715398
	speed: 0.2324s/iter; left time: 931.9655s
Epoch: 1 cost time: 29.713140726089478
Epoch: 1, Steps: 137 | Train Loss: 0.8413417 Vali Loss: 0.5700733 Test Loss: 0.6542471
Validation loss decreased (inf --> 0.570073).  Saving model ...
Updating learning rate to 0.02
	iters: 100, epoch: 2 | loss: 0.2793092
	speed: 0.4837s/iter; left time: 1873.8154s
Epoch: 2 cost time: 25.983686208724976
Epoch: 2, Steps: 137 | Train Loss: 0.3195003 Vali Loss: 0.2420156 Test Loss: 0.2746664
Validation loss decreased (0.570073 --> 0.242016).  Saving model ...
Updating learning rate to 0.02
	iters: 100, epoch: 3 | loss: 0.2701121
	speed: 0.4834s/iter; left time: 1806.4844s
Epoch: 3 cost time: 26.09592580795288
Epoch: 3, Steps: 137 | Train Loss: 0.2845524 Vali Loss: 0.2372513 Test Loss: 0.2681601
Validation loss decreased (0.242016 --> 0.237251).  Saving model ...
Updating learning rate to 0.02
	iters: 100, epoch: 4 | loss: 0.2811627
	speed: 0.4867s/iter; left time: 1752.0800s
Epoch: 4 cost time: 26.274650812149048
Epoch: 4, Steps: 137 | Train Loss: 0.2795255 Vali Loss: 0.2337017 Test Loss: 0.2648698
Validation loss decreased (0.237251 --> 0.233702).  Saving model ...
Updating learning rate to 0.016
	iters: 100, epoch: 5 | loss: 0.2860271
	speed: 0.4890s/iter; left time: 1693.2457s
Epoch: 5 cost time: 26.671882390975952
Epoch: 5, Steps: 137 | Train Loss: 0.2773785 Vali Loss: 0.2310840 Test Loss: 0.2627850
Validation loss decreased (0.233702 --> 0.231084).  Saving model ...
Updating learning rate to 0.012800000000000002
	iters: 100, epoch: 6 | loss: 0.2862085
	speed: 0.4964s/iter; left time: 1650.9859s
Epoch: 6 cost time: 25.912158012390137
Epoch: 6, Steps: 137 | Train Loss: 0.2763186 Vali Loss: 0.2311689 Test Loss: 0.2622482
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.010240000000000003
	iters: 100, epoch: 7 | loss: 0.2643627
	speed: 0.4897s/iter; left time: 1561.6474s
Epoch: 7 cost time: 26.38774347305298
Epoch: 7, Steps: 137 | Train Loss: 0.2759826 Vali Loss: 0.2305927 Test Loss: 0.2619067
Validation loss decreased (0.231084 --> 0.230593).  Saving model ...
Updating learning rate to 0.008192000000000001
	iters: 100, epoch: 8 | loss: 0.2716091
	speed: 0.4868s/iter; left time: 1485.8090s
Epoch: 8 cost time: 25.99834632873535
Epoch: 8, Steps: 137 | Train Loss: 0.2757603 Vali Loss: 0.2305389 Test Loss: 0.2616917
Validation loss decreased (0.230593 --> 0.230539).  Saving model ...
Updating learning rate to 0.0065536000000000014
	iters: 100, epoch: 9 | loss: 0.2759882
	speed: 0.4833s/iter; left time: 1408.8668s
Epoch: 9 cost time: 26.06414270401001
Epoch: 9, Steps: 137 | Train Loss: 0.2756514 Vali Loss: 0.2308080 Test Loss: 0.2618816
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005242880000000002
	iters: 100, epoch: 10 | loss: 0.2793919
	speed: 0.4743s/iter; left time: 1317.5393s
Epoch: 10 cost time: 24.85334873199463
Epoch: 10, Steps: 137 | Train Loss: 0.2757086 Vali Loss: 0.2308311 Test Loss: 0.2614780
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.004194304000000002
	iters: 100, epoch: 11 | loss: 0.2776492
	speed: 0.4839s/iter; left time: 1277.9269s
Epoch: 11 cost time: 25.643585443496704
Epoch: 11, Steps: 137 | Train Loss: 0.2756028 Vali Loss: 0.2305107 Test Loss: 0.2615219
Validation loss decreased (0.230539 --> 0.230511).  Saving model ...
Updating learning rate to 0.003355443200000002
	iters: 100, epoch: 12 | loss: 0.2851245
	speed: 0.4869s/iter; left time: 1219.2783s
Epoch: 12 cost time: 26.467398166656494
Epoch: 12, Steps: 137 | Train Loss: 0.2755386 Vali Loss: 0.2307208 Test Loss: 0.2615432
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.002684354560000001
	iters: 100, epoch: 13 | loss: 0.2771545
	speed: 0.4825s/iter; left time: 1141.9886s
Epoch: 13 cost time: 26.14607572555542
Epoch: 13, Steps: 137 | Train Loss: 0.2755798 Vali Loss: 0.2304754 Test Loss: 0.2614340
Validation loss decreased (0.230511 --> 0.230475).  Saving model ...
Updating learning rate to 0.0021474836480000013
	iters: 100, epoch: 14 | loss: 0.2848943
	speed: 0.5600s/iter; left time: 1248.7041s
Epoch: 14 cost time: 28.90919280052185
Epoch: 14, Steps: 137 | Train Loss: 0.2753653 Vali Loss: 0.2307144 Test Loss: 0.2615097
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0017179869184000011
	iters: 100, epoch: 15 | loss: 0.2789965
	speed: 0.6401s/iter; left time: 1339.6677s
Epoch: 15 cost time: 32.54929208755493
Epoch: 15, Steps: 137 | Train Loss: 0.2755340 Vali Loss: 0.2304820 Test Loss: 0.2614821
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.0013743895347200009
	iters: 100, epoch: 16 | loss: 0.2703719
	speed: 0.7158s/iter; left time: 1400.0434s
Epoch: 16 cost time: 35.44962286949158
Epoch: 16, Steps: 137 | Train Loss: 0.2755283 Vali Loss: 0.2305162 Test Loss: 0.2615153
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.0010995116277760007
	iters: 100, epoch: 17 | loss: 0.2721825
	speed: 0.7385s/iter; left time: 1343.3292s
Epoch: 17 cost time: 35.63347291946411
Epoch: 17, Steps: 137 | Train Loss: 0.2754444 Vali Loss: 0.2306180 Test Loss: 0.2614422
EarlyStopping counter: 4 out of 5
Updating learning rate to 0.0008796093022208007
	iters: 100, epoch: 18 | loss: 0.2671826
	speed: 0.7384s/iter; left time: 1241.9851s
Epoch: 18 cost time: 40.85765886306763
Epoch: 18, Steps: 137 | Train Loss: 0.2754285 Vali Loss: 0.2308243 Test Loss: 0.2615878
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : Electricity_96_720_SparseTSF_custom_ftM_sl96_pl720_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
mse:0.26014626026153564, mae:0.3279138505458832, rse:0.508787214756012
