Args in experiment:
Namespace(is_training=1, model_id='ETTm2_336_96', model='SparseTSF', data='ETTm2', root_path='./dataset/', data_path='ETTm2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, period_len=4, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=256, patience=5, learning_rate=0.02, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=2, use_multi_gpu=0, devices='0,1', test_flop=False)
Use GPU: cuda:2
>>>>>>>start training : ETTm2_336_96_SparseTSF_ETTm2_ftM_sl336_pl96_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.2200050
	speed: 0.1349s/iter; left time: 524.8419s
Epoch: 1 cost time: 15.93200159072876
Epoch: 1, Steps: 133 | Train Loss: 0.3136476 Vali Loss: 0.1413245 Test Loss: 0.1967515
Validation loss decreased (inf --> 0.141324).  Saving model ...
Updating learning rate to 0.02
	iters: 100, epoch: 2 | loss: 0.2058400
	speed: 0.2644s/iter; left time: 993.7601s
Epoch: 2 cost time: 11.5717933177948
Epoch: 2, Steps: 133 | Train Loss: 0.2300340 Vali Loss: 0.1211292 Test Loss: 0.1737712
Validation loss decreased (0.141324 --> 0.121129).  Saving model ...
Updating learning rate to 0.02
	iters: 100, epoch: 3 | loss: 0.2304283
	speed: 0.2603s/iter; left time: 943.6489s
Epoch: 3 cost time: 10.576142072677612
Epoch: 3, Steps: 133 | Train Loss: 0.2219112 Vali Loss: 0.1201845 Test Loss: 0.1671628
Validation loss decreased (0.121129 --> 0.120184).  Saving model ...
Updating learning rate to 0.02
	iters: 100, epoch: 4 | loss: 0.1998965
	speed: 0.2647s/iter; left time: 924.3902s
Epoch: 4 cost time: 10.709024429321289
Epoch: 4, Steps: 133 | Train Loss: 0.2196422 Vali Loss: 0.1182872 Test Loss: 0.1664056
Validation loss decreased (0.120184 --> 0.118287).  Saving model ...
Updating learning rate to 0.016
	iters: 100, epoch: 5 | loss: 0.1913223
	speed: 0.2721s/iter; left time: 913.9887s
Epoch: 5 cost time: 11.240145206451416
Epoch: 5, Steps: 133 | Train Loss: 0.2206363 Vali Loss: 0.1195202 Test Loss: 0.1677873
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.012800000000000002
	iters: 100, epoch: 6 | loss: 0.2179249
	speed: 0.2662s/iter; left time: 858.6240s
Epoch: 6 cost time: 11.19071888923645
Epoch: 6, Steps: 133 | Train Loss: 0.2179745 Vali Loss: 0.1188967 Test Loss: 0.1670025
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.010240000000000003
	iters: 100, epoch: 7 | loss: 0.2595935
	speed: 0.2744s/iter; left time: 848.6056s
Epoch: 7 cost time: 11.78126859664917
Epoch: 7, Steps: 133 | Train Loss: 0.2185173 Vali Loss: 0.1260324 Test Loss: 0.1727373
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.008192000000000001
	iters: 100, epoch: 8 | loss: 0.2085404
	speed: 0.2723s/iter; left time: 805.9581s
Epoch: 8 cost time: 11.25821566581726
Epoch: 8, Steps: 133 | Train Loss: 0.2173694 Vali Loss: 0.1176869 Test Loss: 0.1668615
Validation loss decreased (0.118287 --> 0.117687).  Saving model ...
Updating learning rate to 0.0065536000000000014
	iters: 100, epoch: 9 | loss: 0.2591000
	speed: 0.2653s/iter; left time: 749.8939s
Epoch: 9 cost time: 11.204800128936768
Epoch: 9, Steps: 133 | Train Loss: 0.2168353 Vali Loss: 0.1185106 Test Loss: 0.1667018
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.005242880000000002
	iters: 100, epoch: 10 | loss: 0.1997152
	speed: 0.2619s/iter; left time: 705.5338s
Epoch: 10 cost time: 11.125351905822754
Epoch: 10, Steps: 133 | Train Loss: 0.2156766 Vali Loss: 0.1193209 Test Loss: 0.1698505
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.004194304000000002
	iters: 100, epoch: 11 | loss: 0.2379431
	speed: 0.2683s/iter; left time: 687.1283s
Epoch: 11 cost time: 11.083651542663574
Epoch: 11, Steps: 133 | Train Loss: 0.2157137 Vali Loss: 0.1176269 Test Loss: 0.1663817
Validation loss decreased (0.117687 --> 0.117627).  Saving model ...
Updating learning rate to 0.003355443200000002
	iters: 100, epoch: 12 | loss: 0.2042870
	speed: 0.2657s/iter; left time: 645.0751s
Epoch: 12 cost time: 10.928035497665405
Epoch: 12, Steps: 133 | Train Loss: 0.2153918 Vali Loss: 0.1185875 Test Loss: 0.1668210
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.002684354560000001
	iters: 100, epoch: 13 | loss: 0.1785152
	speed: 0.2725s/iter; left time: 625.3310s
Epoch: 13 cost time: 11.143420219421387
Epoch: 13, Steps: 133 | Train Loss: 0.2155411 Vali Loss: 0.1173149 Test Loss: 0.1658672
Validation loss decreased (0.117627 --> 0.117315).  Saving model ...
Updating learning rate to 0.0021474836480000013
	iters: 100, epoch: 14 | loss: 0.2546090
	speed: 0.2739s/iter; left time: 592.2035s
Epoch: 14 cost time: 11.479756832122803
Epoch: 14, Steps: 133 | Train Loss: 0.2151720 Vali Loss: 0.1172496 Test Loss: 0.1669914
Validation loss decreased (0.117315 --> 0.117250).  Saving model ...
Updating learning rate to 0.0017179869184000011
	iters: 100, epoch: 15 | loss: 0.1726328
	speed: 0.2755s/iter; left time: 558.9557s
Epoch: 15 cost time: 11.743244171142578
Epoch: 15, Steps: 133 | Train Loss: 0.2149264 Vali Loss: 0.1176786 Test Loss: 0.1676392
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0013743895347200009
	iters: 100, epoch: 16 | loss: 0.2483297
	speed: 0.2668s/iter; left time: 505.8256s
Epoch: 16 cost time: 10.748899221420288
Epoch: 16, Steps: 133 | Train Loss: 0.2151622 Vali Loss: 0.1176781 Test Loss: 0.1662359
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.0010995116277760007
	iters: 100, epoch: 17 | loss: 0.2353299
	speed: 0.2362s/iter; left time: 416.3471s
Epoch: 17 cost time: 10.408608436584473
Epoch: 17, Steps: 133 | Train Loss: 0.2149405 Vali Loss: 0.1177716 Test Loss: 0.1659153
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.0008796093022208007
	iters: 100, epoch: 18 | loss: 0.2498274
	speed: 0.2684s/iter; left time: 437.5208s
Epoch: 18 cost time: 11.948448896408081
Epoch: 18, Steps: 133 | Train Loss: 0.2147141 Vali Loss: 0.1174188 Test Loss: 0.1667673
EarlyStopping counter: 4 out of 5
Updating learning rate to 0.0007036874417766406
	iters: 100, epoch: 19 | loss: 0.3145711
	speed: 0.2679s/iter; left time: 401.0871s
Epoch: 19 cost time: 10.932559967041016
Epoch: 19, Steps: 133 | Train Loss: 0.2147593 Vali Loss: 0.1175960 Test Loss: 0.1672266
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm2_336_96_SparseTSF_ETTm2_ftM_sl336_pl96_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.1676979511976242, mae:0.2562088370323181, rse:0.33201679587364197
