Args in experiment:
Namespace(is_training=1, model_id='ETTm1_192_96', model='iTransformer', data='ETTm1', root_path='./dataset/', data_path='ETTm1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=192, label_len=48, pred_len=96, enc_in=7, dec_in=7, c_out=7, d_model=128, n_heads=8, e_layers=2, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='MSE', lradj='type1', use_amp=False, use_gpu=True, gpu=2, use_multi_gpu=False, devices='0,1,2,3', exp_name='MTSF', channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv', efficient_training=False, use_norm=True, partial_start_index=0)
Use GPU: cuda:2
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.dropout.Dropout'>.
[INFO] Register count_convNd() for <class 'torch.nn.modules.conv.Conv1d'>.
[INFO] Register count_normalization() for <class 'torch.nn.modules.normalization.LayerNorm'>.
MACs: 3068416.0
Params: 236512.0
3.07M MACs
>>>>>>>start training : ETTm1_192_96_iTransformer_ETTm1_M_ft192_sl48_ll96_pl128_dm8_nh2_el1_dl128_df1_fctimeF_ebTrue_dtExp_projection_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34273
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.3606254
	speed: 0.0382s/iter; left time: 405.3566s
	iters: 200, epoch: 1 | loss: 0.3541353
	speed: 0.0249s/iter; left time: 261.6544s
	iters: 300, epoch: 1 | loss: 0.3210704
	speed: 0.0274s/iter; left time: 285.6985s
	iters: 400, epoch: 1 | loss: 0.2824092
	speed: 0.0264s/iter; left time: 272.5244s
	iters: 500, epoch: 1 | loss: 0.2436835
	speed: 0.0256s/iter; left time: 261.9034s
	iters: 600, epoch: 1 | loss: 0.3166311
	speed: 0.0255s/iter; left time: 257.9016s
	iters: 700, epoch: 1 | loss: 0.3133404
	speed: 0.0261s/iter; left time: 261.1293s
	iters: 800, epoch: 1 | loss: 0.3196098
	speed: 0.0254s/iter; left time: 251.7453s
	iters: 900, epoch: 1 | loss: 0.3176315
	speed: 0.0275s/iter; left time: 269.3609s
	iters: 1000, epoch: 1 | loss: 0.3130222
	speed: 0.0258s/iter; left time: 250.3173s
Max Memory (MB): 13.1796875
Epoch: 1 cost time: 29.23750948905945
Epoch: 1, Steps: 1071 | Train Loss: 0.3115091 Vali Loss: 0.3810677 Test Loss: 0.3175783
Validation loss decreased (inf --> 0.381068).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3156411
	speed: 0.8240s/iter; left time: 7861.4086s
	iters: 200, epoch: 2 | loss: 0.3188196
	speed: 0.0241s/iter; left time: 227.6742s
	iters: 300, epoch: 2 | loss: 0.3165729
	speed: 0.0247s/iter; left time: 231.1381s
	iters: 400, epoch: 2 | loss: 0.2558668
	speed: 0.0283s/iter; left time: 261.5163s
	iters: 500, epoch: 2 | loss: 0.2716137
	speed: 0.0277s/iter; left time: 252.9044s
	iters: 600, epoch: 2 | loss: 0.2679234
	speed: 0.0271s/iter; left time: 244.5425s
	iters: 700, epoch: 2 | loss: 0.2543525
	speed: 0.0272s/iter; left time: 243.2038s
	iters: 800, epoch: 2 | loss: 0.1984077
	speed: 0.0268s/iter; left time: 236.9865s
	iters: 900, epoch: 2 | loss: 0.2741638
	speed: 0.0267s/iter; left time: 233.3851s
	iters: 1000, epoch: 2 | loss: 0.2772172
	speed: 0.0269s/iter; left time: 232.5717s
Max Memory (MB): 13.1796875
Epoch: 2 cost time: 29.143397569656372
Epoch: 2, Steps: 1071 | Train Loss: 0.2640087 Vali Loss: 0.3738284 Test Loss: 0.3124955
Validation loss decreased (0.381068 --> 0.373828).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2509251
	speed: 0.8251s/iter; left time: 6988.1389s
	iters: 200, epoch: 3 | loss: 0.2154444
	speed: 0.0254s/iter; left time: 212.6938s
	iters: 300, epoch: 3 | loss: 0.2487135
	speed: 0.0244s/iter; left time: 201.4853s
	iters: 400, epoch: 3 | loss: 0.2777415
	speed: 0.0231s/iter; left time: 188.4399s
	iters: 500, epoch: 3 | loss: 0.3162558
	speed: 0.0254s/iter; left time: 204.6495s
	iters: 600, epoch: 3 | loss: 0.2354305
	speed: 0.0245s/iter; left time: 195.5547s
	iters: 700, epoch: 3 | loss: 0.2254570
	speed: 0.0241s/iter; left time: 189.6467s
	iters: 800, epoch: 3 | loss: 0.3214890
	speed: 0.0246s/iter; left time: 191.3809s
	iters: 900, epoch: 3 | loss: 0.2169726
	speed: 0.0242s/iter; left time: 185.3472s
	iters: 1000, epoch: 3 | loss: 0.2544505
	speed: 0.0260s/iter; left time: 196.8240s
Max Memory (MB): 13.1796875
Epoch: 3 cost time: 27.259930849075317
Epoch: 3, Steps: 1071 | Train Loss: 0.2518815 Vali Loss: 0.3686246 Test Loss: 0.3105159
Validation loss decreased (0.373828 --> 0.368625).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2485512
	speed: 0.9416s/iter; left time: 6965.8681s
	iters: 200, epoch: 4 | loss: 0.2204551
	speed: 0.0298s/iter; left time: 217.5636s
	iters: 300, epoch: 4 | loss: 0.2136383
	speed: 0.0322s/iter; left time: 231.8010s
	iters: 400, epoch: 4 | loss: 0.3161864
	speed: 0.0285s/iter; left time: 202.4207s
	iters: 500, epoch: 4 | loss: 0.2564343
	speed: 0.0276s/iter; left time: 193.1319s
	iters: 600, epoch: 4 | loss: 0.2787031
	speed: 0.0297s/iter; left time: 204.9525s
	iters: 700, epoch: 4 | loss: 0.2962472
	speed: 0.0286s/iter; left time: 194.5661s
	iters: 800, epoch: 4 | loss: 0.2326124
	speed: 0.0284s/iter; left time: 190.1685s
	iters: 900, epoch: 4 | loss: 0.2967929
	speed: 0.0275s/iter; left time: 181.6574s
	iters: 1000, epoch: 4 | loss: 0.2394179
	speed: 0.0274s/iter; left time: 178.2522s
Max Memory (MB): 13.1796875
Epoch: 4 cost time: 32.136393547058105
Epoch: 4, Steps: 1071 | Train Loss: 0.2470071 Vali Loss: 0.3648016 Test Loss: 0.3154985
Validation loss decreased (0.368625 --> 0.364802).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2713208
	speed: 0.8257s/iter; left time: 5223.9710s
	iters: 200, epoch: 5 | loss: 0.2645345
	speed: 0.0237s/iter; left time: 147.8623s
	iters: 300, epoch: 5 | loss: 0.2124047
	speed: 0.0247s/iter; left time: 151.1765s
	iters: 400, epoch: 5 | loss: 0.3653701
	speed: 0.0249s/iter; left time: 150.3263s
	iters: 500, epoch: 5 | loss: 0.2383216
	speed: 0.0235s/iter; left time: 139.2902s
	iters: 600, epoch: 5 | loss: 0.2328003
	speed: 0.0242s/iter; left time: 140.8072s
	iters: 700, epoch: 5 | loss: 0.2614330
	speed: 0.0250s/iter; left time: 143.0708s
	iters: 800, epoch: 5 | loss: 0.2237813
	speed: 0.0241s/iter; left time: 135.4600s
	iters: 900, epoch: 5 | loss: 0.2545625
	speed: 0.0244s/iter; left time: 134.6939s
	iters: 1000, epoch: 5 | loss: 0.2561280
	speed: 0.0237s/iter; left time: 128.8637s
Max Memory (MB): 13.1796875
Epoch: 5 cost time: 26.711620092391968
Epoch: 5, Steps: 1071 | Train Loss: 0.2447890 Vali Loss: 0.3661696 Test Loss: 0.3104695
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2884732
	speed: 0.8471s/iter; left time: 4452.4290s
	iters: 200, epoch: 6 | loss: 0.1880384
	speed: 0.0224s/iter; left time: 115.5903s
	iters: 300, epoch: 6 | loss: 0.2072179
	speed: 0.0246s/iter; left time: 124.5172s
	iters: 400, epoch: 6 | loss: 0.2092806
	speed: 0.0242s/iter; left time: 119.6931s
	iters: 500, epoch: 6 | loss: 0.2266275
	speed: 0.0236s/iter; left time: 114.7582s
	iters: 600, epoch: 6 | loss: 0.2473030
	speed: 0.0231s/iter; left time: 110.0420s
	iters: 700, epoch: 6 | loss: 0.3178625
	speed: 0.0236s/iter; left time: 110.0024s
	iters: 800, epoch: 6 | loss: 0.2694972
	speed: 0.0226s/iter; left time: 103.0367s
	iters: 900, epoch: 6 | loss: 0.2030308
	speed: 0.0225s/iter; left time: 100.4336s
	iters: 1000, epoch: 6 | loss: 0.2344643
	speed: 0.0247s/iter; left time: 107.4806s
Max Memory (MB): 13.1796875
Epoch: 6 cost time: 25.834601402282715
Epoch: 6, Steps: 1071 | Train Loss: 0.2437062 Vali Loss: 0.3658535 Test Loss: 0.3110603
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2840639
	speed: 0.8330s/iter; left time: 3486.1790s
	iters: 200, epoch: 7 | loss: 0.1885668
	speed: 0.0282s/iter; left time: 115.0376s
	iters: 300, epoch: 7 | loss: 0.2655347
	speed: 0.0268s/iter; left time: 106.7581s
	iters: 400, epoch: 7 | loss: 0.3267517
	speed: 0.0270s/iter; left time: 104.9279s
	iters: 500, epoch: 7 | loss: 0.2355731
	speed: 0.0256s/iter; left time: 96.7589s
	iters: 600, epoch: 7 | loss: 0.1791050
	speed: 0.0252s/iter; left time: 92.8272s
	iters: 700, epoch: 7 | loss: 0.2701514
	speed: 0.0235s/iter; left time: 84.0710s
	iters: 800, epoch: 7 | loss: 0.2095442
	speed: 0.0243s/iter; left time: 84.7826s
	iters: 900, epoch: 7 | loss: 0.2262267
	speed: 0.0230s/iter; left time: 77.8314s
	iters: 1000, epoch: 7 | loss: 0.2590704
	speed: 0.0243s/iter; left time: 79.8223s
Max Memory (MB): 13.1796875
Epoch: 7 cost time: 28.281066417694092
Epoch: 7, Steps: 1071 | Train Loss: 0.2433263 Vali Loss: 0.3654458 Test Loss: 0.3110972
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm1_192_96_iTransformer_ETTm1_M_ft192_sl48_ll96_pl128_dm8_nh2_el1_dl128_df1_fctimeF_ebTrue_dtExp_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
test shape: (11425, 1, 96, 7) (11425, 1, 96, 7)
test shape: (11425, 96, 7) (11425, 96, 7)
mse:0.3154984130859375, mae:0.35235950350761414
