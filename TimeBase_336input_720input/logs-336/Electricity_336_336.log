Args in experiment:
Namespace(is_training=1, model_id='Electricity_336_336', model='LightTimeBaseTST', data='custom', root_path='./dataset/', data_path='electricity.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=336, period_len=24, basis_num=6, use_period_norm=1, use_orthogonal=1, orthogonal_weight=0.04, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=7, individual=1, embed_type=0, enc_in=321, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=256, patience=5, learning_rate=0.5, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=5, use_multi_gpu=0, devices='0,1', test_flop=False)
Use GPU: cuda:5
60348
>>>>>>>start training : Electricity_336_336_LightTimeBaseTST_custom_ftM_sl336_pl336_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17741
val 2297
test 4925
Epoch: 1 cost time: 93.02050352096558
Epoch: 1, Steps: 70 | Train Loss: 0.2228054 Vali Loss: 0.1685713 Test Loss: 0.1989717
Validation loss decreased (inf --> 0.168571).  Saving model ...
Updating learning rate to 0.5
Epoch: 2 cost time: 93.2441840171814
Epoch: 2, Steps: 70 | Train Loss: 0.2636652 Vali Loss: 0.1860870 Test Loss: 0.2164015
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.5
Epoch: 3 cost time: 89.76012325286865
Epoch: 3, Steps: 70 | Train Loss: 0.2004573 Vali Loss: 0.1727357 Test Loss: 0.2045961
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.5
Epoch: 4 cost time: 85.32483959197998
Epoch: 4, Steps: 70 | Train Loss: 0.2045668 Vali Loss: 0.1781004 Test Loss: 0.2056872
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.4
Epoch: 5 cost time: 89.80027508735657
Epoch: 5, Steps: 70 | Train Loss: 0.1939046 Vali Loss: 0.1652083 Test Loss: 0.1931017
Validation loss decreased (0.168571 --> 0.165208).  Saving model ...
Updating learning rate to 0.32000000000000006
Epoch: 6 cost time: 91.95012021064758
Epoch: 6, Steps: 70 | Train Loss: 0.1882891 Vali Loss: 0.1653107 Test Loss: 0.1906313
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.25600000000000006
Epoch: 7 cost time: 82.45457243919373
Epoch: 7, Steps: 70 | Train Loss: 0.1859150 Vali Loss: 0.1591081 Test Loss: 0.1888749
Validation loss decreased (0.165208 --> 0.159108).  Saving model ...
Updating learning rate to 0.20480000000000004
Epoch: 8 cost time: 86.37531757354736
Epoch: 8, Steps: 70 | Train Loss: 0.1840464 Vali Loss: 0.1581867 Test Loss: 0.1864877
Validation loss decreased (0.159108 --> 0.158187).  Saving model ...
Updating learning rate to 0.16384000000000004
Epoch: 9 cost time: 88.58145093917847
Epoch: 9, Steps: 70 | Train Loss: 0.1825589 Vali Loss: 0.1568577 Test Loss: 0.1855284
Validation loss decreased (0.158187 --> 0.156858).  Saving model ...
Updating learning rate to 0.13107200000000005
Epoch: 10 cost time: 84.36360144615173
Epoch: 10, Steps: 70 | Train Loss: 0.1818238 Vali Loss: 0.1548879 Test Loss: 0.1843165
Validation loss decreased (0.156858 --> 0.154888).  Saving model ...
Updating learning rate to 0.10485760000000004
Epoch: 11 cost time: 84.58584690093994
Epoch: 11, Steps: 70 | Train Loss: 0.1804614 Vali Loss: 0.1529243 Test Loss: 0.1828101
Validation loss decreased (0.154888 --> 0.152924).  Saving model ...
Updating learning rate to 0.08388608000000004
Epoch: 12 cost time: 90.4258325099945
Epoch: 12, Steps: 70 | Train Loss: 0.1797460 Vali Loss: 0.1551059 Test Loss: 0.1821762
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.06710886400000003
Epoch: 13 cost time: 87.9554398059845
Epoch: 13, Steps: 70 | Train Loss: 0.1791400 Vali Loss: 0.1531891 Test Loss: 0.1820141
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.05368709120000003
Epoch: 14 cost time: 89.53313302993774
Epoch: 14, Steps: 70 | Train Loss: 0.1782940 Vali Loss: 0.1519845 Test Loss: 0.1808035
Validation loss decreased (0.152924 --> 0.151984).  Saving model ...
Updating learning rate to 0.042949672960000025
Epoch: 15 cost time: 94.16325378417969
Epoch: 15, Steps: 70 | Train Loss: 0.1780216 Vali Loss: 0.1516907 Test Loss: 0.1803574
Validation loss decreased (0.151984 --> 0.151691).  Saving model ...
Updating learning rate to 0.03435973836800002
Epoch: 16 cost time: 89.59964346885681
Epoch: 16, Steps: 70 | Train Loss: 0.1775841 Vali Loss: 0.1509920 Test Loss: 0.1798198
Validation loss decreased (0.151691 --> 0.150992).  Saving model ...
Updating learning rate to 0.027487790694400018
Epoch: 17 cost time: 85.19934558868408
Epoch: 17, Steps: 70 | Train Loss: 0.1771991 Vali Loss: 0.1513593 Test Loss: 0.1793860
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.021990232555520017
Epoch: 18 cost time: 86.68137884140015
Epoch: 18, Steps: 70 | Train Loss: 0.1769539 Vali Loss: 0.1506852 Test Loss: 0.1794391
Validation loss decreased (0.150992 --> 0.150685).  Saving model ...
Updating learning rate to 0.017592186044416015
Epoch: 19 cost time: 79.42936587333679
Epoch: 19, Steps: 70 | Train Loss: 0.1768430 Vali Loss: 0.1510132 Test Loss: 0.1795879
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.014073748835532812
Epoch: 20 cost time: 83.11773228645325
Epoch: 20, Steps: 70 | Train Loss: 0.1765099 Vali Loss: 0.1502426 Test Loss: 0.1792536
Validation loss decreased (0.150685 --> 0.150243).  Saving model ...
Updating learning rate to 0.011258999068426251
Epoch: 21 cost time: 84.7280604839325
Epoch: 21, Steps: 70 | Train Loss: 0.1762243 Vali Loss: 0.1504466 Test Loss: 0.1785508
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.009007199254741001
Epoch: 22 cost time: 80.82193994522095
Epoch: 22, Steps: 70 | Train Loss: 0.1760624 Vali Loss: 0.1501306 Test Loss: 0.1787008
Validation loss decreased (0.150243 --> 0.150131).  Saving model ...
Updating learning rate to 0.007205759403792801
Epoch: 23 cost time: 83.76004695892334
Epoch: 23, Steps: 70 | Train Loss: 0.1760609 Vali Loss: 0.1498529 Test Loss: 0.1785094
Validation loss decreased (0.150131 --> 0.149853).  Saving model ...
Updating learning rate to 0.0057646075230342415
Epoch: 24 cost time: 86.81984877586365
Epoch: 24, Steps: 70 | Train Loss: 0.1758478 Vali Loss: 0.1498515 Test Loss: 0.1786860
Validation loss decreased (0.149853 --> 0.149852).  Saving model ...
Updating learning rate to 0.0046116860184273935
Epoch: 25 cost time: 80.70177268981934
Epoch: 25, Steps: 70 | Train Loss: 0.1756874 Vali Loss: 0.1497712 Test Loss: 0.1785204
Validation loss decreased (0.149852 --> 0.149771).  Saving model ...
Updating learning rate to 0.003689348814741915
Epoch: 26 cost time: 86.4841001033783
Epoch: 26, Steps: 70 | Train Loss: 0.1757117 Vali Loss: 0.1500269 Test Loss: 0.1779691
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.002951479051793532
Epoch: 27 cost time: 84.40607905387878
Epoch: 27, Steps: 70 | Train Loss: 0.1755271 Vali Loss: 0.1503862 Test Loss: 0.1779148
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.002361183241434826
Epoch: 28 cost time: 84.19493269920349
Epoch: 28, Steps: 70 | Train Loss: 0.1755399 Vali Loss: 0.1502589 Test Loss: 0.1781841
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.0018889465931478608
Epoch: 29 cost time: 80.75570011138916
Epoch: 29, Steps: 70 | Train Loss: 0.1753321 Vali Loss: 0.1503776 Test Loss: 0.1779274
EarlyStopping counter: 4 out of 5
Updating learning rate to 0.0015111572745182887
Epoch: 30 cost time: 76.82021307945251
Epoch: 30, Steps: 70 | Train Loss: 0.1753214 Vali Loss: 0.1496945 Test Loss: 0.1781833
Validation loss decreased (0.149771 --> 0.149694).  Saving model ...
Updating learning rate to 0.001208925819614631
>>>>>>>testing : Electricity_336_336_LightTimeBaseTST_custom_ftM_sl336_pl336_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4925
mse:0.17190219461917877, mae:0.2617422342300415, rse:0.41265013813972473
