Args in experiment:
Namespace(is_training=1, train_only=False, model_id='DLinear_electricity_336_336', model='DLinear', data='custom', root_path='./dataset/', data_path='electricity.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=336, individual=False, embed_type=0, enc_in=321, dec_in=321, c_out=321, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DLinear_electricity_336_336_DLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17741
val 2297
test 4925
	iters: 100, epoch: 1 | loss: 0.3641900
	speed: 0.1050s/iter; left time: 1737.5894s
	iters: 200, epoch: 1 | loss: 0.2863937
	speed: 0.0839s/iter; left time: 1380.1325s
	iters: 300, epoch: 1 | loss: 0.2503498
	speed: 0.0849s/iter; left time: 1387.8147s
	iters: 400, epoch: 1 | loss: 0.2272559
	speed: 0.0840s/iter; left time: 1365.3392s
	iters: 500, epoch: 1 | loss: 0.2291682
	speed: 0.0866s/iter; left time: 1398.6504s
Epoch: 1 cost time: 49.024693965911865
Epoch: 1, Steps: 555 | Train Loss: 0.3234232 Vali Loss: 0.1965524 Test Loss: 0.2222971
Validation loss decreased (inf --> 0.196552).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2224766
	speed: 0.4367s/iter; left time: 6985.0701s
	iters: 200, epoch: 2 | loss: 0.2291189
	speed: 0.0667s/iter; left time: 1061.0206s
	iters: 300, epoch: 2 | loss: 0.2198361
	speed: 0.0677s/iter; left time: 1069.4803s
	iters: 400, epoch: 2 | loss: 0.2046698
	speed: 0.0658s/iter; left time: 1033.2536s
	iters: 500, epoch: 2 | loss: 0.2119391
	speed: 0.0665s/iter; left time: 1037.4652s
Epoch: 2 cost time: 38.31349205970764
Epoch: 2, Steps: 555 | Train Loss: 0.2134412 Vali Loss: 0.1728646 Test Loss: 0.1976624
Validation loss decreased (0.196552 --> 0.172865).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2178716
	speed: 0.4513s/iter; left time: 6968.2695s
	iters: 200, epoch: 3 | loss: 0.1726183
	speed: 0.0767s/iter; left time: 1176.9109s
	iters: 300, epoch: 3 | loss: 0.2228335
	speed: 0.0748s/iter; left time: 1139.7515s
	iters: 400, epoch: 3 | loss: 0.2269623
	speed: 0.0744s/iter; left time: 1126.2979s
	iters: 500, epoch: 3 | loss: 0.2167365
	speed: 0.0745s/iter; left time: 1121.1359s
Epoch: 3 cost time: 43.647390365600586
Epoch: 3, Steps: 555 | Train Loss: 0.1997297 Vali Loss: 0.1665843 Test Loss: 0.1911579
Validation loss decreased (0.172865 --> 0.166584).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1977928
	speed: 0.4930s/iter; left time: 7339.0146s
	iters: 200, epoch: 4 | loss: 0.1842962
	speed: 0.0708s/iter; left time: 1047.5764s
	iters: 300, epoch: 4 | loss: 0.2241175
	speed: 0.0747s/iter; left time: 1096.3544s
	iters: 400, epoch: 4 | loss: 0.2046324
	speed: 0.0744s/iter; left time: 1084.9683s
	iters: 500, epoch: 4 | loss: 0.1744156
	speed: 0.0706s/iter; left time: 1022.3730s
Epoch: 4 cost time: 42.07118368148804
Epoch: 4, Steps: 555 | Train Loss: 0.1953406 Vali Loss: 0.1638838 Test Loss: 0.1881975
Validation loss decreased (0.166584 --> 0.163884).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1941588
	speed: 0.5508s/iter; left time: 7893.2991s
	iters: 200, epoch: 5 | loss: 0.1900593
	speed: 0.0767s/iter; left time: 1092.2193s
	iters: 300, epoch: 5 | loss: 0.1832792
	speed: 0.0765s/iter; left time: 1080.9120s
	iters: 400, epoch: 5 | loss: 0.2056636
	speed: 0.0749s/iter; left time: 1050.5769s
	iters: 500, epoch: 5 | loss: 0.1907872
	speed: 0.0784s/iter; left time: 1092.7367s
Epoch: 5 cost time: 44.74515986442566
Epoch: 5, Steps: 555 | Train Loss: 0.1933744 Vali Loss: 0.1626732 Test Loss: 0.1869465
Validation loss decreased (0.163884 --> 0.162673).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2059242
	speed: 0.5298s/iter; left time: 7298.3029s
	iters: 200, epoch: 6 | loss: 0.1755182
	speed: 0.0836s/iter; left time: 1143.5605s
	iters: 300, epoch: 6 | loss: 0.2209012
	speed: 0.0858s/iter; left time: 1165.3387s
	iters: 400, epoch: 6 | loss: 0.1743986
	speed: 0.0866s/iter; left time: 1167.5294s
	iters: 500, epoch: 6 | loss: 0.1878589
	speed: 0.0850s/iter; left time: 1137.1915s
Epoch: 6 cost time: 49.600871324539185
Epoch: 6, Steps: 555 | Train Loss: 0.1924330 Vali Loss: 0.1620627 Test Loss: 0.1862112
Validation loss decreased (0.162673 --> 0.162063).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1760705
	speed: 0.5505s/iter; left time: 7278.6632s
	iters: 200, epoch: 7 | loss: 0.1790917
	speed: 0.0744s/iter; left time: 975.7787s
	iters: 300, epoch: 7 | loss: 0.2083003
	speed: 0.0756s/iter; left time: 984.6759s
	iters: 400, epoch: 7 | loss: 0.2018465
	speed: 0.0799s/iter; left time: 1033.0095s
	iters: 500, epoch: 7 | loss: 0.1911451
	speed: 0.0771s/iter; left time: 989.1209s
Epoch: 7 cost time: 44.34426498413086
Epoch: 7, Steps: 555 | Train Loss: 0.1918737 Vali Loss: 0.1616976 Test Loss: 0.1859139
Validation loss decreased (0.162063 --> 0.161698).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1772183
	speed: 0.4817s/iter; left time: 6100.7803s
	iters: 200, epoch: 8 | loss: 0.1854685
	speed: 0.0653s/iter; left time: 820.8732s
	iters: 300, epoch: 8 | loss: 0.1957653
	speed: 0.0646s/iter; left time: 805.1940s
	iters: 400, epoch: 8 | loss: 0.1751087
	speed: 0.0624s/iter; left time: 771.5985s
	iters: 500, epoch: 8 | loss: 0.1775619
	speed: 0.0623s/iter; left time: 764.6264s
Epoch: 8 cost time: 37.59216356277466
Epoch: 8, Steps: 555 | Train Loss: 0.1916007 Vali Loss: 0.1615390 Test Loss: 0.1857152
Validation loss decreased (0.161698 --> 0.161539).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2089694
	speed: 0.5302s/iter; left time: 6420.8759s
	iters: 200, epoch: 9 | loss: 0.2082641
	speed: 0.0846s/iter; left time: 1015.6928s
	iters: 300, epoch: 9 | loss: 0.1730515
	speed: 0.0838s/iter; left time: 997.6991s
	iters: 400, epoch: 9 | loss: 0.1965503
	speed: 0.0822s/iter; left time: 971.3294s
	iters: 500, epoch: 9 | loss: 0.2055104
	speed: 0.0823s/iter; left time: 964.0297s
Epoch: 9 cost time: 48.47258734703064
Epoch: 9, Steps: 555 | Train Loss: 0.1914691 Vali Loss: 0.1614497 Test Loss: 0.1856261
Validation loss decreased (0.161539 --> 0.161450).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1957585
	speed: 0.5574s/iter; left time: 6441.3128s
	iters: 200, epoch: 10 | loss: 0.1681348
	speed: 0.0806s/iter; left time: 923.2467s
	iters: 300, epoch: 10 | loss: 0.1952108
	speed: 0.0757s/iter; left time: 859.6159s
	iters: 400, epoch: 10 | loss: 0.1937583
	speed: 0.0714s/iter; left time: 803.3110s
	iters: 500, epoch: 10 | loss: 0.1914329
	speed: 0.0719s/iter; left time: 802.2158s
Epoch: 10 cost time: 44.02847385406494
Epoch: 10, Steps: 555 | Train Loss: 0.1913695 Vali Loss: 0.1613597 Test Loss: 0.1855643
Validation loss decreased (0.161450 --> 0.161360).  Saving model ...
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.2273489
	speed: 0.4454s/iter; left time: 4899.4809s
	iters: 200, epoch: 11 | loss: 0.1566539
	speed: 0.0630s/iter; left time: 686.9597s
	iters: 300, epoch: 11 | loss: 0.2044962
	speed: 0.0666s/iter; left time: 719.2919s
	iters: 400, epoch: 11 | loss: 0.1791844
	speed: 0.0691s/iter; left time: 739.0641s
	iters: 500, epoch: 11 | loss: 0.2033789
	speed: 0.0683s/iter; left time: 723.5879s
Epoch: 11 cost time: 38.34395909309387
Epoch: 11, Steps: 555 | Train Loss: 0.1913622 Vali Loss: 0.1613363 Test Loss: 0.1855360
Validation loss decreased (0.161360 --> 0.161336).  Saving model ...
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1960367
	speed: 0.4656s/iter; left time: 4863.6235s
	iters: 200, epoch: 12 | loss: 0.1835615
	speed: 0.0694s/iter; left time: 718.2503s
	iters: 300, epoch: 12 | loss: 0.1915315
	speed: 0.0741s/iter; left time: 759.0337s
	iters: 400, epoch: 12 | loss: 0.1998162
	speed: 0.0747s/iter; left time: 757.5628s
	iters: 500, epoch: 12 | loss: 0.1999260
	speed: 0.0738s/iter; left time: 741.3670s
Epoch: 12 cost time: 41.851089000701904
Epoch: 12, Steps: 555 | Train Loss: 0.1913232 Vali Loss: 0.1613280 Test Loss: 0.1855230
Validation loss decreased (0.161336 --> 0.161328).  Saving model ...
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.1812158
	speed: 0.5224s/iter; left time: 5167.0884s
	iters: 200, epoch: 13 | loss: 0.2015806
	speed: 0.0801s/iter; left time: 783.9679s
	iters: 300, epoch: 13 | loss: 0.1848963
	speed: 0.0818s/iter; left time: 792.8577s
	iters: 400, epoch: 13 | loss: 0.1951993
	speed: 0.0805s/iter; left time: 772.5383s
	iters: 500, epoch: 13 | loss: 0.1624084
	speed: 0.0840s/iter; left time: 796.8178s
Epoch: 13 cost time: 47.223326683044434
Epoch: 13, Steps: 555 | Train Loss: 0.1913234 Vali Loss: 0.1613132 Test Loss: 0.1855164
Validation loss decreased (0.161328 --> 0.161313).  Saving model ...
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.1787472
	speed: 0.5408s/iter; left time: 5048.7371s
	iters: 200, epoch: 14 | loss: 0.1829737
	speed: 0.0770s/iter; left time: 711.5094s
	iters: 300, epoch: 14 | loss: 0.2130131
	speed: 0.0761s/iter; left time: 695.6955s
	iters: 400, epoch: 14 | loss: 0.2055925
	speed: 0.0757s/iter; left time: 684.3365s
	iters: 500, epoch: 14 | loss: 0.1913785
	speed: 0.0752s/iter; left time: 671.6851s
Epoch: 14 cost time: 44.102108001708984
Epoch: 14, Steps: 555 | Train Loss: 0.1912726 Vali Loss: 0.1613327 Test Loss: 0.1855133
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.220703125e-08
	iters: 100, epoch: 15 | loss: 0.2145620
	speed: 0.4524s/iter; left time: 3972.2979s
	iters: 200, epoch: 15 | loss: 0.2017176
	speed: 0.0668s/iter; left time: 579.5975s
	iters: 300, epoch: 15 | loss: 0.1908099
	speed: 0.0748s/iter; left time: 641.5557s
	iters: 400, epoch: 15 | loss: 0.2032365
	speed: 0.0703s/iter; left time: 596.3359s
	iters: 500, epoch: 15 | loss: 0.1680782
	speed: 0.0684s/iter; left time: 573.3039s
Epoch: 15 cost time: 40.42805814743042
Epoch: 15, Steps: 555 | Train Loss: 0.1913635 Vali Loss: 0.1613343 Test Loss: 0.1855116
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.103515625e-09
	iters: 100, epoch: 16 | loss: 0.1795380
	speed: 0.4590s/iter; left time: 3775.6237s
	iters: 200, epoch: 16 | loss: 0.1973472
	speed: 0.0680s/iter; left time: 552.5828s
	iters: 300, epoch: 16 | loss: 0.1591634
	speed: 0.0668s/iter; left time: 535.7875s
	iters: 400, epoch: 16 | loss: 0.1788764
	speed: 0.0667s/iter; left time: 528.7544s
	iters: 500, epoch: 16 | loss: 0.1927021
	speed: 0.0706s/iter; left time: 552.1715s
Epoch: 16 cost time: 39.75489830970764
Epoch: 16, Steps: 555 | Train Loss: 0.1913040 Vali Loss: 0.1613542 Test Loss: 0.1855109
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : DLinear_electricity_336_336_DLinear_custom_ftM_sl336_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4925
mse:0.18540559709072113, mae:0.2893422842025757
