True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm1_96_96         Model:              TimesNet            

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/          
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm1_96_96_TimesNet_ETTm1_ftM_sl96_ll48_pl96_dm16_nh8_el2_dl1_df32_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.3166772
	speed: 0.1682s/iter; left time: 5406.6865s
	iters: 200, epoch: 1 | loss: 0.3360262
	speed: 0.1391s/iter; left time: 4458.5717s
	iters: 300, epoch: 1 | loss: 0.3343455
	speed: 0.1372s/iter; left time: 4384.0227s
	iters: 400, epoch: 1 | loss: 0.3713460
	speed: 0.1377s/iter; left time: 4385.7702s
	iters: 500, epoch: 1 | loss: 0.3557468
	speed: 0.1377s/iter; left time: 4370.9159s
	iters: 600, epoch: 1 | loss: 0.2761085
	speed: 0.1367s/iter; left time: 4326.2758s
	iters: 700, epoch: 1 | loss: 0.2737009
	speed: 0.1365s/iter; left time: 4305.6375s
	iters: 800, epoch: 1 | loss: 0.3041464
	speed: 0.1375s/iter; left time: 4323.2801s
	iters: 900, epoch: 1 | loss: 0.2637827
	speed: 0.1362s/iter; left time: 4271.2415s
	iters: 1000, epoch: 1 | loss: 0.3280537
	speed: 0.1374s/iter; left time: 4293.2828s
Epoch: 1 cost time: 150.79895544052124
Epoch: 1, Steps: 1075 | Train Loss: 0.3207839 Vali Loss: 0.4131329 Test Loss: 0.3502550
Validation loss decreased (inf --> 0.413133).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2756838
	speed: 0.7239s/iter; left time: 22495.1554s
	iters: 200, epoch: 2 | loss: 0.2873059
	speed: 0.1384s/iter; left time: 4287.8486s
	iters: 300, epoch: 2 | loss: 0.2867230
	speed: 0.1370s/iter; left time: 4229.4819s
	iters: 400, epoch: 2 | loss: 0.2657817
	speed: 0.1364s/iter; left time: 4197.3192s
	iters: 500, epoch: 2 | loss: 0.2916961
	speed: 0.1375s/iter; left time: 4219.3055s
	iters: 600, epoch: 2 | loss: 0.2540250
	speed: 0.1366s/iter; left time: 4176.5198s
	iters: 700, epoch: 2 | loss: 0.2215223
	speed: 0.1377s/iter; left time: 4197.3968s
	iters: 800, epoch: 2 | loss: 0.2483611
	speed: 0.1376s/iter; left time: 4180.5851s
	iters: 900, epoch: 2 | loss: 0.2544654
	speed: 0.1373s/iter; left time: 4156.2420s
	iters: 1000, epoch: 2 | loss: 0.2563655
	speed: 0.1375s/iter; left time: 4149.2137s
Epoch: 2 cost time: 148.4454584121704
Epoch: 2, Steps: 1075 | Train Loss: 0.2596778 Vali Loss: 0.4028316 Test Loss: 0.3357652
Validation loss decreased (0.413133 --> 0.402832).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2200941
	speed: 0.7284s/iter; left time: 21852.7400s
	iters: 200, epoch: 3 | loss: 0.1982759
	speed: 0.1362s/iter; left time: 4073.9934s
	iters: 300, epoch: 3 | loss: 0.2108797
	speed: 0.1386s/iter; left time: 4130.3093s
	iters: 400, epoch: 3 | loss: 0.2291318
	speed: 0.1409s/iter; left time: 4184.3240s
	iters: 500, epoch: 3 | loss: 0.2762879
	speed: 0.1389s/iter; left time: 4111.4184s
	iters: 600, epoch: 3 | loss: 0.2389070
	speed: 0.1354s/iter; left time: 3993.6769s
	iters: 700, epoch: 3 | loss: 0.1938920
	speed: 0.1378s/iter; left time: 4052.0348s
	iters: 800, epoch: 3 | loss: 0.2349889
	speed: 0.1376s/iter; left time: 4031.9454s
	iters: 900, epoch: 3 | loss: 0.2002279
	speed: 0.1376s/iter; left time: 4018.2158s
	iters: 1000, epoch: 3 | loss: 0.2275233
	speed: 0.1389s/iter; left time: 4042.5235s
Epoch: 3 cost time: 148.80375623703003
Epoch: 3, Steps: 1075 | Train Loss: 0.2432305 Vali Loss: 0.4082286 Test Loss: 0.3462988
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1956013
	speed: 0.7268s/iter; left time: 21023.1969s
	iters: 200, epoch: 4 | loss: 0.2194694
	speed: 0.1381s/iter; left time: 3979.4394s
	iters: 300, epoch: 4 | loss: 0.2279628
	speed: 0.1377s/iter; left time: 3954.8111s
	iters: 400, epoch: 4 | loss: 0.2120618
	speed: 0.1379s/iter; left time: 3946.4285s
	iters: 500, epoch: 4 | loss: 0.2525328
	speed: 0.1388s/iter; left time: 3959.3958s
	iters: 600, epoch: 4 | loss: 0.2301367
	speed: 0.1395s/iter; left time: 3965.1942s
	iters: 700, epoch: 4 | loss: 0.2609989
	speed: 0.1392s/iter; left time: 3942.2739s
	iters: 800, epoch: 4 | loss: 0.2825304
	speed: 0.1382s/iter; left time: 3901.2395s
	iters: 900, epoch: 4 | loss: 0.2252030
	speed: 0.1378s/iter; left time: 3876.6480s
	iters: 1000, epoch: 4 | loss: 0.2388544
	speed: 0.1385s/iter; left time: 3881.2364s
Epoch: 4 cost time: 149.78111839294434
Epoch: 4, Steps: 1075 | Train Loss: 0.2356679 Vali Loss: 0.4133813 Test Loss: 0.3441035
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2806960
	speed: 0.7397s/iter; left time: 20601.5522s
	iters: 200, epoch: 5 | loss: 0.1798396
	speed: 0.1378s/iter; left time: 3823.4371s
	iters: 300, epoch: 5 | loss: 0.2123439
	speed: 0.1377s/iter; left time: 3808.1145s
	iters: 400, epoch: 5 | loss: 0.2412553
	speed: 0.1385s/iter; left time: 3815.1511s
	iters: 500, epoch: 5 | loss: 0.2176771
	speed: 0.1383s/iter; left time: 3795.4740s
	iters: 600, epoch: 5 | loss: 0.1814603
	speed: 0.1382s/iter; left time: 3780.7394s
	iters: 700, epoch: 5 | loss: 0.2079638
	speed: 0.1376s/iter; left time: 3750.1822s
	iters: 800, epoch: 5 | loss: 0.1971420
	speed: 0.1362s/iter; left time: 3698.2139s
	iters: 900, epoch: 5 | loss: 0.1670785
	speed: 0.1379s/iter; left time: 3730.3461s
	iters: 1000, epoch: 5 | loss: 0.2370798
	speed: 0.1367s/iter; left time: 3684.0417s
Epoch: 5 cost time: 148.83780145645142
Epoch: 5, Steps: 1075 | Train Loss: 0.2322638 Vali Loss: 0.4124094 Test Loss: 0.3453244
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm1_96_96_TimesNet_ETTm1_ftM_sl96_ll48_pl96_dm16_nh8_el2_dl1_df32_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
test shape: (11425, 96, 7) (11425, 96, 7)
test shape: (11425, 96, 7) (11425, 96, 7)
mse:0.3363429009914398, mae:0.3765150308609009, dtw:not calculated
