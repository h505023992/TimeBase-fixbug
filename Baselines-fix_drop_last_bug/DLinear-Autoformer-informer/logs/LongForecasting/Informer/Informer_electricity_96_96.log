Args in experiment:
Namespace(is_training=1, train_only=False, model_id='Informer_electricity_96_96', model='Informer', data='custom', root_path='./dataset/', data_path='electricity.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=96, individual=False, embed_type=0, enc_in=321, dec_in=321, c_out=321, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : Informer_electricity_96_96_Informer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18221
val 2537
test 5165
	iters: 100, epoch: 1 | loss: 0.6528835
	speed: 0.3675s/iter; left time: 6248.4146s
	iters: 200, epoch: 1 | loss: 0.5540897
	speed: 0.2834s/iter; left time: 4789.2144s
	iters: 300, epoch: 1 | loss: 0.3343780
	speed: 0.3069s/iter; left time: 5156.1284s
	iters: 400, epoch: 1 | loss: 0.3010603
	speed: 0.2854s/iter; left time: 4766.9393s
	iters: 500, epoch: 1 | loss: 0.2608378
	speed: 0.2822s/iter; left time: 4684.4142s
Epoch: 1 cost time: 173.11854529380798
Epoch: 1, Steps: 570 | Train Loss: 0.4540154 Vali Loss: 0.3003328 Test Loss: 0.3752230
Validation loss decreased (inf --> 0.300333).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2135039
	speed: 1.1426s/iter; left time: 18774.5610s
	iters: 200, epoch: 2 | loss: 0.1982349
	speed: 0.2984s/iter; left time: 4872.9232s
	iters: 300, epoch: 2 | loss: 0.2126418
	speed: 0.3061s/iter; left time: 4968.1973s
	iters: 400, epoch: 2 | loss: 0.1785144
	speed: 0.3008s/iter; left time: 4852.1195s
	iters: 500, epoch: 2 | loss: 0.1788230
	speed: 0.3228s/iter; left time: 5175.5027s
Epoch: 2 cost time: 177.62269759178162
Epoch: 2, Steps: 570 | Train Loss: 0.2034315 Vali Loss: 0.2409418 Test Loss: 0.3323191
Validation loss decreased (0.300333 --> 0.240942).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1662836
	speed: 1.1614s/iter; left time: 18421.0167s
	iters: 200, epoch: 3 | loss: 0.1766010
	speed: 0.2861s/iter; left time: 4508.8820s
	iters: 300, epoch: 3 | loss: 0.1688779
	speed: 0.3050s/iter; left time: 4776.0728s
	iters: 400, epoch: 3 | loss: 0.1657839
	speed: 0.2964s/iter; left time: 4612.0201s
	iters: 500, epoch: 3 | loss: 0.1748252
	speed: 0.3036s/iter; left time: 4693.5392s
Epoch: 3 cost time: 171.67500472068787
Epoch: 3, Steps: 570 | Train Loss: 0.1722418 Vali Loss: 0.2346572 Test Loss: 0.3283458
Validation loss decreased (0.240942 --> 0.234657).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1702352
	speed: 1.1439s/iter; left time: 17491.8889s
	iters: 200, epoch: 4 | loss: 0.1627517
	speed: 0.3275s/iter; left time: 4974.3901s
	iters: 300, epoch: 4 | loss: 0.1701563
	speed: 0.3333s/iter; left time: 5029.6217s
	iters: 400, epoch: 4 | loss: 0.1604998
	speed: 0.2910s/iter; left time: 4361.9396s
	iters: 500, epoch: 4 | loss: 0.1613376
	speed: 0.2891s/iter; left time: 4304.4761s
Epoch: 4 cost time: 177.3423523902893
Epoch: 4, Steps: 570 | Train Loss: 0.1616567 Vali Loss: 0.2337871 Test Loss: 0.3233973
Validation loss decreased (0.234657 --> 0.233787).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1570282
	speed: 1.1581s/iter; left time: 17047.9458s
	iters: 200, epoch: 5 | loss: 0.1522512
	speed: 0.3054s/iter; left time: 4464.6601s
	iters: 300, epoch: 5 | loss: 0.1596890
	speed: 0.3108s/iter; left time: 4512.8460s
	iters: 400, epoch: 5 | loss: 0.1619156
	speed: 0.2673s/iter; left time: 3854.0180s
	iters: 500, epoch: 5 | loss: 0.1491591
	speed: 0.2924s/iter; left time: 4186.8841s
Epoch: 5 cost time: 170.9112241268158
Epoch: 5, Steps: 570 | Train Loss: 0.1564985 Vali Loss: 0.2290350 Test Loss: 0.3232329
Validation loss decreased (0.233787 --> 0.229035).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1519066
	speed: 1.1559s/iter; left time: 16356.8696s
	iters: 200, epoch: 6 | loss: 0.1545355
	speed: 0.2937s/iter; left time: 4126.6240s
	iters: 300, epoch: 6 | loss: 0.1575179
	speed: 0.2841s/iter; left time: 3962.8987s
	iters: 400, epoch: 6 | loss: 0.1467530
	speed: 0.2879s/iter; left time: 3988.1180s
	iters: 500, epoch: 6 | loss: 0.1554350
	speed: 0.3138s/iter; left time: 4314.4905s
Epoch: 6 cost time: 170.15658831596375
Epoch: 6, Steps: 570 | Train Loss: 0.1539196 Vali Loss: 0.2306911 Test Loss: 0.3232149
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1504443
	speed: 1.2305s/iter; left time: 16711.4521s
	iters: 200, epoch: 7 | loss: 0.1591593
	speed: 0.3067s/iter; left time: 4134.5648s
	iters: 300, epoch: 7 | loss: 0.1564774
	speed: 0.3289s/iter; left time: 4401.4667s
	iters: 400, epoch: 7 | loss: 0.1472337
	speed: 0.3361s/iter; left time: 4464.3458s
	iters: 500, epoch: 7 | loss: 0.1460772
	speed: 0.3298s/iter; left time: 4346.7740s
Epoch: 7 cost time: 185.287752866745
Epoch: 7, Steps: 570 | Train Loss: 0.1525888 Vali Loss: 0.2304952 Test Loss: 0.3237375
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1514596
	speed: 1.1666s/iter; left time: 15179.0373s
	iters: 200, epoch: 8 | loss: 0.1457889
	speed: 0.3050s/iter; left time: 3938.3217s
	iters: 300, epoch: 8 | loss: 0.1466585
	speed: 0.3088s/iter; left time: 3955.9085s
	iters: 400, epoch: 8 | loss: 0.1472245
	speed: 0.2850s/iter; left time: 3623.1571s
	iters: 500, epoch: 8 | loss: 0.1489402
	speed: 0.2985s/iter; left time: 3764.7045s
Epoch: 8 cost time: 174.18768119812012
Epoch: 8, Steps: 570 | Train Loss: 0.1519483 Vali Loss: 0.2286002 Test Loss: 0.3220088
Validation loss decreased (0.229035 --> 0.228600).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1588998
	speed: 1.1873s/iter; left time: 14771.5906s
	iters: 200, epoch: 9 | loss: 0.1521953
	speed: 0.2890s/iter; left time: 3566.8790s
	iters: 300, epoch: 9 | loss: 0.1512060
	speed: 0.3036s/iter; left time: 3716.0793s
	iters: 400, epoch: 9 | loss: 0.1528642
	speed: 0.3068s/iter; left time: 3725.1356s
	iters: 500, epoch: 9 | loss: 0.1573105
	speed: 0.3045s/iter; left time: 3666.6358s
Epoch: 9 cost time: 173.67681574821472
Epoch: 9, Steps: 570 | Train Loss: 0.1515119 Vali Loss: 0.2281142 Test Loss: 0.3217013
Validation loss decreased (0.228600 --> 0.228114).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1517254
	speed: 1.1379s/iter; left time: 13507.9592s
	iters: 200, epoch: 10 | loss: 0.1535925
	speed: 0.3195s/iter; left time: 3760.4028s
	iters: 300, epoch: 10 | loss: 0.1538662
	speed: 0.3072s/iter; left time: 3585.1558s
	iters: 400, epoch: 10 | loss: 0.1495278
	speed: 0.3113s/iter; left time: 3601.8901s
	iters: 500, epoch: 10 | loss: 0.1474794
	speed: 0.2979s/iter; left time: 3417.6103s
Epoch: 10 cost time: 177.0419144630432
Epoch: 10, Steps: 570 | Train Loss: 0.1513799 Vali Loss: 0.2280672 Test Loss: 0.3219306
Validation loss decreased (0.228114 --> 0.228067).  Saving model ...
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1469503
	speed: 1.1445s/iter; left time: 12934.2205s
	iters: 200, epoch: 11 | loss: 0.1522086
	speed: 0.2947s/iter; left time: 3300.8149s
	iters: 300, epoch: 11 | loss: 0.1462807
	speed: 0.2950s/iter; left time: 3274.8639s
	iters: 400, epoch: 11 | loss: 0.1460887
	speed: 0.2911s/iter; left time: 3201.9271s
	iters: 500, epoch: 11 | loss: 0.1562841
	speed: 0.3117s/iter; left time: 3398.3584s
Epoch: 11 cost time: 171.54894495010376
Epoch: 11, Steps: 570 | Train Loss: 0.1511885 Vali Loss: 0.2295330 Test Loss: 0.3224553
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1524541
	speed: 1.1310s/iter; left time: 12137.1724s
	iters: 200, epoch: 12 | loss: 0.1528822
	speed: 0.3123s/iter; left time: 3319.9865s
	iters: 300, epoch: 12 | loss: 0.1509092
	speed: 0.3093s/iter; left time: 3257.2804s
	iters: 400, epoch: 12 | loss: 0.1529778
	speed: 0.3088s/iter; left time: 3220.6969s
	iters: 500, epoch: 12 | loss: 0.1552209
	speed: 0.2988s/iter; left time: 3086.5645s
Epoch: 12 cost time: 177.03261637687683
Epoch: 12, Steps: 570 | Train Loss: 0.1511766 Vali Loss: 0.2295607 Test Loss: 0.3211423
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.1523531
	speed: 1.1519s/iter; left time: 11704.6712s
	iters: 200, epoch: 13 | loss: 0.1472788
	speed: 0.3165s/iter; left time: 3184.5796s
	iters: 300, epoch: 13 | loss: 0.1501365
	speed: 0.3176s/iter; left time: 3163.8604s
	iters: 400, epoch: 13 | loss: 0.1497253
	speed: 0.2920s/iter; left time: 2879.7363s
	iters: 500, epoch: 13 | loss: 0.1472340
	speed: 0.3009s/iter; left time: 2937.0947s
Epoch: 13 cost time: 174.29339790344238
Epoch: 13, Steps: 570 | Train Loss: 0.1511203 Vali Loss: 0.2284670 Test Loss: 0.3209233
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Informer_electricity_96_96_Informer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
mse:0.3211428225040436, mae:0.40837472677230835
