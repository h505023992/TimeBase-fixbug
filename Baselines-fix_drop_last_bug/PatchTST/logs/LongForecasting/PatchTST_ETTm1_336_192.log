Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='ETTm1', data_path='ETTm1.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='TST', model='PatchTST', model_id='336_192', moving_avg=25, n_heads=16, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.4, pred_len=192, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : 336_192_PatchTST_ETTm1_ftM_sl336_ll48_pl192_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34033
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.4974031
	speed: 0.1729s/iter; left time: 4564.3067s
	iters: 200, epoch: 1 | loss: 0.4357410
	speed: 0.1652s/iter; left time: 4344.0491s
Epoch: 1 cost time: 44.41779041290283
Epoch: 1, Steps: 265 | Train Loss: 0.4660269 Vali Loss: 0.5812990 Test Loss: 0.4006737
Validation loss decreased (inf --> 0.581299).  Saving model ...
Updating learning rate to 4.147995888890545e-06
	iters: 100, epoch: 2 | loss: 0.3748885
	speed: 0.8856s/iter; left time: 23146.4075s
	iters: 200, epoch: 2 | loss: 0.3635997
	speed: 0.1548s/iter; left time: 4029.1252s
Epoch: 2 cost time: 41.29707860946655
Epoch: 2, Steps: 265 | Train Loss: 0.3728814 Vali Loss: 0.5328964 Test Loss: 0.3658694
Validation loss decreased (0.581299 --> 0.532896).  Saving model ...
Updating learning rate to 4.591070939598485e-06
	iters: 100, epoch: 3 | loss: 0.3389266
	speed: 0.8499s/iter; left time: 21988.7096s
	iters: 200, epoch: 3 | loss: 0.3382865
	speed: 0.1512s/iter; left time: 3897.6209s
Epoch: 3 cost time: 38.70765709877014
Epoch: 3, Steps: 265 | Train Loss: 0.3469954 Vali Loss: 0.5202299 Test Loss: 0.3525832
Validation loss decreased (0.532896 --> 0.520230).  Saving model ...
Updating learning rate to 5.326492931874866e-06
	iters: 100, epoch: 4 | loss: 0.3099497
	speed: 0.8798s/iter; left time: 22527.9569s
	iters: 200, epoch: 4 | loss: 0.3200102
	speed: 0.1563s/iter; left time: 3987.1164s
Epoch: 4 cost time: 42.46203351020813
Epoch: 4, Steps: 265 | Train Loss: 0.3338491 Vali Loss: 0.5124007 Test Loss: 0.3463153
Validation loss decreased (0.520230 --> 0.512401).  Saving model ...
Updating learning rate to 6.349726889409005e-06
	iters: 100, epoch: 5 | loss: 0.3374560
	speed: 0.8184s/iter; left time: 20739.0665s
	iters: 200, epoch: 5 | loss: 0.2990471
	speed: 0.1603s/iter; left time: 4045.2951s
Epoch: 5 cost time: 43.561744928359985
Epoch: 5, Steps: 265 | Train Loss: 0.3262401 Vali Loss: 0.5095404 Test Loss: 0.3433155
Validation loss decreased (0.512401 --> 0.509540).  Saving model ...
Updating learning rate to 7.654463044738896e-06
	iters: 100, epoch: 6 | loss: 0.3159035
	speed: 0.8800s/iter; left time: 22066.3866s
	iters: 200, epoch: 6 | loss: 0.3054876
	speed: 0.1473s/iter; left time: 3679.7006s
Epoch: 6 cost time: 41.64592218399048
Epoch: 6, Steps: 265 | Train Loss: 0.3215639 Vali Loss: 0.5047119 Test Loss: 0.3408250
Validation loss decreased (0.509540 --> 0.504712).  Saving model ...
Updating learning rate to 9.232655748403029e-06
	iters: 100, epoch: 7 | loss: 0.3091209
	speed: 0.8812s/iter; left time: 21864.5615s
	iters: 200, epoch: 7 | loss: 0.2990607
	speed: 0.1513s/iter; left time: 3737.7550s
Epoch: 7 cost time: 41.742353677749634
Epoch: 7, Steps: 265 | Train Loss: 0.3176195 Vali Loss: 0.5040498 Test Loss: 0.3391826
Validation loss decreased (0.504712 --> 0.504050).  Saving model ...
Updating learning rate to 1.107457308240065e-05
	iters: 100, epoch: 8 | loss: 0.3310634
	speed: 0.8693s/iter; left time: 21337.5076s
	iters: 200, epoch: 8 | loss: 0.2929002
	speed: 0.1502s/iter; left time: 3670.5948s
Epoch: 8 cost time: 41.14471888542175
Epoch: 8, Steps: 265 | Train Loss: 0.3137676 Vali Loss: 0.5038258 Test Loss: 0.3347615
Validation loss decreased (0.504050 --> 0.503826).  Saving model ...
Updating learning rate to 1.3168856872018862e-05
	iters: 100, epoch: 9 | loss: 0.3435996
	speed: 0.8646s/iter; left time: 20993.5574s
	iters: 200, epoch: 9 | loss: 0.3204708
	speed: 0.1471s/iter; left time: 3557.4639s
Epoch: 9 cost time: 40.085052251815796
Epoch: 9, Steps: 265 | Train Loss: 0.3091913 Vali Loss: 0.5005981 Test Loss: 0.3347569
Validation loss decreased (0.503826 --> 0.500598).  Saving model ...
Updating learning rate to 1.550259272596464e-05
	iters: 100, epoch: 10 | loss: 0.3041357
	speed: 0.8608s/iter; left time: 20672.7819s
	iters: 200, epoch: 10 | loss: 0.2937570
	speed: 0.1551s/iter; left time: 3710.5403s
Epoch: 10 cost time: 40.86735939979553
Epoch: 10, Steps: 265 | Train Loss: 0.3054258 Vali Loss: 0.4999152 Test Loss: 0.3322451
Validation loss decreased (0.500598 --> 0.499915).  Saving model ...
Updating learning rate to 1.806138967289881e-05
	iters: 100, epoch: 11 | loss: 0.3110747
	speed: 0.8344s/iter; left time: 19818.7425s
	iters: 200, epoch: 11 | loss: 0.2707949
	speed: 0.1528s/iter; left time: 3613.6837s
Epoch: 11 cost time: 41.32077503204346
Epoch: 11, Steps: 265 | Train Loss: 0.3019330 Vali Loss: 0.4980615 Test Loss: 0.3321215
Validation loss decreased (0.499915 --> 0.498062).  Saving model ...
Updating learning rate to 2.0829468903294163e-05
	iters: 100, epoch: 12 | loss: 0.3011849
	speed: 0.8537s/iter; left time: 20050.8272s
	iters: 200, epoch: 12 | loss: 0.2848213
	speed: 0.1445s/iter; left time: 3378.7023s
Epoch: 12 cost time: 40.326653718948364
Epoch: 12, Steps: 265 | Train Loss: 0.2984167 Vali Loss: 0.4929130 Test Loss: 0.3317289
Validation loss decreased (0.498062 --> 0.492913).  Saving model ...
Updating learning rate to 2.3789761069391508e-05
	iters: 100, epoch: 13 | loss: 0.2971309
	speed: 0.7736s/iter; left time: 17964.2988s
	iters: 200, epoch: 13 | loss: 0.2992396
	speed: 0.1503s/iter; left time: 3474.0682s
Epoch: 13 cost time: 40.3245894908905
Epoch: 13, Steps: 265 | Train Loss: 0.2953084 Vali Loss: 0.4963667 Test Loss: 0.3295169
EarlyStopping counter: 1 out of 20
Updating learning rate to 2.692401154325343e-05
	iters: 100, epoch: 14 | loss: 0.3233166
	speed: 0.8566s/iter; left time: 19664.7758s
	iters: 200, epoch: 14 | loss: 0.2787464
	speed: 0.1546s/iter; left time: 3533.0209s
Epoch: 14 cost time: 41.003806352615356
Epoch: 14, Steps: 265 | Train Loss: 0.2925529 Vali Loss: 0.4983726 Test Loss: 0.3286374
EarlyStopping counter: 2 out of 20
Updating learning rate to 3.0212892983843068e-05
	iters: 100, epoch: 15 | loss: 0.2798362
	speed: 0.8726s/iter; left time: 19799.3491s
	iters: 200, epoch: 15 | loss: 0.2953900
	speed: 0.1573s/iter; left time: 3552.5868s
Epoch: 15 cost time: 42.65660881996155
Epoch: 15, Steps: 265 | Train Loss: 0.2902555 Vali Loss: 0.4994026 Test Loss: 0.3303320
EarlyStopping counter: 3 out of 20
Updating learning rate to 3.3636124518983084e-05
	iters: 100, epoch: 16 | loss: 0.2910905
	speed: 0.8418s/iter; left time: 18879.2290s
	iters: 200, epoch: 16 | loss: 0.3017223
	speed: 0.1482s/iter; left time: 3309.3626s
Epoch: 16 cost time: 41.82881784439087
Epoch: 16, Steps: 265 | Train Loss: 0.2881268 Vali Loss: 0.4944219 Test Loss: 0.3301923
EarlyStopping counter: 4 out of 20
Updating learning rate to 3.717259680726015e-05
	iters: 100, epoch: 17 | loss: 0.2541653
	speed: 0.8301s/iter; left time: 18396.5128s
	iters: 200, epoch: 17 | loss: 0.2958796
	speed: 0.1460s/iter; left time: 3220.6824s
Epoch: 17 cost time: 39.284337759017944
Epoch: 17, Steps: 265 | Train Loss: 0.2857809 Vali Loss: 0.4900320 Test Loss: 0.3291764
Validation loss decreased (0.492913 --> 0.490032).  Saving model ...
Updating learning rate to 4.080050220868085e-05
	iters: 100, epoch: 18 | loss: 0.2566820
	speed: 0.8170s/iter; left time: 17890.0584s
	iters: 200, epoch: 18 | loss: 0.2655270
	speed: 0.1412s/iter; left time: 3078.1201s
Epoch: 18 cost time: 38.61114716529846
Epoch: 18, Steps: 265 | Train Loss: 0.2841661 Vali Loss: 0.4923123 Test Loss: 0.3301806
EarlyStopping counter: 1 out of 20
Updating learning rate to 4.449746926138297e-05
	iters: 100, epoch: 19 | loss: 0.2785135
	speed: 0.8077s/iter; left time: 17471.9005s
	iters: 200, epoch: 19 | loss: 0.2706817
	speed: 0.1314s/iter; left time: 2829.4537s
Epoch: 19 cost time: 37.732532262802124
Epoch: 19, Steps: 265 | Train Loss: 0.2821181 Vali Loss: 0.4955108 Test Loss: 0.3316605
EarlyStopping counter: 2 out of 20
Updating learning rate to 4.824070063515135e-05
	iters: 100, epoch: 20 | loss: 0.2536880
	speed: 0.5926s/iter; left time: 12660.6185s
	iters: 200, epoch: 20 | loss: 0.2747340
	speed: 0.0900s/iter; left time: 1914.0380s
Epoch: 20 cost time: 25.359156370162964
Epoch: 20, Steps: 265 | Train Loss: 0.2801054 Vali Loss: 0.4929857 Test Loss: 0.3293696
EarlyStopping counter: 3 out of 20
Updating learning rate to 5.200711371104918e-05
	iters: 100, epoch: 21 | loss: 0.2906819
	speed: 0.6033s/iter; left time: 12730.8093s
	iters: 200, epoch: 21 | loss: 0.2602032
	speed: 0.1365s/iter; left time: 2866.1412s
Epoch: 21 cost time: 36.60760831832886
Epoch: 21, Steps: 265 | Train Loss: 0.2780020 Vali Loss: 0.4876485 Test Loss: 0.3301334
Validation loss decreased (0.490032 --> 0.487648).  Saving model ...
Updating learning rate to 5.577348292028073e-05
	iters: 100, epoch: 22 | loss: 0.2751101
	speed: 0.7129s/iter; left time: 14853.2433s
	iters: 200, epoch: 22 | loss: 0.3034146
	speed: 0.1185s/iter; left time: 2457.5700s
Epoch: 22 cost time: 32.37926387786865
Epoch: 22, Steps: 265 | Train Loss: 0.2761006 Vali Loss: 0.4930864 Test Loss: 0.3325688
EarlyStopping counter: 1 out of 20
Updating learning rate to 5.9516582964553954e-05
	iters: 100, epoch: 23 | loss: 0.2667419
	speed: 0.6861s/iter; left time: 14114.5820s
	iters: 200, epoch: 23 | loss: 0.3046765
	speed: 0.1279s/iter; left time: 2619.1012s
Epoch: 23 cost time: 35.59964370727539
Epoch: 23, Steps: 265 | Train Loss: 0.2742458 Vali Loss: 0.4927684 Test Loss: 0.3332376
EarlyStopping counter: 2 out of 20
Updating learning rate to 6.321333203477474e-05
	iters: 100, epoch: 24 | loss: 0.2946343
	speed: 0.7089s/iter; left time: 14395.1230s
	iters: 200, epoch: 24 | loss: 0.2797537
	speed: 0.1355s/iter; left time: 2737.8340s
Epoch: 24 cost time: 36.022331953048706
Epoch: 24, Steps: 265 | Train Loss: 0.2719401 Vali Loss: 0.4954843 Test Loss: 0.3340166
EarlyStopping counter: 3 out of 20
Updating learning rate to 6.684093414491588e-05
	iters: 100, epoch: 25 | loss: 0.2662424
	speed: 0.7667s/iter; left time: 15365.6909s
	iters: 200, epoch: 25 | loss: 0.2599976
	speed: 0.1442s/iter; left time: 2874.8214s
Epoch: 25 cost time: 38.37866473197937
Epoch: 25, Steps: 265 | Train Loss: 0.2696462 Vali Loss: 0.4964764 Test Loss: 0.3340786
EarlyStopping counter: 4 out of 20
Updating learning rate to 7.037701970335941e-05
	iters: 100, epoch: 26 | loss: 0.2546973
	speed: 0.7437s/iter; left time: 14706.9239s
	iters: 200, epoch: 26 | loss: 0.2818456
	speed: 0.1322s/iter; left time: 2601.1537s
Epoch: 26 cost time: 36.441449880599976
Epoch: 26, Steps: 265 | Train Loss: 0.2672008 Vali Loss: 0.4896822 Test Loss: 0.3336081
EarlyStopping counter: 5 out of 20
Updating learning rate to 7.379978345487968e-05
	iters: 100, epoch: 27 | loss: 0.2689682
	speed: 0.7418s/iter; left time: 14473.0447s
	iters: 200, epoch: 27 | loss: 0.2916554
	speed: 0.1150s/iter; left time: 2231.3809s
Epoch: 27 cost time: 33.37377047538757
Epoch: 27, Steps: 265 | Train Loss: 0.2646673 Vali Loss: 0.5022047 Test Loss: 0.3375542
EarlyStopping counter: 6 out of 20
Updating learning rate to 7.70881189426489e-05
	iters: 100, epoch: 28 | loss: 0.2474928
	speed: 0.6367s/iter; left time: 12253.3969s
	iters: 200, epoch: 28 | loss: 0.2395546
	speed: 0.1142s/iter; left time: 2187.3318s
Epoch: 28 cost time: 32.61157155036926
Epoch: 28, Steps: 265 | Train Loss: 0.2621344 Vali Loss: 0.5065508 Test Loss: 0.3348188
EarlyStopping counter: 7 out of 20
Updating learning rate to 8.022174866110521e-05
	iters: 100, epoch: 29 | loss: 0.2705593
	speed: 0.6188s/iter; left time: 11744.7774s
	iters: 200, epoch: 29 | loss: 0.2512428
	speed: 0.1224s/iter; left time: 2310.9862s
Epoch: 29 cost time: 34.03146433830261
Epoch: 29, Steps: 265 | Train Loss: 0.2595014 Vali Loss: 0.5041733 Test Loss: 0.3337424
EarlyStopping counter: 8 out of 20
Updating learning rate to 8.318134909709714e-05
	iters: 100, epoch: 30 | loss: 0.2213066
	speed: 0.7948s/iter; left time: 14875.2845s
	iters: 200, epoch: 30 | loss: 0.2555951
	speed: 0.1429s/iter; left time: 2659.7334s
Epoch: 30 cost time: 38.82081747055054
Epoch: 30, Steps: 265 | Train Loss: 0.2571493 Vali Loss: 0.5054469 Test Loss: 0.3373550
EarlyStopping counter: 9 out of 20
Updating learning rate to 8.594866988823775e-05
	iters: 100, epoch: 31 | loss: 0.2419162
	speed: 0.8060s/iter; left time: 14872.2544s
	iters: 200, epoch: 31 | loss: 0.2895919
	speed: 0.1472s/iter; left time: 2700.5450s
Epoch: 31 cost time: 39.356773853302
Epoch: 31, Steps: 265 | Train Loss: 0.2547707 Vali Loss: 0.5061011 Test Loss: 0.3380597
EarlyStopping counter: 10 out of 20
Updating learning rate to 8.850664636367998e-05
	iters: 100, epoch: 32 | loss: 0.2445997
	speed: 0.7958s/iter; left time: 14472.1134s
	iters: 200, epoch: 32 | loss: 0.2549247
	speed: 0.1437s/iter; left time: 2598.7218s
Epoch: 32 cost time: 38.56627082824707
Epoch: 32, Steps: 265 | Train Loss: 0.2516359 Vali Loss: 0.5171831 Test Loss: 0.3407706
EarlyStopping counter: 11 out of 20
Updating learning rate to 9.083950477333033e-05
	iters: 100, epoch: 33 | loss: 0.2218816
	speed: 0.6707s/iter; left time: 12019.6002s
	iters: 200, epoch: 33 | loss: 0.2552716
	speed: 0.1151s/iter; left time: 2050.3799s
Epoch: 33 cost time: 32.43755483627319
Epoch: 33, Steps: 265 | Train Loss: 0.2488346 Vali Loss: 0.5198766 Test Loss: 0.3412080
EarlyStopping counter: 12 out of 20
Updating learning rate to 9.293285955660577e-05
	iters: 100, epoch: 34 | loss: 0.2422939
	speed: 0.7211s/iter; left time: 12732.1621s
	iters: 200, epoch: 34 | loss: 0.2221283
	speed: 0.1323s/iter; left time: 2323.4468s
Epoch: 34 cost time: 36.3653290271759
Epoch: 34, Steps: 265 | Train Loss: 0.2461209 Vali Loss: 0.5175880 Test Loss: 0.3401518
EarlyStopping counter: 13 out of 20
Updating learning rate to 9.477380205092656e-05
	iters: 100, epoch: 35 | loss: 0.2443251
	speed: 0.7416s/iter; left time: 12897.8115s
	iters: 200, epoch: 35 | loss: 0.2269787
	speed: 0.1363s/iter; left time: 2356.0235s
Epoch: 35 cost time: 36.76321816444397
Epoch: 35, Steps: 265 | Train Loss: 0.2433012 Vali Loss: 0.5208528 Test Loss: 0.3473969
EarlyStopping counter: 14 out of 20
Updating learning rate to 9.635098009292423e-05
	iters: 100, epoch: 36 | loss: 0.2214879
	speed: 0.6808s/iter; left time: 11659.1156s
	iters: 200, epoch: 36 | loss: 0.2234418
	speed: 0.1059s/iter; left time: 1802.5028s
Epoch: 36 cost time: 29.142054319381714
Epoch: 36, Steps: 265 | Train Loss: 0.2404192 Vali Loss: 0.5238056 Test Loss: 0.3476220
EarlyStopping counter: 15 out of 20
Updating learning rate to 9.765466802150444e-05
	iters: 100, epoch: 37 | loss: 0.2755036
	speed: 0.6451s/iter; left time: 10877.4279s
	iters: 200, epoch: 37 | loss: 0.2416440
	speed: 0.1272s/iter; left time: 2132.5399s
Epoch: 37 cost time: 35.61699295043945
Epoch: 37, Steps: 265 | Train Loss: 0.2376043 Vali Loss: 0.5281782 Test Loss: 0.3532218
EarlyStopping counter: 16 out of 20
Updating learning rate to 9.867682665109111e-05
	iters: 100, epoch: 38 | loss: 0.2318436
	speed: 0.6961s/iter; left time: 11551.8110s
	iters: 200, epoch: 38 | loss: 0.2300811
	speed: 0.1369s/iter; left time: 2257.9194s
Epoch: 38 cost time: 37.56587839126587
Epoch: 38, Steps: 265 | Train Loss: 0.2350052 Vali Loss: 0.5345693 Test Loss: 0.3528793
EarlyStopping counter: 17 out of 20
Updating learning rate to 9.941115284522702e-05
	iters: 100, epoch: 39 | loss: 0.2392884
	speed: 0.7390s/iter; left time: 12069.1517s
	iters: 200, epoch: 39 | loss: 0.2152132
	speed: 0.1322s/iter; left time: 2145.2926s
Epoch: 39 cost time: 36.491225242614746
Epoch: 39, Steps: 265 | Train Loss: 0.2320966 Vali Loss: 0.5400221 Test Loss: 0.3613580
EarlyStopping counter: 18 out of 20
Updating learning rate to 9.985311838483566e-05
	iters: 100, epoch: 40 | loss: 0.2068720
	speed: 0.7404s/iter; left time: 11895.3819s
	iters: 200, epoch: 40 | loss: 0.2330121
	speed: 0.1387s/iter; left time: 2214.5199s
Epoch: 40 cost time: 37.18206715583801
Epoch: 40, Steps: 265 | Train Loss: 0.2295222 Vali Loss: 0.5355413 Test Loss: 0.3544189
EarlyStopping counter: 19 out of 20
Updating learning rate to 9.99999990240136e-05
	iters: 100, epoch: 41 | loss: 0.2246353
	speed: 0.7469s/iter; left time: 11802.0034s
	iters: 200, epoch: 41 | loss: 0.2271525
	speed: 0.1382s/iter; left time: 2170.4612s
Epoch: 41 cost time: 38.141634464263916
Epoch: 41, Steps: 265 | Train Loss: 0.2268081 Vali Loss: 0.5425308 Test Loss: 0.3612117
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : 336_192_PatchTST_ETTm1_ftM_sl336_ll48_pl192_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.330718070268631, mae:0.3683226704597473, rse:0.5474323630332947
