Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='192_192', model='PatchTST', data='custom', root_path='./dataset/', data_path='weather.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=192, label_len=48, pred_len=192, fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=21, dec_in=7, c_out=7, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=32, patience=5, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=1, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:1
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.dropout.Dropout'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.container.Sequential'>.
[INFO] Register count_normalization() for <class 'torch.nn.modules.batchnorm.BatchNorm1d'>.
MACs: 213147648.0
Params: 989632.0
213.15M MACs
>>>>>>>start training : 192_192_PatchTST_custom_ftM_sl192_ll48_pl192_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36504
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.7382221
	speed: 0.0835s/iter; left time: 2848.9589s
	iters: 200, epoch: 1 | loss: 0.7176639
	speed: 0.0657s/iter; left time: 2234.7701s
	iters: 300, epoch: 1 | loss: 1.0749415
	speed: 0.0652s/iter; left time: 2211.4284s
	iters: 400, epoch: 1 | loss: 0.8970014
	speed: 0.0625s/iter; left time: 2113.1115s
	iters: 500, epoch: 1 | loss: 0.5340523
	speed: 0.0623s/iter; left time: 2101.6528s
	iters: 600, epoch: 1 | loss: 0.9222172
	speed: 0.0654s/iter; left time: 2198.5063s
	iters: 700, epoch: 1 | loss: 0.5476450
	speed: 0.0594s/iter; left time: 1990.6788s
	iters: 800, epoch: 1 | loss: 0.6160418
	speed: 0.0644s/iter; left time: 2152.8506s
	iters: 900, epoch: 1 | loss: 0.8217474
	speed: 0.0612s/iter; left time: 2038.8714s
	iters: 1000, epoch: 1 | loss: 1.0109886
	speed: 0.0681s/iter; left time: 2263.6530s
	iters: 1100, epoch: 1 | loss: 0.5183966
	speed: 0.0622s/iter; left time: 2062.0453s
Epoch: 1 cost time: 74.68842101097107
Epoch: 1, Steps: 1141 | Train Loss: 0.7336680 Vali Loss: 0.5782214 Test Loss: 0.2510504
Validation loss decreased (inf --> 0.578221).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5411401
	speed: 0.4285s/iter; left time: 14135.4858s
	iters: 200, epoch: 2 | loss: 0.5937636
	speed: 0.0587s/iter; left time: 1929.2386s
	iters: 300, epoch: 2 | loss: 0.3797053
	speed: 0.0589s/iter; left time: 1930.5787s
	iters: 400, epoch: 2 | loss: 0.9332297
	speed: 0.0601s/iter; left time: 1964.3997s
	iters: 500, epoch: 2 | loss: 0.4505879
	speed: 0.0599s/iter; left time: 1951.1108s
	iters: 600, epoch: 2 | loss: 0.9043666
	speed: 0.0570s/iter; left time: 1850.5553s
	iters: 700, epoch: 2 | loss: 0.3814370
	speed: 0.0579s/iter; left time: 1876.8984s
	iters: 800, epoch: 2 | loss: 0.9206634
	speed: 0.0564s/iter; left time: 1820.6706s
	iters: 900, epoch: 2 | loss: 0.4140427
	speed: 0.0566s/iter; left time: 1821.2094s
	iters: 1000, epoch: 2 | loss: 0.3628565
	speed: 0.0551s/iter; left time: 1766.8618s
	iters: 1100, epoch: 2 | loss: 0.4987404
	speed: 0.0555s/iter; left time: 1773.8472s
Epoch: 2 cost time: 67.0219578742981
Epoch: 2, Steps: 1141 | Train Loss: 0.5410224 Vali Loss: 0.4858149 Test Loss: 0.2155640
Validation loss decreased (0.578221 --> 0.485815).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.8301669
	speed: 0.3872s/iter; left time: 12333.4354s
	iters: 200, epoch: 3 | loss: 0.6853522
	speed: 0.0579s/iter; left time: 1836.7317s
	iters: 300, epoch: 3 | loss: 0.4629973
	speed: 0.0692s/iter; left time: 2190.5850s
	iters: 400, epoch: 3 | loss: 0.3911795
	speed: 0.0609s/iter; left time: 1920.6694s
	iters: 500, epoch: 3 | loss: 0.3688032
	speed: 0.0635s/iter; left time: 1998.2366s
	iters: 600, epoch: 3 | loss: 0.4273124
	speed: 0.0617s/iter; left time: 1935.0984s
	iters: 700, epoch: 3 | loss: 0.4373168
	speed: 0.0618s/iter; left time: 1932.2178s
	iters: 800, epoch: 3 | loss: 0.4788572
	speed: 0.0566s/iter; left time: 1762.9885s
	iters: 900, epoch: 3 | loss: 0.5228823
	speed: 0.0574s/iter; left time: 1782.7053s
	iters: 1000, epoch: 3 | loss: 0.3911917
	speed: 0.0524s/iter; left time: 1622.7567s
	iters: 1100, epoch: 3 | loss: 1.1753231
	speed: 0.0509s/iter; left time: 1571.2221s
Epoch: 3 cost time: 67.98135805130005
Epoch: 3, Steps: 1141 | Train Loss: 0.5142159 Vali Loss: 0.4783705 Test Loss: 0.2097065
Validation loss decreased (0.485815 --> 0.478371).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.5264925
	speed: 0.3805s/iter; left time: 11685.7878s
	iters: 200, epoch: 4 | loss: 0.4670641
	speed: 0.0633s/iter; left time: 1937.1059s
	iters: 300, epoch: 4 | loss: 0.4471822
	speed: 0.0598s/iter; left time: 1823.0917s
	iters: 400, epoch: 4 | loss: 0.7318915
	speed: 0.0603s/iter; left time: 1833.3980s
	iters: 500, epoch: 4 | loss: 0.8679155
	speed: 0.0593s/iter; left time: 1798.0617s
	iters: 600, epoch: 4 | loss: 0.7744960
	speed: 0.0586s/iter; left time: 1769.9376s
	iters: 700, epoch: 4 | loss: 0.4060996
	speed: 0.0585s/iter; left time: 1760.8757s
	iters: 800, epoch: 4 | loss: 0.8246132
	speed: 0.0571s/iter; left time: 1714.4352s
	iters: 900, epoch: 4 | loss: 0.4246601
	speed: 0.0580s/iter; left time: 1734.6484s
	iters: 1000, epoch: 4 | loss: 0.8980042
	speed: 0.0546s/iter; left time: 1626.2642s
	iters: 1100, epoch: 4 | loss: 0.4105725
	speed: 0.0564s/iter; left time: 1674.8358s
Epoch: 4 cost time: 67.38376021385193
Epoch: 4, Steps: 1141 | Train Loss: 0.5058248 Vali Loss: 0.4776812 Test Loss: 0.2087481
Validation loss decreased (0.478371 --> 0.477681).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.4870618
	speed: 0.3857s/iter; left time: 11403.0680s
	iters: 200, epoch: 5 | loss: 0.4343527
	speed: 0.0574s/iter; left time: 1692.6775s
	iters: 300, epoch: 5 | loss: 0.9203944
	speed: 0.0585s/iter; left time: 1717.9144s
	iters: 400, epoch: 5 | loss: 0.3343098
	speed: 0.0580s/iter; left time: 1697.4069s
	iters: 500, epoch: 5 | loss: 0.4985558
	speed: 0.0576s/iter; left time: 1680.2197s
	iters: 600, epoch: 5 | loss: 0.3765434
	speed: 0.0611s/iter; left time: 1777.1308s
	iters: 700, epoch: 5 | loss: 0.4027528
	speed: 0.0565s/iter; left time: 1637.4379s
	iters: 800, epoch: 5 | loss: 0.5250329
	speed: 0.0537s/iter; left time: 1550.2120s
	iters: 900, epoch: 5 | loss: 1.3046585
	speed: 0.0576s/iter; left time: 1656.5550s
	iters: 1000, epoch: 5 | loss: 0.3546784
	speed: 0.0653s/iter; left time: 1871.8838s
	iters: 1100, epoch: 5 | loss: 0.6065617
	speed: 0.0670s/iter; left time: 1913.6938s
Epoch: 5 cost time: 69.67212629318237
Epoch: 5, Steps: 1141 | Train Loss: 0.5001204 Vali Loss: 0.4763571 Test Loss: 0.2065517
Validation loss decreased (0.477681 --> 0.476357).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.4695539
	speed: 0.4750s/iter; left time: 13502.2094s
	iters: 200, epoch: 6 | loss: 0.4399836
	speed: 0.0654s/iter; left time: 1853.0738s
	iters: 300, epoch: 6 | loss: 0.4252090
	speed: 0.0650s/iter; left time: 1833.5985s
	iters: 400, epoch: 6 | loss: 0.3796514
	speed: 0.0666s/iter; left time: 1872.5212s
	iters: 500, epoch: 6 | loss: 0.4926813
	speed: 0.0598s/iter; left time: 1675.6477s
	iters: 600, epoch: 6 | loss: 0.8796575
	speed: 0.0602s/iter; left time: 1681.1124s
	iters: 700, epoch: 6 | loss: 0.8860763
	speed: 0.0671s/iter; left time: 1868.1688s
	iters: 800, epoch: 6 | loss: 0.7811691
	speed: 0.0602s/iter; left time: 1669.1921s
	iters: 900, epoch: 6 | loss: 0.3675980
	speed: 0.0727s/iter; left time: 2007.1622s
	iters: 1000, epoch: 6 | loss: 0.3490312
	speed: 0.0618s/iter; left time: 1699.9260s
	iters: 1100, epoch: 6 | loss: 1.1337528
	speed: 0.0628s/iter; left time: 1723.2967s
Epoch: 6 cost time: 74.60934042930603
Epoch: 6, Steps: 1141 | Train Loss: 0.4955213 Vali Loss: 0.4723051 Test Loss: 0.2039190
Validation loss decreased (0.476357 --> 0.472305).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.4114160
	speed: 0.4687s/iter; left time: 12789.3767s
	iters: 200, epoch: 7 | loss: 0.4092822
	speed: 0.0641s/iter; left time: 1742.6585s
	iters: 300, epoch: 7 | loss: 0.3485615
	speed: 0.0607s/iter; left time: 1643.6395s
	iters: 400, epoch: 7 | loss: 0.4236056
	speed: 0.0614s/iter; left time: 1657.5366s
	iters: 500, epoch: 7 | loss: 0.8194155
	speed: 0.0608s/iter; left time: 1634.4417s
	iters: 600, epoch: 7 | loss: 0.3680592
	speed: 0.0611s/iter; left time: 1637.0404s
	iters: 700, epoch: 7 | loss: 0.3791797
	speed: 0.0678s/iter; left time: 1810.5542s
	iters: 800, epoch: 7 | loss: 0.8174965
	speed: 0.0617s/iter; left time: 1640.2825s
	iters: 900, epoch: 7 | loss: 0.5797801
	speed: 0.0610s/iter; left time: 1616.4192s
	iters: 1000, epoch: 7 | loss: 0.5659249
	speed: 0.0686s/iter; left time: 1810.7591s
	iters: 1100, epoch: 7 | loss: 0.4658557
	speed: 0.0650s/iter; left time: 1708.3567s
Epoch: 7 cost time: 73.75473880767822
Epoch: 7, Steps: 1141 | Train Loss: 0.4909213 Vali Loss: 0.4689052 Test Loss: 0.2037998
Validation loss decreased (0.472305 --> 0.468905).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 1.4712024
	speed: 0.4499s/iter; left time: 11761.7112s
	iters: 200, epoch: 8 | loss: 0.5125783
	speed: 0.0642s/iter; left time: 1672.2985s
	iters: 300, epoch: 8 | loss: 0.4162326
	speed: 0.0634s/iter; left time: 1645.7430s
	iters: 400, epoch: 8 | loss: 0.3644499
	speed: 0.0681s/iter; left time: 1759.0900s
	iters: 500, epoch: 8 | loss: 0.4311668
	speed: 0.0629s/iter; left time: 1620.5220s
	iters: 600, epoch: 8 | loss: 0.3038189
	speed: 0.0588s/iter; left time: 1507.6063s
	iters: 700, epoch: 8 | loss: 0.3728718
	speed: 0.0625s/iter; left time: 1595.2655s
	iters: 800, epoch: 8 | loss: 0.4515696
	speed: 0.0681s/iter; left time: 1732.0947s
	iters: 900, epoch: 8 | loss: 0.3075466
	speed: 0.0673s/iter; left time: 1705.2063s
	iters: 1000, epoch: 8 | loss: 0.3685736
	speed: 0.0654s/iter; left time: 1650.1362s
	iters: 1100, epoch: 8 | loss: 0.4398533
	speed: 0.0645s/iter; left time: 1622.3928s
Epoch: 8 cost time: 74.16346597671509
Epoch: 8, Steps: 1141 | Train Loss: 0.4867968 Vali Loss: 0.4696838 Test Loss: 0.2043916
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.4510019
	speed: 0.4427s/iter; left time: 11069.6342s
	iters: 200, epoch: 9 | loss: 0.4858041
	speed: 0.0697s/iter; left time: 1734.6614s
	iters: 300, epoch: 9 | loss: 0.3998491
	speed: 0.0623s/iter; left time: 1546.4485s
	iters: 400, epoch: 9 | loss: 0.4049917
	speed: 0.0625s/iter; left time: 1544.0685s
	iters: 500, epoch: 9 | loss: 0.3646327
	speed: 0.0603s/iter; left time: 1483.5160s
	iters: 600, epoch: 9 | loss: 0.4000531
	speed: 0.0700s/iter; left time: 1715.3655s
	iters: 700, epoch: 9 | loss: 0.4113979
	speed: 0.0658s/iter; left time: 1606.2254s
	iters: 800, epoch: 9 | loss: 0.3035834
	speed: 0.0654s/iter; left time: 1588.9503s
	iters: 900, epoch: 9 | loss: 0.4644130
	speed: 0.0648s/iter; left time: 1568.6163s
	iters: 1000, epoch: 9 | loss: 0.8997284
	speed: 0.0641s/iter; left time: 1545.8094s
	iters: 1100, epoch: 9 | loss: 0.4173539
	speed: 0.0625s/iter; left time: 1500.7772s
Epoch: 9 cost time: 74.73668217658997
Epoch: 9, Steps: 1141 | Train Loss: 0.4835336 Vali Loss: 0.4664611 Test Loss: 0.2018327
Validation loss decreased (0.468905 --> 0.466461).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.4282674
	speed: 0.4435s/iter; left time: 10582.4668s
	iters: 200, epoch: 10 | loss: 0.4631513
	speed: 0.0623s/iter; left time: 1479.6962s
	iters: 300, epoch: 10 | loss: 0.3633402
	speed: 0.0631s/iter; left time: 1491.9738s
	iters: 400, epoch: 10 | loss: 0.4269018
	speed: 0.0706s/iter; left time: 1664.4024s
	iters: 500, epoch: 10 | loss: 0.4384801
	speed: 0.0637s/iter; left time: 1494.4196s
	iters: 600, epoch: 10 | loss: 0.3715830
	speed: 0.0663s/iter; left time: 1548.1677s
	iters: 700, epoch: 10 | loss: 0.3303376
	speed: 0.0635s/iter; left time: 1477.1407s
	iters: 800, epoch: 10 | loss: 0.4227062
	speed: 0.0664s/iter; left time: 1538.2167s
	iters: 900, epoch: 10 | loss: 0.3119119
	speed: 0.0639s/iter; left time: 1472.7733s
	iters: 1000, epoch: 10 | loss: 0.3562530
	speed: 0.0644s/iter; left time: 1478.4087s
	iters: 1100, epoch: 10 | loss: 0.3359210
	speed: 0.0600s/iter; left time: 1372.0469s
Epoch: 10 cost time: 74.15686798095703
Epoch: 10, Steps: 1141 | Train Loss: 0.4813612 Vali Loss: 0.4691814 Test Loss: 0.2026247
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.3838595
	speed: 0.4657s/iter; left time: 10581.9229s
	iters: 200, epoch: 11 | loss: 0.8583437
	speed: 0.0685s/iter; left time: 1550.3961s
	iters: 300, epoch: 11 | loss: 0.8771329
	speed: 0.0655s/iter; left time: 1476.1355s
	iters: 400, epoch: 11 | loss: 0.3290209
	speed: 0.0621s/iter; left time: 1392.2356s
	iters: 500, epoch: 11 | loss: 0.9618424
	speed: 0.0654s/iter; left time: 1459.0478s
	iters: 600, epoch: 11 | loss: 0.3495463
	speed: 0.0670s/iter; left time: 1488.4413s
	iters: 700, epoch: 11 | loss: 0.3604562
	speed: 0.0611s/iter; left time: 1352.0863s
	iters: 800, epoch: 11 | loss: 0.3313425
	speed: 0.0650s/iter; left time: 1431.7029s
	iters: 900, epoch: 11 | loss: 0.4031910
	speed: 0.0604s/iter; left time: 1323.3675s
	iters: 1000, epoch: 11 | loss: 0.3162117
	speed: 0.0650s/iter; left time: 1418.2233s
	iters: 1100, epoch: 11 | loss: 0.3895762
	speed: 0.0626s/iter; left time: 1359.7350s
Epoch: 11 cost time: 74.9668083190918
Epoch: 11, Steps: 1141 | Train Loss: 0.4789974 Vali Loss: 0.4680064 Test Loss: 0.2016173
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 1.1245290
	speed: 0.4792s/iter; left time: 10340.3496s
	iters: 200, epoch: 12 | loss: 0.5674719
	speed: 0.0665s/iter; left time: 1428.8426s
	iters: 300, epoch: 12 | loss: 0.4330913
	speed: 0.0639s/iter; left time: 1367.0379s
	iters: 400, epoch: 12 | loss: 0.7012463
	speed: 0.0640s/iter; left time: 1362.3787s
	iters: 500, epoch: 12 | loss: 0.4455213
	speed: 0.0669s/iter; left time: 1417.0992s
	iters: 600, epoch: 12 | loss: 0.4390186
	speed: 0.0589s/iter; left time: 1241.0419s
	iters: 700, epoch: 12 | loss: 0.4823527
	speed: 0.0637s/iter; left time: 1336.1835s
	iters: 800, epoch: 12 | loss: 0.7971908
	speed: 0.0653s/iter; left time: 1362.6002s
	iters: 900, epoch: 12 | loss: 0.4268605
	speed: 0.0633s/iter; left time: 1315.0330s
	iters: 1000, epoch: 12 | loss: 0.4803639
	speed: 0.0690s/iter; left time: 1427.3935s
	iters: 1100, epoch: 12 | loss: 0.4503070
	speed: 0.0608s/iter; left time: 1251.8838s
Epoch: 12 cost time: 74.5976333618164
Epoch: 12, Steps: 1141 | Train Loss: 0.4769593 Vali Loss: 0.4638803 Test Loss: 0.2003326
Validation loss decreased (0.466461 --> 0.463880).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.3112123
	speed: 0.4838s/iter; left time: 9888.6593s
	iters: 200, epoch: 13 | loss: 0.3476887
	speed: 0.0663s/iter; left time: 1348.6541s
	iters: 300, epoch: 13 | loss: 0.8766809
	speed: 0.0619s/iter; left time: 1252.3150s
	iters: 400, epoch: 13 | loss: 0.4150938
	speed: 0.0615s/iter; left time: 1239.2603s
	iters: 500, epoch: 13 | loss: 0.3888201
	speed: 0.0668s/iter; left time: 1337.8371s
	iters: 600, epoch: 13 | loss: 0.3536876
	speed: 0.0620s/iter; left time: 1236.2520s
	iters: 700, epoch: 13 | loss: 0.5939408
	speed: 0.0698s/iter; left time: 1385.0326s
	iters: 800, epoch: 13 | loss: 0.3771251
	speed: 0.0633s/iter; left time: 1248.7931s
	iters: 900, epoch: 13 | loss: 0.3088466
	speed: 0.0623s/iter; left time: 1224.0559s
	iters: 1000, epoch: 13 | loss: 0.3579495
	speed: 0.0644s/iter; left time: 1258.4814s
	iters: 1100, epoch: 13 | loss: 0.4211737
	speed: 0.0709s/iter; left time: 1378.6287s
Epoch: 13 cost time: 75.5565574169159
Epoch: 13, Steps: 1141 | Train Loss: 0.4753423 Vali Loss: 0.4674788 Test Loss: 0.2022720
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.4941598
	speed: 0.4747s/iter; left time: 9161.0456s
	iters: 200, epoch: 14 | loss: 0.5373012
	speed: 0.0624s/iter; left time: 1198.4731s
	iters: 300, epoch: 14 | loss: 0.9571393
	speed: 0.0613s/iter; left time: 1170.3145s
	iters: 400, epoch: 14 | loss: 0.2951117
	speed: 0.0715s/iter; left time: 1358.2016s
	iters: 500, epoch: 14 | loss: 0.4055867
	speed: 0.0625s/iter; left time: 1181.5024s
	iters: 600, epoch: 14 | loss: 0.4150635
	speed: 0.0674s/iter; left time: 1267.7905s
	iters: 700, epoch: 14 | loss: 0.3004799
	speed: 0.0667s/iter; left time: 1247.9311s
	iters: 800, epoch: 14 | loss: 0.3735870
	speed: 0.0740s/iter; left time: 1375.6571s
	iters: 900, epoch: 14 | loss: 0.4104770
	speed: 0.0640s/iter; left time: 1184.5819s
	iters: 1000, epoch: 14 | loss: 0.3483312
	speed: 0.0637s/iter; left time: 1171.9455s
	iters: 1100, epoch: 14 | loss: 0.4900734
	speed: 0.0631s/iter; left time: 1153.7801s
Epoch: 14 cost time: 75.53546619415283
Epoch: 14, Steps: 1141 | Train Loss: 0.4742922 Vali Loss: 0.4660160 Test Loss: 0.2007775
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.5438625
	speed: 0.4553s/iter; left time: 8266.1715s
	iters: 200, epoch: 15 | loss: 0.4273088
	speed: 0.0667s/iter; left time: 1203.9935s
	iters: 300, epoch: 15 | loss: 0.2687392
	speed: 0.0604s/iter; left time: 1084.6409s
	iters: 400, epoch: 15 | loss: 0.3525653
	speed: 0.0616s/iter; left time: 1100.7664s
	iters: 500, epoch: 15 | loss: 0.5131405
	speed: 0.0662s/iter; left time: 1175.6716s
	iters: 600, epoch: 15 | loss: 0.8019652
	speed: 0.0673s/iter; left time: 1188.7524s
	iters: 700, epoch: 15 | loss: 0.9051079
	speed: 0.0655s/iter; left time: 1150.3392s
	iters: 800, epoch: 15 | loss: 0.4048805
	speed: 0.0658s/iter; left time: 1148.7808s
	iters: 900, epoch: 15 | loss: 0.9228771
	speed: 0.0654s/iter; left time: 1134.3974s
	iters: 1000, epoch: 15 | loss: 0.4572542
	speed: 0.0630s/iter; left time: 1086.7642s
	iters: 1100, epoch: 15 | loss: 0.4634864
	speed: 0.0626s/iter; left time: 1074.0081s
Epoch: 15 cost time: 74.60735774040222
Epoch: 15, Steps: 1141 | Train Loss: 0.4728720 Vali Loss: 0.4682346 Test Loss: 0.2005847
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.3801562
	speed: 0.4477s/iter; left time: 7617.8739s
	iters: 200, epoch: 16 | loss: 0.3120593
	speed: 0.0592s/iter; left time: 1000.7868s
	iters: 300, epoch: 16 | loss: 0.3872364
	speed: 0.0712s/iter; left time: 1197.5739s
	iters: 400, epoch: 16 | loss: 0.4481894
	speed: 0.0612s/iter; left time: 1022.4904s
	iters: 500, epoch: 16 | loss: 0.3698198
	speed: 0.0687s/iter; left time: 1141.7387s
	iters: 600, epoch: 16 | loss: 0.4638190
	speed: 0.0665s/iter; left time: 1097.9531s
	iters: 700, epoch: 16 | loss: 0.3052247
	speed: 0.0634s/iter; left time: 1040.9836s
	iters: 800, epoch: 16 | loss: 0.3514569
	speed: 0.0661s/iter; left time: 1077.8880s
	iters: 900, epoch: 16 | loss: 0.2877340
	speed: 0.0662s/iter; left time: 1074.0798s
	iters: 1000, epoch: 16 | loss: 0.4751982
	speed: 0.0612s/iter; left time: 986.4445s
	iters: 1100, epoch: 16 | loss: 0.5442507
	speed: 0.0620s/iter; left time: 992.9277s
Epoch: 16 cost time: 74.1792242527008
Epoch: 16, Steps: 1141 | Train Loss: 0.4719434 Vali Loss: 0.4666965 Test Loss: 0.2010959
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.3859294
	speed: 0.4542s/iter; left time: 7210.2069s
	iters: 200, epoch: 17 | loss: 0.3525926
	speed: 0.0616s/iter; left time: 972.3733s
	iters: 300, epoch: 17 | loss: 0.8717798
	speed: 0.0645s/iter; left time: 1011.5727s
	iters: 400, epoch: 17 | loss: 0.8112686
	speed: 0.0628s/iter; left time: 977.6658s
	iters: 500, epoch: 17 | loss: 0.4476304
	speed: 0.0668s/iter; left time: 1033.9307s
	iters: 600, epoch: 17 | loss: 0.8279116
	speed: 0.0666s/iter; left time: 1023.5448s
	iters: 700, epoch: 17 | loss: 0.3635488
	speed: 0.0676s/iter; left time: 1032.9824s
	iters: 800, epoch: 17 | loss: 0.3190991
	speed: 0.0614s/iter; left time: 931.1686s
	iters: 900, epoch: 17 | loss: 0.5579304
	speed: 0.0591s/iter; left time: 890.4221s
	iters: 1000, epoch: 17 | loss: 1.0325708
	speed: 0.0644s/iter; left time: 964.8544s
	iters: 1100, epoch: 17 | loss: 0.8800117
	speed: 0.0659s/iter; left time: 980.0707s
Epoch: 17 cost time: 75.19825220108032
Epoch: 17, Steps: 1141 | Train Loss: 0.4710362 Vali Loss: 0.4662254 Test Loss: 0.2001838
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : 192_192_PatchTST_custom_ftM_sl192_ll48_pl192_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
mse:0.20056341588497162, mae:0.2416648417711258, rse:0.5895137786865234
