True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_96_192      Model:              TimesNet            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/          
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_weather_96_192_TimesNet_custom_ftM_sl96_ll48_pl192_dm32_nh8_el2_dl1_df32_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36600
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.5623047
	speed: 0.2839s/iter; left time: 9714.1299s
	iters: 200, epoch: 1 | loss: 0.4781279
	speed: 0.2082s/iter; left time: 7104.9104s
	iters: 300, epoch: 1 | loss: 0.4331671
	speed: 0.2061s/iter; left time: 7010.2753s
	iters: 400, epoch: 1 | loss: 0.5287201
	speed: 0.2253s/iter; left time: 7643.3080s
	iters: 500, epoch: 1 | loss: 0.4609671
	speed: 0.2257s/iter; left time: 7634.2887s
	iters: 600, epoch: 1 | loss: 0.5086617
	speed: 0.2250s/iter; left time: 7586.8618s
	iters: 700, epoch: 1 | loss: 0.4210527
	speed: 0.2237s/iter; left time: 7522.1279s
	iters: 800, epoch: 1 | loss: 0.4473509
	speed: 0.2176s/iter; left time: 7295.0930s
	iters: 900, epoch: 1 | loss: 0.3463927
	speed: 0.2053s/iter; left time: 6860.1985s
	iters: 1000, epoch: 1 | loss: 0.8837795
	speed: 0.2281s/iter; left time: 7602.0992s
	iters: 1100, epoch: 1 | loss: 0.6017534
	speed: 0.2347s/iter; left time: 7796.7853s
Epoch: 1 cost time: 259.24115562438965
Epoch: 1, Steps: 1144 | Train Loss: 0.5486211 Vali Loss: 0.4947410 Test Loss: 0.2251277
Validation loss decreased (inf --> 0.494741).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5197880
	speed: 1.2929s/iter; left time: 42764.2833s
	iters: 200, epoch: 2 | loss: 1.3266978
	speed: 0.2196s/iter; left time: 7241.5460s
	iters: 300, epoch: 2 | loss: 0.3725380
	speed: 0.2068s/iter; left time: 6797.9721s
	iters: 400, epoch: 2 | loss: 0.8304859
	speed: 0.2168s/iter; left time: 7104.5516s
	iters: 500, epoch: 2 | loss: 0.7308281
	speed: 0.2251s/iter; left time: 7356.5436s
	iters: 600, epoch: 2 | loss: 0.3717935
	speed: 0.2229s/iter; left time: 7260.6712s
	iters: 700, epoch: 2 | loss: 0.3561824
	speed: 0.2159s/iter; left time: 7011.8423s
	iters: 800, epoch: 2 | loss: 0.4670919
	speed: 0.2098s/iter; left time: 6791.7366s
	iters: 900, epoch: 2 | loss: 0.4000929
	speed: 0.2082s/iter; left time: 6720.9654s
	iters: 1000, epoch: 2 | loss: 0.4177178
	speed: 0.2175s/iter; left time: 6997.2624s
	iters: 1100, epoch: 2 | loss: 0.5010238
	speed: 0.2125s/iter; left time: 6817.0285s
Epoch: 2 cost time: 250.8477008342743
Epoch: 2, Steps: 1144 | Train Loss: 0.4831732 Vali Loss: 0.4920967 Test Loss: 0.2229547
Validation loss decreased (0.494741 --> 0.492097).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3305433
	speed: 1.3183s/iter; left time: 42097.4062s
	iters: 200, epoch: 3 | loss: 0.8548017
	speed: 0.2427s/iter; left time: 7725.5586s
	iters: 300, epoch: 3 | loss: 0.3780118
	speed: 0.2499s/iter; left time: 7928.5272s
	iters: 400, epoch: 3 | loss: 0.3340529
	speed: 0.2419s/iter; left time: 7652.7572s
	iters: 500, epoch: 3 | loss: 0.3189034
	speed: 0.2430s/iter; left time: 7661.4048s
	iters: 600, epoch: 3 | loss: 0.5045020
	speed: 0.2305s/iter; left time: 7244.3161s
	iters: 700, epoch: 3 | loss: 0.3291824
	speed: 0.2491s/iter; left time: 7803.6788s
	iters: 800, epoch: 3 | loss: 0.8880231
	speed: 0.2429s/iter; left time: 7584.9776s
	iters: 900, epoch: 3 | loss: 0.5012271
	speed: 0.2425s/iter; left time: 7550.2710s
	iters: 1000, epoch: 3 | loss: 0.3362181
	speed: 0.2448s/iter; left time: 7598.3456s
	iters: 1100, epoch: 3 | loss: 0.4916379
	speed: 0.2408s/iter; left time: 7448.0006s
Epoch: 3 cost time: 279.20264434814453
Epoch: 3, Steps: 1144 | Train Loss: 0.4648096 Vali Loss: 0.4896506 Test Loss: 0.2254664
Validation loss decreased (0.492097 --> 0.489651).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2989255
	speed: 1.2191s/iter; left time: 37535.8324s
	iters: 200, epoch: 4 | loss: 0.3571649
	speed: 0.2373s/iter; left time: 7282.3143s
	iters: 300, epoch: 4 | loss: 0.3683081
	speed: 0.2454s/iter; left time: 7505.7315s
	iters: 400, epoch: 4 | loss: 0.3679985
	speed: 0.2436s/iter; left time: 7426.6863s
	iters: 500, epoch: 4 | loss: 0.8703408
	speed: 0.2473s/iter; left time: 7515.4189s
	iters: 600, epoch: 4 | loss: 0.3337702
	speed: 0.2384s/iter; left time: 7220.7310s
	iters: 700, epoch: 4 | loss: 0.3642044
	speed: 0.2486s/iter; left time: 7504.4833s
	iters: 800, epoch: 4 | loss: 0.7477722
	speed: 0.2351s/iter; left time: 7073.3397s
	iters: 900, epoch: 4 | loss: 0.3999233
	speed: 0.2440s/iter; left time: 7318.1839s
	iters: 1000, epoch: 4 | loss: 0.8105458
	speed: 0.2459s/iter; left time: 7348.5221s
	iters: 1100, epoch: 4 | loss: 0.3020363
	speed: 0.2493s/iter; left time: 7425.3825s
Epoch: 4 cost time: 279.0892629623413
Epoch: 4, Steps: 1144 | Train Loss: 0.4570985 Vali Loss: 0.4877672 Test Loss: 0.2241855
Validation loss decreased (0.489651 --> 0.487767).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3879360
	speed: 1.2856s/iter; left time: 38112.8417s
	iters: 200, epoch: 5 | loss: 0.3761478
	speed: 0.2411s/iter; left time: 7123.2622s
	iters: 300, epoch: 5 | loss: 0.3062145
	speed: 0.2331s/iter; left time: 6865.0841s
	iters: 400, epoch: 5 | loss: 0.4523972
	speed: 0.2425s/iter; left time: 7115.8379s
	iters: 500, epoch: 5 | loss: 0.3884395
	speed: 0.2420s/iter; left time: 7078.2570s
	iters: 600, epoch: 5 | loss: 0.3812800
	speed: 0.2364s/iter; left time: 6889.0456s
	iters: 700, epoch: 5 | loss: 0.4124288
	speed: 0.2411s/iter; left time: 7002.3345s
	iters: 800, epoch: 5 | loss: 0.3037924
	speed: 0.2397s/iter; left time: 6939.1046s
	iters: 900, epoch: 5 | loss: 0.3764921
	speed: 0.2507s/iter; left time: 7230.4067s
	iters: 1000, epoch: 5 | loss: 0.3129044
	speed: 0.2553s/iter; left time: 7339.4569s
	iters: 1100, epoch: 5 | loss: 0.3173704
	speed: 0.2444s/iter; left time: 6999.7957s
Epoch: 5 cost time: 279.78981018066406
Epoch: 5, Steps: 1144 | Train Loss: 0.4534752 Vali Loss: 0.4874726 Test Loss: 0.2242087
Validation loss decreased (0.487767 --> 0.487473).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3147450
	speed: 1.4026s/iter; left time: 39975.3339s
	iters: 200, epoch: 6 | loss: 0.5057151
	speed: 0.2489s/iter; left time: 7069.4244s
	iters: 300, epoch: 6 | loss: 0.3380854
	speed: 0.2490s/iter; left time: 7048.1350s
	iters: 400, epoch: 6 | loss: 0.8272714
	speed: 0.2488s/iter; left time: 7015.6897s
	iters: 500, epoch: 6 | loss: 0.3861201
	speed: 0.2424s/iter; left time: 6810.9468s
	iters: 600, epoch: 6 | loss: 0.4639788
	speed: 0.2430s/iter; left time: 6804.3692s
	iters: 700, epoch: 6 | loss: 0.3854548
	speed: 0.2391s/iter; left time: 6670.2006s
	iters: 800, epoch: 6 | loss: 0.3134315
	speed: 0.2329s/iter; left time: 6473.5502s
	iters: 900, epoch: 6 | loss: 0.3444863
	speed: 0.2456s/iter; left time: 6802.7369s
	iters: 1000, epoch: 6 | loss: 0.4051724
	speed: 0.2441s/iter; left time: 6737.4899s
	iters: 1100, epoch: 6 | loss: 1.2146343
	speed: 0.2406s/iter; left time: 6617.2477s
Epoch: 6 cost time: 280.21329736709595
Epoch: 6, Steps: 1144 | Train Loss: 0.4515294 Vali Loss: 0.4893870 Test Loss: 0.2249901
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3358320
	speed: 1.2709s/iter; left time: 34769.3261s
	iters: 200, epoch: 7 | loss: 0.4420497
	speed: 0.2492s/iter; left time: 6791.6324s
	iters: 300, epoch: 7 | loss: 0.3132420
	speed: 0.2413s/iter; left time: 6554.0341s
	iters: 400, epoch: 7 | loss: 1.3292445
	speed: 0.2409s/iter; left time: 6517.0856s
	iters: 500, epoch: 7 | loss: 0.3270719
	speed: 0.2381s/iter; left time: 6418.5934s
	iters: 600, epoch: 7 | loss: 0.3677237
	speed: 0.2516s/iter; left time: 6758.0623s
	iters: 700, epoch: 7 | loss: 0.2914480
	speed: 0.2553s/iter; left time: 6831.5855s
	iters: 800, epoch: 7 | loss: 0.4063446
	speed: 0.2542s/iter; left time: 6776.5300s
	iters: 900, epoch: 7 | loss: 0.4621972
	speed: 0.2522s/iter; left time: 6697.4639s
	iters: 1000, epoch: 7 | loss: 0.3125090
	speed: 0.2582s/iter; left time: 6830.9329s
	iters: 1100, epoch: 7 | loss: 0.3997883
	speed: 0.2420s/iter; left time: 6377.8918s
Epoch: 7 cost time: 286.1320164203644
Epoch: 7, Steps: 1144 | Train Loss: 0.4506066 Vali Loss: 0.4890274 Test Loss: 0.2254464
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3913630
	speed: 1.2025s/iter; left time: 31522.1671s
	iters: 200, epoch: 8 | loss: 0.4424703
	speed: 0.2451s/iter; left time: 6401.1129s
	iters: 300, epoch: 8 | loss: 0.3048562
	speed: 0.2375s/iter; left time: 6176.9809s
	iters: 400, epoch: 8 | loss: 0.2777449
	speed: 0.2459s/iter; left time: 6371.1246s
	iters: 500, epoch: 8 | loss: 0.3729449
	speed: 0.2437s/iter; left time: 6291.2222s
	iters: 600, epoch: 8 | loss: 0.2685425
	speed: 0.2441s/iter; left time: 6275.8147s
	iters: 700, epoch: 8 | loss: 0.5233549
	speed: 0.2482s/iter; left time: 6357.4468s
	iters: 800, epoch: 8 | loss: 0.3267218
	speed: 0.2386s/iter; left time: 6088.6052s
	iters: 900, epoch: 8 | loss: 0.3547567
	speed: 0.2485s/iter; left time: 6314.2604s
	iters: 1000, epoch: 8 | loss: 0.3818695
	speed: 0.2490s/iter; left time: 6302.0287s
	iters: 1100, epoch: 8 | loss: 0.3075556
	speed: 0.2350s/iter; left time: 5924.3862s
Epoch: 8 cost time: 280.6605668067932
Epoch: 8, Steps: 1144 | Train Loss: 0.4501854 Vali Loss: 0.4899948 Test Loss: 0.2254045
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_weather_96_192_TimesNet_custom_ftM_sl96_ll48_pl192_dm32_nh8_el2_dl1_df32_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
test shape: (10348, 192, 21) (10348, 192, 21)
test shape: (10348, 192, 21) (10348, 192, 21)
mse:0.2245326191186905, mae:0.26396456360816956, dtw:not calculated
