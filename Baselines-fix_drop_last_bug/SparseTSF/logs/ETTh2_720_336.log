Args in experiment:
Namespace(is_training=1, model_id='ETTh2_720_336', model='SparseTSF', data='ETTh2', root_path='./dataset/', data_path='ETTh2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=336, period_len=24, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=256, patience=5, learning_rate=0.03, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ETTh2_720_336_SparseTSF_ETTh2_ftM_sl720_pl336_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7585
val 2545
test 2545
Epoch: 1 cost time: 2.7007269859313965
Epoch: 1, Steps: 29 | Train Loss: 0.8544009 Vali Loss: 0.5631574 Test Loss: 0.4203347
Validation loss decreased (inf --> 0.563157).  Saving model ...
Updating learning rate to 0.03
Epoch: 2 cost time: 1.420060634613037
Epoch: 2, Steps: 29 | Train Loss: 0.7889098 Vali Loss: 0.4328133 Test Loss: 0.4167472
Validation loss decreased (0.563157 --> 0.432813).  Saving model ...
Updating learning rate to 0.03
Epoch: 3 cost time: 1.3130555152893066
Epoch: 3, Steps: 29 | Train Loss: 0.6822410 Vali Loss: 0.4131852 Test Loss: 0.3757980
Validation loss decreased (0.432813 --> 0.413185).  Saving model ...
Updating learning rate to 0.03
Epoch: 4 cost time: 1.2534809112548828
Epoch: 4, Steps: 29 | Train Loss: 0.6419705 Vali Loss: 0.3918600 Test Loss: 0.3673735
Validation loss decreased (0.413185 --> 0.391860).  Saving model ...
Updating learning rate to 0.024
Epoch: 5 cost time: 1.4961817264556885
Epoch: 5, Steps: 29 | Train Loss: 0.6326117 Vali Loss: 0.3834130 Test Loss: 0.3598029
Validation loss decreased (0.391860 --> 0.383413).  Saving model ...
Updating learning rate to 0.019200000000000002
Epoch: 6 cost time: 1.468418836593628
Epoch: 6, Steps: 29 | Train Loss: 0.6268562 Vali Loss: 0.3781589 Test Loss: 0.3622702
Validation loss decreased (0.383413 --> 0.378159).  Saving model ...
Updating learning rate to 0.015360000000000004
Epoch: 7 cost time: 1.4557242393493652
Epoch: 7, Steps: 29 | Train Loss: 0.6296198 Vali Loss: 0.3783516 Test Loss: 0.3604729
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.012288000000000002
Epoch: 8 cost time: 1.330815076828003
Epoch: 8, Steps: 29 | Train Loss: 0.6309713 Vali Loss: 0.3836068 Test Loss: 0.3569383
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.009830400000000001
Epoch: 9 cost time: 1.6809132099151611
Epoch: 9, Steps: 29 | Train Loss: 0.6250469 Vali Loss: 0.3822941 Test Loss: 0.3592243
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.007864320000000003
Epoch: 10 cost time: 1.4650375843048096
Epoch: 10, Steps: 29 | Train Loss: 0.6256103 Vali Loss: 0.3823313 Test Loss: 0.3579169
EarlyStopping counter: 4 out of 5
Updating learning rate to 0.006291456000000002
Epoch: 11 cost time: 1.3174433708190918
Epoch: 11, Steps: 29 | Train Loss: 0.6281428 Vali Loss: 0.3802311 Test Loss: 0.3603434
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTh2_720_336_SparseTSF_ETTh2_ftM_sl720_pl336_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2545
mse:0.3595329523086548, mae:0.3978397846221924, rse:0.4794119894504547
