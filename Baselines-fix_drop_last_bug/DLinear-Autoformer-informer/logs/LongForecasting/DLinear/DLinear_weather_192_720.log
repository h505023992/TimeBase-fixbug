Args in experiment:
Namespace(is_training=1, train_only=False, model_id='DLinear_weather_192_720', model='DLinear', data='custom', root_path='./dataset/', data_path='weather.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=192, label_len=48, pred_len=720, individual=False, embed_type=0, enc_in=21, dec_in=21, c_out=21, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DLinear_weather_192_720_DLinear_custom_ftM_sl192_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35976
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.6829885
	speed: 0.0501s/iter; left time: 1684.6816s
	iters: 200, epoch: 1 | loss: 0.7970289
	speed: 0.0272s/iter; left time: 911.0293s
	iters: 300, epoch: 1 | loss: 0.6209348
	speed: 0.0276s/iter; left time: 921.9203s
	iters: 400, epoch: 1 | loss: 0.8021309
	speed: 0.0261s/iter; left time: 870.6791s
	iters: 500, epoch: 1 | loss: 0.8181391
	speed: 0.0266s/iter; left time: 883.8541s
	iters: 600, epoch: 1 | loss: 0.6499023
	speed: 0.0285s/iter; left time: 946.1371s
	iters: 700, epoch: 1 | loss: 0.7374282
	speed: 0.0340s/iter; left time: 1122.2549s
	iters: 800, epoch: 1 | loss: 0.7110327
	speed: 0.0349s/iter; left time: 1151.4085s
	iters: 900, epoch: 1 | loss: 0.6801399
	speed: 0.0340s/iter; left time: 1115.9035s
	iters: 1000, epoch: 1 | loss: 0.5934601
	speed: 0.0346s/iter; left time: 1134.5320s
	iters: 1100, epoch: 1 | loss: 0.7404196
	speed: 0.0343s/iter; left time: 1120.2500s
Epoch: 1 cost time: 36.51072025299072
Epoch: 1, Steps: 1125 | Train Loss: 0.6987045 Vali Loss: 0.6477494 Test Loss: 0.3417135
Validation loss decreased (inf --> 0.647749).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5859782
	speed: 0.2661s/iter; left time: 8656.3608s
	iters: 200, epoch: 2 | loss: 0.6817809
	speed: 0.0277s/iter; left time: 897.8920s
	iters: 300, epoch: 2 | loss: 0.6534781
	speed: 0.0316s/iter; left time: 1022.0945s
	iters: 400, epoch: 2 | loss: 0.5771571
	speed: 0.0232s/iter; left time: 748.0376s
	iters: 500, epoch: 2 | loss: 0.6413530
	speed: 0.0237s/iter; left time: 762.3826s
	iters: 600, epoch: 2 | loss: 0.6490144
	speed: 0.0229s/iter; left time: 731.9290s
	iters: 700, epoch: 2 | loss: 0.5595134
	speed: 0.0211s/iter; left time: 674.5058s
	iters: 800, epoch: 2 | loss: 0.8450481
	speed: 0.0235s/iter; left time: 749.4009s
	iters: 900, epoch: 2 | loss: 0.7583944
	speed: 0.0215s/iter; left time: 683.6839s
	iters: 1000, epoch: 2 | loss: 0.4971963
	speed: 0.0270s/iter; left time: 853.0061s
	iters: 1100, epoch: 2 | loss: 0.5497987
	speed: 0.0293s/iter; left time: 924.5210s
Epoch: 2 cost time: 29.671871185302734
Epoch: 2, Steps: 1125 | Train Loss: 0.6468076 Vali Loss: 0.6424151 Test Loss: 0.3368155
Validation loss decreased (0.647749 --> 0.642415).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7007864
	speed: 0.2712s/iter; left time: 8514.7508s
	iters: 200, epoch: 3 | loss: 0.7148986
	speed: 0.0248s/iter; left time: 777.6034s
	iters: 300, epoch: 3 | loss: 0.5370385
	speed: 0.0260s/iter; left time: 811.9310s
	iters: 400, epoch: 3 | loss: 0.6419298
	speed: 0.0249s/iter; left time: 775.0019s
	iters: 500, epoch: 3 | loss: 0.6724004
	speed: 0.0249s/iter; left time: 771.6169s
	iters: 600, epoch: 3 | loss: 0.6105530
	speed: 0.0239s/iter; left time: 737.8141s
	iters: 700, epoch: 3 | loss: 0.5072375
	speed: 0.0243s/iter; left time: 748.8393s
	iters: 800, epoch: 3 | loss: 0.6208358
	speed: 0.0307s/iter; left time: 942.5628s
	iters: 900, epoch: 3 | loss: 0.5508501
	speed: 0.0297s/iter; left time: 907.3594s
	iters: 1000, epoch: 3 | loss: 0.5249477
	speed: 0.0288s/iter; left time: 877.2618s
	iters: 1100, epoch: 3 | loss: 0.4953834
	speed: 0.0306s/iter; left time: 930.7867s
Epoch: 3 cost time: 30.934325456619263
Epoch: 3, Steps: 1125 | Train Loss: 0.6398244 Vali Loss: 0.6407431 Test Loss: 0.3359951
Validation loss decreased (0.642415 --> 0.640743).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.4691189
	speed: 0.2609s/iter; left time: 7898.8691s
	iters: 200, epoch: 4 | loss: 0.5470502
	speed: 0.0236s/iter; left time: 712.4340s
	iters: 300, epoch: 4 | loss: 0.5740309
	speed: 0.0244s/iter; left time: 734.6097s
	iters: 400, epoch: 4 | loss: 0.5329344
	speed: 0.0245s/iter; left time: 735.1679s
	iters: 500, epoch: 4 | loss: 0.4900085
	speed: 0.0260s/iter; left time: 776.1031s
	iters: 600, epoch: 4 | loss: 0.7076915
	speed: 0.0311s/iter; left time: 924.6755s
	iters: 700, epoch: 4 | loss: 0.4967893
	speed: 0.0296s/iter; left time: 877.6587s
	iters: 800, epoch: 4 | loss: 0.5982100
	speed: 0.0288s/iter; left time: 850.9691s
	iters: 900, epoch: 4 | loss: 0.4919557
	speed: 0.0311s/iter; left time: 915.4907s
	iters: 1000, epoch: 4 | loss: 0.4887777
	speed: 0.0350s/iter; left time: 1029.5156s
	iters: 1100, epoch: 4 | loss: 0.5419244
	speed: 0.0318s/iter; left time: 932.0605s
Epoch: 4 cost time: 33.0288302898407
Epoch: 4, Steps: 1125 | Train Loss: 0.6373443 Vali Loss: 0.6419700 Test Loss: 0.3350963
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.6860102
	speed: 0.3391s/iter; left time: 9885.8224s
	iters: 200, epoch: 5 | loss: 0.8704420
	speed: 0.0364s/iter; left time: 1056.0590s
	iters: 300, epoch: 5 | loss: 0.5987681
	speed: 0.0384s/iter; left time: 1112.2582s
	iters: 400, epoch: 5 | loss: 0.4940830
	speed: 0.0364s/iter; left time: 1049.3499s
	iters: 500, epoch: 5 | loss: 0.6383482
	speed: 0.0317s/iter; left time: 911.2463s
	iters: 600, epoch: 5 | loss: 0.5239257
	speed: 0.0264s/iter; left time: 757.6280s
	iters: 700, epoch: 5 | loss: 0.5432746
	speed: 0.0233s/iter; left time: 664.9192s
	iters: 800, epoch: 5 | loss: 0.8217537
	speed: 0.0241s/iter; left time: 686.1041s
	iters: 900, epoch: 5 | loss: 0.5037357
	speed: 0.0241s/iter; left time: 682.4243s
	iters: 1000, epoch: 5 | loss: 0.5339815
	speed: 0.0247s/iter; left time: 697.8941s
	iters: 1100, epoch: 5 | loss: 0.5078611
	speed: 0.0229s/iter; left time: 643.3762s
Epoch: 5 cost time: 34.134870529174805
Epoch: 5, Steps: 1125 | Train Loss: 0.6360792 Vali Loss: 0.6382180 Test Loss: 0.3364921
Validation loss decreased (0.640743 --> 0.638218).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.6170103
	speed: 0.3297s/iter; left time: 9240.4118s
	iters: 200, epoch: 6 | loss: 0.7899957
	speed: 0.0342s/iter; left time: 954.9753s
	iters: 300, epoch: 6 | loss: 0.8844236
	speed: 0.0294s/iter; left time: 817.8393s
	iters: 400, epoch: 6 | loss: 0.5450778
	speed: 0.0323s/iter; left time: 895.8264s
	iters: 500, epoch: 6 | loss: 0.5972483
	speed: 0.0341s/iter; left time: 941.3878s
	iters: 600, epoch: 6 | loss: 0.6684597
	speed: 0.0327s/iter; left time: 898.9247s
	iters: 700, epoch: 6 | loss: 0.5208740
	speed: 0.0310s/iter; left time: 849.6865s
	iters: 800, epoch: 6 | loss: 0.5960014
	speed: 0.0335s/iter; left time: 914.8634s
	iters: 900, epoch: 6 | loss: 0.6154860
	speed: 0.0314s/iter; left time: 853.8576s
	iters: 1000, epoch: 6 | loss: 0.5868338
	speed: 0.0309s/iter; left time: 838.6808s
	iters: 1100, epoch: 6 | loss: 0.7852398
	speed: 0.0321s/iter; left time: 868.5645s
Epoch: 6 cost time: 37.73460125923157
Epoch: 6, Steps: 1125 | Train Loss: 0.6354811 Vali Loss: 0.6398969 Test Loss: 0.3353826
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.7223077
	speed: 0.4116s/iter; left time: 11073.1400s
	iters: 200, epoch: 7 | loss: 0.8878723
	speed: 0.0348s/iter; left time: 933.6369s
	iters: 300, epoch: 7 | loss: 0.6102561
	speed: 0.0340s/iter; left time: 906.9314s
	iters: 400, epoch: 7 | loss: 0.6459970
	speed: 0.0392s/iter; left time: 1042.1112s
	iters: 500, epoch: 7 | loss: 0.8837325
	speed: 0.0412s/iter; left time: 1092.5534s
	iters: 600, epoch: 7 | loss: 0.8088877
	speed: 0.0449s/iter; left time: 1184.8443s
	iters: 700, epoch: 7 | loss: 0.6783658
	speed: 0.0472s/iter; left time: 1240.9473s
	iters: 800, epoch: 7 | loss: 0.4823532
	speed: 0.0459s/iter; left time: 1203.1567s
	iters: 900, epoch: 7 | loss: 0.6730026
	speed: 0.0478s/iter; left time: 1248.4601s
	iters: 1000, epoch: 7 | loss: 0.8143963
	speed: 0.0479s/iter; left time: 1245.5835s
	iters: 1100, epoch: 7 | loss: 0.6419290
	speed: 0.0404s/iter; left time: 1045.4494s
Epoch: 7 cost time: 48.014169454574585
Epoch: 7, Steps: 1125 | Train Loss: 0.6352924 Vali Loss: 0.6398264 Test Loss: 0.3352089
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4642555
	speed: 0.4137s/iter; left time: 10664.5409s
	iters: 200, epoch: 8 | loss: 0.6440237
	speed: 0.0386s/iter; left time: 991.2179s
	iters: 300, epoch: 8 | loss: 0.5649307
	speed: 0.0374s/iter; left time: 957.6404s
	iters: 400, epoch: 8 | loss: 0.4726941
	speed: 0.0339s/iter; left time: 863.9152s
	iters: 500, epoch: 8 | loss: 0.5584665
	speed: 0.0345s/iter; left time: 875.4222s
	iters: 600, epoch: 8 | loss: 0.5800564
	speed: 0.0349s/iter; left time: 881.4246s
	iters: 700, epoch: 8 | loss: 0.6291742
	speed: 0.0282s/iter; left time: 709.7425s
	iters: 800, epoch: 8 | loss: 0.6496003
	speed: 0.0265s/iter; left time: 663.4253s
	iters: 900, epoch: 8 | loss: 0.6549981
	speed: 0.0237s/iter; left time: 593.0360s
	iters: 1000, epoch: 8 | loss: 0.8236191
	speed: 0.0250s/iter; left time: 622.9035s
	iters: 1100, epoch: 8 | loss: 0.9249849
	speed: 0.0254s/iter; left time: 630.0069s
Epoch: 8 cost time: 36.4085111618042
Epoch: 8, Steps: 1125 | Train Loss: 0.6349542 Vali Loss: 0.6386836 Test Loss: 0.3354975
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : DLinear_weather_192_720_DLinear_custom_ftM_sl192_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
mse:0.33638206124305725, mae:0.37436315417289734
