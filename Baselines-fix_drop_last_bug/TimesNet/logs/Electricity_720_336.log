True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ECL_720_336         Model:              TimesNet            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/          
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            720                 Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             321                 Dec In:             321                 
  C Out:              321                 d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ECL_720_336_TimesNet_custom_ftM_sl720_ll48_pl336_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17357
val 2297
test 4925
	iters: 100, epoch: 1 | loss: 0.4919680
	speed: 0.7624s/iter; left time: 12343.5051s
	iters: 200, epoch: 1 | loss: 0.3767401
	speed: 0.7049s/iter; left time: 11343.1911s
	iters: 300, epoch: 1 | loss: 0.3105097
	speed: 0.7552s/iter; left time: 12076.8240s
	iters: 400, epoch: 1 | loss: 0.2841558
	speed: 0.7315s/iter; left time: 11624.1252s
	iters: 500, epoch: 1 | loss: 0.2961494
	speed: 0.7784s/iter; left time: 12291.0287s
Epoch: 1 cost time: 407.58852648735046
Epoch: 1, Steps: 543 | Train Loss: 0.3986630 Vali Loss: 0.2406217 Test Loss: 0.2900622
Validation loss decreased (inf --> 0.240622).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2910872
	speed: 2.4080s/iter; left time: 37680.1822s
	iters: 200, epoch: 2 | loss: 0.2504203
	speed: 0.8532s/iter; left time: 13265.8494s
	iters: 300, epoch: 2 | loss: 0.2733121
	speed: 1.0334s/iter; left time: 15963.2390s
	iters: 400, epoch: 2 | loss: 0.2770704
	speed: 0.9227s/iter; left time: 14161.1210s
	iters: 500, epoch: 2 | loss: 0.2726620
	speed: 0.9160s/iter; left time: 13966.5941s
Epoch: 2 cost time: 492.513436794281
Epoch: 2, Steps: 543 | Train Loss: 0.2670070 Vali Loss: 0.2139096 Test Loss: 0.2455665
Validation loss decreased (0.240622 --> 0.213910).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2177874
	speed: 2.6206s/iter; left time: 39584.4836s
	iters: 200, epoch: 3 | loss: 0.1984983
	speed: 0.7991s/iter; left time: 11990.0905s
	iters: 300, epoch: 3 | loss: 0.1969105
	speed: 0.7992s/iter; left time: 11912.2904s
	iters: 400, epoch: 3 | loss: 0.2220137
	speed: 0.7991s/iter; left time: 11830.2474s
	iters: 500, epoch: 3 | loss: 0.1762733
	speed: 0.7990s/iter; left time: 11749.1673s
Epoch: 3 cost time: 435.9680323600769
Epoch: 3, Steps: 543 | Train Loss: 0.2005377 Vali Loss: 0.1846047 Test Loss: 0.2362167
Validation loss decreased (0.213910 --> 0.184605).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2034064
	speed: 2.3931s/iter; left time: 34848.1724s
	iters: 200, epoch: 4 | loss: 0.1748478
	speed: 0.7996s/iter; left time: 11564.0275s
	iters: 300, epoch: 4 | loss: 0.1836598
	speed: 0.7991s/iter; left time: 11476.2067s
	iters: 400, epoch: 4 | loss: 0.1882481
	speed: 0.7996s/iter; left time: 11403.3125s
	iters: 500, epoch: 4 | loss: 0.1750385
	speed: 0.7998s/iter; left time: 11327.2069s
Epoch: 4 cost time: 435.0662086009979
Epoch: 4, Steps: 543 | Train Loss: 0.1833846 Vali Loss: 0.1819441 Test Loss: 0.2317430
Validation loss decreased (0.184605 --> 0.181944).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1821788
	speed: 2.3849s/iter; left time: 33433.9027s
	iters: 200, epoch: 5 | loss: 0.1917530
	speed: 0.7999s/iter; left time: 11133.6426s
	iters: 300, epoch: 5 | loss: 0.1699596
	speed: 0.7996s/iter; left time: 11049.3931s
	iters: 400, epoch: 5 | loss: 0.1653617
	speed: 0.8001s/iter; left time: 10976.0625s
	iters: 500, epoch: 5 | loss: 0.1773397
	speed: 0.8000s/iter; left time: 10895.7662s
Epoch: 5 cost time: 435.14028120040894
Epoch: 5, Steps: 543 | Train Loss: 0.1764288 Vali Loss: 0.1869509 Test Loss: 0.2346094
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1748028
	speed: 2.3886s/iter; left time: 32188.1780s
	iters: 200, epoch: 6 | loss: 0.1830081
	speed: 0.8000s/iter; left time: 10700.2641s
	iters: 300, epoch: 6 | loss: 0.1719800
	speed: 0.8004s/iter; left time: 10626.4807s
	iters: 400, epoch: 6 | loss: 0.1830241
	speed: 0.8000s/iter; left time: 10541.2498s
	iters: 500, epoch: 6 | loss: 0.1651747
	speed: 0.8000s/iter; left time: 10461.0190s
Epoch: 6 cost time: 435.23018622398376
Epoch: 6, Steps: 543 | Train Loss: 0.1727916 Vali Loss: 0.1885434 Test Loss: 0.2373877
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1717215
	speed: 2.3852s/iter; left time: 30847.6552s
	iters: 200, epoch: 7 | loss: 0.1768108
	speed: 0.7984s/iter; left time: 10245.6243s
	iters: 300, epoch: 7 | loss: 0.1703750
	speed: 0.7986s/iter; left time: 10168.1992s
	iters: 400, epoch: 7 | loss: 0.1611190
	speed: 0.7985s/iter; left time: 10087.2273s
	iters: 500, epoch: 7 | loss: 0.1608367
	speed: 0.7990s/iter; left time: 10013.9163s
Epoch: 7 cost time: 434.47182273864746
Epoch: 7, Steps: 543 | Train Loss: 0.1708898 Vali Loss: 0.1905040 Test Loss: 0.2381980
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ECL_720_336_TimesNet_custom_ftM_sl720_ll48_pl336_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4925
test shape: (4925, 336, 321) (4925, 336, 321)
test shape: (4925, 336, 321) (4925, 336, 321)
mse:0.2316398173570633, mae:0.3315146267414093, dtw:not calculated
