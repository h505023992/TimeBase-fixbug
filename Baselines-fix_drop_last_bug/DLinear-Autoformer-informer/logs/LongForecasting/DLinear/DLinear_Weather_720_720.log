Args in experiment:
Namespace(is_training=1, train_only=False, model_id='weather_720_720', model='DLinear', data='custom', root_path='./dataset/', data_path='weather.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=720, individual=False, embed_type=0, enc_in=21, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=10, batch_size=16, patience=3, learning_rate=0.001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=7, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:7
>>>>>>>start training : weather_720_720_DLinear_custom_ftM_sl720_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35448
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.8157496
	speed: 0.0223s/iter; left time: 491.9205s
	iters: 200, epoch: 1 | loss: 0.7273841
	speed: 0.0094s/iter; left time: 206.7488s
	iters: 300, epoch: 1 | loss: 0.6646935
	speed: 0.0092s/iter; left time: 201.0243s
	iters: 400, epoch: 1 | loss: 0.4249986
	speed: 0.0097s/iter; left time: 211.0936s
	iters: 500, epoch: 1 | loss: 0.7109296
	speed: 0.0110s/iter; left time: 238.5640s
	iters: 600, epoch: 1 | loss: 0.4763200
	speed: 0.0107s/iter; left time: 231.4292s
	iters: 700, epoch: 1 | loss: 0.7955661
	speed: 0.0094s/iter; left time: 201.9490s
	iters: 800, epoch: 1 | loss: 0.5069902
	speed: 0.0093s/iter; left time: 198.8874s
	iters: 900, epoch: 1 | loss: 0.4551619
	speed: 0.0086s/iter; left time: 182.6455s
	iters: 1000, epoch: 1 | loss: 0.6215161
	speed: 0.0081s/iter; left time: 170.3226s
	iters: 1100, epoch: 1 | loss: 0.6063498
	speed: 0.0088s/iter; left time: 185.2763s
	iters: 1200, epoch: 1 | loss: 0.5321938
	speed: 0.0085s/iter; left time: 178.0420s
	iters: 1300, epoch: 1 | loss: 0.4975036
	speed: 0.0083s/iter; left time: 172.9112s
	iters: 1400, epoch: 1 | loss: 0.6123770
	speed: 0.0086s/iter; left time: 177.7535s
	iters: 1500, epoch: 1 | loss: 0.4481799
	speed: 0.0083s/iter; left time: 172.0152s
	iters: 1600, epoch: 1 | loss: 0.4309604
	speed: 0.0084s/iter; left time: 173.6331s
	iters: 1700, epoch: 1 | loss: 0.7125793
	speed: 0.0087s/iter; left time: 176.9150s
	iters: 1800, epoch: 1 | loss: 0.5902791
	speed: 0.0081s/iter; left time: 165.1725s
	iters: 1900, epoch: 1 | loss: 0.7022960
	speed: 0.0080s/iter; left time: 161.6551s
	iters: 2000, epoch: 1 | loss: 0.5775954
	speed: 0.0084s/iter; left time: 168.5393s
	iters: 2100, epoch: 1 | loss: 0.6931592
	speed: 0.0085s/iter; left time: 169.5172s
	iters: 2200, epoch: 1 | loss: 0.4178703
	speed: 0.0079s/iter; left time: 157.3707s
Epoch: 1 cost time: 20.982671976089478
Epoch: 1, Steps: 2215 | Train Loss: 0.6044361 Vali Loss: 0.6109654 Test Loss: 0.3213894
Validation loss decreased (inf --> 0.610965).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.5716383
	speed: 0.1140s/iter; left time: 2260.4515s
	iters: 200, epoch: 2 | loss: 0.5647351
	speed: 0.0136s/iter; left time: 268.6235s
	iters: 300, epoch: 2 | loss: 0.6273028
	speed: 0.0096s/iter; left time: 189.0710s
	iters: 400, epoch: 2 | loss: 0.4783836
	speed: 0.0086s/iter; left time: 168.1747s
	iters: 500, epoch: 2 | loss: 0.5727953
	speed: 0.0084s/iter; left time: 163.0736s
	iters: 600, epoch: 2 | loss: 0.4997158
	speed: 0.0081s/iter; left time: 157.2625s
	iters: 700, epoch: 2 | loss: 0.5440087
	speed: 0.0087s/iter; left time: 167.1042s
	iters: 800, epoch: 2 | loss: 0.5015564
	speed: 0.0083s/iter; left time: 159.0435s
	iters: 900, epoch: 2 | loss: 0.6939907
	speed: 0.0083s/iter; left time: 157.8981s
	iters: 1000, epoch: 2 | loss: 1.0250627
	speed: 0.0084s/iter; left time: 158.7604s
	iters: 1100, epoch: 2 | loss: 0.5481523
	speed: 0.0089s/iter; left time: 168.4472s
	iters: 1200, epoch: 2 | loss: 0.5290083
	speed: 0.0084s/iter; left time: 158.1404s
	iters: 1300, epoch: 2 | loss: 0.6315467
	speed: 0.0086s/iter; left time: 160.7745s
	iters: 1400, epoch: 2 | loss: 0.5822473
	speed: 0.0124s/iter; left time: 230.6161s
	iters: 1500, epoch: 2 | loss: 0.5588788
	speed: 0.0104s/iter; left time: 191.6793s
	iters: 1600, epoch: 2 | loss: 0.4172693
	speed: 0.0087s/iter; left time: 159.4266s
	iters: 1700, epoch: 2 | loss: 0.4070095
	speed: 0.0085s/iter; left time: 154.9362s
	iters: 1800, epoch: 2 | loss: 0.5467345
	speed: 0.0084s/iter; left time: 152.8369s
	iters: 1900, epoch: 2 | loss: 0.5600876
	speed: 0.0089s/iter; left time: 160.2042s
	iters: 2000, epoch: 2 | loss: 0.5593433
	speed: 0.0094s/iter; left time: 167.9154s
	iters: 2100, epoch: 2 | loss: 0.6091264
	speed: 0.0102s/iter; left time: 181.5591s
	iters: 2200, epoch: 2 | loss: 0.6151317
	speed: 0.0091s/iter; left time: 161.4128s
Epoch: 2 cost time: 21.339973211288452
Epoch: 2, Steps: 2215 | Train Loss: 0.6006991 Vali Loss: 0.6053203 Test Loss: 0.3314750
Validation loss decreased (0.610965 --> 0.605320).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.4825241
	speed: 0.1410s/iter; left time: 2484.3032s
	iters: 200, epoch: 3 | loss: 0.6509373
	speed: 0.0087s/iter; left time: 151.7402s
	iters: 300, epoch: 3 | loss: 0.5726404
	speed: 0.0090s/iter; left time: 157.3065s
	iters: 400, epoch: 3 | loss: 0.7129217
	speed: 0.0085s/iter; left time: 147.8779s
	iters: 500, epoch: 3 | loss: 0.5691053
	speed: 0.0080s/iter; left time: 136.9442s
	iters: 600, epoch: 3 | loss: 0.4340933
	speed: 0.0084s/iter; left time: 144.3189s
	iters: 700, epoch: 3 | loss: 0.5600647
	speed: 0.0085s/iter; left time: 144.2382s
	iters: 800, epoch: 3 | loss: 0.4510942
	speed: 0.0085s/iter; left time: 144.3448s
	iters: 900, epoch: 3 | loss: 0.6216760
	speed: 0.0116s/iter; left time: 195.3782s
	iters: 1000, epoch: 3 | loss: 0.7606280
	speed: 0.0146s/iter; left time: 243.9909s
	iters: 1100, epoch: 3 | loss: 0.4749767
	speed: 0.0099s/iter; left time: 164.9878s
	iters: 1200, epoch: 3 | loss: 0.7008421
	speed: 0.0092s/iter; left time: 151.7373s
	iters: 1300, epoch: 3 | loss: 0.9784740
	speed: 0.0093s/iter; left time: 152.7417s
	iters: 1400, epoch: 3 | loss: 0.5205292
	speed: 0.0085s/iter; left time: 138.6601s
	iters: 1500, epoch: 3 | loss: 0.4981072
	speed: 0.0133s/iter; left time: 216.2449s
	iters: 1600, epoch: 3 | loss: 0.7161040
	speed: 0.0150s/iter; left time: 242.1435s
	iters: 1700, epoch: 3 | loss: 0.8046400
	speed: 0.0090s/iter; left time: 144.0564s
	iters: 1800, epoch: 3 | loss: 0.5488884
	speed: 0.0085s/iter; left time: 135.5813s
	iters: 1900, epoch: 3 | loss: 0.5681430
	speed: 0.0083s/iter; left time: 132.0343s
	iters: 2000, epoch: 3 | loss: 0.4705523
	speed: 0.0086s/iter; left time: 134.9842s
	iters: 2100, epoch: 3 | loss: 0.4250868
	speed: 0.0087s/iter; left time: 135.5416s
	iters: 2200, epoch: 3 | loss: 0.4083493
	speed: 0.0087s/iter; left time: 134.5283s
Epoch: 3 cost time: 22.087684631347656
Epoch: 3, Steps: 2215 | Train Loss: 0.5863398 Vali Loss: 0.6023600 Test Loss: 0.3282591
Validation loss decreased (0.605320 --> 0.602360).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.6160007
	speed: 0.1376s/iter; left time: 2119.5365s
	iters: 200, epoch: 4 | loss: 0.6156881
	speed: 0.0102s/iter; left time: 156.8465s
	iters: 300, epoch: 4 | loss: 0.4759562
	speed: 0.0102s/iter; left time: 155.8387s
	iters: 400, epoch: 4 | loss: 0.4537823
	speed: 0.0102s/iter; left time: 154.0287s
	iters: 500, epoch: 4 | loss: 0.4176346
	speed: 0.0115s/iter; left time: 172.9265s
	iters: 600, epoch: 4 | loss: 0.5640892
	speed: 0.0085s/iter; left time: 126.1727s
	iters: 700, epoch: 4 | loss: 0.4275466
	speed: 0.0090s/iter; left time: 133.7285s
	iters: 800, epoch: 4 | loss: 0.5392313
	speed: 0.0104s/iter; left time: 153.5850s
	iters: 900, epoch: 4 | loss: 0.7057682
	speed: 0.0105s/iter; left time: 153.8156s
	iters: 1000, epoch: 4 | loss: 0.5097885
	speed: 0.0091s/iter; left time: 131.9400s
	iters: 1100, epoch: 4 | loss: 0.4559281
	speed: 0.0108s/iter; left time: 155.2259s
	iters: 1200, epoch: 4 | loss: 0.6454162
	speed: 0.0087s/iter; left time: 124.2365s
	iters: 1300, epoch: 4 | loss: 0.5415042
	speed: 0.0101s/iter; left time: 143.2296s
	iters: 1400, epoch: 4 | loss: 0.5982063
	speed: 0.0091s/iter; left time: 128.0409s
	iters: 1500, epoch: 4 | loss: 0.4786002
	speed: 0.0084s/iter; left time: 117.5510s
	iters: 1600, epoch: 4 | loss: 0.4617831
	speed: 0.0086s/iter; left time: 118.9522s
	iters: 1700, epoch: 4 | loss: 0.6017577
	speed: 0.0077s/iter; left time: 106.7472s
	iters: 1800, epoch: 4 | loss: 0.6433632
	speed: 0.0080s/iter; left time: 109.7996s
	iters: 1900, epoch: 4 | loss: 0.5767125
	speed: 0.0085s/iter; left time: 115.8944s
	iters: 2000, epoch: 4 | loss: 0.4895155
	speed: 0.0078s/iter; left time: 105.5633s
	iters: 2100, epoch: 4 | loss: 0.4684924
	speed: 0.0080s/iter; left time: 106.7112s
	iters: 2200, epoch: 4 | loss: 0.4601358
	speed: 0.0089s/iter; left time: 118.9619s
Epoch: 4 cost time: 21.27460289001465
Epoch: 4, Steps: 2215 | Train Loss: 0.5786552 Vali Loss: 0.5892433 Test Loss: 0.3291623
Validation loss decreased (0.602360 --> 0.589243).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.5377644
	speed: 0.1404s/iter; left time: 1851.4872s
	iters: 200, epoch: 5 | loss: 0.4690476
	speed: 0.0099s/iter; left time: 130.2548s
	iters: 300, epoch: 5 | loss: 0.5178715
	speed: 0.0086s/iter; left time: 112.2019s
	iters: 400, epoch: 5 | loss: 0.4901218
	speed: 0.0092s/iter; left time: 119.1291s
	iters: 500, epoch: 5 | loss: 0.7366347
	speed: 0.0090s/iter; left time: 114.8314s
	iters: 600, epoch: 5 | loss: 0.5984588
	speed: 0.0139s/iter; left time: 176.8918s
	iters: 700, epoch: 5 | loss: 0.7671896
	speed: 0.0112s/iter; left time: 141.5870s
	iters: 800, epoch: 5 | loss: 0.7697054
	speed: 0.0084s/iter; left time: 105.2273s
	iters: 900, epoch: 5 | loss: 0.6050838
	speed: 0.0084s/iter; left time: 103.5433s
	iters: 1000, epoch: 5 | loss: 0.4705578
	speed: 0.0095s/iter; left time: 116.2929s
	iters: 1100, epoch: 5 | loss: 0.4350573
	speed: 0.0089s/iter; left time: 108.0388s
	iters: 1200, epoch: 5 | loss: 0.4943243
	speed: 0.0091s/iter; left time: 110.2041s
	iters: 1300, epoch: 5 | loss: 0.7469996
	speed: 0.0092s/iter; left time: 110.8724s
	iters: 1400, epoch: 5 | loss: 0.5722935
	speed: 0.0094s/iter; left time: 111.8184s
	iters: 1500, epoch: 5 | loss: 0.7498848
	speed: 0.0093s/iter; left time: 109.7308s
	iters: 1600, epoch: 5 | loss: 0.4723972
	speed: 0.0091s/iter; left time: 106.3826s
	iters: 1700, epoch: 5 | loss: 0.4780497
	speed: 0.0075s/iter; left time: 86.5099s
	iters: 1800, epoch: 5 | loss: 0.3993194
	speed: 0.0084s/iter; left time: 96.7634s
	iters: 1900, epoch: 5 | loss: 0.5254331
	speed: 0.0107s/iter; left time: 122.1715s
	iters: 2000, epoch: 5 | loss: 0.4674293
	speed: 0.0094s/iter; left time: 105.6972s
	iters: 2100, epoch: 5 | loss: 0.8710729
	speed: 0.0091s/iter; left time: 101.3844s
	iters: 2200, epoch: 5 | loss: 0.5364207
	speed: 0.0101s/iter; left time: 112.5177s
Epoch: 5 cost time: 21.621204614639282
Epoch: 5, Steps: 2215 | Train Loss: 0.5748140 Vali Loss: 0.5896596 Test Loss: 0.3289449
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.4206820
	speed: 0.1330s/iter; left time: 1459.4553s
	iters: 200, epoch: 6 | loss: 0.6608646
	speed: 0.0092s/iter; left time: 100.1222s
	iters: 300, epoch: 6 | loss: 0.4978790
	speed: 0.0099s/iter; left time: 106.9739s
	iters: 400, epoch: 6 | loss: 0.9923353
	speed: 0.0096s/iter; left time: 102.7007s
	iters: 500, epoch: 6 | loss: 0.5251370
	speed: 0.0097s/iter; left time: 102.9405s
	iters: 600, epoch: 6 | loss: 0.4051827
	speed: 0.0098s/iter; left time: 102.7608s
	iters: 700, epoch: 6 | loss: 0.6086245
	speed: 0.0096s/iter; left time: 99.5409s
	iters: 800, epoch: 6 | loss: 0.7812845
	speed: 0.0127s/iter; left time: 130.1949s
	iters: 900, epoch: 6 | loss: 0.4321789
	speed: 0.0169s/iter; left time: 172.4540s
	iters: 1000, epoch: 6 | loss: 0.6530202
	speed: 0.0090s/iter; left time: 90.5361s
	iters: 1100, epoch: 6 | loss: 0.7015924
	speed: 0.0095s/iter; left time: 94.3172s
	iters: 1200, epoch: 6 | loss: 0.4258350
	speed: 0.0095s/iter; left time: 93.6476s
	iters: 1300, epoch: 6 | loss: 0.9225578
	speed: 0.0099s/iter; left time: 96.3075s
	iters: 1400, epoch: 6 | loss: 0.6576198
	speed: 0.0096s/iter; left time: 92.6428s
	iters: 1500, epoch: 6 | loss: 0.3970519
	speed: 0.0105s/iter; left time: 100.1303s
	iters: 1600, epoch: 6 | loss: 0.4827806
	speed: 0.0087s/iter; left time: 82.8855s
	iters: 1700, epoch: 6 | loss: 0.6851138
	speed: 0.0089s/iter; left time: 83.7642s
	iters: 1800, epoch: 6 | loss: 0.4701584
	speed: 0.0089s/iter; left time: 82.2853s
	iters: 1900, epoch: 6 | loss: 0.3749292
	speed: 0.0079s/iter; left time: 72.0419s
	iters: 2000, epoch: 6 | loss: 0.5458878
	speed: 0.0168s/iter; left time: 152.5647s
	iters: 2100, epoch: 6 | loss: 0.4378352
	speed: 0.0094s/iter; left time: 84.8229s
	iters: 2200, epoch: 6 | loss: 0.5504255
	speed: 0.0086s/iter; left time: 75.9601s
Epoch: 6 cost time: 23.220335245132446
Epoch: 6, Steps: 2215 | Train Loss: 0.5727301 Vali Loss: 0.5925533 Test Loss: 0.3283807
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.8543141
	speed: 0.1418s/iter; left time: 1242.5838s
	iters: 200, epoch: 7 | loss: 0.4248176
	speed: 0.0117s/iter; left time: 101.2771s
	iters: 300, epoch: 7 | loss: 0.6734448
	speed: 0.0096s/iter; left time: 82.4723s
	iters: 400, epoch: 7 | loss: 0.4118779
	speed: 0.0102s/iter; left time: 86.6581s
	iters: 500, epoch: 7 | loss: 0.5917200
	speed: 0.0093s/iter; left time: 77.6319s
	iters: 600, epoch: 7 | loss: 0.7486483
	speed: 0.0097s/iter; left time: 80.5026s
	iters: 700, epoch: 7 | loss: 0.4460532
	speed: 0.0106s/iter; left time: 86.1904s
	iters: 800, epoch: 7 | loss: 0.3875429
	speed: 0.0085s/iter; left time: 68.1757s
	iters: 900, epoch: 7 | loss: 0.5098186
	speed: 0.0088s/iter; left time: 70.1000s
	iters: 1000, epoch: 7 | loss: 0.5760816
	speed: 0.0097s/iter; left time: 75.9005s
	iters: 1100, epoch: 7 | loss: 0.4857771
	speed: 0.0107s/iter; left time: 83.2259s
	iters: 1200, epoch: 7 | loss: 0.8130703
	speed: 0.0110s/iter; left time: 83.9837s
	iters: 1300, epoch: 7 | loss: 0.4091870
	speed: 0.0124s/iter; left time: 93.7721s
	iters: 1400, epoch: 7 | loss: 0.4868408
	speed: 0.0093s/iter; left time: 69.3577s
	iters: 1500, epoch: 7 | loss: 0.4343930
	speed: 0.0085s/iter; left time: 62.4793s
	iters: 1600, epoch: 7 | loss: 0.9701467
	speed: 0.0092s/iter; left time: 66.8646s
	iters: 1700, epoch: 7 | loss: 0.4222742
	speed: 0.0094s/iter; left time: 67.2711s
	iters: 1800, epoch: 7 | loss: 0.7417051
	speed: 0.0101s/iter; left time: 71.1815s
	iters: 1900, epoch: 7 | loss: 0.7677845
	speed: 0.0146s/iter; left time: 101.6588s
	iters: 2000, epoch: 7 | loss: 0.9782928
	speed: 0.0092s/iter; left time: 62.9221s
	iters: 2100, epoch: 7 | loss: 0.5320147
	speed: 0.0088s/iter; left time: 59.2045s
	iters: 2200, epoch: 7 | loss: 0.5408437
	speed: 0.0087s/iter; left time: 57.7661s
Epoch: 7 cost time: 22.823060989379883
Epoch: 7, Steps: 2215 | Train Loss: 0.5715958 Vali Loss: 0.5894806 Test Loss: 0.3280495
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_720_720_DLinear_custom_ftM_sl720_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
mse:0.32605893778800964, mae:0.3592964925765991
