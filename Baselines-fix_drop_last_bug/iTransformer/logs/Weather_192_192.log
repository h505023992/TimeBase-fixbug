Args in experiment:
Namespace(is_training=1, model_id='weather_192_192', model='iTransformer', data='custom', root_path='./dataset/', data_path='weather.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=192, label_len=48, pred_len=192, enc_in=21, dec_in=21, c_out=21, d_model=128, n_heads=8, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=10, batch_size=64, patience=3, learning_rate=0.0001, des='Exp', loss='MSE', lradj='type1', use_amp=False, use_gpu=True, gpu=2, use_multi_gpu=False, devices='0,1,2,3', exp_name='MTSF', channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv', efficient_training=False, use_norm=True, partial_start_index=0)
Use GPU: cuda:2
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.dropout.Dropout'>.
[INFO] Register count_convNd() for <class 'torch.nn.modules.conv.Conv1d'>.
[INFO] Register count_normalization() for <class 'torch.nn.modules.normalization.LayerNorm'>.
MACs: 9386496.0
Params: 348480.0
9.39M MACs
>>>>>>>start training : weather_192_192_iTransformer_custom_M_ft192_sl48_ll192_pl128_dm8_nh3_el1_dl128_df1_fctimeF_ebTrue_dtExp_projection_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36504
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.8886341
	speed: 0.1037s/iter; left time: 580.7219s
	iters: 200, epoch: 1 | loss: 0.4605033
	speed: 0.0813s/iter; left time: 447.4575s
	iters: 300, epoch: 1 | loss: 0.7230415
	speed: 0.0757s/iter; left time: 408.8830s
	iters: 400, epoch: 1 | loss: 0.4868835
	speed: 0.0684s/iter; left time: 362.5753s
	iters: 500, epoch: 1 | loss: 0.4708248
	speed: 0.0704s/iter; left time: 366.3270s
Max Memory (MB): 176.1689453125
Epoch: 1 cost time: 44.87350535392761
Epoch: 1, Steps: 570 | Train Loss: 0.5924230 Vali Loss: 0.5311332 Test Loss: 0.2305803
Validation loss decreased (inf --> 0.531133).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4513578
	speed: 1.4992s/iter; left time: 7542.3163s
	iters: 200, epoch: 2 | loss: 0.6109278
	speed: 0.0661s/iter; left time: 326.1784s
	iters: 300, epoch: 2 | loss: 0.7076544
	speed: 0.0698s/iter; left time: 337.0746s
	iters: 400, epoch: 2 | loss: 0.5350600
	speed: 0.0701s/iter; left time: 331.6137s
	iters: 500, epoch: 2 | loss: 0.3904139
	speed: 0.0697s/iter; left time: 322.7066s
Max Memory (MB): 176.1689453125
Epoch: 2 cost time: 41.58711385726929
Epoch: 2, Steps: 570 | Train Loss: 0.5259546 Vali Loss: 0.4967518 Test Loss: 0.2190018
Validation loss decreased (0.531133 --> 0.496752).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4401794
	speed: 1.3016s/iter; left time: 5806.6200s
	iters: 200, epoch: 3 | loss: 0.4913963
	speed: 0.0579s/iter; left time: 252.7035s
	iters: 300, epoch: 3 | loss: 0.4029641
	speed: 0.0593s/iter; left time: 252.4809s
	iters: 400, epoch: 3 | loss: 0.6483511
	speed: 0.0616s/iter; left time: 256.5088s
	iters: 500, epoch: 3 | loss: 0.9420616
	speed: 0.0685s/iter; left time: 277.9940s
Max Memory (MB): 176.1689453125
Epoch: 3 cost time: 36.502777338027954
Epoch: 3, Steps: 570 | Train Loss: 0.5103891 Vali Loss: 0.4897733 Test Loss: 0.2156964
Validation loss decreased (0.496752 --> 0.489773).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6161910
	speed: 1.3069s/iter; left time: 5085.1840s
	iters: 200, epoch: 4 | loss: 0.4274216
	speed: 0.0509s/iter; left time: 192.9420s
	iters: 300, epoch: 4 | loss: 0.4012954
	speed: 0.0556s/iter; left time: 205.2156s
	iters: 400, epoch: 4 | loss: 0.5629952
	speed: 0.0550s/iter; left time: 197.6799s
	iters: 500, epoch: 4 | loss: 0.8931094
	speed: 0.0546s/iter; left time: 190.7096s
Max Memory (MB): 176.1689453125
Epoch: 4 cost time: 31.363632917404175
Epoch: 4, Steps: 570 | Train Loss: 0.5042612 Vali Loss: 0.4840676 Test Loss: 0.2145213
Validation loss decreased (0.489773 --> 0.484068).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3566316
	speed: 1.1672s/iter; left time: 3876.1194s
	iters: 200, epoch: 5 | loss: 0.3536156
	speed: 0.0642s/iter; left time: 206.9101s
	iters: 300, epoch: 5 | loss: 0.5572278
	speed: 0.0619s/iter; left time: 193.2205s
	iters: 400, epoch: 5 | loss: 0.3461668
	speed: 0.0568s/iter; left time: 171.4861s
	iters: 500, epoch: 5 | loss: 0.5447159
	speed: 0.0587s/iter; left time: 171.3675s
Max Memory (MB): 176.1689453125
Epoch: 5 cost time: 35.890769243240356
Epoch: 5, Steps: 570 | Train Loss: 0.5018945 Vali Loss: 0.4822393 Test Loss: 0.2141517
Validation loss decreased (0.484068 --> 0.482239).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.6507320
	speed: 1.2007s/iter; left time: 3303.1072s
	iters: 200, epoch: 6 | loss: 0.6893071
	speed: 0.0587s/iter; left time: 155.4978s
	iters: 300, epoch: 6 | loss: 0.6926484
	speed: 0.0651s/iter; left time: 166.0704s
	iters: 400, epoch: 6 | loss: 0.6340239
	speed: 0.0638s/iter; left time: 156.4447s
	iters: 500, epoch: 6 | loss: 0.7689808
	speed: 0.0659s/iter; left time: 154.8226s
Max Memory (MB): 176.1689453125
Epoch: 6 cost time: 36.38910794258118
Epoch: 6, Steps: 570 | Train Loss: 0.5000474 Vali Loss: 0.4825224 Test Loss: 0.2136903
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3902830
	speed: 1.2244s/iter; left time: 2670.5251s
	iters: 200, epoch: 7 | loss: 0.3863806
	speed: 0.0552s/iter; left time: 114.8498s
	iters: 300, epoch: 7 | loss: 0.6342511
	speed: 0.0533s/iter; left time: 105.5066s
	iters: 400, epoch: 7 | loss: 0.4139017
	speed: 0.0644s/iter; left time: 121.1031s
	iters: 500, epoch: 7 | loss: 0.4435123
	speed: 0.0617s/iter; left time: 109.9416s
Max Memory (MB): 176.1689453125
Epoch: 7 cost time: 34.76049518585205
Epoch: 7, Steps: 570 | Train Loss: 0.4999136 Vali Loss: 0.4828396 Test Loss: 0.2136403
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4140106
	speed: 1.5168s/iter; left time: 2443.5065s
	iters: 200, epoch: 8 | loss: 0.6440145
	speed: 0.0808s/iter; left time: 122.0922s
	iters: 300, epoch: 8 | loss: 0.6888453
	speed: 0.0811s/iter; left time: 114.4017s
	iters: 400, epoch: 8 | loss: 0.6845858
	speed: 0.0816s/iter; left time: 106.9871s
	iters: 500, epoch: 8 | loss: 0.7134548
	speed: 0.0789s/iter; left time: 95.5582s
Max Memory (MB): 176.1689453125
Epoch: 8 cost time: 47.01387095451355
Epoch: 8, Steps: 570 | Train Loss: 0.4995980 Vali Loss: 0.4822477 Test Loss: 0.2135412
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_192_192_iTransformer_custom_M_ft192_sl48_ll192_pl128_dm8_nh3_el1_dl128_df1_fctimeF_ebTrue_dtExp_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
test shape: (10348, 1, 192, 21) (10348, 1, 192, 21)
test shape: (10348, 192, 21) (10348, 192, 21)
mse:0.2141517847776413, mae:0.2542605400085449
