Args in experiment:
Namespace(is_training=1, train_only=False, model_id='DLinear_electricity_96_720', model='DLinear', data='custom', root_path='./dataset/', data_path='electricity.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=720, individual=False, embed_type=0, enc_in=321, dec_in=321, c_out=321, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DLinear_electricity_96_720_DLinear_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17597
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.6952111
	speed: 0.0782s/iter; left time: 1283.2574s
	iters: 200, epoch: 1 | loss: 0.4878173
	speed: 0.0584s/iter; left time: 951.3536s
	iters: 300, epoch: 1 | loss: 0.3908758
	speed: 0.0560s/iter; left time: 907.1247s
	iters: 400, epoch: 1 | loss: 0.3990789
	speed: 0.0601s/iter; left time: 967.0902s
	iters: 500, epoch: 1 | loss: 0.3532150
	speed: 0.0554s/iter; left time: 887.2290s
Epoch: 1 cost time: 33.48067045211792
Epoch: 1, Steps: 550 | Train Loss: 0.5222882 Vali Loss: 0.2954746 Test Loss: 0.3296581
Validation loss decreased (inf --> 0.295475).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3353266
	speed: 0.3052s/iter; left time: 4838.3376s
	iters: 200, epoch: 2 | loss: 0.3362949
	speed: 0.0525s/iter; left time: 827.4642s
	iters: 300, epoch: 2 | loss: 0.3125600
	speed: 0.0485s/iter; left time: 758.6737s
	iters: 400, epoch: 2 | loss: 0.3031800
	speed: 0.0502s/iter; left time: 780.8933s
	iters: 500, epoch: 2 | loss: 0.3104997
	speed: 0.0487s/iter; left time: 752.7622s
Epoch: 2 cost time: 29.004727363586426
Epoch: 2, Steps: 550 | Train Loss: 0.3140261 Vali Loss: 0.2583337 Test Loss: 0.2914730
Validation loss decreased (0.295475 --> 0.258334).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2876228
	speed: 0.3320s/iter; left time: 5079.4926s
	iters: 200, epoch: 3 | loss: 0.2856260
	speed: 0.0513s/iter; left time: 780.3254s
	iters: 300, epoch: 3 | loss: 0.3038048
	speed: 0.0568s/iter; left time: 857.2876s
	iters: 400, epoch: 3 | loss: 0.3052959
	speed: 0.0582s/iter; left time: 873.7153s
	iters: 500, epoch: 3 | loss: 0.2927951
	speed: 0.0573s/iter; left time: 854.5088s
Epoch: 3 cost time: 32.2103316783905
Epoch: 3, Steps: 550 | Train Loss: 0.2933749 Vali Loss: 0.2486307 Test Loss: 0.2815969
Validation loss decreased (0.258334 --> 0.248631).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2956934
	speed: 0.4765s/iter; left time: 7029.2299s
	iters: 200, epoch: 4 | loss: 0.3008781
	speed: 0.0628s/iter; left time: 919.4417s
	iters: 300, epoch: 4 | loss: 0.2756305
	speed: 0.0600s/iter; left time: 873.7352s
	iters: 400, epoch: 4 | loss: 0.2725417
	speed: 0.0614s/iter; left time: 887.8764s
	iters: 500, epoch: 4 | loss: 0.2614927
	speed: 0.0609s/iter; left time: 874.5028s
Epoch: 4 cost time: 38.20471477508545
Epoch: 4, Steps: 550 | Train Loss: 0.2863502 Vali Loss: 0.2443906 Test Loss: 0.2771845
Validation loss decreased (0.248631 --> 0.244391).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2894322
	speed: 0.3579s/iter; left time: 5082.2185s
	iters: 200, epoch: 5 | loss: 0.2779100
	speed: 0.0585s/iter; left time: 824.7942s
	iters: 300, epoch: 5 | loss: 0.2710268
	speed: 0.0580s/iter; left time: 811.6048s
	iters: 400, epoch: 5 | loss: 0.2717454
	speed: 0.0546s/iter; left time: 758.6535s
	iters: 500, epoch: 5 | loss: 0.2694959
	speed: 0.0503s/iter; left time: 693.9687s
Epoch: 5 cost time: 32.124452352523804
Epoch: 5, Steps: 550 | Train Loss: 0.2830584 Vali Loss: 0.2422009 Test Loss: 0.2748213
Validation loss decreased (0.244391 --> 0.242201).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2879906
	speed: 0.3542s/iter; left time: 4834.5444s
	iters: 200, epoch: 6 | loss: 0.2729670
	speed: 0.0579s/iter; left time: 784.1967s
	iters: 300, epoch: 6 | loss: 0.2815469
	speed: 0.0588s/iter; left time: 790.8166s
	iters: 400, epoch: 6 | loss: 0.2859716
	speed: 0.0617s/iter; left time: 823.2123s
	iters: 500, epoch: 6 | loss: 0.2704385
	speed: 0.0655s/iter; left time: 867.4949s
Epoch: 6 cost time: 34.661261558532715
Epoch: 6, Steps: 550 | Train Loss: 0.2813649 Vali Loss: 0.2410872 Test Loss: 0.2736471
Validation loss decreased (0.242201 --> 0.241087).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2696922
	speed: 0.3419s/iter; left time: 4479.8159s
	iters: 200, epoch: 7 | loss: 0.2877966
	speed: 0.0463s/iter; left time: 602.1435s
	iters: 300, epoch: 7 | loss: 0.2653639
	speed: 0.0477s/iter; left time: 615.1851s
	iters: 400, epoch: 7 | loss: 0.2720735
	speed: 0.0472s/iter; left time: 604.7674s
	iters: 500, epoch: 7 | loss: 0.2664624
	speed: 0.0476s/iter; left time: 604.6940s
Epoch: 7 cost time: 28.572741508483887
Epoch: 7, Steps: 550 | Train Loss: 0.2804612 Vali Loss: 0.2404787 Test Loss: 0.2730494
Validation loss decreased (0.241087 --> 0.240479).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2876070
	speed: 0.3960s/iter; left time: 4970.4902s
	iters: 200, epoch: 8 | loss: 0.2600231
	speed: 0.0558s/iter; left time: 694.9484s
	iters: 300, epoch: 8 | loss: 0.2871297
	speed: 0.0614s/iter; left time: 758.2471s
	iters: 400, epoch: 8 | loss: 0.3143154
	speed: 0.0622s/iter; left time: 761.8507s
	iters: 500, epoch: 8 | loss: 0.2950431
	speed: 0.0621s/iter; left time: 755.1832s
Epoch: 8 cost time: 35.8573796749115
Epoch: 8, Steps: 550 | Train Loss: 0.2799695 Vali Loss: 0.2401945 Test Loss: 0.2727096
Validation loss decreased (0.240479 --> 0.240195).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2759303
	speed: 0.4606s/iter; left time: 5528.1794s
	iters: 200, epoch: 9 | loss: 0.2717290
	speed: 0.0495s/iter; left time: 589.3253s
	iters: 300, epoch: 9 | loss: 0.2792249
	speed: 0.0497s/iter; left time: 585.9775s
	iters: 400, epoch: 9 | loss: 0.3024586
	speed: 0.0498s/iter; left time: 582.6067s
	iters: 500, epoch: 9 | loss: 0.2833955
	speed: 0.0488s/iter; left time: 565.6032s
Epoch: 9 cost time: 30.418303966522217
Epoch: 9, Steps: 550 | Train Loss: 0.2797108 Vali Loss: 0.2399938 Test Loss: 0.2725225
Validation loss decreased (0.240195 --> 0.239994).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3201043
	speed: 0.3159s/iter; left time: 3617.8858s
	iters: 200, epoch: 10 | loss: 0.2564958
	speed: 0.0515s/iter; left time: 584.3767s
	iters: 300, epoch: 10 | loss: 0.2799455
	speed: 0.0492s/iter; left time: 553.5455s
	iters: 400, epoch: 10 | loss: 0.2801306
	speed: 0.0508s/iter; left time: 566.1945s
	iters: 500, epoch: 10 | loss: 0.2735846
	speed: 0.0524s/iter; left time: 578.7775s
Epoch: 10 cost time: 30.06582808494568
Epoch: 10, Steps: 550 | Train Loss: 0.2795767 Vali Loss: 0.2399363 Test Loss: 0.2724271
Validation loss decreased (0.239994 --> 0.239936).  Saving model ...
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.2672708
	speed: 0.4578s/iter; left time: 4990.6532s
	iters: 200, epoch: 11 | loss: 0.2996277
	speed: 0.0672s/iter; left time: 726.2945s
	iters: 300, epoch: 11 | loss: 0.2648049
	speed: 0.0610s/iter; left time: 652.5671s
	iters: 400, epoch: 11 | loss: 0.3011726
	speed: 0.0588s/iter; left time: 623.0004s
	iters: 500, epoch: 11 | loss: 0.2782854
	speed: 0.0584s/iter; left time: 613.4708s
Epoch: 11 cost time: 36.931283950805664
Epoch: 11, Steps: 550 | Train Loss: 0.2795187 Vali Loss: 0.2398794 Test Loss: 0.2723773
Validation loss decreased (0.239936 --> 0.239879).  Saving model ...
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.2942926
	speed: 0.4133s/iter; left time: 4277.7795s
	iters: 200, epoch: 12 | loss: 0.2950898
	speed: 0.0641s/iter; left time: 657.3686s
	iters: 300, epoch: 12 | loss: 0.2898966
	speed: 0.0636s/iter; left time: 645.2296s
	iters: 400, epoch: 12 | loss: 0.2873216
	speed: 0.0654s/iter; left time: 657.3315s
	iters: 500, epoch: 12 | loss: 0.2816716
	speed: 0.0640s/iter; left time: 636.7316s
Epoch: 12 cost time: 37.81766891479492
Epoch: 12, Steps: 550 | Train Loss: 0.2794724 Vali Loss: 0.2398804 Test Loss: 0.2723520
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.2583818
	speed: 0.4585s/iter; left time: 4493.9036s
	iters: 200, epoch: 13 | loss: 0.2494525
	speed: 0.0706s/iter; left time: 684.8430s
	iters: 300, epoch: 13 | loss: 0.2709028
	speed: 0.0723s/iter; left time: 694.0485s
	iters: 400, epoch: 13 | loss: 0.2738534
	speed: 0.0596s/iter; left time: 566.6462s
	iters: 500, epoch: 13 | loss: 0.2981775
	speed: 0.0562s/iter; left time: 528.4564s
Epoch: 13 cost time: 38.478331089019775
Epoch: 13, Steps: 550 | Train Loss: 0.2794519 Vali Loss: 0.2398517 Test Loss: 0.2723395
Validation loss decreased (0.239879 --> 0.239852).  Saving model ...
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.2830984
	speed: 0.4063s/iter; left time: 3758.5447s
	iters: 200, epoch: 14 | loss: 0.2902798
	speed: 0.0518s/iter; left time: 473.5680s
	iters: 300, epoch: 14 | loss: 0.2977205
	speed: 0.0506s/iter; left time: 457.8720s
	iters: 400, epoch: 14 | loss: 0.3020051
	speed: 0.0535s/iter; left time: 478.8937s
	iters: 500, epoch: 14 | loss: 0.2897643
	speed: 0.0524s/iter; left time: 463.9776s
Epoch: 14 cost time: 31.088237524032593
Epoch: 14, Steps: 550 | Train Loss: 0.2794392 Vali Loss: 0.2398506 Test Loss: 0.2723331
Validation loss decreased (0.239852 --> 0.239851).  Saving model ...
Updating learning rate to 1.220703125e-08
	iters: 100, epoch: 15 | loss: 0.2838386
	speed: 0.3866s/iter; left time: 3363.6542s
	iters: 200, epoch: 15 | loss: 0.2863104
	speed: 0.0659s/iter; left time: 566.7745s
	iters: 300, epoch: 15 | loss: 0.2755879
	speed: 0.0657s/iter; left time: 558.3488s
	iters: 400, epoch: 15 | loss: 0.2870101
	speed: 0.0644s/iter; left time: 541.1903s
	iters: 500, epoch: 15 | loss: 0.2779829
	speed: 0.0617s/iter; left time: 512.0227s
Epoch: 15 cost time: 37.712073802948
Epoch: 15, Steps: 550 | Train Loss: 0.2794332 Vali Loss: 0.2398095 Test Loss: 0.2723300
Validation loss decreased (0.239851 --> 0.239810).  Saving model ...
Updating learning rate to 6.103515625e-09
	iters: 100, epoch: 16 | loss: 0.2747978
	speed: 0.3865s/iter; left time: 3150.6022s
	iters: 200, epoch: 16 | loss: 0.2771508
	speed: 0.0572s/iter; left time: 460.5745s
	iters: 300, epoch: 16 | loss: 0.2643187
	speed: 0.0529s/iter; left time: 420.9087s
	iters: 400, epoch: 16 | loss: 0.3040052
	speed: 0.0551s/iter; left time: 432.2678s
	iters: 500, epoch: 16 | loss: 0.2737691
	speed: 0.0584s/iter; left time: 452.3444s
Epoch: 16 cost time: 32.7648138999939
Epoch: 16, Steps: 550 | Train Loss: 0.2794327 Vali Loss: 0.2398334 Test Loss: 0.2723286
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.0517578125e-09
	iters: 100, epoch: 17 | loss: 0.2762984
	speed: 0.4004s/iter; left time: 3043.0611s
	iters: 200, epoch: 17 | loss: 0.2651324
	speed: 0.0623s/iter; left time: 467.0999s
	iters: 300, epoch: 17 | loss: 0.2574400
	speed: 0.0668s/iter; left time: 494.5157s
	iters: 400, epoch: 17 | loss: 0.2670021
	speed: 0.0629s/iter; left time: 459.1318s
	iters: 500, epoch: 17 | loss: 0.2751783
	speed: 0.0629s/iter; left time: 452.8919s
Epoch: 17 cost time: 37.437442779541016
Epoch: 17, Steps: 550 | Train Loss: 0.2794352 Vali Loss: 0.2398306 Test Loss: 0.2723281
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.52587890625e-09
	iters: 100, epoch: 18 | loss: 0.2914126
	speed: 0.3723s/iter; left time: 2624.8699s
	iters: 200, epoch: 18 | loss: 0.2940395
	speed: 0.0547s/iter; left time: 379.9773s
	iters: 300, epoch: 18 | loss: 0.2919173
	speed: 0.0553s/iter; left time: 379.1279s
	iters: 400, epoch: 18 | loss: 0.2745487
	speed: 0.0515s/iter; left time: 348.0128s
	iters: 500, epoch: 18 | loss: 0.2753532
	speed: 0.0516s/iter; left time: 342.9818s
Epoch: 18 cost time: 30.606292247772217
Epoch: 18, Steps: 550 | Train Loss: 0.2794338 Vali Loss: 0.2398226 Test Loss: 0.2723279
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : DLinear_electricity_96_720_DLinear_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
mse:0.27224665880203247, mae:0.362824022769928
