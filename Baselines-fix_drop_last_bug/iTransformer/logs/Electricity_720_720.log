Args in experiment:
Namespace(is_training=1, model_id='ECL_720_720', model='iTransformer', data='custom', root_path='./dataset/', data_path='electricity.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=720, enc_in=321, dec_in=321, c_out=321, d_model=512, n_heads=8, e_layers=3, d_layers=1, d_ff=512, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=10, batch_size=16, patience=3, learning_rate=0.0001, des='Exp', loss='MSE', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', exp_name='MTSF', channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv', efficient_training=False, use_norm=True, partial_start_index=0)
Use GPU: cuda:0
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.dropout.Dropout'>.
[INFO] Register count_convNd() for <class 'torch.nn.modules.conv.Conv1d'>.
[INFO] Register count_normalization() for <class 'torch.nn.modules.normalization.LayerNorm'>.
MACs: 1788758016.0
Params: 5473488.0
1.79G MACs
>>>>>>>start training : ECL_720_720_iTransformer_custom_M_ft720_sl48_ll720_pl512_dm8_nh3_el1_dl512_df1_fctimeF_ebTrue_dtExp_projection_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 16973
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.3015155
	speed: 0.1184s/iter; left time: 1242.8727s
	iters: 200, epoch: 1 | loss: 0.2638474
	speed: 0.0897s/iter; left time: 933.2690s
	iters: 300, epoch: 1 | loss: 0.2740557
	speed: 0.0922s/iter; left time: 950.1824s
	iters: 400, epoch: 1 | loss: 0.2260605
	speed: 0.0832s/iter; left time: 849.1814s
	iters: 500, epoch: 1 | loss: 0.2634678
	speed: 0.0842s/iter; left time: 850.4015s
	iters: 600, epoch: 1 | loss: 0.2147430
	speed: 0.0886s/iter; left time: 886.1101s
	iters: 700, epoch: 1 | loss: 0.2312484
	speed: 0.0876s/iter; left time: 866.8352s
	iters: 800, epoch: 1 | loss: 0.2546219
	speed: 0.0875s/iter; left time: 858.0454s
	iters: 900, epoch: 1 | loss: 0.2333553
	speed: 0.0862s/iter; left time: 836.2774s
	iters: 1000, epoch: 1 | loss: 0.2465990
	speed: 0.0832s/iter; left time: 798.6297s
Max Memory (MB): 1012.7724609375
Epoch: 1 cost time: 94.92638111114502
Epoch: 1, Steps: 1060 | Train Loss: 0.2763465 Vali Loss: 0.1881477 Test Loss: 0.2166380
Validation loss decreased (inf --> 0.188148).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2154638
	speed: 1.3795s/iter; left time: 13023.7519s
	iters: 200, epoch: 2 | loss: 0.2669986
	speed: 0.0852s/iter; left time: 796.1249s
	iters: 300, epoch: 2 | loss: 0.2089619
	speed: 0.0916s/iter; left time: 846.8694s
	iters: 400, epoch: 2 | loss: 0.2164810
	speed: 0.0861s/iter; left time: 787.1303s
	iters: 500, epoch: 2 | loss: 0.2436909
	speed: 0.0867s/iter; left time: 784.1111s
	iters: 600, epoch: 2 | loss: 0.2190951
	speed: 0.0822s/iter; left time: 734.6976s
	iters: 700, epoch: 2 | loss: 0.2074498
	speed: 0.0872s/iter; left time: 770.6093s
	iters: 800, epoch: 2 | loss: 0.2024318
	speed: 0.0864s/iter; left time: 755.4361s
	iters: 900, epoch: 2 | loss: 0.2065305
	speed: 0.0944s/iter; left time: 815.4970s
	iters: 1000, epoch: 2 | loss: 0.2351431
	speed: 0.0932s/iter; left time: 796.2982s
Max Memory (MB): 1012.7724609375
Epoch: 2 cost time: 96.35451173782349
Epoch: 2, Steps: 1060 | Train Loss: 0.2202497 Vali Loss: 0.1803817 Test Loss: 0.2024912
Validation loss decreased (0.188148 --> 0.180382).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2204411
	speed: 1.2970s/iter; left time: 10869.7760s
	iters: 200, epoch: 3 | loss: 0.2051973
	speed: 0.0730s/iter; left time: 604.5399s
	iters: 300, epoch: 3 | loss: 0.2170517
	speed: 0.0738s/iter; left time: 603.6070s
	iters: 400, epoch: 3 | loss: 0.1899602
	speed: 0.0725s/iter; left time: 585.5908s
	iters: 500, epoch: 3 | loss: 0.1996676
	speed: 0.0831s/iter; left time: 662.8863s
	iters: 600, epoch: 3 | loss: 0.1823196
	speed: 0.0757s/iter; left time: 596.5074s
	iters: 700, epoch: 3 | loss: 0.1987014
	speed: 0.0720s/iter; left time: 560.3945s
	iters: 800, epoch: 3 | loss: 0.1891271
	speed: 0.0761s/iter; left time: 584.8599s
	iters: 900, epoch: 3 | loss: 0.1866128
	speed: 0.0817s/iter; left time: 619.6849s
	iters: 1000, epoch: 3 | loss: 0.1998860
	speed: 0.0839s/iter; left time: 627.4437s
Max Memory (MB): 1012.7724609375
Epoch: 3 cost time: 84.97293591499329
Epoch: 3, Steps: 1060 | Train Loss: 0.2019567 Vali Loss: 0.1782886 Test Loss: 0.2047274
Validation loss decreased (0.180382 --> 0.178289).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1971307
	speed: 1.4773s/iter; left time: 10815.1099s
	iters: 200, epoch: 4 | loss: 0.2240313
	speed: 0.0921s/iter; left time: 664.8076s
	iters: 300, epoch: 4 | loss: 0.1967418
	speed: 0.0855s/iter; left time: 609.1605s
	iters: 400, epoch: 4 | loss: 0.2206742
	speed: 0.0894s/iter; left time: 627.3637s
	iters: 500, epoch: 4 | loss: 0.2139430
	speed: 0.0938s/iter; left time: 649.4589s
	iters: 600, epoch: 4 | loss: 0.1917442
	speed: 0.0844s/iter; left time: 575.7741s
	iters: 700, epoch: 4 | loss: 0.1794879
	speed: 0.0912s/iter; left time: 612.7840s
	iters: 800, epoch: 4 | loss: 0.1716731
	speed: 0.0843s/iter; left time: 557.9315s
	iters: 900, epoch: 4 | loss: 0.1985748
	speed: 0.0825s/iter; left time: 538.2416s
	iters: 1000, epoch: 4 | loss: 0.1922344
	speed: 0.0808s/iter; left time: 519.0368s
Max Memory (MB): 1012.7724609375
Epoch: 4 cost time: 96.22907781600952
Epoch: 4, Steps: 1060 | Train Loss: 0.1958484 Vali Loss: 0.1727684 Test Loss: 0.2030966
Validation loss decreased (0.178289 --> 0.172768).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1730455
	speed: 1.3004s/iter; left time: 8141.5616s
	iters: 200, epoch: 5 | loss: 0.1896801
	speed: 0.0835s/iter; left time: 514.4913s
	iters: 300, epoch: 5 | loss: 0.1954700
	speed: 0.0843s/iter; left time: 511.1999s
	iters: 400, epoch: 5 | loss: 0.1868908
	speed: 0.0895s/iter; left time: 533.2505s
	iters: 500, epoch: 5 | loss: 0.1938551
	speed: 0.0824s/iter; left time: 482.8940s
	iters: 600, epoch: 5 | loss: 0.2020788
	speed: 0.0904s/iter; left time: 520.8275s
	iters: 700, epoch: 5 | loss: 0.1829574
	speed: 0.0877s/iter; left time: 496.7232s
	iters: 800, epoch: 5 | loss: 0.1747863
	speed: 0.0880s/iter; left time: 489.5395s
	iters: 900, epoch: 5 | loss: 0.1986732
	speed: 0.0845s/iter; left time: 461.4992s
	iters: 1000, epoch: 5 | loss: 0.1812787
	speed: 0.0831s/iter; left time: 445.4261s
Max Memory (MB): 1012.7724609375
Epoch: 5 cost time: 94.22034049034119
Epoch: 5, Steps: 1060 | Train Loss: 0.1929523 Vali Loss: 0.1727396 Test Loss: 0.2035699
Validation loss decreased (0.172768 --> 0.172740).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1939081
	speed: 1.6425s/iter; left time: 8542.8932s
	iters: 200, epoch: 6 | loss: 0.2056674
	speed: 0.0947s/iter; left time: 483.2474s
	iters: 300, epoch: 6 | loss: 0.1766105
	speed: 0.0886s/iter; left time: 442.8706s
	iters: 400, epoch: 6 | loss: 0.1924173
	speed: 0.0879s/iter; left time: 430.5819s
	iters: 500, epoch: 6 | loss: 0.1880844
	speed: 0.0886s/iter; left time: 425.5313s
	iters: 600, epoch: 6 | loss: 0.1799402
	speed: 0.0880s/iter; left time: 413.7880s
	iters: 700, epoch: 6 | loss: 0.1885292
	speed: 0.0898s/iter; left time: 413.2049s
	iters: 800, epoch: 6 | loss: 0.1777656
	speed: 0.0834s/iter; left time: 375.2926s
	iters: 900, epoch: 6 | loss: 0.1894984
	speed: 0.0886s/iter; left time: 390.0351s
	iters: 1000, epoch: 6 | loss: 0.1789146
	speed: 0.0847s/iter; left time: 364.1756s
Max Memory (MB): 1012.7724609375
Epoch: 6 cost time: 96.68909192085266
Epoch: 6, Steps: 1060 | Train Loss: 0.1914297 Vali Loss: 0.1716784 Test Loss: 0.2034639
Validation loss decreased (0.172740 --> 0.171678).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1834766
	speed: 1.4313s/iter; left time: 5926.8801s
	iters: 200, epoch: 7 | loss: 0.1804851
	speed: 0.0843s/iter; left time: 340.6293s
	iters: 300, epoch: 7 | loss: 0.1898461
	speed: 0.0852s/iter; left time: 335.7108s
	iters: 400, epoch: 7 | loss: 0.1821047
	speed: 0.0881s/iter; left time: 338.4052s
	iters: 500, epoch: 7 | loss: 0.1803322
	speed: 0.0815s/iter; left time: 304.7343s
	iters: 600, epoch: 7 | loss: 0.1829435
	speed: 0.0910s/iter; left time: 331.2253s
	iters: 700, epoch: 7 | loss: 0.1823106
	speed: 0.0871s/iter; left time: 308.2871s
	iters: 800, epoch: 7 | loss: 0.2058552
	speed: 0.0881s/iter; left time: 303.1295s
	iters: 900, epoch: 7 | loss: 0.1813913
	speed: 0.0845s/iter; left time: 282.1840s
	iters: 1000, epoch: 7 | loss: 0.1855740
	speed: 0.0848s/iter; left time: 274.9277s
Max Memory (MB): 1012.7724609375
Epoch: 7 cost time: 93.95885753631592
Epoch: 7, Steps: 1060 | Train Loss: 0.1906731 Vali Loss: 0.1715851 Test Loss: 0.2035712
Validation loss decreased (0.171678 --> 0.171585).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1719030
	speed: 1.5183s/iter; left time: 4677.8147s
	iters: 200, epoch: 8 | loss: 0.1916910
	speed: 0.0693s/iter; left time: 206.5699s
	iters: 300, epoch: 8 | loss: 0.1835601
	speed: 0.0754s/iter; left time: 217.2527s
	iters: 400, epoch: 8 | loss: 0.1973163
	speed: 0.0877s/iter; left time: 243.7724s
	iters: 500, epoch: 8 | loss: 0.1886227
	speed: 0.0876s/iter; left time: 234.9223s
	iters: 600, epoch: 8 | loss: 0.2023868
	speed: 0.0848s/iter; left time: 218.8897s
	iters: 700, epoch: 8 | loss: 0.1821360
	speed: 0.0825s/iter; left time: 204.7276s
	iters: 800, epoch: 8 | loss: 0.1801430
	speed: 0.0848s/iter; left time: 201.8147s
	iters: 900, epoch: 8 | loss: 0.1870960
	speed: 0.0899s/iter; left time: 205.0525s
	iters: 1000, epoch: 8 | loss: 0.1788701
	speed: 0.0834s/iter; left time: 181.7868s
Max Memory (MB): 1012.7724609375
Epoch: 8 cost time: 92.3877203464508
Epoch: 8, Steps: 1060 | Train Loss: 0.1903060 Vali Loss: 0.1718064 Test Loss: 0.2042501
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1831359
	speed: 1.3910s/iter; left time: 2811.2670s
	iters: 200, epoch: 9 | loss: 0.2032620
	speed: 0.0883s/iter; left time: 169.6345s
	iters: 300, epoch: 9 | loss: 0.1787351
	speed: 0.0860s/iter; left time: 156.6081s
	iters: 400, epoch: 9 | loss: 0.1977553
	speed: 0.0853s/iter; left time: 146.8696s
	iters: 500, epoch: 9 | loss: 0.1898895
	speed: 0.0832s/iter; left time: 134.8550s
	iters: 600, epoch: 9 | loss: 0.1865155
	speed: 0.0844s/iter; left time: 128.4211s
	iters: 700, epoch: 9 | loss: 0.1853241
	speed: 0.0882s/iter; left time: 125.2986s
	iters: 800, epoch: 9 | loss: 0.2152214
	speed: 0.0879s/iter; left time: 116.1787s
	iters: 900, epoch: 9 | loss: 0.1687704
	speed: 0.0944s/iter; left time: 115.2623s
	iters: 1000, epoch: 9 | loss: 0.1832716
	speed: 0.0886s/iter; left time: 99.3257s
Max Memory (MB): 1012.7724609375
Epoch: 9 cost time: 96.40831279754639
Epoch: 9, Steps: 1060 | Train Loss: 0.1900978 Vali Loss: 0.1714685 Test Loss: 0.2038875
Validation loss decreased (0.171585 --> 0.171468).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1839007
	speed: 1.5727s/iter; left time: 1511.3170s
	iters: 200, epoch: 10 | loss: 0.1749707
	speed: 0.0899s/iter; left time: 77.3652s
	iters: 300, epoch: 10 | loss: 0.1845821
	speed: 0.0929s/iter; left time: 70.6818s
	iters: 400, epoch: 10 | loss: 0.1945386
	speed: 0.0870s/iter; left time: 57.5250s
	iters: 500, epoch: 10 | loss: 0.1865020
	speed: 0.0914s/iter; left time: 51.3001s
	iters: 600, epoch: 10 | loss: 0.2043715
	speed: 0.0842s/iter; left time: 38.8317s
	iters: 700, epoch: 10 | loss: 0.1880418
	speed: 0.0843s/iter; left time: 30.4472s
	iters: 800, epoch: 10 | loss: 0.1845818
	speed: 0.0854s/iter; left time: 22.2925s
	iters: 900, epoch: 10 | loss: 0.2226029
	speed: 0.0853s/iter; left time: 13.7352s
	iters: 1000, epoch: 10 | loss: 0.1888322
	speed: 0.0854s/iter; left time: 5.2112s
Max Memory (MB): 1012.7724609375
Epoch: 10 cost time: 95.70424485206604
Epoch: 10, Steps: 1060 | Train Loss: 0.1900054 Vali Loss: 0.1715292 Test Loss: 0.2038987
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : ECL_720_720_iTransformer_custom_M_ft720_sl48_ll720_pl512_dm8_nh3_el1_dl512_df1_fctimeF_ebTrue_dtExp_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
test shape: (4541, 1, 720, 321) (4541, 1, 720, 321)
test shape: (4541, 720, 321) (4541, 720, 321)
mse:0.20388714969158173, mae:0.3006281852722168
