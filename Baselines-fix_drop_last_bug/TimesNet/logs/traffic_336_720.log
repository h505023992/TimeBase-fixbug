True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           traffic_336_720     Model:              TimesNet            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/          
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            336                 Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         8                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_traffic_336_720_TimesNet_custom_ftM_sl336_ll48_pl720_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11225
val 1037
test 2789
	iters: 100, epoch: 1 | loss: 0.7046877
	speed: 0.3679s/iter; left time: 15457.6197s
	iters: 200, epoch: 1 | loss: 0.5463281
	speed: 0.2533s/iter; left time: 10619.5807s
	iters: 300, epoch: 1 | loss: 0.4583952
	speed: 0.2589s/iter; left time: 10827.7558s
	iters: 400, epoch: 1 | loss: 0.4789928
	speed: 0.2579s/iter; left time: 10758.0381s
	iters: 500, epoch: 1 | loss: 0.4152651
	speed: 0.2561s/iter; left time: 10657.6906s
	iters: 600, epoch: 1 | loss: 0.4281175
	speed: 0.2559s/iter; left time: 10626.4135s
	iters: 700, epoch: 1 | loss: 0.3852966
	speed: 0.2560s/iter; left time: 10603.5529s
	iters: 800, epoch: 1 | loss: 0.3594705
	speed: 0.2580s/iter; left time: 10659.3811s
	iters: 900, epoch: 1 | loss: 0.3173297
	speed: 0.2560s/iter; left time: 10553.4565s
	iters: 1000, epoch: 1 | loss: 0.3031288
	speed: 0.2582s/iter; left time: 10618.2416s
	iters: 1100, epoch: 1 | loss: 0.3011370
	speed: 0.2540s/iter; left time: 10419.6154s
	iters: 1200, epoch: 1 | loss: 0.2933458
	speed: 0.2557s/iter; left time: 10462.9734s
	iters: 1300, epoch: 1 | loss: 0.2865862
	speed: 0.2529s/iter; left time: 10323.2429s
	iters: 1400, epoch: 1 | loss: 0.2692233
	speed: 0.2536s/iter; left time: 10324.9921s
Epoch: 1 cost time: 370.647581577301
Epoch: 1, Steps: 1404 | Train Loss: 0.4381776 Vali Loss: 0.4754433 Test Loss: 0.6736543
Validation loss decreased (inf --> 0.475443).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2767638
	speed: 1.3578s/iter; left time: 55148.0925s
	iters: 200, epoch: 2 | loss: 0.2699102
	speed: 0.2604s/iter; left time: 10551.7987s
	iters: 300, epoch: 2 | loss: 0.2524309
	speed: 0.2596s/iter; left time: 10492.2630s
	iters: 400, epoch: 2 | loss: 0.2804753
	speed: 0.2685s/iter; left time: 10826.1749s
	iters: 500, epoch: 2 | loss: 0.2515446
	speed: 0.2694s/iter; left time: 10835.9069s
	iters: 600, epoch: 2 | loss: 0.2633727
	speed: 0.2635s/iter; left time: 10569.6085s
	iters: 700, epoch: 2 | loss: 0.2779702
	speed: 0.2592s/iter; left time: 10370.8452s
	iters: 800, epoch: 2 | loss: 0.2591594
	speed: 0.2584s/iter; left time: 10315.9415s
	iters: 900, epoch: 2 | loss: 0.2670025
	speed: 0.2558s/iter; left time: 10183.1988s
	iters: 1000, epoch: 2 | loss: 0.2673197
	speed: 0.2563s/iter; left time: 10178.5386s
	iters: 1100, epoch: 2 | loss: 0.2586384
	speed: 0.2540s/iter; left time: 10060.9908s
	iters: 1200, epoch: 2 | loss: 0.2532267
	speed: 0.2538s/iter; left time: 10028.1969s
	iters: 1300, epoch: 2 | loss: 0.2598899
	speed: 0.2559s/iter; left time: 10086.1485s
	iters: 1400, epoch: 2 | loss: 0.2572111
	speed: 0.2596s/iter; left time: 10205.8706s
Epoch: 2 cost time: 366.6631224155426
Epoch: 2, Steps: 1404 | Train Loss: 0.2650984 Vali Loss: 0.4697185 Test Loss: 0.6594216
Validation loss decreased (0.475443 --> 0.469719).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2767303
	speed: 1.4759s/iter; left time: 57872.8702s
	iters: 200, epoch: 3 | loss: 0.2516081
	speed: 0.2533s/iter; left time: 9907.8584s
	iters: 300, epoch: 3 | loss: 0.2478370
	speed: 0.2562s/iter; left time: 9996.9930s
	iters: 400, epoch: 3 | loss: 0.2415738
	speed: 0.2589s/iter; left time: 10075.3136s
	iters: 500, epoch: 3 | loss: 0.2529397
	speed: 0.2613s/iter; left time: 10141.5884s
	iters: 600, epoch: 3 | loss: 0.2439605
	speed: 0.2654s/iter; left time: 10272.7704s
	iters: 700, epoch: 3 | loss: 0.2331803
	speed: 0.2602s/iter; left time: 10046.9825s
	iters: 800, epoch: 3 | loss: 0.2339741
	speed: 0.2555s/iter; left time: 9839.1123s
	iters: 900, epoch: 3 | loss: 0.2379783
	speed: 0.2567s/iter; left time: 9861.9847s
	iters: 1000, epoch: 3 | loss: 0.2373715
	speed: 0.2600s/iter; left time: 9962.9962s
	iters: 1100, epoch: 3 | loss: 0.2366114
	speed: 0.2681s/iter; left time: 10246.1144s
	iters: 1200, epoch: 3 | loss: 0.2527263
	speed: 0.2732s/iter; left time: 10414.2406s
	iters: 1300, epoch: 3 | loss: 0.2411162
	speed: 0.2713s/iter; left time: 10314.2199s
	iters: 1400, epoch: 3 | loss: 0.2488930
	speed: 0.2611s/iter; left time: 9900.9307s
Epoch: 3 cost time: 369.83706760406494
Epoch: 3, Steps: 1404 | Train Loss: 0.2498023 Vali Loss: 0.4782665 Test Loss: 0.6752020
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2493468
	speed: 1.4776s/iter; left time: 55866.6447s
	iters: 200, epoch: 4 | loss: 0.2412247
	speed: 0.2646s/iter; left time: 9977.4760s
	iters: 300, epoch: 4 | loss: 0.2506363
	speed: 0.2638s/iter; left time: 9922.9261s
	iters: 400, epoch: 4 | loss: 0.2510512
	speed: 0.2650s/iter; left time: 9941.4310s
	iters: 500, epoch: 4 | loss: 0.2356487
	speed: 0.2633s/iter; left time: 9849.0476s
	iters: 600, epoch: 4 | loss: 0.2419813
	speed: 0.2610s/iter; left time: 9736.8519s
	iters: 700, epoch: 4 | loss: 0.2455665
	speed: 0.2609s/iter; left time: 9707.6605s
	iters: 800, epoch: 4 | loss: 0.2293884
	speed: 0.2698s/iter; left time: 10011.7152s
	iters: 900, epoch: 4 | loss: 0.2397703
	speed: 0.2759s/iter; left time: 10210.3782s
	iters: 1000, epoch: 4 | loss: 0.2527378
	speed: 0.2731s/iter; left time: 10079.8334s
	iters: 1100, epoch: 4 | loss: 0.2280229
	speed: 0.2644s/iter; left time: 9733.3563s
	iters: 1200, epoch: 4 | loss: 0.2275188
	speed: 0.2593s/iter; left time: 9519.1543s
	iters: 1300, epoch: 4 | loss: 0.2406816
	speed: 0.2545s/iter; left time: 9316.0348s
	iters: 1400, epoch: 4 | loss: 0.2430126
	speed: 0.2500s/iter; left time: 9128.0425s
Epoch: 4 cost time: 374.1252055168152
Epoch: 4, Steps: 1404 | Train Loss: 0.2432482 Vali Loss: 0.4752392 Test Loss: 0.6736899
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2534767
	speed: 1.3881s/iter; left time: 50533.9433s
	iters: 200, epoch: 5 | loss: 0.2369119
	speed: 0.2511s/iter; left time: 9117.6045s
	iters: 300, epoch: 5 | loss: 0.2551645
	speed: 0.2485s/iter; left time: 8997.8521s
	iters: 400, epoch: 5 | loss: 0.2451668
	speed: 0.2514s/iter; left time: 9077.3672s
	iters: 500, epoch: 5 | loss: 0.2271197
	speed: 0.2473s/iter; left time: 8905.3014s
	iters: 600, epoch: 5 | loss: 0.2454432
	speed: 0.2481s/iter; left time: 8908.1946s
	iters: 700, epoch: 5 | loss: 0.2340754
	speed: 0.2510s/iter; left time: 8988.1601s
	iters: 800, epoch: 5 | loss: 0.2321128
	speed: 0.2569s/iter; left time: 9173.8500s
	iters: 900, epoch: 5 | loss: 0.2361096
	speed: 0.2568s/iter; left time: 9144.3685s
	iters: 1000, epoch: 5 | loss: 0.2499852
	speed: 0.2589s/iter; left time: 9191.1129s
	iters: 1100, epoch: 5 | loss: 0.2261935
	speed: 0.2596s/iter; left time: 9191.2218s
	iters: 1200, epoch: 5 | loss: 0.2486316
	speed: 0.2565s/iter; left time: 9055.5484s
	iters: 1300, epoch: 5 | loss: 0.2326175
	speed: 0.2574s/iter; left time: 9060.2254s
	iters: 1400, epoch: 5 | loss: 0.2281723
	speed: 0.2569s/iter; left time: 9018.8881s
Epoch: 5 cost time: 359.14137744903564
Epoch: 5, Steps: 1404 | Train Loss: 0.2396662 Vali Loss: 0.4777167 Test Loss: 0.6758497
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_traffic_336_720_TimesNet_custom_ftM_sl336_ll48_pl720_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
test shape: (2789, 720, 862) (2789, 720, 862)
test shape: (2789, 720, 862) (2789, 720, 862)
mse:0.6594433188438416, mae:0.36340340971946716, dtw:not calculated
