True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_192_192     Model:              TimesNet            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/          
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            192                 Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_weather_192_192_TimesNet_custom_ftM_sl192_ll48_pl192_dm32_nh8_el2_dl1_df32_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36504
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.5894866
	speed: 0.2818s/iter; left time: 9618.1046s
	iters: 200, epoch: 1 | loss: 0.4657570
	speed: 0.2282s/iter; left time: 7764.4461s
	iters: 300, epoch: 1 | loss: 0.5040896
	speed: 0.2218s/iter; left time: 7524.8859s
	iters: 400, epoch: 1 | loss: 0.3632646
	speed: 0.2356s/iter; left time: 7970.3827s
	iters: 500, epoch: 1 | loss: 0.5091756
	speed: 0.2456s/iter; left time: 8285.6411s
	iters: 600, epoch: 1 | loss: 0.4247203
	speed: 0.2526s/iter; left time: 8495.4204s
	iters: 700, epoch: 1 | loss: 0.4599521
	speed: 0.2548s/iter; left time: 8544.6110s
	iters: 800, epoch: 1 | loss: 0.4210971
	speed: 0.2508s/iter; left time: 8383.5309s
	iters: 900, epoch: 1 | loss: 0.4518779
	speed: 0.2507s/iter; left time: 8355.4103s
	iters: 1000, epoch: 1 | loss: 0.3893489
	speed: 0.2406s/iter; left time: 7995.1290s
	iters: 1100, epoch: 1 | loss: 0.4991460
	speed: 0.2461s/iter; left time: 8151.9503s
Epoch: 1 cost time: 280.90776777267456
Epoch: 1, Steps: 1141 | Train Loss: 0.5015065 Vali Loss: 0.4630091 Test Loss: 0.2202547
Validation loss decreased (inf --> 0.463009).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8586220
	speed: 1.3663s/iter; left time: 45073.0066s
	iters: 200, epoch: 2 | loss: 0.3677171
	speed: 0.2494s/iter; left time: 8203.8051s
	iters: 300, epoch: 2 | loss: 0.4051346
	speed: 0.2304s/iter; left time: 7556.4153s
	iters: 400, epoch: 2 | loss: 0.9490121
	speed: 0.2477s/iter; left time: 8098.2214s
	iters: 500, epoch: 2 | loss: 0.2946139
	speed: 0.2392s/iter; left time: 7796.9181s
	iters: 600, epoch: 2 | loss: 0.4254613
	speed: 0.2457s/iter; left time: 7981.5788s
	iters: 700, epoch: 2 | loss: 0.3537328
	speed: 0.2403s/iter; left time: 7783.1790s
	iters: 800, epoch: 2 | loss: 0.5860361
	speed: 0.2258s/iter; left time: 7292.2284s
	iters: 900, epoch: 2 | loss: 0.3770315
	speed: 0.2272s/iter; left time: 7313.5283s
	iters: 1000, epoch: 2 | loss: 0.3748271
	speed: 0.2424s/iter; left time: 7779.1192s
	iters: 1100, epoch: 2 | loss: 0.3087047
	speed: 0.2424s/iter; left time: 7755.5586s
Epoch: 2 cost time: 275.3666527271271
Epoch: 2, Steps: 1141 | Train Loss: 0.4318431 Vali Loss: 0.4776593 Test Loss: 0.2270797
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4506542
	speed: 1.2193s/iter; left time: 38833.4259s
	iters: 200, epoch: 3 | loss: 0.3655412
	speed: 0.2390s/iter; left time: 7586.6731s
	iters: 300, epoch: 3 | loss: 0.4387895
	speed: 0.2351s/iter; left time: 7441.9735s
	iters: 400, epoch: 3 | loss: 0.2558763
	speed: 0.2331s/iter; left time: 7355.3443s
	iters: 500, epoch: 3 | loss: 0.3848118
	speed: 0.2322s/iter; left time: 7303.8836s
	iters: 600, epoch: 3 | loss: 0.4497844
	speed: 0.2270s/iter; left time: 7116.6221s
	iters: 700, epoch: 3 | loss: 0.2650047
	speed: 0.2452s/iter; left time: 7662.4913s
	iters: 800, epoch: 3 | loss: 0.2707467
	speed: 0.2356s/iter; left time: 7337.4464s
	iters: 900, epoch: 3 | loss: 0.3354555
	speed: 0.2387s/iter; left time: 7410.0479s
	iters: 1000, epoch: 3 | loss: 0.7357422
	speed: 0.2395s/iter; left time: 7411.0332s
	iters: 1100, epoch: 3 | loss: 0.3152939
	speed: 0.2432s/iter; left time: 7503.3774s
Epoch: 3 cost time: 271.69685769081116
Epoch: 3, Steps: 1141 | Train Loss: 0.4028914 Vali Loss: 0.4819422 Test Loss: 0.2340295
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3425294
	speed: 1.2399s/iter; left time: 38074.0291s
	iters: 200, epoch: 4 | loss: 0.2827954
	speed: 0.2385s/iter; left time: 7300.9804s
	iters: 300, epoch: 4 | loss: 0.7410035
	speed: 0.2332s/iter; left time: 7114.7445s
	iters: 400, epoch: 4 | loss: 0.2798520
	speed: 0.2216s/iter; left time: 6737.4293s
	iters: 500, epoch: 4 | loss: 0.3138272
	speed: 0.2344s/iter; left time: 7104.5080s
	iters: 600, epoch: 4 | loss: 0.3548980
	speed: 0.2333s/iter; left time: 7046.7593s
	iters: 700, epoch: 4 | loss: 0.3066789
	speed: 0.2385s/iter; left time: 7180.6344s
	iters: 800, epoch: 4 | loss: 0.2376759
	speed: 0.2299s/iter; left time: 6897.3688s
	iters: 900, epoch: 4 | loss: 0.3213701
	speed: 0.2381s/iter; left time: 7122.3185s
	iters: 1000, epoch: 4 | loss: 0.3446088
	speed: 0.2418s/iter; left time: 7207.5724s
	iters: 1100, epoch: 4 | loss: 0.3309606
	speed: 0.2446s/iter; left time: 7267.4928s
Epoch: 4 cost time: 270.43379855155945
Epoch: 4, Steps: 1141 | Train Loss: 0.3892319 Vali Loss: 0.4888589 Test Loss: 0.2385236
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_weather_192_192_TimesNet_custom_ftM_sl192_ll48_pl192_dm32_nh8_el2_dl1_df32_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
test shape: (10348, 192, 21) (10348, 192, 21)
test shape: (10348, 192, 21) (10348, 192, 21)
mse:0.22046221792697906, mae:0.26504290103912354, dtw:not calculated
