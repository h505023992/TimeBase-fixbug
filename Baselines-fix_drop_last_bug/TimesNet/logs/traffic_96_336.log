True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           traffic_96_336      Model:              TimesNet            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/          
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         8                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_traffic_96_336_TimesNet_custom_ftM_sl96_ll48_pl336_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11849
val 1421
test 3173
	iters: 100, epoch: 1 | loss: 0.7749658
	speed: 0.3683s/iter; left time: 16337.8431s
	iters: 200, epoch: 1 | loss: 0.6100942
	speed: 0.3148s/iter; left time: 13932.7958s
	iters: 300, epoch: 1 | loss: 0.5468957
	speed: 0.3060s/iter; left time: 13512.7904s
	iters: 400, epoch: 1 | loss: 0.5084887
	speed: 0.3079s/iter; left time: 13568.4625s
	iters: 500, epoch: 1 | loss: 0.4923725
	speed: 0.2787s/iter; left time: 12251.0489s
	iters: 600, epoch: 1 | loss: 0.4856979
	speed: 0.2807s/iter; left time: 12309.7201s
	iters: 700, epoch: 1 | loss: 0.4647917
	speed: 0.2796s/iter; left time: 12235.4415s
	iters: 800, epoch: 1 | loss: 0.4375090
	speed: 0.2750s/iter; left time: 12006.9453s
	iters: 900, epoch: 1 | loss: 0.4468913
	speed: 0.2793s/iter; left time: 12164.6070s
	iters: 1000, epoch: 1 | loss: 0.4410171
	speed: 0.2787s/iter; left time: 12111.1303s
	iters: 1100, epoch: 1 | loss: 0.4478961
	speed: 0.2874s/iter; left time: 12460.5677s
	iters: 1200, epoch: 1 | loss: 0.3986004
	speed: 0.2827s/iter; left time: 12231.2577s
	iters: 1300, epoch: 1 | loss: 0.3810127
	speed: 0.2771s/iter; left time: 11957.7960s
	iters: 1400, epoch: 1 | loss: 0.3436969
	speed: 0.2764s/iter; left time: 11900.4436s
Epoch: 1 cost time: 433.01072096824646
Epoch: 1, Steps: 1482 | Train Loss: 0.5047551 Vali Loss: 0.5562877 Test Loss: 0.7555739
Validation loss decreased (inf --> 0.556288).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3286050
	speed: 1.9266s/iter; left time: 82610.0131s
	iters: 200, epoch: 2 | loss: 0.3248200
	speed: 0.2758s/iter; left time: 11796.5357s
	iters: 300, epoch: 2 | loss: 0.3322277
	speed: 0.2698s/iter; left time: 11513.8389s
	iters: 400, epoch: 2 | loss: 0.3271921
	speed: 0.2705s/iter; left time: 11518.4665s
	iters: 500, epoch: 2 | loss: 0.2865712
	speed: 0.2723s/iter; left time: 11566.7204s
	iters: 600, epoch: 2 | loss: 0.3000163
	speed: 0.2637s/iter; left time: 11173.3269s
	iters: 700, epoch: 2 | loss: 0.3174349
	speed: 0.2621s/iter; left time: 11081.7267s
	iters: 800, epoch: 2 | loss: 0.3226183
	speed: 0.2584s/iter; left time: 10898.4154s
	iters: 900, epoch: 2 | loss: 0.3327332
	speed: 0.2535s/iter; left time: 10666.5331s
	iters: 1000, epoch: 2 | loss: 0.2919469
	speed: 0.2438s/iter; left time: 10236.2570s
	iters: 1100, epoch: 2 | loss: 0.3049751
	speed: 0.2384s/iter; left time: 9983.1094s
	iters: 1200, epoch: 2 | loss: 0.3031085
	speed: 0.2459s/iter; left time: 10272.7111s
	iters: 1300, epoch: 2 | loss: 0.2845964
	speed: 0.2257s/iter; left time: 9405.8138s
	iters: 1400, epoch: 2 | loss: 0.2800040
	speed: 0.2284s/iter; left time: 9496.7032s
Epoch: 2 cost time: 379.066198348999
Epoch: 2, Steps: 1482 | Train Loss: 0.3019291 Vali Loss: 0.4976298 Test Loss: 0.6616319
Validation loss decreased (0.556288 --> 0.497630).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2620829
	speed: 1.4471s/iter; left time: 59905.2204s
	iters: 200, epoch: 3 | loss: 0.2678421
	speed: 0.2200s/iter; left time: 9085.2166s
	iters: 300, epoch: 3 | loss: 0.2768591
	speed: 0.2269s/iter; left time: 9345.9275s
	iters: 400, epoch: 3 | loss: 0.2763840
	speed: 0.2263s/iter; left time: 9299.0740s
	iters: 500, epoch: 3 | loss: 0.2683168
	speed: 0.2211s/iter; left time: 9064.6141s
	iters: 600, epoch: 3 | loss: 0.2843851
	speed: 0.2256s/iter; left time: 9225.9089s
	iters: 700, epoch: 3 | loss: 0.2695965
	speed: 0.2191s/iter; left time: 8938.8624s
	iters: 800, epoch: 3 | loss: 0.2648000
	speed: 0.2254s/iter; left time: 9172.1181s
	iters: 900, epoch: 3 | loss: 0.2651466
	speed: 0.2167s/iter; left time: 8798.2643s
	iters: 1000, epoch: 3 | loss: 0.2481847
	speed: 0.2142s/iter; left time: 8675.6743s
	iters: 1100, epoch: 3 | loss: 0.2816285
	speed: 0.2097s/iter; left time: 8472.1948s
	iters: 1200, epoch: 3 | loss: 0.2474808
	speed: 0.2149s/iter; left time: 8658.1903s
	iters: 1300, epoch: 3 | loss: 0.2860396
	speed: 0.2083s/iter; left time: 8373.9563s
	iters: 1400, epoch: 3 | loss: 0.2569551
	speed: 0.2036s/iter; left time: 8163.9197s
Epoch: 3 cost time: 325.2961378097534
Epoch: 3, Steps: 1482 | Train Loss: 0.2725235 Vali Loss: 0.4908108 Test Loss: 0.6505332
Validation loss decreased (0.497630 --> 0.490811).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2814076
	speed: 1.5254s/iter; left time: 60884.9305s
	iters: 200, epoch: 4 | loss: 0.2566042
	speed: 0.1995s/iter; left time: 7942.2394s
	iters: 300, epoch: 4 | loss: 0.2566396
	speed: 0.2054s/iter; left time: 8159.3826s
	iters: 400, epoch: 4 | loss: 0.2579514
	speed: 0.2041s/iter; left time: 8084.2738s
	iters: 500, epoch: 4 | loss: 0.2729396
	speed: 0.2012s/iter; left time: 7948.5005s
	iters: 600, epoch: 4 | loss: 0.2573483
	speed: 0.2070s/iter; left time: 8159.5536s
	iters: 700, epoch: 4 | loss: 0.2523310
	speed: 0.1988s/iter; left time: 7814.5743s
	iters: 800, epoch: 4 | loss: 0.2541498
	speed: 0.1968s/iter; left time: 7718.5143s
	iters: 900, epoch: 4 | loss: 0.2592441
	speed: 0.2039s/iter; left time: 7974.2789s
	iters: 1000, epoch: 4 | loss: 0.2722130
	speed: 0.2001s/iter; left time: 7807.7905s
	iters: 1100, epoch: 4 | loss: 0.2823818
	speed: 0.1957s/iter; left time: 7615.7773s
	iters: 1200, epoch: 4 | loss: 0.2493562
	speed: 0.1984s/iter; left time: 7701.4853s
	iters: 1300, epoch: 4 | loss: 0.2768162
	speed: 0.2027s/iter; left time: 7848.9433s
	iters: 1400, epoch: 4 | loss: 0.2782311
	speed: 0.2014s/iter; left time: 7778.1196s
Epoch: 4 cost time: 301.7816824913025
Epoch: 4, Steps: 1482 | Train Loss: 0.2622829 Vali Loss: 0.4885576 Test Loss: 0.6468893
Validation loss decreased (0.490811 --> 0.488558).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2640821
	speed: 1.4354s/iter; left time: 55168.2499s
	iters: 200, epoch: 5 | loss: 0.2815965
	speed: 0.2080s/iter; left time: 7973.4065s
	iters: 300, epoch: 5 | loss: 0.2861001
	speed: 0.2136s/iter; left time: 8164.7451s
	iters: 400, epoch: 5 | loss: 0.2562485
	speed: 0.2049s/iter; left time: 7813.6065s
	iters: 500, epoch: 5 | loss: 0.2565559
	speed: 0.1980s/iter; left time: 7531.3738s
	iters: 600, epoch: 5 | loss: 0.2556762
	speed: 0.1988s/iter; left time: 7541.2799s
	iters: 700, epoch: 5 | loss: 0.2400372
	speed: 0.2012s/iter; left time: 7612.1911s
	iters: 800, epoch: 5 | loss: 0.2607201
	speed: 0.1995s/iter; left time: 7528.0568s
	iters: 900, epoch: 5 | loss: 0.2737576
	speed: 0.2022s/iter; left time: 7609.2790s
	iters: 1000, epoch: 5 | loss: 0.2672440
	speed: 0.2028s/iter; left time: 7611.2809s
	iters: 1100, epoch: 5 | loss: 0.2516237
	speed: 0.2167s/iter; left time: 8110.0684s
	iters: 1200, epoch: 5 | loss: 0.2498396
	speed: 0.2174s/iter; left time: 8115.9310s
	iters: 1300, epoch: 5 | loss: 0.2529623
	speed: 0.2121s/iter; left time: 7897.5103s
	iters: 1400, epoch: 5 | loss: 0.2774434
	speed: 0.2090s/iter; left time: 7761.6951s
Epoch: 5 cost time: 309.1918306350708
Epoch: 5, Steps: 1482 | Train Loss: 0.2584173 Vali Loss: 0.4861592 Test Loss: 0.6463284
Validation loss decreased (0.488558 --> 0.486159).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2695232
	speed: 1.3182s/iter; left time: 48708.7565s
	iters: 200, epoch: 6 | loss: 0.2695626
	speed: 0.2090s/iter; left time: 7700.4398s
	iters: 300, epoch: 6 | loss: 0.2778430
	speed: 0.1996s/iter; left time: 7336.3560s
	iters: 400, epoch: 6 | loss: 0.2409646
	speed: 0.2040s/iter; left time: 7476.0928s
	iters: 500, epoch: 6 | loss: 0.2475911
	speed: 0.2031s/iter; left time: 7422.9977s
	iters: 600, epoch: 6 | loss: 0.2486927
	speed: 0.2042s/iter; left time: 7444.1004s
	iters: 700, epoch: 6 | loss: 0.2626044
	speed: 0.2020s/iter; left time: 7342.2338s
	iters: 800, epoch: 6 | loss: 0.2446438
	speed: 0.2066s/iter; left time: 7488.2382s
	iters: 900, epoch: 6 | loss: 0.2668805
	speed: 0.2026s/iter; left time: 7325.5057s
	iters: 1000, epoch: 6 | loss: 0.2509680
	speed: 0.2047s/iter; left time: 7379.0915s
	iters: 1100, epoch: 6 | loss: 0.2680584
	speed: 0.2024s/iter; left time: 7278.0522s
	iters: 1200, epoch: 6 | loss: 0.2311382
	speed: 0.2027s/iter; left time: 7266.4891s
	iters: 1300, epoch: 6 | loss: 0.2456019
	speed: 0.2042s/iter; left time: 7301.0336s
	iters: 1400, epoch: 6 | loss: 0.2524098
	speed: 0.2069s/iter; left time: 7375.6916s
Epoch: 6 cost time: 306.16305470466614
Epoch: 6, Steps: 1482 | Train Loss: 0.2564579 Vali Loss: 0.4891296 Test Loss: 0.6477653
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2452678
	speed: 1.4795s/iter; left time: 52476.8390s
	iters: 200, epoch: 7 | loss: 0.2473939
	speed: 0.2165s/iter; left time: 7656.9048s
	iters: 300, epoch: 7 | loss: 0.2833593
	speed: 0.2102s/iter; left time: 7412.2710s
	iters: 400, epoch: 7 | loss: 0.2576177
	speed: 0.2062s/iter; left time: 7251.9715s
	iters: 500, epoch: 7 | loss: 0.2486814
	speed: 0.2072s/iter; left time: 7265.9850s
	iters: 600, epoch: 7 | loss: 0.2545053
	speed: 0.2078s/iter; left time: 7268.1786s
	iters: 700, epoch: 7 | loss: 0.2683481
	speed: 0.2126s/iter; left time: 7414.1192s
	iters: 800, epoch: 7 | loss: 0.2393908
	speed: 0.2082s/iter; left time: 7238.9375s
	iters: 900, epoch: 7 | loss: 0.2349007
	speed: 0.2048s/iter; left time: 7101.6775s
	iters: 1000, epoch: 7 | loss: 0.2507574
	speed: 0.2055s/iter; left time: 7104.1903s
	iters: 1100, epoch: 7 | loss: 0.2436954
	speed: 0.2091s/iter; left time: 7208.2732s
	iters: 1200, epoch: 7 | loss: 0.2503393
	speed: 0.2077s/iter; left time: 7137.2404s
	iters: 1300, epoch: 7 | loss: 0.2637789
	speed: 0.2118s/iter; left time: 7259.4991s
	iters: 1400, epoch: 7 | loss: 0.2756414
	speed: 0.2233s/iter; left time: 7630.7024s
Epoch: 7 cost time: 314.8884391784668
Epoch: 7, Steps: 1482 | Train Loss: 0.2553958 Vali Loss: 0.4846310 Test Loss: 0.6439075
Validation loss decreased (0.486159 --> 0.484631).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2547940
	speed: 1.4009s/iter; left time: 47611.4548s
	iters: 200, epoch: 8 | loss: 0.2570829
	speed: 0.2125s/iter; left time: 7201.3050s
	iters: 300, epoch: 8 | loss: 0.2504647
	speed: 0.2209s/iter; left time: 7463.2436s
	iters: 400, epoch: 8 | loss: 0.2470845
	speed: 0.2211s/iter; left time: 7448.4216s
	iters: 500, epoch: 8 | loss: 0.2401880
	speed: 0.2268s/iter; left time: 7616.0935s
	iters: 600, epoch: 8 | loss: 0.2584674
	speed: 0.2207s/iter; left time: 7391.0122s
	iters: 700, epoch: 8 | loss: 0.2615767
	speed: 0.2140s/iter; left time: 7143.9033s
	iters: 800, epoch: 8 | loss: 0.2612218
	speed: 0.2117s/iter; left time: 7048.0269s
	iters: 900, epoch: 8 | loss: 0.2654901
	speed: 0.2044s/iter; left time: 6782.0668s
	iters: 1000, epoch: 8 | loss: 0.2360034
	speed: 0.2067s/iter; left time: 6838.1387s
	iters: 1100, epoch: 8 | loss: 0.2502679
	speed: 0.2001s/iter; left time: 6602.1903s
	iters: 1200, epoch: 8 | loss: 0.2718658
	speed: 0.2111s/iter; left time: 6941.6325s
	iters: 1300, epoch: 8 | loss: 0.2389096
	speed: 0.2025s/iter; left time: 6639.1778s
	iters: 1400, epoch: 8 | loss: 0.2619853
	speed: 0.2125s/iter; left time: 6946.6701s
Epoch: 8 cost time: 318.183944940567
Epoch: 8, Steps: 1482 | Train Loss: 0.2548379 Vali Loss: 0.4851961 Test Loss: 0.6434035
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2494274
	speed: 1.3725s/iter; left time: 44612.7650s
	iters: 200, epoch: 9 | loss: 0.2525391
	speed: 0.2041s/iter; left time: 6612.2937s
	iters: 300, epoch: 9 | loss: 0.2763925
	speed: 0.2062s/iter; left time: 6662.4380s
	iters: 400, epoch: 9 | loss: 0.2667838
	speed: 0.2060s/iter; left time: 6635.4547s
	iters: 500, epoch: 9 | loss: 0.2652268
	speed: 0.2077s/iter; left time: 6669.5718s
	iters: 600, epoch: 9 | loss: 0.2659303
	speed: 0.2101s/iter; left time: 6725.5104s
	iters: 700, epoch: 9 | loss: 0.2588784
	speed: 0.2110s/iter; left time: 6731.6653s
	iters: 800, epoch: 9 | loss: 0.2496948
	speed: 0.2068s/iter; left time: 6576.3436s
	iters: 900, epoch: 9 | loss: 0.2639686
	speed: 0.2026s/iter; left time: 6423.8348s
	iters: 1000, epoch: 9 | loss: 0.2577816
	speed: 0.2026s/iter; left time: 6404.7400s
	iters: 1100, epoch: 9 | loss: 0.2719993
	speed: 0.2047s/iter; left time: 6448.1848s
	iters: 1200, epoch: 9 | loss: 0.2562779
	speed: 0.2023s/iter; left time: 6354.6703s
	iters: 1300, epoch: 9 | loss: 0.2732061
	speed: 0.2106s/iter; left time: 6593.7431s
	iters: 1400, epoch: 9 | loss: 0.2661382
	speed: 0.2046s/iter; left time: 6384.9141s
Epoch: 9 cost time: 308.9851059913635
Epoch: 9, Steps: 1482 | Train Loss: 0.2545756 Vali Loss: 0.4866190 Test Loss: 0.6447641
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2595870
	speed: 1.3588s/iter; left time: 42153.6629s
	iters: 200, epoch: 10 | loss: 0.2479281
	speed: 0.2085s/iter; left time: 6448.6179s
	iters: 300, epoch: 10 | loss: 0.2578729
	speed: 0.2011s/iter; left time: 6199.6024s
	iters: 400, epoch: 10 | loss: 0.2436819
	speed: 0.2081s/iter; left time: 6394.8449s
	iters: 500, epoch: 10 | loss: 0.2466096
	speed: 0.2044s/iter; left time: 6259.5903s
	iters: 600, epoch: 10 | loss: 0.2618414
	speed: 0.2067s/iter; left time: 6310.2281s
	iters: 700, epoch: 10 | loss: 0.2301962
	speed: 0.2047s/iter; left time: 6227.0341s
	iters: 800, epoch: 10 | loss: 0.2599729
	speed: 0.2154s/iter; left time: 6530.8610s
	iters: 900, epoch: 10 | loss: 0.2543766
	speed: 0.2090s/iter; left time: 6317.4520s
	iters: 1000, epoch: 10 | loss: 0.2503574
	speed: 0.2076s/iter; left time: 6252.0983s
	iters: 1100, epoch: 10 | loss: 0.2360152
	speed: 0.2056s/iter; left time: 6173.4930s
	iters: 1200, epoch: 10 | loss: 0.2637282
	speed: 0.2105s/iter; left time: 6299.3656s
	iters: 1300, epoch: 10 | loss: 0.2625340
	speed: 0.2058s/iter; left time: 6137.0063s
	iters: 1400, epoch: 10 | loss: 0.2520305
	speed: 0.2066s/iter; left time: 6140.9445s
Epoch: 10 cost time: 310.64787340164185
Epoch: 10, Steps: 1482 | Train Loss: 0.2544330 Vali Loss: 0.4863394 Test Loss: 0.6448694
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_traffic_96_336_TimesNet_custom_ftM_sl96_ll48_pl336_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3173
test shape: (3173, 336, 862) (3173, 336, 862)
test shape: (3173, 336, 862) (3173, 336, 862)
mse:0.6438060402870178, mae:0.34873443841934204, dtw:not calculated
