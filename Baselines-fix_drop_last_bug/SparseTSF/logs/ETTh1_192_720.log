Args in experiment:
Namespace(is_training=1, model_id='ETTh1_192_720', model='SparseTSF', data='ETTh1', root_path='./dataset/', data_path='ETTh1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=192, label_len=48, pred_len=720, period_len=24, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=256, patience=5, learning_rate=0.02, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=2, use_multi_gpu=0, devices='0,1', test_flop=False)
Use GPU: cuda:2
>>>>>>>start training : ETTh1_192_720_SparseTSF_ETTh1_ftM_sl192_pl720_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7729
val 2161
test 2161
Epoch: 1 cost time: 6.091337442398071
Epoch: 1, Steps: 30 | Train Loss: 0.8168487 Vali Loss: 1.9269221 Test Loss: 0.7473657
Validation loss decreased (inf --> 1.926922).  Saving model ...
Updating learning rate to 0.02
Epoch: 2 cost time: 2.3090522289276123
Epoch: 2, Steps: 30 | Train Loss: 0.6849085 Vali Loss: 1.5967604 Test Loss: 0.5183808
Validation loss decreased (1.926922 --> 1.596760).  Saving model ...
Updating learning rate to 0.02
Epoch: 3 cost time: 2.1907477378845215
Epoch: 3, Steps: 30 | Train Loss: 0.6228338 Vali Loss: 1.5520569 Test Loss: 0.4649218
Validation loss decreased (1.596760 --> 1.552057).  Saving model ...
Updating learning rate to 0.02
Epoch: 4 cost time: 2.420429229736328
Epoch: 4, Steps: 30 | Train Loss: 0.6020686 Vali Loss: 1.5267394 Test Loss: 0.4493322
Validation loss decreased (1.552057 --> 1.526739).  Saving model ...
Updating learning rate to 0.016
Epoch: 5 cost time: 2.36924147605896
Epoch: 5, Steps: 30 | Train Loss: 0.5934738 Vali Loss: 1.5054080 Test Loss: 0.4459060
Validation loss decreased (1.526739 --> 1.505408).  Saving model ...
Updating learning rate to 0.012800000000000002
Epoch: 6 cost time: 2.310231924057007
Epoch: 6, Steps: 30 | Train Loss: 0.5909101 Vali Loss: 1.5009170 Test Loss: 0.4453489
Validation loss decreased (1.505408 --> 1.500917).  Saving model ...
Updating learning rate to 0.010240000000000003
Epoch: 7 cost time: 2.3473966121673584
Epoch: 7, Steps: 30 | Train Loss: 0.5896530 Vali Loss: 1.5056918 Test Loss: 0.4427196
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.008192000000000001
Epoch: 8 cost time: 2.462886333465576
Epoch: 8, Steps: 30 | Train Loss: 0.5898115 Vali Loss: 1.5063882 Test Loss: 0.4456553
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.0065536000000000014
Epoch: 9 cost time: 2.319108486175537
Epoch: 9, Steps: 30 | Train Loss: 0.5898751 Vali Loss: 1.5023521 Test Loss: 0.4442317
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.005242880000000002
Epoch: 10 cost time: 2.299830675125122
Epoch: 10, Steps: 30 | Train Loss: 0.5903389 Vali Loss: 1.5042194 Test Loss: 0.4437526
EarlyStopping counter: 4 out of 5
Updating learning rate to 0.004194304000000002
Epoch: 11 cost time: 2.3072497844696045
Epoch: 11, Steps: 30 | Train Loss: 0.5899460 Vali Loss: 1.4971169 Test Loss: 0.4449686
Validation loss decreased (1.500917 --> 1.497117).  Saving model ...
Updating learning rate to 0.003355443200000002
Epoch: 12 cost time: 2.4928457736968994
Epoch: 12, Steps: 30 | Train Loss: 0.5898379 Vali Loss: 1.5013345 Test Loss: 0.4442975
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.002684354560000001
Epoch: 13 cost time: 2.26001238822937
Epoch: 13, Steps: 30 | Train Loss: 0.5896421 Vali Loss: 1.5061777 Test Loss: 0.4446563
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.0021474836480000013
Epoch: 14 cost time: 2.4511301517486572
Epoch: 14, Steps: 30 | Train Loss: 0.5898318 Vali Loss: 1.5037444 Test Loss: 0.4447801
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.0017179869184000011
Epoch: 15 cost time: 2.2723352909088135
Epoch: 15, Steps: 30 | Train Loss: 0.5896669 Vali Loss: 1.5014701 Test Loss: 0.4444293
EarlyStopping counter: 4 out of 5
Updating learning rate to 0.0013743895347200009
Epoch: 16 cost time: 2.2329800128936768
Epoch: 16, Steps: 30 | Train Loss: 0.5893287 Vali Loss: 1.5001990 Test Loss: 0.4434343
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTh1_192_720_SparseTSF_ETTh1_ftM_sl192_pl720_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.43499982357025146, mae:0.4485718607902527, rse:0.631388247013092
