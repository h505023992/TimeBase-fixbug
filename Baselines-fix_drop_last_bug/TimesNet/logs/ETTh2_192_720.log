True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTh2_192_96        Model:              TimesNet            

[1mData Loader[0m
  Data:               ETTh2               Root Path:          ./dataset/          
  Data Path:          ETTh2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            192                 Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTh2_192_96_TimesNet_ETTh2_ftM_sl192_ll48_pl720_dm16_nh8_el2_dl1_df32_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7729
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.8730156
	speed: 0.5157s/iter; left time: 3693.2164s
	iters: 200, epoch: 1 | loss: 0.5682119
	speed: 0.3925s/iter; left time: 2771.3910s
Epoch: 1 cost time: 106.75087308883667
Epoch: 1, Steps: 242 | Train Loss: 0.8580697 Vali Loss: 0.6949975 Test Loss: 0.4927209
Validation loss decreased (inf --> 0.694998).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7848653
	speed: 0.7876s/iter; left time: 5449.3358s
	iters: 200, epoch: 2 | loss: 0.5250509
	speed: 0.3460s/iter; left time: 2359.3436s
Epoch: 2 cost time: 84.9953556060791
Epoch: 2, Steps: 242 | Train Loss: 0.7648399 Vali Loss: 0.6956081 Test Loss: 0.4497304
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.6782814
	speed: 0.7230s/iter; left time: 4827.6039s
	iters: 200, epoch: 3 | loss: 0.5746684
	speed: 0.3217s/iter; left time: 2115.9491s
Epoch: 3 cost time: 78.59777545928955
Epoch: 3, Steps: 242 | Train Loss: 0.7190318 Vali Loss: 0.6919546 Test Loss: 0.4341090
Validation loss decreased (0.694998 --> 0.691955).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.7127798
	speed: 0.6807s/iter; left time: 4380.2621s
	iters: 200, epoch: 4 | loss: 0.5605436
	speed: 0.3131s/iter; left time: 1983.4219s
Epoch: 4 cost time: 76.70479130744934
Epoch: 4, Steps: 242 | Train Loss: 0.7033522 Vali Loss: 0.6958805 Test Loss: 0.4264373
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.5173928
	speed: 0.6654s/iter; left time: 4120.5513s
	iters: 200, epoch: 5 | loss: 0.7969965
	speed: 0.3033s/iter; left time: 1848.0334s
Epoch: 5 cost time: 75.48923301696777
Epoch: 5, Steps: 242 | Train Loss: 0.6957350 Vali Loss: 0.6899807 Test Loss: 0.4240575
Validation loss decreased (0.691955 --> 0.689981).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.5584077
	speed: 0.6792s/iter; left time: 4041.6989s
	iters: 200, epoch: 6 | loss: 0.7189571
	speed: 0.3088s/iter; left time: 1807.0539s
Epoch: 6 cost time: 75.86760592460632
Epoch: 6, Steps: 242 | Train Loss: 0.6918257 Vali Loss: 0.6894753 Test Loss: 0.4223971
Validation loss decreased (0.689981 --> 0.689475).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.8380652
	speed: 0.6675s/iter; left time: 3810.6914s
	iters: 200, epoch: 7 | loss: 0.6748145
	speed: 0.3134s/iter; left time: 1757.6168s
Epoch: 7 cost time: 76.69522476196289
Epoch: 7, Steps: 242 | Train Loss: 0.6897309 Vali Loss: 0.6884210 Test Loss: 0.4212478
Validation loss decreased (0.689475 --> 0.688421).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.5137753
	speed: 0.6727s/iter; left time: 3677.7159s
	iters: 200, epoch: 8 | loss: 0.6214759
	speed: 0.3141s/iter; left time: 1685.6025s
Epoch: 8 cost time: 76.98226046562195
Epoch: 8, Steps: 242 | Train Loss: 0.6897595 Vali Loss: 0.6911538 Test Loss: 0.4215065
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.8172355
	speed: 0.6857s/iter; left time: 3582.9812s
	iters: 200, epoch: 9 | loss: 0.7306557
	speed: 0.3150s/iter; left time: 1614.3350s
Epoch: 9 cost time: 77.04876136779785
Epoch: 9, Steps: 242 | Train Loss: 0.6892777 Vali Loss: 0.6904386 Test Loss: 0.4211618
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.8735830
	speed: 0.7079s/iter; left time: 3527.6186s
	iters: 200, epoch: 10 | loss: 0.6371875
	speed: 0.3118s/iter; left time: 1522.4088s
Epoch: 10 cost time: 76.64853692054749
Epoch: 10, Steps: 242 | Train Loss: 0.6888149 Vali Loss: 0.6898428 Test Loss: 0.4209657
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTh2_192_96_TimesNet_ETTh2_ftM_sl192_ll48_pl720_dm16_nh8_el2_dl1_df32_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
test shape: (2161, 720, 7) (2161, 720, 7)
test shape: (2161, 720, 7) (2161, 720, 7)
mse:0.4190939962863922, mae:0.4459329843521118, dtw:not calculated
