Args in experiment:
Namespace(is_training=1, model_id='weather_192_720', model='iTransformer', data='custom', root_path='./dataset/', data_path='weather.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=192, label_len=48, pred_len=720, enc_in=21, dec_in=21, c_out=21, d_model=128, n_heads=8, e_layers=3, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=10, batch_size=64, patience=3, learning_rate=0.0001, des='Exp', loss='MSE', lradj='type1', use_amp=False, use_gpu=True, gpu=2, use_multi_gpu=False, devices='0,1,2,3', exp_name='MTSF', channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv', efficient_training=False, use_norm=True, partial_start_index=0)
Use GPU: cuda:2
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.dropout.Dropout'>.
[INFO] Register count_convNd() for <class 'torch.nn.modules.conv.Conv1d'>.
[INFO] Register count_normalization() for <class 'torch.nn.modules.normalization.LayerNorm'>.
MACs: 11211264.0
Params: 416592.0
11.21M MACs
>>>>>>>start training : weather_192_720_iTransformer_custom_M_ft192_sl48_ll720_pl128_dm8_nh3_el1_dl128_df1_fctimeF_ebTrue_dtExp_projection_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35976
val 4551
test 9820
	iters: 100, epoch: 1 | loss: 0.8426623
	speed: 0.0877s/iter; left time: 484.1611s
	iters: 200, epoch: 1 | loss: 0.9072898
	speed: 0.0813s/iter; left time: 440.9422s
	iters: 300, epoch: 1 | loss: 0.7057295
	speed: 0.0674s/iter; left time: 358.8615s
	iters: 400, epoch: 1 | loss: 0.6114151
	speed: 0.0785s/iter; left time: 409.6072s
	iters: 500, epoch: 1 | loss: 0.7887707
	speed: 0.0698s/iter; left time: 357.3164s
Max Memory (MB): 190.2275390625
Epoch: 1 cost time: 43.583378076553345
Epoch: 1, Steps: 562 | Train Loss: 0.7413184 Vali Loss: 0.7331226 Test Loss: 0.3577687
Validation loss decreased (inf --> 0.733123).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8119426
	speed: 1.1245s/iter; left time: 5576.2060s
	iters: 200, epoch: 2 | loss: 0.6431383
	speed: 0.0717s/iter; left time: 348.2241s
	iters: 300, epoch: 2 | loss: 0.6299576
	speed: 0.0691s/iter; left time: 328.7962s
	iters: 400, epoch: 2 | loss: 0.7064143
	speed: 0.0651s/iter; left time: 303.4931s
	iters: 500, epoch: 2 | loss: 0.6848499
	speed: 0.0543s/iter; left time: 247.4829s
Max Memory (MB): 190.2275390625
Epoch: 2 cost time: 36.7260468006134
Epoch: 2, Steps: 562 | Train Loss: 0.6787467 Vali Loss: 0.7031421 Test Loss: 0.3478180
Validation loss decreased (0.733123 --> 0.703142).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5590945
	speed: 1.3651s/iter; left time: 6002.2493s
	iters: 200, epoch: 3 | loss: 0.6360842
	speed: 0.0769s/iter; left time: 330.4227s
	iters: 300, epoch: 3 | loss: 0.6117131
	speed: 0.0621s/iter; left time: 260.4418s
	iters: 400, epoch: 3 | loss: 0.6362309
	speed: 0.0634s/iter; left time: 259.6017s
	iters: 500, epoch: 3 | loss: 0.5943949
	speed: 0.0615s/iter; left time: 245.6313s
Max Memory (MB): 190.2275390625
Epoch: 3 cost time: 40.1171395778656
Epoch: 3, Steps: 562 | Train Loss: 0.6579155 Vali Loss: 0.6932858 Test Loss: 0.3429186
Validation loss decreased (0.703142 --> 0.693286).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.6017087
	speed: 1.1529s/iter; left time: 4421.3965s
	iters: 200, epoch: 4 | loss: 0.6417527
	speed: 0.0769s/iter; left time: 287.0692s
	iters: 300, epoch: 4 | loss: 0.6479318
	speed: 0.0768s/iter; left time: 279.2551s
	iters: 400, epoch: 4 | loss: 0.5791211
	speed: 0.0770s/iter; left time: 272.3502s
	iters: 500, epoch: 4 | loss: 0.7374272
	speed: 0.0628s/iter; left time: 215.8679s
Max Memory (MB): 190.2275390625
Epoch: 4 cost time: 41.67325472831726
Epoch: 4, Steps: 562 | Train Loss: 0.6497935 Vali Loss: 0.6917115 Test Loss: 0.3416871
Validation loss decreased (0.693286 --> 0.691711).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.6389362
	speed: 1.2468s/iter; left time: 4080.7168s
	iters: 200, epoch: 5 | loss: 0.6380839
	speed: 0.0745s/iter; left time: 236.3504s
	iters: 300, epoch: 5 | loss: 0.7289181
	speed: 0.0814s/iter; left time: 250.0195s
	iters: 400, epoch: 5 | loss: 0.6606082
	speed: 0.0735s/iter; left time: 218.4639s
	iters: 500, epoch: 5 | loss: 0.6289334
	speed: 0.0659s/iter; left time: 189.3721s
Max Memory (MB): 190.2275390625
Epoch: 5 cost time: 42.82153344154358
Epoch: 5, Steps: 562 | Train Loss: 0.6464194 Vali Loss: 0.6899956 Test Loss: 0.3410176
Validation loss decreased (0.691711 --> 0.689996).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.6800340
	speed: 1.3378s/iter; left time: 3626.6411s
	iters: 200, epoch: 6 | loss: 0.7009730
	speed: 0.0750s/iter; left time: 195.7183s
	iters: 300, epoch: 6 | loss: 0.5929319
	speed: 0.0613s/iter; left time: 153.8587s
	iters: 400, epoch: 6 | loss: 0.6955834
	speed: 0.0545s/iter; left time: 131.5016s
	iters: 500, epoch: 6 | loss: 0.6734571
	speed: 0.0509s/iter; left time: 117.7195s
Max Memory (MB): 190.2275390625
Epoch: 6 cost time: 36.129544496536255
Epoch: 6, Steps: 562 | Train Loss: 0.6450827 Vali Loss: 0.6892965 Test Loss: 0.3408620
Validation loss decreased (0.689996 --> 0.689296).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.6990767
	speed: 1.2543s/iter; left time: 2695.4797s
	iters: 200, epoch: 7 | loss: 0.6715819
	speed: 0.0741s/iter; left time: 151.7814s
	iters: 300, epoch: 7 | loss: 0.7121428
	speed: 0.0717s/iter; left time: 139.6479s
	iters: 400, epoch: 7 | loss: 0.8103529
	speed: 0.0724s/iter; left time: 133.8130s
	iters: 500, epoch: 7 | loss: 0.6237504
	speed: 0.0685s/iter; left time: 119.7620s
Max Memory (MB): 190.2275390625
Epoch: 7 cost time: 41.78054237365723
Epoch: 7, Steps: 562 | Train Loss: 0.6445263 Vali Loss: 0.6900544 Test Loss: 0.3407894
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.5802487
	speed: 1.2295s/iter; left time: 1951.1588s
	iters: 200, epoch: 8 | loss: 0.6098205
	speed: 0.0678s/iter; left time: 100.8715s
	iters: 300, epoch: 8 | loss: 0.6441834
	speed: 0.0726s/iter; left time: 100.6488s
	iters: 400, epoch: 8 | loss: 0.6654466
	speed: 0.0751s/iter; left time: 96.6135s
	iters: 500, epoch: 8 | loss: 0.5949479
	speed: 0.0712s/iter; left time: 84.5082s
Max Memory (MB): 190.2275390625
Epoch: 8 cost time: 41.71607303619385
Epoch: 8, Steps: 562 | Train Loss: 0.6441552 Vali Loss: 0.6898784 Test Loss: 0.3407422
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.5948909
	speed: 1.2818s/iter; left time: 1313.8594s
	iters: 200, epoch: 9 | loss: 0.7357175
	speed: 0.0710s/iter; left time: 65.6565s
	iters: 300, epoch: 9 | loss: 0.6265641
	speed: 0.0674s/iter; left time: 55.6395s
	iters: 400, epoch: 9 | loss: 0.6537430
	speed: 0.0798s/iter; left time: 57.8734s
	iters: 500, epoch: 9 | loss: 0.7892001
	speed: 0.0775s/iter; left time: 48.4606s
Max Memory (MB): 190.2275390625
Epoch: 9 cost time: 43.3214008808136
Epoch: 9, Steps: 562 | Train Loss: 0.6440459 Vali Loss: 0.6891708 Test Loss: 0.3406544
Validation loss decreased (0.689296 --> 0.689171).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.6174703
	speed: 1.2374s/iter; left time: 572.9011s
	iters: 200, epoch: 10 | loss: 0.7141935
	speed: 0.0707s/iter; left time: 25.6543s
	iters: 300, epoch: 10 | loss: 0.5901544
	speed: 0.0683s/iter; left time: 17.9537s
	iters: 400, epoch: 10 | loss: 0.6365801
	speed: 0.0656s/iter; left time: 10.6990s
	iters: 500, epoch: 10 | loss: 0.6513637
	speed: 0.0639s/iter; left time: 4.0260s
Max Memory (MB): 190.2275390625
Epoch: 10 cost time: 38.99385404586792
Epoch: 10, Steps: 562 | Train Loss: 0.6438388 Vali Loss: 0.6898066 Test Loss: 0.3406561
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : weather_192_720_iTransformer_custom_M_ft192_sl48_ll720_pl128_dm8_nh3_el1_dl128_df1_fctimeF_ebTrue_dtExp_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9820
test shape: (9820, 1, 720, 21) (9820, 1, 720, 21)
test shape: (9820, 720, 21) (9820, 720, 21)
mse:0.3406539559364319, mae:0.34412744641304016
