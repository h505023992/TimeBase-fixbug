Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='96_192', model='PatchTST', data='custom', root_path='./dataset/', data_path='weather.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=192, fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=21, dec_in=7, c_out=7, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=32, patience=5, learning_rate=0.0001, des='Exp', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=1, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:1
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.dropout.Dropout'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.container.Sequential'>.
[INFO] Register count_normalization() for <class 'torch.nn.modules.batchnorm.BatchNorm1d'>.
MACs: 106573824.0
Params: 694720.0
106.57M MACs
>>>>>>>start training : 96_192_PatchTST_custom_ftM_sl96_ll48_pl192_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36600
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 1.7009664
	speed: 0.0729s/iter; left time: 2496.0843s
	iters: 200, epoch: 1 | loss: 0.6253687
	speed: 0.0625s/iter; left time: 2133.8982s
	iters: 300, epoch: 1 | loss: 0.7244401
	speed: 0.0659s/iter; left time: 2242.3289s
	iters: 400, epoch: 1 | loss: 0.6180978
	speed: 0.0596s/iter; left time: 2022.6665s
	iters: 500, epoch: 1 | loss: 1.0698000
	speed: 0.0654s/iter; left time: 2211.5167s
	iters: 600, epoch: 1 | loss: 0.8446750
	speed: 0.0629s/iter; left time: 2121.3046s
	iters: 700, epoch: 1 | loss: 1.1715299
	speed: 0.0764s/iter; left time: 2569.9001s
	iters: 800, epoch: 1 | loss: 0.6093410
	speed: 0.0697s/iter; left time: 2337.7381s
	iters: 900, epoch: 1 | loss: 1.1759640
	speed: 0.0685s/iter; left time: 2289.0412s
	iters: 1000, epoch: 1 | loss: 0.6565317
	speed: 0.0694s/iter; left time: 2312.4632s
	iters: 1100, epoch: 1 | loss: 0.5840614
	speed: 0.0708s/iter; left time: 2350.7263s
Epoch: 1 cost time: 77.62818336486816
Epoch: 1, Steps: 1144 | Train Loss: 0.7754906 Vali Loss: 0.6168758 Test Loss: 0.2575036
Validation loss decreased (inf --> 0.616876).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.9457966
	speed: 0.5522s/iter; left time: 18265.1409s
	iters: 200, epoch: 2 | loss: 0.5960296
	speed: 0.0739s/iter; left time: 2435.3577s
	iters: 300, epoch: 2 | loss: 0.4267924
	speed: 0.0717s/iter; left time: 2358.3869s
	iters: 400, epoch: 2 | loss: 0.3748310
	speed: 0.0699s/iter; left time: 2291.5044s
	iters: 500, epoch: 2 | loss: 0.4125051
	speed: 0.0651s/iter; left time: 2126.8607s
	iters: 600, epoch: 2 | loss: 0.4918464
	speed: 0.0722s/iter; left time: 2350.4589s
	iters: 700, epoch: 2 | loss: 0.5056264
	speed: 0.0702s/iter; left time: 2279.9315s
	iters: 800, epoch: 2 | loss: 0.9927658
	speed: 0.0705s/iter; left time: 2283.9715s
	iters: 900, epoch: 2 | loss: 0.5383710
	speed: 0.0664s/iter; left time: 2142.2509s
	iters: 1000, epoch: 2 | loss: 0.5342683
	speed: 0.0676s/iter; left time: 2175.8737s
	iters: 1100, epoch: 2 | loss: 0.4468062
	speed: 0.0682s/iter; left time: 2186.8624s
Epoch: 2 cost time: 80.66770315170288
Epoch: 2, Steps: 1144 | Train Loss: 0.5813678 Vali Loss: 0.5425728 Test Loss: 0.2409338
Validation loss decreased (0.616876 --> 0.542573).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.4348700
	speed: 0.5781s/iter; left time: 18459.2887s
	iters: 200, epoch: 3 | loss: 0.4911661
	speed: 0.0713s/iter; left time: 2270.1214s
	iters: 300, epoch: 3 | loss: 0.4298801
	speed: 0.0695s/iter; left time: 2205.1111s
	iters: 400, epoch: 3 | loss: 0.4715452
	speed: 0.0670s/iter; left time: 2119.2271s
	iters: 500, epoch: 3 | loss: 0.4807011
	speed: 0.0703s/iter; left time: 2217.3849s
	iters: 600, epoch: 3 | loss: 0.5449769
	speed: 0.0675s/iter; left time: 2121.6759s
	iters: 700, epoch: 3 | loss: 0.9340042
	speed: 0.0736s/iter; left time: 2305.8466s
	iters: 800, epoch: 3 | loss: 0.4742768
	speed: 0.0686s/iter; left time: 2141.8751s
	iters: 900, epoch: 3 | loss: 0.5567818
	speed: 0.0704s/iter; left time: 2190.3720s
	iters: 1000, epoch: 3 | loss: 0.5357758
	speed: 0.0665s/iter; left time: 2062.3967s
	iters: 1100, epoch: 3 | loss: 0.5011547
	speed: 0.0752s/iter; left time: 2327.2996s
Epoch: 3 cost time: 81.7834484577179
Epoch: 3, Steps: 1144 | Train Loss: 0.5547038 Vali Loss: 0.5290256 Test Loss: 0.2347218
Validation loss decreased (0.542573 --> 0.529026).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.4977707
	speed: 0.5563s/iter; left time: 17127.5939s
	iters: 200, epoch: 4 | loss: 0.4721289
	speed: 0.0680s/iter; left time: 2087.8171s
	iters: 300, epoch: 4 | loss: 0.4578990
	speed: 0.0743s/iter; left time: 2273.9499s
	iters: 400, epoch: 4 | loss: 0.5102265
	speed: 0.0665s/iter; left time: 2028.6490s
	iters: 500, epoch: 4 | loss: 0.4067454
	speed: 0.0711s/iter; left time: 2160.8425s
	iters: 600, epoch: 4 | loss: 0.5151694
	speed: 0.0692s/iter; left time: 2094.9087s
	iters: 700, epoch: 4 | loss: 0.4574125
	speed: 0.0750s/iter; left time: 2264.8221s
	iters: 800, epoch: 4 | loss: 0.4280927
	speed: 0.0700s/iter; left time: 2107.4397s
	iters: 900, epoch: 4 | loss: 0.5030850
	speed: 0.0719s/iter; left time: 2156.5068s
	iters: 1000, epoch: 4 | loss: 0.4753747
	speed: 0.0699s/iter; left time: 2090.6158s
	iters: 1100, epoch: 4 | loss: 0.4538078
	speed: 0.0669s/iter; left time: 1991.5605s
Epoch: 4 cost time: 81.14525175094604
Epoch: 4, Steps: 1144 | Train Loss: 0.5440207 Vali Loss: 0.5194372 Test Loss: 0.2254278
Validation loss decreased (0.529026 --> 0.519437).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.6462401
	speed: 0.5648s/iter; left time: 16744.3544s
	iters: 200, epoch: 5 | loss: 0.4529334
	speed: 0.0801s/iter; left time: 2366.4182s
	iters: 300, epoch: 5 | loss: 0.6009243
	speed: 0.0661s/iter; left time: 1947.3973s
	iters: 400, epoch: 5 | loss: 0.5445253
	speed: 0.0681s/iter; left time: 1999.0733s
	iters: 500, epoch: 5 | loss: 0.3965457
	speed: 0.0704s/iter; left time: 2059.9453s
	iters: 600, epoch: 5 | loss: 0.5319831
	speed: 0.0706s/iter; left time: 2057.7695s
	iters: 700, epoch: 5 | loss: 0.3979061
	speed: 0.0697s/iter; left time: 2024.9306s
	iters: 800, epoch: 5 | loss: 0.4668379
	speed: 0.0708s/iter; left time: 2050.4622s
	iters: 900, epoch: 5 | loss: 0.5074326
	speed: 0.0668s/iter; left time: 1925.9206s
	iters: 1000, epoch: 5 | loss: 0.5126590
	speed: 0.0691s/iter; left time: 1985.5606s
	iters: 1100, epoch: 5 | loss: 0.4742877
	speed: 0.0680s/iter; left time: 1947.1960s
Epoch: 5 cost time: 81.35529708862305
Epoch: 5, Steps: 1144 | Train Loss: 0.5360145 Vali Loss: 0.5164151 Test Loss: 0.2261031
Validation loss decreased (0.519437 --> 0.516415).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.3771205
	speed: 0.4903s/iter; left time: 13973.9633s
	iters: 200, epoch: 6 | loss: 0.5596924
	speed: 0.0717s/iter; left time: 2036.3789s
	iters: 300, epoch: 6 | loss: 0.5335124
	speed: 0.0661s/iter; left time: 1871.3483s
	iters: 400, epoch: 6 | loss: 0.4445688
	speed: 0.0646s/iter; left time: 1822.9309s
	iters: 500, epoch: 6 | loss: 0.5081967
	speed: 0.0646s/iter; left time: 1815.8028s
	iters: 600, epoch: 6 | loss: 0.3808634
	speed: 0.0619s/iter; left time: 1732.5218s
	iters: 700, epoch: 6 | loss: 0.2916330
	speed: 0.0633s/iter; left time: 1766.1179s
	iters: 800, epoch: 6 | loss: 0.5312176
	speed: 0.0608s/iter; left time: 1691.0768s
	iters: 900, epoch: 6 | loss: 0.4892781
	speed: 0.0723s/iter; left time: 2001.7525s
	iters: 1000, epoch: 6 | loss: 0.3679715
	speed: 0.0656s/iter; left time: 1809.5405s
	iters: 1100, epoch: 6 | loss: 0.4452870
	speed: 0.0624s/iter; left time: 1715.3722s
Epoch: 6 cost time: 75.32266044616699
Epoch: 6, Steps: 1144 | Train Loss: 0.5273302 Vali Loss: 0.5106875 Test Loss: 0.2260454
Validation loss decreased (0.516415 --> 0.510687).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.5155160
	speed: 0.5415s/iter; left time: 14813.9818s
	iters: 200, epoch: 7 | loss: 0.3933373
	speed: 0.0628s/iter; left time: 1712.3523s
	iters: 300, epoch: 7 | loss: 0.3645548
	speed: 0.0618s/iter; left time: 1678.6630s
	iters: 400, epoch: 7 | loss: 0.5469732
	speed: 0.0666s/iter; left time: 1801.8419s
	iters: 500, epoch: 7 | loss: 0.4362691
	speed: 0.0614s/iter; left time: 1655.9857s
	iters: 600, epoch: 7 | loss: 0.4278412
	speed: 0.0738s/iter; left time: 1981.8819s
	iters: 700, epoch: 7 | loss: 0.3527654
	speed: 0.0636s/iter; left time: 1701.7190s
	iters: 800, epoch: 7 | loss: 0.8612087
	speed: 0.0615s/iter; left time: 1638.3522s
	iters: 900, epoch: 7 | loss: 0.4531908
	speed: 0.0638s/iter; left time: 1695.0837s
	iters: 1000, epoch: 7 | loss: 0.3776187
	speed: 0.0769s/iter; left time: 2035.5131s
	iters: 1100, epoch: 7 | loss: 0.5504961
	speed: 0.0679s/iter; left time: 1790.8718s
Epoch: 7 cost time: 76.19185400009155
Epoch: 7, Steps: 1144 | Train Loss: 0.5215215 Vali Loss: 0.5093577 Test Loss: 0.2230999
Validation loss decreased (0.510687 --> 0.509358).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.4120955
	speed: 0.5289s/iter; left time: 13863.3908s
	iters: 200, epoch: 8 | loss: 0.3527256
	speed: 0.0653s/iter; left time: 1705.0595s
	iters: 300, epoch: 8 | loss: 1.0108639
	speed: 0.0715s/iter; left time: 1859.5703s
	iters: 400, epoch: 8 | loss: 0.4719174
	speed: 0.0615s/iter; left time: 1593.8081s
	iters: 500, epoch: 8 | loss: 0.4770107
	speed: 0.0613s/iter; left time: 1583.4164s
	iters: 600, epoch: 8 | loss: 0.8884597
	speed: 0.0621s/iter; left time: 1595.4951s
	iters: 700, epoch: 8 | loss: 0.4588933
	speed: 0.0728s/iter; left time: 1863.7160s
	iters: 800, epoch: 8 | loss: 0.4648668
	speed: 0.0681s/iter; left time: 1737.8062s
	iters: 900, epoch: 8 | loss: 0.2741582
	speed: 0.0642s/iter; left time: 1630.4551s
	iters: 1000, epoch: 8 | loss: 0.3313088
	speed: 0.0637s/iter; left time: 1613.3233s
	iters: 1100, epoch: 8 | loss: 0.4962930
	speed: 0.0680s/iter; left time: 1715.5304s
Epoch: 8 cost time: 76.35596776008606
Epoch: 8, Steps: 1144 | Train Loss: 0.5179386 Vali Loss: 0.5049479 Test Loss: 0.2230303
Validation loss decreased (0.509358 --> 0.504948).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.4732178
	speed: 0.5187s/iter; left time: 13002.3179s
	iters: 200, epoch: 9 | loss: 0.5488619
	speed: 0.0655s/iter; left time: 1636.5324s
	iters: 300, epoch: 9 | loss: 0.5020915
	speed: 0.0664s/iter; left time: 1650.2555s
	iters: 400, epoch: 9 | loss: 0.4147316
	speed: 0.0631s/iter; left time: 1562.4301s
	iters: 500, epoch: 9 | loss: 0.5459245
	speed: 0.0681s/iter; left time: 1679.3273s
	iters: 600, epoch: 9 | loss: 0.5451459
	speed: 0.0651s/iter; left time: 1599.0437s
	iters: 700, epoch: 9 | loss: 0.3735595
	speed: 0.0654s/iter; left time: 1601.0717s
	iters: 800, epoch: 9 | loss: 0.3997743
	speed: 0.0671s/iter; left time: 1635.1690s
	iters: 900, epoch: 9 | loss: 0.9426869
	speed: 0.0661s/iter; left time: 1604.9673s
	iters: 1000, epoch: 9 | loss: 0.3663665
	speed: 0.0670s/iter; left time: 1620.2448s
	iters: 1100, epoch: 9 | loss: 0.4826602
	speed: 0.0611s/iter; left time: 1469.5151s
Epoch: 9 cost time: 75.18996572494507
Epoch: 9, Steps: 1144 | Train Loss: 0.5155320 Vali Loss: 0.5015394 Test Loss: 0.2214610
Validation loss decreased (0.504948 --> 0.501539).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.5056792
	speed: 0.5328s/iter; left time: 12746.6963s
	iters: 200, epoch: 10 | loss: 0.4107358
	speed: 0.0665s/iter; left time: 1583.1909s
	iters: 300, epoch: 10 | loss: 0.9724091
	speed: 0.0648s/iter; left time: 1536.9450s
	iters: 400, epoch: 10 | loss: 0.3796857
	speed: 0.0643s/iter; left time: 1520.0613s
	iters: 500, epoch: 10 | loss: 0.4620510
	speed: 0.0625s/iter; left time: 1470.1741s
	iters: 600, epoch: 10 | loss: 0.8895979
	speed: 0.0646s/iter; left time: 1513.0332s
	iters: 700, epoch: 10 | loss: 0.3329242
	speed: 0.0664s/iter; left time: 1548.1930s
	iters: 800, epoch: 10 | loss: 0.5171195
	speed: 0.0631s/iter; left time: 1466.5771s
	iters: 900, epoch: 10 | loss: 0.3665360
	speed: 0.0590s/iter; left time: 1363.5954s
	iters: 1000, epoch: 10 | loss: 0.3843607
	speed: 0.0676s/iter; left time: 1556.8042s
	iters: 1100, epoch: 10 | loss: 0.5085739
	speed: 0.0661s/iter; left time: 1514.4428s
Epoch: 10 cost time: 76.40229201316833
Epoch: 10, Steps: 1144 | Train Loss: 0.5128697 Vali Loss: 0.4997912 Test Loss: 0.2220601
Validation loss decreased (0.501539 --> 0.499791).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.4358674
	speed: 0.5388s/iter; left time: 12274.2695s
	iters: 200, epoch: 11 | loss: 0.4106698
	speed: 0.0638s/iter; left time: 1448.0601s
	iters: 300, epoch: 11 | loss: 0.3842789
	speed: 0.0635s/iter; left time: 1433.5665s
	iters: 400, epoch: 11 | loss: 0.5976663
	speed: 0.0694s/iter; left time: 1559.3803s
	iters: 500, epoch: 11 | loss: 0.4036670
	speed: 0.0604s/iter; left time: 1352.7572s
	iters: 600, epoch: 11 | loss: 0.8289846
	speed: 0.0646s/iter; left time: 1438.3585s
	iters: 700, epoch: 11 | loss: 0.5849080
	speed: 0.0630s/iter; left time: 1396.4054s
	iters: 800, epoch: 11 | loss: 0.4669344
	speed: 0.0713s/iter; left time: 1573.9086s
	iters: 900, epoch: 11 | loss: 0.3912319
	speed: 0.0643s/iter; left time: 1414.4077s
	iters: 1000, epoch: 11 | loss: 0.3817815
	speed: 0.0602s/iter; left time: 1316.5248s
	iters: 1100, epoch: 11 | loss: 0.4529707
	speed: 0.0628s/iter; left time: 1368.1792s
Epoch: 11 cost time: 74.91728973388672
Epoch: 11, Steps: 1144 | Train Loss: 0.5110222 Vali Loss: 0.5036523 Test Loss: 0.2228779
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.4112915
	speed: 0.5415s/iter; left time: 11716.4731s
	iters: 200, epoch: 12 | loss: 0.8550254
	speed: 0.0620s/iter; left time: 1335.5896s
	iters: 300, epoch: 12 | loss: 0.4180947
	speed: 0.0644s/iter; left time: 1380.5710s
	iters: 400, epoch: 12 | loss: 0.4258575
	speed: 0.0637s/iter; left time: 1358.7178s
	iters: 500, epoch: 12 | loss: 0.3761013
	speed: 0.0726s/iter; left time: 1542.7752s
	iters: 600, epoch: 12 | loss: 0.5400984
	speed: 0.0639s/iter; left time: 1351.4716s
	iters: 700, epoch: 12 | loss: 0.4080845
	speed: 0.0622s/iter; left time: 1309.0626s
	iters: 800, epoch: 12 | loss: 0.3524223
	speed: 0.0616s/iter; left time: 1289.3200s
	iters: 900, epoch: 12 | loss: 0.3923444
	speed: 0.0737s/iter; left time: 1535.2772s
	iters: 1000, epoch: 12 | loss: 0.7212473
	speed: 0.0653s/iter; left time: 1354.2964s
	iters: 1100, epoch: 12 | loss: 0.4053780
	speed: 0.0665s/iter; left time: 1371.7380s
Epoch: 12 cost time: 75.98904371261597
Epoch: 12, Steps: 1144 | Train Loss: 0.5093037 Vali Loss: 0.4986943 Test Loss: 0.2209655
Validation loss decreased (0.499791 --> 0.498694).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.9280432
	speed: 0.5239s/iter; left time: 10736.7947s
	iters: 200, epoch: 13 | loss: 0.4420793
	speed: 0.0736s/iter; left time: 1500.3609s
	iters: 300, epoch: 13 | loss: 0.4342068
	speed: 0.0596s/iter; left time: 1209.7071s
	iters: 400, epoch: 13 | loss: 0.8672484
	speed: 0.0661s/iter; left time: 1333.9579s
	iters: 500, epoch: 13 | loss: 0.4189579
	speed: 0.0622s/iter; left time: 1249.5353s
	iters: 600, epoch: 13 | loss: 0.5206849
	speed: 0.0742s/iter; left time: 1484.0123s
	iters: 700, epoch: 13 | loss: 0.9217450
	speed: 0.0651s/iter; left time: 1294.3484s
	iters: 800, epoch: 13 | loss: 0.4274920
	speed: 0.0633s/iter; left time: 1253.1801s
	iters: 900, epoch: 13 | loss: 0.8346797
	speed: 0.0652s/iter; left time: 1284.2982s
	iters: 1000, epoch: 13 | loss: 0.8479313
	speed: 0.0663s/iter; left time: 1299.1849s
	iters: 1100, epoch: 13 | loss: 0.3841524
	speed: 0.0666s/iter; left time: 1298.2427s
Epoch: 13 cost time: 76.2897367477417
Epoch: 13, Steps: 1144 | Train Loss: 0.5082387 Vali Loss: 0.4987956 Test Loss: 0.2216482
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.5597406
	speed: 0.5283s/iter; left time: 10221.4147s
	iters: 200, epoch: 14 | loss: 0.4971540
	speed: 0.0679s/iter; left time: 1306.2410s
	iters: 300, epoch: 14 | loss: 0.4957200
	speed: 0.0703s/iter; left time: 1345.8611s
	iters: 400, epoch: 14 | loss: 0.4159315
	speed: 0.0663s/iter; left time: 1262.1655s
	iters: 500, epoch: 14 | loss: 0.4011984
	speed: 0.0634s/iter; left time: 1201.0248s
	iters: 600, epoch: 14 | loss: 0.3787175
	speed: 0.0633s/iter; left time: 1192.2126s
	iters: 700, epoch: 14 | loss: 0.4477427
	speed: 0.0606s/iter; left time: 1136.4171s
	iters: 800, epoch: 14 | loss: 0.4051988
	speed: 0.0626s/iter; left time: 1166.7492s
	iters: 900, epoch: 14 | loss: 0.4697758
	speed: 0.0654s/iter; left time: 1213.4969s
	iters: 1000, epoch: 14 | loss: 0.4037231
	speed: 0.0600s/iter; left time: 1107.4791s
	iters: 1100, epoch: 14 | loss: 0.4125879
	speed: 0.0641s/iter; left time: 1175.5382s
Epoch: 14 cost time: 74.36422681808472
Epoch: 14, Steps: 1144 | Train Loss: 0.5069233 Vali Loss: 0.4979189 Test Loss: 0.2201126
Validation loss decreased (0.498694 --> 0.497919).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.4764957
	speed: 0.5267s/iter; left time: 9587.8672s
	iters: 200, epoch: 15 | loss: 0.5106744
	speed: 0.0657s/iter; left time: 1189.1695s
	iters: 300, epoch: 15 | loss: 0.3073584
	speed: 0.0662s/iter; left time: 1192.4737s
	iters: 400, epoch: 15 | loss: 0.9262267
	speed: 0.0640s/iter; left time: 1146.7341s
	iters: 500, epoch: 15 | loss: 0.5510176
	speed: 0.0650s/iter; left time: 1157.4799s
	iters: 600, epoch: 15 | loss: 0.8469092
	speed: 0.0649s/iter; left time: 1149.6523s
	iters: 700, epoch: 15 | loss: 0.8240949
	speed: 0.0611s/iter; left time: 1075.7830s
	iters: 800, epoch: 15 | loss: 0.3235594
	speed: 0.0623s/iter; left time: 1090.1376s
	iters: 900, epoch: 15 | loss: 0.2989803
	speed: 0.0644s/iter; left time: 1121.2021s
	iters: 1000, epoch: 15 | loss: 0.3203987
	speed: 0.0613s/iter; left time: 1059.9556s
	iters: 1100, epoch: 15 | loss: 0.4080679
	speed: 0.0712s/iter; left time: 1224.6024s
Epoch: 15 cost time: 74.94394111633301
Epoch: 15, Steps: 1144 | Train Loss: 0.5058229 Vali Loss: 0.4950491 Test Loss: 0.2205835
Validation loss decreased (0.497919 --> 0.495049).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.4338550
	speed: 0.5337s/iter; left time: 9105.3139s
	iters: 200, epoch: 16 | loss: 0.4228132
	speed: 0.0658s/iter; left time: 1116.1293s
	iters: 300, epoch: 16 | loss: 0.4167897
	speed: 0.0672s/iter; left time: 1133.7480s
	iters: 400, epoch: 16 | loss: 0.3172543
	speed: 0.0595s/iter; left time: 997.5151s
	iters: 500, epoch: 16 | loss: 0.4967182
	speed: 0.0647s/iter; left time: 1078.0684s
	iters: 600, epoch: 16 | loss: 0.3632876
	speed: 0.0636s/iter; left time: 1053.3828s
	iters: 700, epoch: 16 | loss: 0.3851892
	speed: 0.0611s/iter; left time: 1006.3106s
	iters: 800, epoch: 16 | loss: 0.3315013
	speed: 0.0757s/iter; left time: 1238.9677s
	iters: 900, epoch: 16 | loss: 0.5453702
	speed: 0.0613s/iter; left time: 997.4929s
	iters: 1000, epoch: 16 | loss: 0.5114840
	speed: 0.0597s/iter; left time: 964.2733s
	iters: 1100, epoch: 16 | loss: 0.4743672
	speed: 0.0626s/iter; left time: 1005.0440s
Epoch: 16 cost time: 74.68622612953186
Epoch: 16, Steps: 1144 | Train Loss: 0.5049322 Vali Loss: 0.4955343 Test Loss: 0.2212002
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.3609133
	speed: 0.5354s/iter; left time: 8521.7897s
	iters: 200, epoch: 17 | loss: 0.5103703
	speed: 0.0665s/iter; left time: 1052.2817s
	iters: 300, epoch: 17 | loss: 0.3523865
	speed: 0.0651s/iter; left time: 1023.3617s
	iters: 400, epoch: 17 | loss: 0.4968474
	speed: 0.0643s/iter; left time: 1004.0873s
	iters: 500, epoch: 17 | loss: 0.4254102
	speed: 0.0667s/iter; left time: 1035.3016s
	iters: 600, epoch: 17 | loss: 0.9634636
	speed: 0.0624s/iter; left time: 962.3266s
	iters: 700, epoch: 17 | loss: 0.4604515
	speed: 0.0600s/iter; left time: 919.6329s
	iters: 800, epoch: 17 | loss: 0.3519246
	speed: 0.0567s/iter; left time: 863.0146s
	iters: 900, epoch: 17 | loss: 0.4027105
	speed: 0.0603s/iter; left time: 912.1848s
	iters: 1000, epoch: 17 | loss: 0.3734494
	speed: 0.0711s/iter; left time: 1067.3451s
	iters: 1100, epoch: 17 | loss: 0.5274498
	speed: 0.0657s/iter; left time: 980.3078s
Epoch: 17 cost time: 74.2125735282898
Epoch: 17, Steps: 1144 | Train Loss: 0.5044157 Vali Loss: 0.4966092 Test Loss: 0.2200356
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.4642912
	speed: 0.5335s/iter; left time: 7881.1265s
	iters: 200, epoch: 18 | loss: 0.3309941
	speed: 0.0720s/iter; left time: 1057.0336s
	iters: 300, epoch: 18 | loss: 0.3708317
	speed: 0.0658s/iter; left time: 959.3502s
	iters: 400, epoch: 18 | loss: 0.3867970
	speed: 0.0640s/iter; left time: 926.8910s
	iters: 500, epoch: 18 | loss: 0.4115592
	speed: 0.0636s/iter; left time: 913.4188s
	iters: 600, epoch: 18 | loss: 0.3867627
	speed: 0.0752s/iter; left time: 1073.4545s
	iters: 700, epoch: 18 | loss: 0.4862973
	speed: 0.0686s/iter; left time: 971.9353s
	iters: 800, epoch: 18 | loss: 0.3602040
	speed: 0.0697s/iter; left time: 980.2202s
	iters: 900, epoch: 18 | loss: 0.3383360
	speed: 0.0694s/iter; left time: 969.9900s
	iters: 1000, epoch: 18 | loss: 0.3828974
	speed: 0.0681s/iter; left time: 945.3568s
	iters: 1100, epoch: 18 | loss: 0.3504448
	speed: 0.0685s/iter; left time: 943.5647s
Epoch: 18 cost time: 78.91027498245239
Epoch: 18, Steps: 1144 | Train Loss: 0.5033018 Vali Loss: 0.4947076 Test Loss: 0.2198246
Validation loss decreased (0.495049 --> 0.494708).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.4349693
	speed: 0.5260s/iter; left time: 7168.3563s
	iters: 200, epoch: 19 | loss: 0.3869627
	speed: 0.0701s/iter; left time: 949.0288s
	iters: 300, epoch: 19 | loss: 0.3706297
	speed: 0.0715s/iter; left time: 959.7883s
	iters: 400, epoch: 19 | loss: 0.9001206
	speed: 0.0690s/iter; left time: 919.6259s
	iters: 500, epoch: 19 | loss: 0.3900926
	speed: 0.0647s/iter; left time: 856.0983s
	iters: 600, epoch: 19 | loss: 0.4021563
	speed: 0.0676s/iter; left time: 887.7417s
	iters: 700, epoch: 19 | loss: 0.6399200
	speed: 0.0699s/iter; left time: 910.4296s
	iters: 800, epoch: 19 | loss: 0.4254426
	speed: 0.0690s/iter; left time: 891.6470s
	iters: 900, epoch: 19 | loss: 0.8777532
	speed: 0.0625s/iter; left time: 802.1499s
	iters: 1000, epoch: 19 | loss: 0.4023067
	speed: 0.0667s/iter; left time: 848.4986s
	iters: 1100, epoch: 19 | loss: 0.3488355
	speed: 0.0693s/iter; left time: 875.5174s
Epoch: 19 cost time: 78.55079126358032
Epoch: 19, Steps: 1144 | Train Loss: 0.5029494 Vali Loss: 0.4968669 Test Loss: 0.2205326
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.3265337
	speed: 0.5390s/iter; left time: 6729.2598s
	iters: 200, epoch: 20 | loss: 0.3933919
	speed: 0.0666s/iter; left time: 824.6410s
	iters: 300, epoch: 20 | loss: 0.8864518
	speed: 0.0715s/iter; left time: 878.2727s
	iters: 400, epoch: 20 | loss: 0.4354042
	speed: 0.0719s/iter; left time: 876.5387s
	iters: 500, epoch: 20 | loss: 0.5230192
	speed: 0.0659s/iter; left time: 796.8594s
	iters: 600, epoch: 20 | loss: 0.8438302
	speed: 0.0634s/iter; left time: 759.3929s
	iters: 700, epoch: 20 | loss: 0.3872046
	speed: 0.0658s/iter; left time: 782.1828s
	iters: 800, epoch: 20 | loss: 0.5246279
	speed: 0.0675s/iter; left time: 795.4529s
	iters: 900, epoch: 20 | loss: 0.3283185
	speed: 0.0697s/iter; left time: 814.0770s
	iters: 1000, epoch: 20 | loss: 0.4482405
	speed: 0.0654s/iter; left time: 757.3363s
	iters: 1100, epoch: 20 | loss: 0.4421987
	speed: 0.0649s/iter; left time: 745.3815s
Epoch: 20 cost time: 78.21119570732117
Epoch: 20, Steps: 1144 | Train Loss: 0.5024943 Vali Loss: 0.4950167 Test Loss: 0.2207552
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.5185352
	speed: 0.5544s/iter; left time: 6287.0851s
	iters: 200, epoch: 21 | loss: 0.3586551
	speed: 0.0622s/iter; left time: 699.3335s
	iters: 300, epoch: 21 | loss: 0.3932059
	speed: 0.0668s/iter; left time: 744.5024s
	iters: 400, epoch: 21 | loss: 0.3418161
	speed: 0.0656s/iter; left time: 724.0871s
	iters: 500, epoch: 21 | loss: 0.4399661
	speed: 0.0706s/iter; left time: 772.0355s
	iters: 600, epoch: 21 | loss: 0.3320535
	speed: 0.0645s/iter; left time: 699.5900s
	iters: 700, epoch: 21 | loss: 0.4792407
	speed: 0.0682s/iter; left time: 732.4703s
	iters: 800, epoch: 21 | loss: 0.4717605
	speed: 0.0617s/iter; left time: 656.3142s
	iters: 900, epoch: 21 | loss: 0.8569677
	speed: 0.0738s/iter; left time: 778.0412s
	iters: 1000, epoch: 21 | loss: 0.4141383
	speed: 0.0688s/iter; left time: 718.3397s
	iters: 1100, epoch: 21 | loss: 0.4301756
	speed: 0.0711s/iter; left time: 735.0679s
Epoch: 21 cost time: 78.41812419891357
Epoch: 21, Steps: 1144 | Train Loss: 0.5019722 Vali Loss: 0.4941736 Test Loss: 0.2195050
Validation loss decreased (0.494708 --> 0.494174).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.8651133
	speed: 0.5501s/iter; left time: 5608.9128s
	iters: 200, epoch: 22 | loss: 0.9776234
	speed: 0.0651s/iter; left time: 657.6124s
	iters: 300, epoch: 22 | loss: 0.5089571
	speed: 0.0661s/iter; left time: 660.5623s
	iters: 400, epoch: 22 | loss: 0.3855679
	speed: 0.0661s/iter; left time: 653.9499s
	iters: 500, epoch: 22 | loss: 0.5283293
	speed: 0.0766s/iter; left time: 750.5947s
	iters: 600, epoch: 22 | loss: 0.5762911
	speed: 0.0642s/iter; left time: 622.3919s
	iters: 700, epoch: 22 | loss: 0.7850801
	speed: 0.0672s/iter; left time: 645.3628s
	iters: 800, epoch: 22 | loss: 0.4832162
	speed: 0.0701s/iter; left time: 665.7194s
	iters: 900, epoch: 22 | loss: 0.3848287
	speed: 0.0708s/iter; left time: 665.0717s
	iters: 1000, epoch: 22 | loss: 0.3966508
	speed: 0.0666s/iter; left time: 619.5677s
	iters: 1100, epoch: 22 | loss: 0.4562140
	speed: 0.0701s/iter; left time: 644.9640s
Epoch: 22 cost time: 79.6048800945282
Epoch: 22, Steps: 1144 | Train Loss: 0.5015130 Vali Loss: 0.4937864 Test Loss: 0.2199540
Validation loss decreased (0.494174 --> 0.493786).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.8421670
	speed: 0.5427s/iter; left time: 4913.1231s
	iters: 200, epoch: 23 | loss: 0.4663388
	speed: 0.0683s/iter; left time: 611.1671s
	iters: 300, epoch: 23 | loss: 0.4443865
	speed: 0.0634s/iter; left time: 561.5132s
	iters: 400, epoch: 23 | loss: 0.4615060
	speed: 0.0672s/iter; left time: 588.0066s
	iters: 500, epoch: 23 | loss: 0.5876415
	speed: 0.0664s/iter; left time: 574.8145s
	iters: 600, epoch: 23 | loss: 0.4072616
	speed: 0.0648s/iter; left time: 554.6462s
	iters: 700, epoch: 23 | loss: 0.3848979
	speed: 0.0701s/iter; left time: 592.4537s
	iters: 800, epoch: 23 | loss: 0.4860377
	speed: 0.0638s/iter; left time: 532.6906s
	iters: 900, epoch: 23 | loss: 0.3829715
	speed: 0.0636s/iter; left time: 525.0223s
	iters: 1000, epoch: 23 | loss: 0.3768269
	speed: 0.0636s/iter; left time: 518.7932s
	iters: 1100, epoch: 23 | loss: 0.8849635
	speed: 0.0660s/iter; left time: 531.2926s
Epoch: 23 cost time: 77.60111832618713
Epoch: 23, Steps: 1144 | Train Loss: 0.5011368 Vali Loss: 0.4942583 Test Loss: 0.2199403
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.4316821
	speed: 0.5525s/iter; left time: 4369.3620s
	iters: 200, epoch: 24 | loss: 0.4169891
	speed: 0.0679s/iter; left time: 530.5074s
	iters: 300, epoch: 24 | loss: 0.3509836
	speed: 0.0640s/iter; left time: 493.1270s
	iters: 400, epoch: 24 | loss: 0.3577034
	speed: 0.0636s/iter; left time: 483.6011s
	iters: 500, epoch: 24 | loss: 0.8622127
	speed: 0.0642s/iter; left time: 482.2889s
	iters: 600, epoch: 24 | loss: 1.0065138
	speed: 0.0677s/iter; left time: 501.6530s
	iters: 700, epoch: 24 | loss: 0.3772069
	speed: 0.0627s/iter; left time: 458.1953s
	iters: 800, epoch: 24 | loss: 0.4226215
	speed: 0.0694s/iter; left time: 500.0510s
	iters: 900, epoch: 24 | loss: 0.8384063
	speed: 0.0654s/iter; left time: 464.8235s
	iters: 1000, epoch: 24 | loss: 0.9090082
	speed: 0.0686s/iter; left time: 480.7705s
	iters: 1100, epoch: 24 | loss: 0.4178305
	speed: 0.0662s/iter; left time: 457.6225s
Epoch: 24 cost time: 76.69801950454712
Epoch: 24, Steps: 1144 | Train Loss: 0.5006466 Vali Loss: 0.4945168 Test Loss: 0.2205242
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.4008090
	speed: 0.5368s/iter; left time: 3631.6681s
	iters: 200, epoch: 25 | loss: 0.5011194
	speed: 0.0633s/iter; left time: 421.7696s
	iters: 300, epoch: 25 | loss: 0.4577209
	speed: 0.0644s/iter; left time: 422.9462s
	iters: 400, epoch: 25 | loss: 0.3598224
	speed: 0.0636s/iter; left time: 410.9101s
	iters: 500, epoch: 25 | loss: 0.3781933
	speed: 0.0736s/iter; left time: 468.2371s
	iters: 600, epoch: 25 | loss: 0.3491247
	speed: 0.0632s/iter; left time: 395.7864s
	iters: 700, epoch: 25 | loss: 0.2883086
	speed: 0.0646s/iter; left time: 398.2184s
	iters: 800, epoch: 25 | loss: 0.3541735
	speed: 0.0620s/iter; left time: 375.9922s
	iters: 900, epoch: 25 | loss: 0.4167678
	speed: 0.0602s/iter; left time: 358.8645s
	iters: 1000, epoch: 25 | loss: 0.4087984
	speed: 0.0627s/iter; left time: 367.5711s
	iters: 1100, epoch: 25 | loss: 0.4212801
	speed: 0.0698s/iter; left time: 402.4841s
Epoch: 25 cost time: 75.07108974456787
Epoch: 25, Steps: 1144 | Train Loss: 0.5005906 Vali Loss: 0.4947886 Test Loss: 0.2197881
EarlyStopping counter: 3 out of 5
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.9613422
	speed: 0.5367s/iter; left time: 3016.9306s
	iters: 200, epoch: 26 | loss: 0.3145946
	speed: 0.0669s/iter; left time: 369.4627s
	iters: 300, epoch: 26 | loss: 0.3739042
	speed: 0.0677s/iter; left time: 367.2072s
	iters: 400, epoch: 26 | loss: 0.5187079
	speed: 0.0712s/iter; left time: 379.1129s
	iters: 500, epoch: 26 | loss: 0.4117374
	speed: 0.0621s/iter; left time: 324.3362s
	iters: 600, epoch: 26 | loss: 0.4515032
	speed: 0.0644s/iter; left time: 329.6434s
	iters: 700, epoch: 26 | loss: 0.3201528
	speed: 0.0648s/iter; left time: 325.6103s
	iters: 800, epoch: 26 | loss: 0.4420725
	speed: 0.0768s/iter; left time: 377.9134s
	iters: 900, epoch: 26 | loss: 0.4161699
	speed: 0.0661s/iter; left time: 318.7750s
	iters: 1000, epoch: 26 | loss: 0.4510203
	speed: 0.0698s/iter; left time: 329.5444s
	iters: 1100, epoch: 26 | loss: 0.4402969
	speed: 0.0667s/iter; left time: 308.0113s
Epoch: 26 cost time: 77.52696871757507
Epoch: 26, Steps: 1144 | Train Loss: 0.5002718 Vali Loss: 0.4945475 Test Loss: 0.2198253
EarlyStopping counter: 4 out of 5
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.5935386
	speed: 0.4929s/iter; left time: 2206.6350s
	iters: 200, epoch: 27 | loss: 0.3045695
	speed: 0.0630s/iter; left time: 275.8645s
	iters: 300, epoch: 27 | loss: 0.4183983
	speed: 0.0662s/iter; left time: 283.3319s
	iters: 400, epoch: 27 | loss: 0.3788734
	speed: 0.0630s/iter; left time: 263.2773s
	iters: 500, epoch: 27 | loss: 0.9687325
	speed: 0.0724s/iter; left time: 295.3467s
	iters: 600, epoch: 27 | loss: 0.4667084
	speed: 0.0661s/iter; left time: 263.0493s
	iters: 700, epoch: 27 | loss: 0.4299991
	speed: 0.0673s/iter; left time: 261.0008s
	iters: 800, epoch: 27 | loss: 0.3715668
	speed: 0.0699s/iter; left time: 264.1243s
	iters: 900, epoch: 27 | loss: 0.5209306
	speed: 0.0629s/iter; left time: 231.3137s
	iters: 1000, epoch: 27 | loss: 0.7800937
	speed: 0.0688s/iter; left time: 246.0884s
	iters: 1100, epoch: 27 | loss: 0.3412767
	speed: 0.0677s/iter; left time: 235.5474s
Epoch: 27 cost time: 77.23930335044861
Epoch: 27, Steps: 1144 | Train Loss: 0.5001013 Vali Loss: 0.4939506 Test Loss: 0.2200282
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : 96_192_PatchTST_custom_ftM_sl96_ll48_pl192_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
mse:0.22023263573646545, mae:0.2555072605609894, rse:0.6177446246147156
