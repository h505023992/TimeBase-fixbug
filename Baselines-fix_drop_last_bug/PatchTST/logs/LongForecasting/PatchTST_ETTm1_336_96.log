Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='ETTm1', data_path='ETTm1.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='TST', model='PatchTST', model_id='336_96', moving_avg=25, n_heads=16, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.4, pred_len=96, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : 336_96_PatchTST_ETTm1_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.4348989
	speed: 0.1354s/iter; left time: 3587.9334s
	iters: 200, epoch: 1 | loss: 0.3602688
	speed: 0.1453s/iter; left time: 3834.8987s
Epoch: 1 cost time: 37.63788056373596
Epoch: 1, Steps: 266 | Train Loss: 0.4422010 Vali Loss: 0.4746676 Test Loss: 0.3739114
Validation loss decreased (inf --> 0.474668).  Saving model ...
Updating learning rate to 4.147995783958166e-06
	iters: 100, epoch: 2 | loss: 0.3630393
	speed: 0.8095s/iter; left time: 21237.1965s
	iters: 200, epoch: 2 | loss: 0.3377228
	speed: 0.1361s/iter; left time: 3556.0092s
Epoch: 2 cost time: 37.90329670906067
Epoch: 2, Steps: 266 | Train Loss: 0.3441035 Vali Loss: 0.4228516 Test Loss: 0.3343315
Validation loss decreased (0.474668 --> 0.422852).  Saving model ...
Updating learning rate to 4.591070521163098e-06
	iters: 100, epoch: 3 | loss: 0.2923786
	speed: 0.7945s/iter; left time: 20632.7055s
	iters: 200, epoch: 3 | loss: 0.3172418
	speed: 0.1447s/iter; left time: 3742.1462s
Epoch: 3 cost time: 38.332844734191895
Epoch: 3, Steps: 266 | Train Loss: 0.3157589 Vali Loss: 0.4046575 Test Loss: 0.3194771
Validation loss decreased (0.422852 --> 0.404657).  Saving model ...
Updating learning rate to 5.326491995236255e-06
	iters: 100, epoch: 4 | loss: 0.3172133
	speed: 0.7936s/iter; left time: 20399.1559s
	iters: 200, epoch: 4 | loss: 0.3129337
	speed: 0.1379s/iter; left time: 3531.3348s
Epoch: 4 cost time: 37.81877565383911
Epoch: 4, Steps: 266 | Train Loss: 0.2996615 Vali Loss: 0.3952194 Test Loss: 0.3112179
Validation loss decreased (0.404657 --> 0.395219).  Saving model ...
Updating learning rate to 6.349725236277868e-06
	iters: 100, epoch: 5 | loss: 0.2832506
	speed: 0.7987s/iter; left time: 20317.3957s
	iters: 200, epoch: 5 | loss: 0.2984037
	speed: 0.1454s/iter; left time: 3682.8141s
Epoch: 5 cost time: 38.728251457214355
Epoch: 5, Steps: 266 | Train Loss: 0.2898679 Vali Loss: 0.3912868 Test Loss: 0.3054214
Validation loss decreased (0.395219 --> 0.391287).  Saving model ...
Updating learning rate to 7.654460485717921e-06
	iters: 100, epoch: 6 | loss: 0.2768218
	speed: 0.7422s/iter; left time: 18681.5620s
	iters: 200, epoch: 6 | loss: 0.2930452
	speed: 0.1334s/iter; left time: 3343.3292s
Epoch: 6 cost time: 36.244038343429565
Epoch: 6, Steps: 266 | Train Loss: 0.2832907 Vali Loss: 0.3879001 Test Loss: 0.3022876
Validation loss decreased (0.391287 --> 0.387900).  Saving model ...
Updating learning rate to 9.232652105385623e-06
	iters: 100, epoch: 7 | loss: 0.2611232
	speed: 0.7098s/iter; left time: 17677.8031s
	iters: 200, epoch: 7 | loss: 0.3004646
	speed: 0.1348s/iter; left time: 3343.7847s
Epoch: 7 cost time: 37.10910773277283
Epoch: 7, Steps: 266 | Train Loss: 0.2776327 Vali Loss: 0.3856281 Test Loss: 0.2998257
Validation loss decreased (0.387900 --> 0.385628).  Saving model ...
Updating learning rate to 1.1074568190864783e-05
	iters: 100, epoch: 8 | loss: 0.2732253
	speed: 0.7259s/iter; left time: 17884.3030s
	iters: 200, epoch: 8 | loss: 0.2802658
	speed: 0.1363s/iter; left time: 3344.5516s
Epoch: 8 cost time: 36.89964413642883
Epoch: 8, Steps: 266 | Train Loss: 0.2714981 Vali Loss: 0.3831413 Test Loss: 0.2966268
Validation loss decreased (0.385628 --> 0.383141).  Saving model ...
Updating learning rate to 1.316885058319476e-05
	iters: 100, epoch: 9 | loss: 0.2610539
	speed: 0.7490s/iter; left time: 18254.5063s
	iters: 200, epoch: 9 | loss: 0.2492885
	speed: 0.1364s/iter; left time: 3310.1188s
Epoch: 9 cost time: 37.30580806732178
Epoch: 9, Steps: 266 | Train Loss: 0.2660667 Vali Loss: 0.3777781 Test Loss: 0.2941056
Validation loss decreased (0.383141 --> 0.377778).  Saving model ...
Updating learning rate to 1.5502584908855415e-05
	iters: 100, epoch: 10 | loss: 0.2394654
	speed: 0.7380s/iter; left time: 17790.3383s
	iters: 200, epoch: 10 | loss: 0.2592066
	speed: 0.1387s/iter; left time: 3330.4809s
Epoch: 10 cost time: 37.57078742980957
Epoch: 10, Steps: 266 | Train Loss: 0.2623248 Vali Loss: 0.3818127 Test Loss: 0.2925000
EarlyStopping counter: 1 out of 20
Updating learning rate to 1.806138021613527e-05
	iters: 100, epoch: 11 | loss: 0.2851304
	speed: 0.7714s/iter; left time: 18389.8947s
	iters: 200, epoch: 11 | loss: 0.2507432
	speed: 0.1372s/iter; left time: 3257.7376s
Epoch: 11 cost time: 38.212353467941284
Epoch: 11, Steps: 266 | Train Loss: 0.2588614 Vali Loss: 0.3747653 Test Loss: 0.2910296
Validation loss decreased (0.377778 --> 0.374765).  Saving model ...
Updating learning rate to 2.0829457716805565e-05
	iters: 100, epoch: 12 | loss: 0.2755857
	speed: 0.7720s/iter; left time: 18200.3530s
	iters: 200, epoch: 12 | loss: 0.2705189
	speed: 0.1413s/iter; left time: 3316.1712s
Epoch: 12 cost time: 38.46861171722412
Epoch: 12, Steps: 266 | Train Loss: 0.2557670 Vali Loss: 0.3775672 Test Loss: 0.2910117
EarlyStopping counter: 1 out of 20
Updating learning rate to 2.3789748085875986e-05
	iters: 100, epoch: 13 | loss: 0.2302364
	speed: 0.7569s/iter; left time: 17641.8865s
	iters: 200, epoch: 13 | loss: 0.2277368
	speed: 0.1374s/iter; left time: 3188.6871s
Epoch: 13 cost time: 37.75193500518799
Epoch: 13, Steps: 266 | Train Loss: 0.2531647 Vali Loss: 0.3755027 Test Loss: 0.2896502
EarlyStopping counter: 2 out of 20
Updating learning rate to 2.6923996719433387e-05
	iters: 100, epoch: 14 | loss: 0.2508825
	speed: 0.7504s/iter; left time: 17292.0003s
	iters: 200, epoch: 14 | loss: 0.2424682
	speed: 0.1391s/iter; left time: 3190.7487s
Epoch: 14 cost time: 37.13045573234558
Epoch: 14, Steps: 266 | Train Loss: 0.2503834 Vali Loss: 0.3716669 Test Loss: 0.2910776
Validation loss decreased (0.374765 --> 0.371667).  Saving model ...
Updating learning rate to 3.021287630149266e-05
	iters: 100, epoch: 15 | loss: 0.2724970
	speed: 0.7476s/iter; left time: 17029.1055s
	iters: 200, epoch: 15 | loss: 0.2424216
	speed: 0.1351s/iter; left time: 3063.8567s
Epoch: 15 cost time: 37.73862552642822
Epoch: 15, Steps: 266 | Train Loss: 0.2481565 Vali Loss: 0.3753456 Test Loss: 0.2899711
EarlyStopping counter: 1 out of 20
Updating learning rate to 3.363610598571669e-05
	iters: 100, epoch: 16 | loss: 0.2643093
	speed: 0.7426s/iter; left time: 16716.5404s
	iters: 200, epoch: 16 | loss: 0.2633767
	speed: 0.1085s/iter; left time: 2431.4204s
Epoch: 16 cost time: 33.31600475311279
Epoch: 16, Steps: 266 | Train Loss: 0.2460940 Vali Loss: 0.3696592 Test Loss: 0.2910065
Validation loss decreased (0.371667 --> 0.369659).  Saving model ...
Updating learning rate to 3.717257645707274e-05
	iters: 100, epoch: 17 | loss: 0.2925246
	speed: 0.7225s/iter; left time: 16072.2863s
	iters: 200, epoch: 17 | loss: 0.2417852
	speed: 0.1363s/iter; left time: 3017.4774s
Epoch: 17 cost time: 36.441375732421875
Epoch: 17, Steps: 266 | Train Loss: 0.2439586 Vali Loss: 0.3707552 Test Loss: 0.2904094
EarlyStopping counter: 1 out of 20
Updating learning rate to 4.08004801022336e-05
	iters: 100, epoch: 18 | loss: 0.2597343
	speed: 0.7214s/iter; left time: 15856.7134s
	iters: 200, epoch: 18 | loss: 0.2240778
	speed: 0.1351s/iter; left time: 2955.8685s
Epoch: 18 cost time: 36.01870942115784
Epoch: 18, Steps: 266 | Train Loss: 0.2418513 Vali Loss: 0.3668652 Test Loss: 0.2925232
Validation loss decreased (0.369659 --> 0.366865).  Saving model ...
Updating learning rate to 4.4497445486028815e-05
	iters: 100, epoch: 19 | loss: 0.2443612
	speed: 0.7321s/iter; left time: 15895.2310s
	iters: 200, epoch: 19 | loss: 0.2316171
	speed: 0.1372s/iter; left time: 2964.8816s
Epoch: 19 cost time: 36.83019685745239
Epoch: 19, Steps: 266 | Train Loss: 0.2396372 Vali Loss: 0.3655657 Test Loss: 0.2901983
Validation loss decreased (0.366865 --> 0.365566).  Saving model ...
Updating learning rate to 4.8240675304698384e-05
	iters: 100, epoch: 20 | loss: 0.2482192
	speed: 0.7373s/iter; left time: 15812.6013s
	iters: 200, epoch: 20 | loss: 0.2474422
	speed: 0.1145s/iter; left time: 2444.5751s
Epoch: 20 cost time: 33.69132113456726
Epoch: 20, Steps: 266 | Train Loss: 0.2374957 Vali Loss: 0.3691831 Test Loss: 0.2909222
EarlyStopping counter: 1 out of 20
Updating learning rate to 5.2007086965261054e-05
	iters: 100, epoch: 21 | loss: 0.2347711
	speed: 0.7868s/iter; left time: 16664.3605s
	iters: 200, epoch: 21 | loss: 0.2205945
	speed: 0.1427s/iter; left time: 3009.1668s
Epoch: 21 cost time: 38.652716398239136
Epoch: 21, Steps: 266 | Train Loss: 0.2353515 Vali Loss: 0.3659968 Test Loss: 0.2914578
EarlyStopping counter: 2 out of 20
Updating learning rate to 5.5773454924116216e-05
	iters: 100, epoch: 22 | loss: 0.2470910
	speed: 0.8036s/iter; left time: 16807.7894s
	iters: 200, epoch: 22 | loss: 0.2472679
	speed: 0.1397s/iter; left time: 2907.3483s
Epoch: 22 cost time: 38.90952944755554
Epoch: 22, Steps: 266 | Train Loss: 0.2331793 Vali Loss: 0.3641673 Test Loss: 0.2936776
Validation loss decreased (0.365566 --> 0.364167).  Saving model ...
Updating learning rate to 5.95165539071495e-05
	iters: 100, epoch: 23 | loss: 0.2583292
	speed: 0.7852s/iter; left time: 16214.5420s
	iters: 200, epoch: 23 | loss: 0.2218128
	speed: 0.1530s/iter; left time: 3144.2111s
Epoch: 23 cost time: 41.07145667076111
Epoch: 23, Steps: 266 | Train Loss: 0.2310617 Vali Loss: 0.3730583 Test Loss: 0.2954981
EarlyStopping counter: 1 out of 20
Updating learning rate to 6.321330212817643e-05
	iters: 100, epoch: 24 | loss: 0.2409173
	speed: 0.8177s/iter; left time: 16668.0490s
	iters: 200, epoch: 24 | loss: 0.2174005
	speed: 0.1484s/iter; left time: 3009.9513s
Epoch: 24 cost time: 40.81800723075867
Epoch: 24, Steps: 266 | Train Loss: 0.2288977 Vali Loss: 0.3743058 Test Loss: 0.2950362
EarlyStopping counter: 2 out of 20
Updating learning rate to 6.684090362256924e-05
	iters: 100, epoch: 25 | loss: 0.2310532
	speed: 0.8391s/iter; left time: 16879.1758s
	iters: 200, epoch: 25 | loss: 0.2146866
	speed: 0.1466s/iter; left time: 2934.0547s
Epoch: 25 cost time: 40.113213300704956
Epoch: 25, Steps: 266 | Train Loss: 0.2264525 Vali Loss: 0.3726898 Test Loss: 0.2905839
EarlyStopping counter: 3 out of 20
Updating learning rate to 7.037698881836747e-05
	iters: 100, epoch: 26 | loss: 0.2095324
	speed: 0.8076s/iter; left time: 16031.8936s
	iters: 200, epoch: 26 | loss: 0.2294142
	speed: 0.1398s/iter; left time: 2760.5006s
Epoch: 26 cost time: 38.472883224487305
Epoch: 26, Steps: 266 | Train Loss: 0.2246375 Vali Loss: 0.3668181 Test Loss: 0.2898633
EarlyStopping counter: 4 out of 20
Updating learning rate to 7.379975247804219e-05
	iters: 100, epoch: 27 | loss: 0.2259058
	speed: 0.7444s/iter; left time: 14578.8010s
	iters: 200, epoch: 27 | loss: 0.2156707
	speed: 0.1384s/iter; left time: 2695.7725s
Epoch: 27 cost time: 37.358275175094604
Epoch: 27, Steps: 266 | Train Loss: 0.2224951 Vali Loss: 0.3760414 Test Loss: 0.2939679
EarlyStopping counter: 5 out of 20
Updating learning rate to 7.70880881602968e-05
	iters: 100, epoch: 28 | loss: 0.2090309
	speed: 0.7553s/iter; left time: 14592.1215s
	iters: 200, epoch: 28 | loss: 0.2178012
	speed: 0.1370s/iter; left time: 2633.5756s
Epoch: 28 cost time: 37.65439701080322
Epoch: 28, Steps: 266 | Train Loss: 0.2205694 Vali Loss: 0.3790014 Test Loss: 0.2976762
EarlyStopping counter: 6 out of 20
Updating learning rate to 8.02217183727475e-05
	iters: 100, epoch: 29 | loss: 0.2326464
	speed: 0.7551s/iter; left time: 14387.3856s
	iters: 200, epoch: 29 | loss: 0.2150610
	speed: 0.1392s/iter; left time: 2638.9243s
Epoch: 29 cost time: 37.93660116195679
Epoch: 29, Steps: 266 | Train Loss: 0.2186054 Vali Loss: 0.3807495 Test Loss: 0.2976785
EarlyStopping counter: 7 out of 20
Updating learning rate to 8.318131961289731e-05
	iters: 100, epoch: 30 | loss: 0.2223155
	speed: 0.7930s/iter; left time: 14897.4132s
	iters: 200, epoch: 30 | loss: 0.2115257
	speed: 0.1525s/iter; left time: 2849.5820s
Epoch: 30 cost time: 40.25903344154358
Epoch: 30, Steps: 266 | Train Loss: 0.2165935 Vali Loss: 0.3719726 Test Loss: 0.2965049
EarlyStopping counter: 8 out of 20
Updating learning rate to 8.59486415263404e-05
	iters: 100, epoch: 31 | loss: 0.2276828
	speed: 0.7947s/iter; left time: 14719.0625s
	iters: 200, epoch: 31 | loss: 0.2062495
	speed: 0.1604s/iter; left time: 2955.1922s
Epoch: 31 cost time: 43.24063062667847
Epoch: 31, Steps: 266 | Train Loss: 0.2144933 Vali Loss: 0.3741693 Test Loss: 0.2943296
EarlyStopping counter: 9 out of 20
Updating learning rate to 8.850661944740828e-05
	iters: 100, epoch: 32 | loss: 0.2266178
	speed: 0.7317s/iter; left time: 13357.8398s
	iters: 200, epoch: 32 | loss: 0.1869051
	speed: 0.1418s/iter; left time: 2574.7176s
Epoch: 32 cost time: 37.809061765670776
Epoch: 32, Steps: 266 | Train Loss: 0.2124946 Vali Loss: 0.3790866 Test Loss: 0.2981863
EarlyStopping counter: 10 out of 20
Updating learning rate to 9.083947962827694e-05
	iters: 100, epoch: 33 | loss: 0.2313568
	speed: 0.8808s/iter; left time: 15844.9974s
	iters: 200, epoch: 33 | loss: 0.2055199
	speed: 0.1612s/iter; left time: 2883.0005s
Epoch: 33 cost time: 42.55743908882141
Epoch: 33, Steps: 266 | Train Loss: 0.2105306 Vali Loss: 0.3859337 Test Loss: 0.3002456
EarlyStopping counter: 11 out of 20
Updating learning rate to 9.293283650764084e-05
	iters: 100, epoch: 34 | loss: 0.2154113
	speed: 0.7001s/iter; left time: 12408.4248s
	iters: 200, epoch: 34 | loss: 0.1857843
	speed: 0.1009s/iter; left time: 1777.5856s
Epoch: 34 cost time: 30.95217227935791
Epoch: 34, Steps: 266 | Train Loss: 0.2083561 Vali Loss: 0.3844033 Test Loss: 0.2976613
EarlyStopping counter: 12 out of 20
Updating learning rate to 9.477378141914727e-05
	iters: 100, epoch: 35 | loss: 0.2059008
	speed: 0.8470s/iter; left time: 14785.3158s
	iters: 200, epoch: 35 | loss: 0.1946357
	speed: 0.1616s/iter; left time: 2805.0422s
Epoch: 35 cost time: 43.87407660484314
Epoch: 35, Steps: 266 | Train Loss: 0.2066119 Vali Loss: 0.3868077 Test Loss: 0.3005702
EarlyStopping counter: 13 out of 20
Updating learning rate to 9.635096219257111e-05
	iters: 100, epoch: 36 | loss: 0.1949085
	speed: 0.9250s/iter; left time: 15902.1945s
	iters: 200, epoch: 36 | loss: 0.2274368
	speed: 0.1619s/iter; left time: 2767.4816s
Epoch: 36 cost time: 44.51288652420044
Epoch: 36, Steps: 266 | Train Loss: 0.2045058 Vali Loss: 0.4016469 Test Loss: 0.3006376
EarlyStopping counter: 14 out of 20
Updating learning rate to 9.765465315687045e-05
	iters: 100, epoch: 37 | loss: 0.2101860
	speed: 0.8566s/iter; left time: 14497.6990s
	iters: 200, epoch: 37 | loss: 0.1966486
	speed: 0.1634s/iter; left time: 2748.9578s
Epoch: 37 cost time: 41.32161998748779
Epoch: 37, Steps: 266 | Train Loss: 0.2026486 Vali Loss: 0.4077417 Test Loss: 0.3062026
EarlyStopping counter: 15 out of 20
Updating learning rate to 9.867681511344941e-05
	iters: 100, epoch: 38 | loss: 0.2065623
	speed: 0.8869s/iter; left time: 14775.2585s
	iters: 200, epoch: 38 | loss: 0.2079217
	speed: 0.1502s/iter; left time: 2486.5411s
Epoch: 38 cost time: 42.09844470024109
Epoch: 38, Steps: 266 | Train Loss: 0.2003458 Vali Loss: 0.3893987 Test Loss: 0.3071233
EarlyStopping counter: 16 out of 20
Updating learning rate to 9.941114490980398e-05
	iters: 100, epoch: 39 | loss: 0.2061788
	speed: 0.8967s/iter; left time: 14699.7276s
	iters: 200, epoch: 39 | loss: 0.2029301
	speed: 0.1571s/iter; left time: 2559.5455s
Epoch: 39 cost time: 43.95876622200012
Epoch: 39, Steps: 266 | Train Loss: 0.1987267 Vali Loss: 0.3872209 Test Loss: 0.3052620
EarlyStopping counter: 17 out of 20
Updating learning rate to 9.98531143078552e-05
	iters: 100, epoch: 40 | loss: 0.2147331
	speed: 0.8944s/iter; left time: 14424.6413s
	iters: 200, epoch: 40 | loss: 0.1865523
	speed: 0.1619s/iter; left time: 2595.2119s
Epoch: 40 cost time: 43.70326066017151
Epoch: 40, Steps: 266 | Train Loss: 0.1969696 Vali Loss: 0.3981382 Test Loss: 0.3118337
EarlyStopping counter: 18 out of 20
Updating learning rate to 9.999999903133806e-05
	iters: 100, epoch: 41 | loss: 0.1766306
	speed: 0.8854s/iter; left time: 14043.3363s
	iters: 200, epoch: 41 | loss: 0.1939289
	speed: 0.1549s/iter; left time: 2442.0873s
Epoch: 41 cost time: 42.595292806625366
Epoch: 41, Steps: 266 | Train Loss: 0.1948461 Vali Loss: 0.3950935 Test Loss: 0.3034671
EarlyStopping counter: 19 out of 20
Updating learning rate to 9.993096095176514e-05
	iters: 100, epoch: 42 | loss: 0.1799853
	speed: 0.8968s/iter; left time: 13985.7334s
	iters: 200, epoch: 42 | loss: 0.1909040
	speed: 0.1570s/iter; left time: 2433.4068s
Epoch: 42 cost time: 43.3204824924469
Epoch: 42, Steps: 266 | Train Loss: 0.1929045 Vali Loss: 0.3965842 Test Loss: 0.3079954
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : 336_96_PatchTST_ETTm1_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.2929265797138214, mae:0.343125581741333, rse:0.5150047540664673
