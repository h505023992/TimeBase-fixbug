Args in experiment:
Namespace(is_training=1, train_only=False, model_id='DLinear_electricity_192_192', model='DLinear', data='custom', root_path='./dataset/', data_path='electricity.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=192, label_len=48, pred_len=192, individual=False, embed_type=0, enc_in=321, dec_in=321, c_out=321, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DLinear_electricity_192_192_DLinear_custom_ftM_sl192_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18029
val 2441
test 5069
	iters: 100, epoch: 1 | loss: 0.4331658
	speed: 0.0740s/iter; left time: 1244.9250s
	iters: 200, epoch: 1 | loss: 0.3302857
	speed: 0.0456s/iter; left time: 761.7713s
	iters: 300, epoch: 1 | loss: 0.2760724
	speed: 0.0431s/iter; left time: 715.8521s
	iters: 400, epoch: 1 | loss: 0.2546482
	speed: 0.0379s/iter; left time: 626.7707s
	iters: 500, epoch: 1 | loss: 0.2299179
	speed: 0.0399s/iter; left time: 654.8273s
Epoch: 1 cost time: 26.577741622924805
Epoch: 1, Steps: 564 | Train Loss: 0.3678595 Vali Loss: 0.2074729 Test Loss: 0.2352604
Validation loss decreased (inf --> 0.207473).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2154219
	speed: 0.3179s/iter; left time: 5168.7952s
	iters: 200, epoch: 2 | loss: 0.2028930
	speed: 0.0427s/iter; left time: 690.4475s
	iters: 300, epoch: 2 | loss: 0.2258884
	speed: 0.0417s/iter; left time: 669.7527s
	iters: 400, epoch: 2 | loss: 0.2104125
	speed: 0.0441s/iter; left time: 703.7380s
	iters: 500, epoch: 2 | loss: 0.2025868
	speed: 0.0418s/iter; left time: 662.6358s
Epoch: 2 cost time: 24.94911527633667
Epoch: 2, Steps: 564 | Train Loss: 0.2141209 Vali Loss: 0.1765428 Test Loss: 0.2032941
Validation loss decreased (0.207473 --> 0.176543).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2065345
	speed: 0.3743s/iter; left time: 5874.3941s
	iters: 200, epoch: 3 | loss: 0.1920525
	speed: 0.0489s/iter; left time: 762.2606s
	iters: 300, epoch: 3 | loss: 0.1986772
	speed: 0.0477s/iter; left time: 738.5829s
	iters: 400, epoch: 3 | loss: 0.1971511
	speed: 0.0497s/iter; left time: 764.6724s
	iters: 500, epoch: 3 | loss: 0.1890604
	speed: 0.0463s/iter; left time: 708.6205s
Epoch: 3 cost time: 28.825057983398438
Epoch: 3, Steps: 564 | Train Loss: 0.1960086 Vali Loss: 0.1681488 Test Loss: 0.1944430
Validation loss decreased (0.176543 --> 0.168149).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2057611
	speed: 0.3821s/iter; left time: 5780.3453s
	iters: 200, epoch: 4 | loss: 0.1983416
	speed: 0.0509s/iter; left time: 765.0063s
	iters: 300, epoch: 4 | loss: 0.1880845
	speed: 0.0486s/iter; left time: 725.2501s
	iters: 400, epoch: 4 | loss: 0.2035441
	speed: 0.0468s/iter; left time: 694.3304s
	iters: 500, epoch: 4 | loss: 0.1697233
	speed: 0.0469s/iter; left time: 691.3294s
Epoch: 4 cost time: 28.785738229751587
Epoch: 4, Steps: 564 | Train Loss: 0.1899176 Vali Loss: 0.1644994 Test Loss: 0.1906261
Validation loss decreased (0.168149 --> 0.164499).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1948351
	speed: 0.3921s/iter; left time: 5710.8686s
	iters: 200, epoch: 5 | loss: 0.1668688
	speed: 0.0441s/iter; left time: 637.9819s
	iters: 300, epoch: 5 | loss: 0.2119593
	speed: 0.0394s/iter; left time: 566.2236s
	iters: 400, epoch: 5 | loss: 0.1808100
	speed: 0.0388s/iter; left time: 552.9572s
	iters: 500, epoch: 5 | loss: 0.1890171
	speed: 0.0379s/iter; left time: 537.0204s
Epoch: 5 cost time: 24.3375461101532
Epoch: 5, Steps: 564 | Train Loss: 0.1871783 Vali Loss: 0.1626530 Test Loss: 0.1889037
Validation loss decreased (0.164499 --> 0.162653).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1968871
	speed: 0.3016s/iter; left time: 4223.2578s
	iters: 200, epoch: 6 | loss: 0.1806168
	speed: 0.0393s/iter; left time: 546.2686s
	iters: 300, epoch: 6 | loss: 0.1684529
	speed: 0.0387s/iter; left time: 534.0385s
	iters: 400, epoch: 6 | loss: 0.1799037
	speed: 0.0388s/iter; left time: 530.9786s
	iters: 500, epoch: 6 | loss: 0.1859010
	speed: 0.0382s/iter; left time: 519.2363s
Epoch: 6 cost time: 23.43804430961609
Epoch: 6, Steps: 564 | Train Loss: 0.1857322 Vali Loss: 0.1618830 Test Loss: 0.1878762
Validation loss decreased (0.162653 --> 0.161883).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1967383
	speed: 0.3353s/iter; left time: 4505.1649s
	iters: 200, epoch: 7 | loss: 0.1826590
	speed: 0.0419s/iter; left time: 558.4218s
	iters: 300, epoch: 7 | loss: 0.1841931
	speed: 0.0411s/iter; left time: 543.5915s
	iters: 400, epoch: 7 | loss: 0.1786714
	speed: 0.0418s/iter; left time: 548.7509s
	iters: 500, epoch: 7 | loss: 0.2027752
	speed: 0.0430s/iter; left time: 560.1033s
Epoch: 7 cost time: 25.746550798416138
Epoch: 7, Steps: 564 | Train Loss: 0.1849413 Vali Loss: 0.1612232 Test Loss: 0.1873132
Validation loss decreased (0.161883 --> 0.161223).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1684814
	speed: 0.3905s/iter; left time: 5026.6196s
	iters: 200, epoch: 8 | loss: 0.1776967
	speed: 0.0477s/iter; left time: 609.2388s
	iters: 300, epoch: 8 | loss: 0.1894596
	speed: 0.0474s/iter; left time: 600.7923s
	iters: 400, epoch: 8 | loss: 0.1865034
	speed: 0.0495s/iter; left time: 622.4461s
	iters: 500, epoch: 8 | loss: 0.1757829
	speed: 0.0489s/iter; left time: 610.3730s
Epoch: 8 cost time: 28.644224405288696
Epoch: 8, Steps: 564 | Train Loss: 0.1846456 Vali Loss: 0.1610930 Test Loss: 0.1870314
Validation loss decreased (0.161223 --> 0.161093).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2073354
	speed: 0.4208s/iter; left time: 5179.7780s
	iters: 200, epoch: 9 | loss: 0.1869605
	speed: 0.0520s/iter; left time: 635.0429s
	iters: 300, epoch: 9 | loss: 0.1790143
	speed: 0.0497s/iter; left time: 601.6284s
	iters: 400, epoch: 9 | loss: 0.1662234
	speed: 0.0460s/iter; left time: 551.9475s
	iters: 500, epoch: 9 | loss: 0.1850948
	speed: 0.0442s/iter; left time: 526.2390s
Epoch: 9 cost time: 29.135844707489014
Epoch: 9, Steps: 564 | Train Loss: 0.1843788 Vali Loss: 0.1609345 Test Loss: 0.1868770
Validation loss decreased (0.161093 --> 0.160935).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1938893
	speed: 0.3194s/iter; left time: 3751.0275s
	iters: 200, epoch: 10 | loss: 0.1722766
	speed: 0.0354s/iter; left time: 412.2915s
	iters: 300, epoch: 10 | loss: 0.2069012
	speed: 0.0364s/iter; left time: 420.1134s
	iters: 400, epoch: 10 | loss: 0.1633110
	speed: 0.0362s/iter; left time: 413.8580s
	iters: 500, epoch: 10 | loss: 0.1901664
	speed: 0.0372s/iter; left time: 421.7849s
Epoch: 10 cost time: 21.678658485412598
Epoch: 10, Steps: 564 | Train Loss: 0.1842472 Vali Loss: 0.1608032 Test Loss: 0.1867975
Validation loss decreased (0.160935 --> 0.160803).  Saving model ...
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.1765546
	speed: 0.3068s/iter; left time: 3430.8721s
	iters: 200, epoch: 11 | loss: 0.1665084
	speed: 0.0421s/iter; left time: 466.3559s
	iters: 300, epoch: 11 | loss: 0.1762702
	speed: 0.0411s/iter; left time: 450.9175s
	iters: 400, epoch: 11 | loss: 0.1628823
	speed: 0.0406s/iter; left time: 441.9135s
	iters: 500, epoch: 11 | loss: 0.1975351
	speed: 0.0407s/iter; left time: 439.1891s
Epoch: 11 cost time: 24.578840255737305
Epoch: 11, Steps: 564 | Train Loss: 0.1842092 Vali Loss: 0.1609004 Test Loss: 0.1867568
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.1739650
	speed: 0.3380s/iter; left time: 3588.1281s
	iters: 200, epoch: 12 | loss: 0.1660395
	speed: 0.0423s/iter; left time: 444.8194s
	iters: 300, epoch: 12 | loss: 0.1871791
	speed: 0.0407s/iter; left time: 424.2831s
	iters: 400, epoch: 12 | loss: 0.1780664
	speed: 0.0404s/iter; left time: 417.0332s
	iters: 500, epoch: 12 | loss: 0.1953896
	speed: 0.0409s/iter; left time: 418.1998s
Epoch: 12 cost time: 24.704041004180908
Epoch: 12, Steps: 564 | Train Loss: 0.1841413 Vali Loss: 0.1607629 Test Loss: 0.1867357
Validation loss decreased (0.160803 --> 0.160763).  Saving model ...
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.1968777
	speed: 0.3378s/iter; left time: 3396.2002s
	iters: 200, epoch: 13 | loss: 0.1798737
	speed: 0.0435s/iter; left time: 432.5723s
	iters: 300, epoch: 13 | loss: 0.1862912
	speed: 0.0431s/iter; left time: 425.1277s
	iters: 400, epoch: 13 | loss: 0.1856433
	speed: 0.0414s/iter; left time: 404.0938s
	iters: 500, epoch: 13 | loss: 0.1767756
	speed: 0.0424s/iter; left time: 409.5281s
Epoch: 13 cost time: 25.347254514694214
Epoch: 13, Steps: 564 | Train Loss: 0.1841449 Vali Loss: 0.1608291 Test Loss: 0.1867251
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.1893550
	speed: 0.3275s/iter; left time: 3107.1770s
	iters: 200, epoch: 14 | loss: 0.1677448
	speed: 0.0422s/iter; left time: 396.1491s
	iters: 300, epoch: 14 | loss: 0.1840340
	speed: 0.0441s/iter; left time: 409.9884s
	iters: 400, epoch: 14 | loss: 0.1744251
	speed: 0.0446s/iter; left time: 409.5460s
	iters: 500, epoch: 14 | loss: 0.1812353
	speed: 0.0442s/iter; left time: 401.4160s
Epoch: 14 cost time: 25.885391235351562
Epoch: 14, Steps: 564 | Train Loss: 0.1841346 Vali Loss: 0.1607646 Test Loss: 0.1867199
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.220703125e-08
	iters: 100, epoch: 15 | loss: 0.1921418
	speed: 0.3704s/iter; left time: 3305.8721s
	iters: 200, epoch: 15 | loss: 0.1688761
	speed: 0.0483s/iter; left time: 426.4112s
	iters: 300, epoch: 15 | loss: 0.1804862
	speed: 0.0478s/iter; left time: 416.9196s
	iters: 400, epoch: 15 | loss: 0.1783587
	speed: 0.0480s/iter; left time: 413.7700s
	iters: 500, epoch: 15 | loss: 0.1990805
	speed: 0.0473s/iter; left time: 402.9854s
Epoch: 15 cost time: 28.3416166305542
Epoch: 15, Steps: 564 | Train Loss: 0.1841033 Vali Loss: 0.1608243 Test Loss: 0.1867173
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : DLinear_electricity_192_192_DLinear_custom_ftM_sl192_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5069
mse:0.18564073741436005, mae:0.2885746359825134
