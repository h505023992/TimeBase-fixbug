Args in experiment:
Namespace(is_training=1, model_id='ETTm1_192_720', model='SparseTSF', data='ETTm1', root_path='./dataset/', data_path='ETTm1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=192, label_len=48, pred_len=720, period_len=4, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=256, patience=5, learning_rate=0.02, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=2, use_multi_gpu=0, devices='0,1', test_flop=False)
Use GPU: cuda:2
>>>>>>>start training : ETTm1_192_720_SparseTSF_ETTm1_ftM_sl192_pl720_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33649
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.4949023
	speed: 0.1428s/iter; left time: 547.0067s
Epoch: 1 cost time: 16.84770917892456
Epoch: 1, Steps: 131 | Train Loss: 0.5568177 Vali Loss: 1.0216988 Test Loss: 0.4923726
Validation loss decreased (inf --> 1.021699).  Saving model ...
Updating learning rate to 0.02
	iters: 100, epoch: 2 | loss: 0.4468130
	speed: 0.2884s/iter; left time: 1066.9833s
Epoch: 2 cost time: 12.541776657104492
Epoch: 2, Steps: 131 | Train Loss: 0.4513417 Vali Loss: 0.9819464 Test Loss: 0.4507835
Validation loss decreased (1.021699 --> 0.981946).  Saving model ...
Updating learning rate to 0.02
	iters: 100, epoch: 3 | loss: 0.4418063
	speed: 0.2915s/iter; left time: 1040.2569s
Epoch: 3 cost time: 12.626634120941162
Epoch: 3, Steps: 131 | Train Loss: 0.4439252 Vali Loss: 0.9840457 Test Loss: 0.4505388
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.02
	iters: 100, epoch: 4 | loss: 0.4545109
	speed: 0.2944s/iter; left time: 1012.2949s
Epoch: 4 cost time: 12.346242189407349
Epoch: 4, Steps: 131 | Train Loss: 0.4431923 Vali Loss: 0.9823374 Test Loss: 0.4483171
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.016
	iters: 100, epoch: 5 | loss: 0.4298209
	speed: 0.3039s/iter; left time: 1004.9872s
Epoch: 5 cost time: 12.55423617362976
Epoch: 5, Steps: 131 | Train Loss: 0.4422830 Vali Loss: 0.9838576 Test Loss: 0.4461507
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.012800000000000002
	iters: 100, epoch: 6 | loss: 0.4563375
	speed: 0.2992s/iter; left time: 950.3481s
Epoch: 6 cost time: 12.830305099487305
Epoch: 6, Steps: 131 | Train Loss: 0.4414610 Vali Loss: 0.9784884 Test Loss: 0.4468573
Validation loss decreased (0.981946 --> 0.978488).  Saving model ...
Updating learning rate to 0.010240000000000003
	iters: 100, epoch: 7 | loss: 0.4497522
	speed: 0.2959s/iter; left time: 900.9133s
Epoch: 7 cost time: 12.68588638305664
Epoch: 7, Steps: 131 | Train Loss: 0.4411580 Vali Loss: 0.9807984 Test Loss: 0.4470938
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.008192000000000001
	iters: 100, epoch: 8 | loss: 0.4483587
	speed: 0.3021s/iter; left time: 880.4494s
Epoch: 8 cost time: 13.364482164382935
Epoch: 8, Steps: 131 | Train Loss: 0.4407868 Vali Loss: 0.9808487 Test Loss: 0.4457902
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.0065536000000000014
	iters: 100, epoch: 9 | loss: 0.4384647
	speed: 0.3088s/iter; left time: 859.5093s
Epoch: 9 cost time: 12.809643030166626
Epoch: 9, Steps: 131 | Train Loss: 0.4407158 Vali Loss: 0.9800472 Test Loss: 0.4463789
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.005242880000000002
	iters: 100, epoch: 10 | loss: 0.4166932
	speed: 0.2981s/iter; left time: 790.4955s
Epoch: 10 cost time: 12.516261339187622
Epoch: 10, Steps: 131 | Train Loss: 0.4403895 Vali Loss: 0.9797786 Test Loss: 0.4455786
EarlyStopping counter: 4 out of 5
Updating learning rate to 0.004194304000000002
	iters: 100, epoch: 11 | loss: 0.4403696
	speed: 0.3031s/iter; left time: 764.1305s
Epoch: 11 cost time: 12.51493501663208
Epoch: 11, Steps: 131 | Train Loss: 0.4404768 Vali Loss: 0.9792895 Test Loss: 0.4457522
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm1_192_720_SparseTSF_ETTm1_ftM_sl192_pl720_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
mse:0.4423358142375946, mae:0.4239012897014618, rse:0.632771372795105
