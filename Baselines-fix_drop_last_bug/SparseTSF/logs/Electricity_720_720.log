Args in experiment:
Namespace(is_training=1, model_id='Electricity_720_720', model='SparseTSF', data='custom', root_path='./dataset/', data_path='electricity.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=720, period_len=24, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=321, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=128, patience=5, learning_rate=0.02, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_720_720_SparseTSF_custom_ftM_sl720_pl720_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 16973
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.3229096
	speed: 0.2774s/iter; left time: 1071.1737s
Epoch: 1 cost time: 34.04282760620117
Epoch: 1, Steps: 132 | Train Loss: 0.4706403 Vali Loss: 0.2613731 Test Loss: 0.2938710
Validation loss decreased (inf --> 0.261373).  Saving model ...
Updating learning rate to 0.02
	iters: 100, epoch: 2 | loss: 0.2301656
	speed: 0.5012s/iter; left time: 1869.0590s
Epoch: 2 cost time: 29.501714944839478
Epoch: 2, Steps: 132 | Train Loss: 0.2386472 Vali Loss: 0.1781062 Test Loss: 0.2088450
Validation loss decreased (0.261373 --> 0.178106).  Saving model ...
Updating learning rate to 0.02
	iters: 100, epoch: 3 | loss: 0.2198446
	speed: 0.4838s/iter; left time: 1740.3980s
Epoch: 3 cost time: 28.04179883003235
Epoch: 3, Steps: 132 | Train Loss: 0.2200131 Vali Loss: 0.1772282 Test Loss: 0.2069740
Validation loss decreased (0.178106 --> 0.177228).  Saving model ...
Updating learning rate to 0.02
	iters: 100, epoch: 4 | loss: 0.2054476
	speed: 0.4776s/iter; left time: 1654.9855s
Epoch: 4 cost time: 28.035227060317993
Epoch: 4, Steps: 132 | Train Loss: 0.2192890 Vali Loss: 0.1760811 Test Loss: 0.2071271
Validation loss decreased (0.177228 --> 0.176081).  Saving model ...
Updating learning rate to 0.016
	iters: 100, epoch: 5 | loss: 0.2091382
	speed: 0.4909s/iter; left time: 1636.2345s
Epoch: 5 cost time: 28.463335275650024
Epoch: 5, Steps: 132 | Train Loss: 0.2192181 Vali Loss: 0.1757296 Test Loss: 0.2081956
Validation loss decreased (0.176081 --> 0.175730).  Saving model ...
Updating learning rate to 0.012800000000000002
	iters: 100, epoch: 6 | loss: 0.2271024
	speed: 0.4702s/iter; left time: 1504.9653s
Epoch: 6 cost time: 27.827625036239624
Epoch: 6, Steps: 132 | Train Loss: 0.2189689 Vali Loss: 0.1761673 Test Loss: 0.2065789
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.010240000000000003
	iters: 100, epoch: 7 | loss: 0.2321111
	speed: 0.4810s/iter; left time: 1476.3261s
Epoch: 7 cost time: 28.80234384536743
Epoch: 7, Steps: 132 | Train Loss: 0.2188343 Vali Loss: 0.1758958 Test Loss: 0.2062555
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.008192000000000001
	iters: 100, epoch: 8 | loss: 0.2146584
	speed: 0.4773s/iter; left time: 1401.9149s
Epoch: 8 cost time: 28.073617935180664
Epoch: 8, Steps: 132 | Train Loss: 0.2188667 Vali Loss: 0.1759299 Test Loss: 0.2064773
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.0065536000000000014
	iters: 100, epoch: 9 | loss: 0.2331977
	speed: 0.4866s/iter; left time: 1364.8112s
Epoch: 9 cost time: 28.48367428779602
Epoch: 9, Steps: 132 | Train Loss: 0.2188720 Vali Loss: 0.1766130 Test Loss: 0.2063589
EarlyStopping counter: 4 out of 5
Updating learning rate to 0.005242880000000002
	iters: 100, epoch: 10 | loss: 0.2106318
	speed: 0.4766s/iter; left time: 1273.8761s
Epoch: 10 cost time: 28.30413007736206
Epoch: 10, Steps: 132 | Train Loss: 0.2185924 Vali Loss: 0.1763249 Test Loss: 0.2064839
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : Electricity_720_720_SparseTSF_custom_ftM_sl720_pl720_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
mse:0.20750067925453186, mae:0.2999336211681366, rse:0.4533025324344635
