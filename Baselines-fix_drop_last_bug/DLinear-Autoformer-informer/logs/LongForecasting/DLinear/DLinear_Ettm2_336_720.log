Args in experiment:
Namespace(is_training=1, train_only=False, model_id='DLinear_ETTm2_336_720', model='DLinear', data='ETTm2', root_path='./dataset/', data_path='ETTm2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=720, individual=False, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DLinear_ETTm2_336_720_DLinear_ETTm2_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33505
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.6489356
	speed: 0.0683s/iter; left time: 2140.6311s
	iters: 200, epoch: 1 | loss: 0.5290684
	speed: 0.0450s/iter; left time: 1405.1811s
	iters: 300, epoch: 1 | loss: 0.9070542
	speed: 0.0454s/iter; left time: 1413.9136s
	iters: 400, epoch: 1 | loss: 0.9478679
	speed: 0.0437s/iter; left time: 1356.4999s
	iters: 500, epoch: 1 | loss: 0.4790477
	speed: 0.0433s/iter; left time: 1340.8196s
	iters: 600, epoch: 1 | loss: 0.5507413
	speed: 0.0430s/iter; left time: 1327.1290s
	iters: 700, epoch: 1 | loss: 0.9430810
	speed: 0.0430s/iter; left time: 1321.6044s
	iters: 800, epoch: 1 | loss: 0.4635966
	speed: 0.0393s/iter; left time: 1205.2738s
	iters: 900, epoch: 1 | loss: 0.4729967
	speed: 0.0413s/iter; left time: 1261.9681s
	iters: 1000, epoch: 1 | loss: 0.4968597
	speed: 0.0455s/iter; left time: 1383.7616s
Epoch: 1 cost time: 47.54160690307617
Epoch: 1, Steps: 1048 | Train Loss: 0.5318542 Vali Loss: 0.3295040 Test Loss: 0.4887722
Validation loss decreased (inf --> 0.329504).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6262428
	speed: 0.5805s/iter; left time: 17586.2523s
	iters: 200, epoch: 2 | loss: 0.5601301
	speed: 0.0460s/iter; left time: 1390.0496s
	iters: 300, epoch: 2 | loss: 0.7496970
	speed: 0.0456s/iter; left time: 1370.8435s
	iters: 400, epoch: 2 | loss: 0.9705422
	speed: 0.0453s/iter; left time: 1359.5318s
	iters: 500, epoch: 2 | loss: 0.5312466
	speed: 0.0413s/iter; left time: 1234.8771s
	iters: 600, epoch: 2 | loss: 0.6232418
	speed: 0.0438s/iter; left time: 1305.5407s
	iters: 700, epoch: 2 | loss: 0.3656703
	speed: 0.0429s/iter; left time: 1275.1750s
	iters: 800, epoch: 2 | loss: 0.3157285
	speed: 0.0436s/iter; left time: 1290.9847s
	iters: 900, epoch: 2 | loss: 0.2790850
	speed: 0.0437s/iter; left time: 1288.8950s
	iters: 1000, epoch: 2 | loss: 0.2715845
	speed: 0.0446s/iter; left time: 1310.7627s
Epoch: 2 cost time: 46.97597861289978
Epoch: 2, Steps: 1048 | Train Loss: 0.4895391 Vali Loss: 0.3306107 Test Loss: 0.4973556
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4414199
	speed: 0.6201s/iter; left time: 18135.3724s
	iters: 200, epoch: 3 | loss: 0.5685271
	speed: 0.0410s/iter; left time: 1194.9655s
	iters: 300, epoch: 3 | loss: 0.5337154
	speed: 0.0378s/iter; left time: 1098.5100s
	iters: 400, epoch: 3 | loss: 0.4667553
	speed: 0.0387s/iter; left time: 1120.1165s
	iters: 500, epoch: 3 | loss: 0.6026742
	speed: 0.0376s/iter; left time: 1083.6857s
	iters: 600, epoch: 3 | loss: 0.2338993
	speed: 0.0286s/iter; left time: 821.5817s
	iters: 700, epoch: 3 | loss: 0.4387973
	speed: 0.0372s/iter; left time: 1066.5235s
	iters: 800, epoch: 3 | loss: 0.3869270
	speed: 0.0350s/iter; left time: 998.8335s
	iters: 900, epoch: 3 | loss: 0.5202136
	speed: 0.0344s/iter; left time: 979.7171s
	iters: 1000, epoch: 3 | loss: 0.6516433
	speed: 0.0359s/iter; left time: 1016.5404s
Epoch: 3 cost time: 39.84843325614929
Epoch: 3, Steps: 1048 | Train Loss: 0.4852358 Vali Loss: 0.3231727 Test Loss: 0.4794191
Validation loss decreased (0.329504 --> 0.323173).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.5960165
	speed: 0.6510s/iter; left time: 18355.3565s
	iters: 200, epoch: 4 | loss: 0.3739910
	speed: 0.0598s/iter; left time: 1680.6443s
	iters: 300, epoch: 4 | loss: 0.6087450
	speed: 0.0571s/iter; left time: 1599.9033s
	iters: 400, epoch: 4 | loss: 0.5854036
	speed: 0.0541s/iter; left time: 1508.6743s
	iters: 500, epoch: 4 | loss: 0.3538048
	speed: 0.0544s/iter; left time: 1511.7909s
	iters: 600, epoch: 4 | loss: 0.4381117
	speed: 0.0582s/iter; left time: 1611.6975s
	iters: 700, epoch: 4 | loss: 0.3414390
	speed: 0.0623s/iter; left time: 1718.2448s
	iters: 800, epoch: 4 | loss: 0.3336054
	speed: 0.0600s/iter; left time: 1649.8932s
	iters: 900, epoch: 4 | loss: 0.4130531
	speed: 0.0576s/iter; left time: 1578.3159s
	iters: 1000, epoch: 4 | loss: 0.6262460
	speed: 0.0520s/iter; left time: 1420.1733s
Epoch: 4 cost time: 59.725396156311035
Epoch: 4, Steps: 1048 | Train Loss: 0.4893526 Vali Loss: 0.3169875 Test Loss: 0.4672770
Validation loss decreased (0.323173 --> 0.316988).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3954813
	speed: 0.7160s/iter; left time: 19439.1800s
	iters: 200, epoch: 5 | loss: 0.6664152
	speed: 0.0451s/iter; left time: 1220.0787s
	iters: 300, epoch: 5 | loss: 0.4439287
	speed: 0.0470s/iter; left time: 1266.7536s
	iters: 400, epoch: 5 | loss: 0.5408558
	speed: 0.0448s/iter; left time: 1202.0481s
	iters: 500, epoch: 5 | loss: 0.5672343
	speed: 0.0391s/iter; left time: 1046.4880s
	iters: 600, epoch: 5 | loss: 0.7567656
	speed: 0.0411s/iter; left time: 1095.6992s
	iters: 700, epoch: 5 | loss: 0.7103565
	speed: 0.0468s/iter; left time: 1241.6031s
	iters: 800, epoch: 5 | loss: 0.3721001
	speed: 0.0406s/iter; left time: 1073.7216s
	iters: 900, epoch: 5 | loss: 0.4846274
	speed: 0.0401s/iter; left time: 1056.8761s
	iters: 1000, epoch: 5 | loss: 0.5918422
	speed: 0.0424s/iter; left time: 1112.1075s
Epoch: 5 cost time: 46.09269428253174
Epoch: 5, Steps: 1048 | Train Loss: 0.4830555 Vali Loss: 0.3133816 Test Loss: 0.4602324
Validation loss decreased (0.316988 --> 0.313382).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3422832
	speed: 0.5196s/iter; left time: 13562.9057s
	iters: 200, epoch: 6 | loss: 0.4683710
	speed: 0.0344s/iter; left time: 895.0416s
	iters: 300, epoch: 6 | loss: 0.2965359
	speed: 0.0344s/iter; left time: 890.0514s
	iters: 400, epoch: 6 | loss: 0.3077807
	speed: 0.0340s/iter; left time: 876.7773s
	iters: 500, epoch: 6 | loss: 0.5585665
	speed: 0.0343s/iter; left time: 881.8333s
	iters: 600, epoch: 6 | loss: 0.3080482
	speed: 0.0320s/iter; left time: 820.4619s
	iters: 700, epoch: 6 | loss: 0.4138125
	speed: 0.0337s/iter; left time: 858.7735s
	iters: 800, epoch: 6 | loss: 0.3414629
	speed: 0.0348s/iter; left time: 884.6255s
	iters: 900, epoch: 6 | loss: 0.6978630
	speed: 0.0341s/iter; left time: 862.2184s
	iters: 1000, epoch: 6 | loss: 0.3840429
	speed: 0.0311s/iter; left time: 784.3625s
Epoch: 6 cost time: 36.21561360359192
Epoch: 6, Steps: 1048 | Train Loss: 0.4826697 Vali Loss: 0.3138878 Test Loss: 0.4607955
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2889339
	speed: 0.5014s/iter; left time: 12562.0459s
	iters: 200, epoch: 7 | loss: 0.5035763
	speed: 0.0463s/iter; left time: 1156.5082s
	iters: 300, epoch: 7 | loss: 0.4714023
	speed: 0.0449s/iter; left time: 1115.9355s
	iters: 400, epoch: 7 | loss: 0.4884228
	speed: 0.0443s/iter; left time: 1095.6489s
	iters: 500, epoch: 7 | loss: 0.2409233
	speed: 0.0470s/iter; left time: 1159.5429s
	iters: 600, epoch: 7 | loss: 0.2786010
	speed: 0.0439s/iter; left time: 1076.8756s
	iters: 700, epoch: 7 | loss: 0.2629594
	speed: 0.0446s/iter; left time: 1090.9771s
	iters: 800, epoch: 7 | loss: 0.3303507
	speed: 0.0443s/iter; left time: 1079.7352s
	iters: 900, epoch: 7 | loss: 0.5393978
	speed: 0.0449s/iter; left time: 1088.2182s
	iters: 1000, epoch: 7 | loss: 0.3685588
	speed: 0.0438s/iter; left time: 1056.8914s
Epoch: 7 cost time: 47.67621111869812
Epoch: 7, Steps: 1048 | Train Loss: 0.4828117 Vali Loss: 0.3138182 Test Loss: 0.4600970
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.4602093
	speed: 0.7005s/iter; left time: 16816.5934s
	iters: 200, epoch: 8 | loss: 0.2746040
	speed: 0.0587s/iter; left time: 1403.1066s
	iters: 300, epoch: 8 | loss: 0.3125924
	speed: 0.0577s/iter; left time: 1374.0814s
	iters: 400, epoch: 8 | loss: 0.5455979
	speed: 0.0582s/iter; left time: 1378.7017s
	iters: 500, epoch: 8 | loss: 0.2806274
	speed: 0.0571s/iter; left time: 1348.4540s
	iters: 600, epoch: 8 | loss: 0.5889919
	speed: 0.0570s/iter; left time: 1340.3668s
	iters: 700, epoch: 8 | loss: 0.5633196
	speed: 0.0573s/iter; left time: 1341.1401s
	iters: 800, epoch: 8 | loss: 0.2421680
	speed: 0.0575s/iter; left time: 1340.4507s
	iters: 900, epoch: 8 | loss: 0.4620016
	speed: 0.0577s/iter; left time: 1339.4299s
	iters: 1000, epoch: 8 | loss: 0.7353383
	speed: 0.0529s/iter; left time: 1221.5013s
Epoch: 8 cost time: 60.900323152542114
Epoch: 8, Steps: 1048 | Train Loss: 0.4829265 Vali Loss: 0.3135795 Test Loss: 0.4600055
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : DLinear_ETTm2_336_720_DLinear_ETTm2_ftM_sl336_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
mse:0.46018096804618835, mae:0.4649907350540161
