Args in experiment:
Namespace(is_training=1, train_only=False, model_id='weather_720_336', model='Informer', data='custom', root_path='./dataset/', data_path='weather.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=336, individual=False, embed_type=0, enc_in=21, dec_in=21, c_out=21, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : weather_720_336_Informer_custom_ftM_sl720_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35832
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.5294505
	speed: 0.4799s/iter; left time: 16077.4662s
	iters: 200, epoch: 1 | loss: 0.5063958
	speed: 0.4577s/iter; left time: 15286.3526s
	iters: 300, epoch: 1 | loss: 0.6567469
	speed: 0.4616s/iter; left time: 15370.6072s
	iters: 400, epoch: 1 | loss: 0.3257503
	speed: 0.4591s/iter; left time: 15242.0735s
	iters: 500, epoch: 1 | loss: 0.6201211
	speed: 0.4579s/iter; left time: 15157.4987s
	iters: 600, epoch: 1 | loss: 0.2556153
	speed: 0.4630s/iter; left time: 15278.5486s
	iters: 700, epoch: 1 | loss: 0.6300510
	speed: 0.4570s/iter; left time: 15035.8795s
	iters: 800, epoch: 1 | loss: 0.2507014
	speed: 0.4544s/iter; left time: 14905.0956s
	iters: 900, epoch: 1 | loss: 0.8019516
	speed: 0.4488s/iter; left time: 14676.0291s
	iters: 1000, epoch: 1 | loss: 0.2332428
	speed: 0.4576s/iter; left time: 14917.4052s
	iters: 1100, epoch: 1 | loss: 0.3051482
	speed: 0.4574s/iter; left time: 14864.6713s
Epoch: 1 cost time: 514.7615435123444
Epoch: 1, Steps: 1120 | Train Loss: 0.4577800 Vali Loss: 0.6765696 Test Loss: 0.6829132
Validation loss decreased (inf --> 0.676570).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2942000
	speed: 1.6937s/iter; left time: 54842.4301s
	iters: 200, epoch: 2 | loss: 0.2253193
	speed: 0.4588s/iter; left time: 14810.6163s
	iters: 300, epoch: 2 | loss: 0.4163571
	speed: 0.4641s/iter; left time: 14936.2606s
	iters: 400, epoch: 2 | loss: 0.2105255
	speed: 0.4542s/iter; left time: 14572.7171s
	iters: 500, epoch: 2 | loss: 0.2217600
	speed: 0.4584s/iter; left time: 14660.0618s
	iters: 600, epoch: 2 | loss: 0.1972075
	speed: 0.4431s/iter; left time: 14126.4848s
	iters: 700, epoch: 2 | loss: 0.2743064
	speed: 0.4385s/iter; left time: 13937.5435s
	iters: 800, epoch: 2 | loss: 0.2835276
	speed: 0.4551s/iter; left time: 14417.9964s
	iters: 900, epoch: 2 | loss: 0.5328913
	speed: 0.4645s/iter; left time: 14670.0120s
	iters: 1000, epoch: 2 | loss: 0.2633446
	speed: 0.4529s/iter; left time: 14258.4269s
	iters: 1100, epoch: 2 | loss: 0.1862721
	speed: 0.4625s/iter; left time: 14513.1445s
Epoch: 2 cost time: 511.6738951206207
Epoch: 2, Steps: 1120 | Train Loss: 0.3405410 Vali Loss: 0.6723793 Test Loss: 0.5874394
Validation loss decreased (0.676570 --> 0.672379).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4429900
	speed: 1.7057s/iter; left time: 53321.6340s
	iters: 200, epoch: 3 | loss: 0.4486114
	speed: 0.4631s/iter; left time: 14431.8115s
	iters: 300, epoch: 3 | loss: 0.2827545
	speed: 0.4546s/iter; left time: 14121.7453s
	iters: 400, epoch: 3 | loss: 0.4054312
	speed: 0.4498s/iter; left time: 13925.9634s
	iters: 500, epoch: 3 | loss: 0.4266017
	speed: 0.4546s/iter; left time: 14030.5420s
	iters: 600, epoch: 3 | loss: 0.1887830
	speed: 0.4602s/iter; left time: 14154.8642s
	iters: 700, epoch: 3 | loss: 0.2103624
	speed: 0.4578s/iter; left time: 14037.2182s
	iters: 800, epoch: 3 | loss: 0.3834656
	speed: 0.4625s/iter; left time: 14135.2845s
	iters: 900, epoch: 3 | loss: 0.4133535
	speed: 0.4596s/iter; left time: 14000.8044s
	iters: 1000, epoch: 3 | loss: 0.3719753
	speed: 0.4631s/iter; left time: 14060.6487s
	iters: 1100, epoch: 3 | loss: 0.1919600
	speed: 0.4568s/iter; left time: 13822.9436s
Epoch: 3 cost time: 514.0911586284637
Epoch: 3, Steps: 1120 | Train Loss: 0.2785850 Vali Loss: 0.6900710 Test Loss: 0.5875268
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1638031
	speed: 1.6992s/iter; left time: 51214.6992s
	iters: 200, epoch: 4 | loss: 0.3649073
	speed: 0.4603s/iter; left time: 13828.5229s
	iters: 300, epoch: 4 | loss: 0.2290570
	speed: 0.4622s/iter; left time: 13839.7950s
	iters: 400, epoch: 4 | loss: 0.1806418
	speed: 0.4604s/iter; left time: 13738.5048s
	iters: 500, epoch: 4 | loss: 0.3339629
	speed: 0.4603s/iter; left time: 13688.3804s
	iters: 600, epoch: 4 | loss: 0.3660018
	speed: 0.4559s/iter; left time: 13511.9879s
	iters: 700, epoch: 4 | loss: 0.1491898
	speed: 0.4616s/iter; left time: 13636.6699s
	iters: 800, epoch: 4 | loss: 0.2550303
	speed: 0.4591s/iter; left time: 13517.6397s
	iters: 900, epoch: 4 | loss: 0.1888821
	speed: 0.4579s/iter; left time: 13435.9369s
	iters: 1000, epoch: 4 | loss: 0.1980351
	speed: 0.4591s/iter; left time: 13423.2145s
	iters: 1100, epoch: 4 | loss: 0.1811928
	speed: 0.4623s/iter; left time: 13472.1261s
Epoch: 4 cost time: 516.2991700172424
Epoch: 4, Steps: 1120 | Train Loss: 0.2549767 Vali Loss: 0.7189808 Test Loss: 0.6550950
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1425700
	speed: 1.6758s/iter; left time: 48631.9716s
	iters: 200, epoch: 5 | loss: 0.2793190
	speed: 0.4625s/iter; left time: 13376.6231s
	iters: 300, epoch: 5 | loss: 0.3890054
	speed: 0.4556s/iter; left time: 13131.9592s
	iters: 400, epoch: 5 | loss: 0.3592495
	speed: 0.4591s/iter; left time: 13185.4384s
	iters: 500, epoch: 5 | loss: 0.3703804
	speed: 0.4568s/iter; left time: 13075.3833s
	iters: 600, epoch: 5 | loss: 0.1631813
	speed: 0.4640s/iter; left time: 13235.0162s
	iters: 700, epoch: 5 | loss: 0.1494085
	speed: 0.4622s/iter; left time: 13137.5608s
	iters: 800, epoch: 5 | loss: 0.1874781
	speed: 0.4596s/iter; left time: 13017.4213s
	iters: 900, epoch: 5 | loss: 0.2171104
	speed: 0.4483s/iter; left time: 12650.6162s
	iters: 1000, epoch: 5 | loss: 0.1976276
	speed: 0.4480s/iter; left time: 12598.6420s
	iters: 1100, epoch: 5 | loss: 0.1964511
	speed: 0.4571s/iter; left time: 12807.6963s
Epoch: 5 cost time: 514.0298156738281
Epoch: 5, Steps: 1120 | Train Loss: 0.2441023 Vali Loss: 0.7252571 Test Loss: 0.6681752
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : weather_720_336_Informer_custom_ftM_sl720_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
mse:0.5873922109603882, mae:0.5259840488433838
