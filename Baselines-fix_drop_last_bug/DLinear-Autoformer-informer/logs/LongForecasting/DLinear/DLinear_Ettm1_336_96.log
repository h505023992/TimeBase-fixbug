Args in experiment:
Namespace(is_training=1, train_only=False, model_id='DLinear_ETTm1_336_96', model='DLinear', data='ETTm1', root_path='./dataset/', data_path='ETTm1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=96, individual=False, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DLinear_ETTm1_336_96_DLinear_ETTm1_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.5152123
	speed: 0.0512s/iter; left time: 1634.8538s
	iters: 200, epoch: 1 | loss: 0.3675646
	speed: 0.0249s/iter; left time: 791.5960s
	iters: 300, epoch: 1 | loss: 0.3387544
	speed: 0.0215s/iter; left time: 680.4578s
	iters: 400, epoch: 1 | loss: 0.3240531
	speed: 0.0251s/iter; left time: 792.8301s
	iters: 500, epoch: 1 | loss: 0.3253661
	speed: 0.0277s/iter; left time: 873.0412s
	iters: 600, epoch: 1 | loss: 0.2601780
	speed: 0.0265s/iter; left time: 833.7264s
	iters: 700, epoch: 1 | loss: 0.2613000
	speed: 0.0257s/iter; left time: 806.1302s
	iters: 800, epoch: 1 | loss: 0.2602501
	speed: 0.0273s/iter; left time: 853.0053s
	iters: 900, epoch: 1 | loss: 0.3650035
	speed: 0.0294s/iter; left time: 915.8470s
	iters: 1000, epoch: 1 | loss: 0.2271877
	speed: 0.0270s/iter; left time: 837.6217s
Epoch: 1 cost time: 30.674603700637817
Epoch: 1, Steps: 1067 | Train Loss: 0.3384593 Vali Loss: 0.4029258 Test Loss: 0.3122826
Validation loss decreased (inf --> 0.402926).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2274939
	speed: 0.2866s/iter; left time: 8839.2075s
	iters: 200, epoch: 2 | loss: 0.3456470
	speed: 0.0333s/iter; left time: 1024.9008s
	iters: 300, epoch: 2 | loss: 0.2692528
	speed: 0.0338s/iter; left time: 1035.6634s
	iters: 400, epoch: 2 | loss: 0.2774915
	speed: 0.0315s/iter; left time: 962.0577s
	iters: 500, epoch: 2 | loss: 0.2597379
	speed: 0.0312s/iter; left time: 949.1222s
	iters: 600, epoch: 2 | loss: 0.2617450
	speed: 0.0320s/iter; left time: 972.0344s
	iters: 700, epoch: 2 | loss: 0.2791556
	speed: 0.0310s/iter; left time: 938.2326s
	iters: 800, epoch: 2 | loss: 0.2437535
	speed: 0.0314s/iter; left time: 946.7571s
	iters: 900, epoch: 2 | loss: 0.2491273
	speed: 0.0293s/iter; left time: 880.5509s
	iters: 1000, epoch: 2 | loss: 0.2989066
	speed: 0.0313s/iter; left time: 935.8664s
Epoch: 2 cost time: 34.74649953842163
Epoch: 2, Steps: 1067 | Train Loss: 0.2776979 Vali Loss: 0.3902463 Test Loss: 0.3045224
Validation loss decreased (0.402926 --> 0.390246).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2427974
	speed: 0.2425s/iter; left time: 7221.2010s
	iters: 200, epoch: 3 | loss: 0.2330741
	speed: 0.0256s/iter; left time: 759.5229s
	iters: 300, epoch: 3 | loss: 0.2617653
	speed: 0.0268s/iter; left time: 792.7605s
	iters: 400, epoch: 3 | loss: 0.2497239
	speed: 0.0261s/iter; left time: 768.4747s
	iters: 500, epoch: 3 | loss: 0.2803403
	speed: 0.0265s/iter; left time: 778.4344s
	iters: 600, epoch: 3 | loss: 0.3456709
	speed: 0.0269s/iter; left time: 787.1076s
	iters: 700, epoch: 3 | loss: 0.2576732
	speed: 0.0267s/iter; left time: 778.8800s
	iters: 800, epoch: 3 | loss: 0.2952833
	speed: 0.0257s/iter; left time: 748.5952s
	iters: 900, epoch: 3 | loss: 0.2693812
	speed: 0.0271s/iter; left time: 786.2461s
	iters: 1000, epoch: 3 | loss: 0.2747824
	speed: 0.0262s/iter; left time: 757.5373s
Epoch: 3 cost time: 28.944450855255127
Epoch: 3, Steps: 1067 | Train Loss: 0.2732812 Vali Loss: 0.3888374 Test Loss: 0.3025617
Validation loss decreased (0.390246 --> 0.388837).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2283474
	speed: 0.2725s/iter; left time: 7822.0486s
	iters: 200, epoch: 4 | loss: 0.2941580
	speed: 0.0318s/iter; left time: 908.4972s
	iters: 300, epoch: 4 | loss: 0.3558885
	speed: 0.0330s/iter; left time: 941.9657s
	iters: 400, epoch: 4 | loss: 0.2815517
	speed: 0.0302s/iter; left time: 858.0146s
	iters: 500, epoch: 4 | loss: 0.3040148
	speed: 0.0299s/iter; left time: 845.8043s
	iters: 600, epoch: 4 | loss: 0.2941563
	speed: 0.0267s/iter; left time: 752.6310s
	iters: 700, epoch: 4 | loss: 0.2362702
	speed: 0.0208s/iter; left time: 585.2623s
	iters: 800, epoch: 4 | loss: 0.2895798
	speed: 0.0240s/iter; left time: 671.7826s
	iters: 900, epoch: 4 | loss: 0.2287985
	speed: 0.0229s/iter; left time: 640.1437s
	iters: 1000, epoch: 4 | loss: 0.2876397
	speed: 0.0211s/iter; left time: 587.9204s
Epoch: 4 cost time: 29.409831285476685
Epoch: 4, Steps: 1067 | Train Loss: 0.2720442 Vali Loss: 0.3847505 Test Loss: 0.3026063
Validation loss decreased (0.388837 --> 0.384750).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2671376
	speed: 0.1963s/iter; left time: 5427.5089s
	iters: 200, epoch: 5 | loss: 0.1968943
	speed: 0.0204s/iter; left time: 562.3362s
	iters: 300, epoch: 5 | loss: 0.2490664
	speed: 0.0199s/iter; left time: 546.0268s
	iters: 400, epoch: 5 | loss: 0.3122476
	speed: 0.0210s/iter; left time: 575.4584s
	iters: 500, epoch: 5 | loss: 0.2351765
	speed: 0.0207s/iter; left time: 564.4835s
	iters: 600, epoch: 5 | loss: 0.2626564
	speed: 0.0210s/iter; left time: 569.8073s
	iters: 700, epoch: 5 | loss: 0.2643370
	speed: 0.0201s/iter; left time: 543.1050s
	iters: 800, epoch: 5 | loss: 0.2774275
	speed: 0.0211s/iter; left time: 567.8575s
	iters: 900, epoch: 5 | loss: 0.2778179
	speed: 0.0200s/iter; left time: 535.5703s
	iters: 1000, epoch: 5 | loss: 0.2808682
	speed: 0.0242s/iter; left time: 648.5045s
Epoch: 5 cost time: 23.316415071487427
Epoch: 5, Steps: 1067 | Train Loss: 0.2715041 Vali Loss: 0.3869321 Test Loss: 0.3018608
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2585272
	speed: 0.2797s/iter; left time: 7434.0584s
	iters: 200, epoch: 6 | loss: 0.2740998
	speed: 0.0350s/iter; left time: 926.2963s
	iters: 300, epoch: 6 | loss: 0.3357976
	speed: 0.0328s/iter; left time: 865.1433s
	iters: 400, epoch: 6 | loss: 0.2575268
	speed: 0.0361s/iter; left time: 947.5182s
	iters: 500, epoch: 6 | loss: 0.2792156
	speed: 0.0362s/iter; left time: 947.3048s
	iters: 600, epoch: 6 | loss: 0.2526612
	speed: 0.0362s/iter; left time: 944.6150s
	iters: 700, epoch: 6 | loss: 0.2805419
	speed: 0.0316s/iter; left time: 819.9538s
	iters: 800, epoch: 6 | loss: 0.3554766
	speed: 0.0313s/iter; left time: 810.6744s
	iters: 900, epoch: 6 | loss: 0.2685607
	speed: 0.0326s/iter; left time: 840.7456s
	iters: 1000, epoch: 6 | loss: 0.2162293
	speed: 0.0340s/iter; left time: 872.4448s
Epoch: 6 cost time: 36.760092973709106
Epoch: 6, Steps: 1067 | Train Loss: 0.2712775 Vali Loss: 0.3890426 Test Loss: 0.3019413
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2730616
	speed: 0.2821s/iter; left time: 7196.3172s
	iters: 200, epoch: 7 | loss: 0.2857012
	speed: 0.0312s/iter; left time: 792.1384s
	iters: 300, epoch: 7 | loss: 0.2673020
	speed: 0.0299s/iter; left time: 757.1871s
	iters: 400, epoch: 7 | loss: 0.2531773
	speed: 0.0300s/iter; left time: 756.4458s
	iters: 500, epoch: 7 | loss: 0.2702275
	speed: 0.0291s/iter; left time: 730.3578s
	iters: 600, epoch: 7 | loss: 0.2787845
	speed: 0.0303s/iter; left time: 758.8978s
	iters: 700, epoch: 7 | loss: 0.3572890
	speed: 0.0296s/iter; left time: 738.4437s
	iters: 800, epoch: 7 | loss: 0.2690634
	speed: 0.0268s/iter; left time: 665.4595s
	iters: 900, epoch: 7 | loss: 0.3210639
	speed: 0.0258s/iter; left time: 637.2491s
	iters: 1000, epoch: 7 | loss: 0.2514760
	speed: 0.0255s/iter; left time: 627.3989s
Epoch: 7 cost time: 31.32717800140381
Epoch: 7, Steps: 1067 | Train Loss: 0.2711738 Vali Loss: 0.3854283 Test Loss: 0.3017788
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : DLinear_ETTm1_336_96_DLinear_ETTm1_ftM_sl336_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.30317991971969604, mae:0.34692081809043884
