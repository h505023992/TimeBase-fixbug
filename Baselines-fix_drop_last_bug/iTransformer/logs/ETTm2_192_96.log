Args in experiment:
Namespace(is_training=1, model_id='ETTm2_192_96', model='iTransformer', data='ETTm2', root_path='./dataset/', data_path='ETTm2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=192, label_len=48, pred_len=96, enc_in=7, dec_in=7, c_out=7, d_model=128, n_heads=8, e_layers=2, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='MSE', lradj='type1', use_amp=False, use_gpu=True, gpu=2, use_multi_gpu=False, devices='0,1,2,3', exp_name='MTSF', channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv', efficient_training=False, use_norm=True, partial_start_index=0)
Use GPU: cuda:2
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.dropout.Dropout'>.
[INFO] Register count_convNd() for <class 'torch.nn.modules.conv.Conv1d'>.
[INFO] Register count_normalization() for <class 'torch.nn.modules.normalization.LayerNorm'>.
MACs: 3068416.0
Params: 236512.0
3.07M MACs
>>>>>>>start training : ETTm2_192_96_iTransformer_ETTm2_M_ft192_sl48_ll96_pl128_dm8_nh2_el1_dl128_df1_fctimeF_ebTrue_dtExp_projection_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34273
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.3788789
	speed: 0.0846s/iter; left time: 897.3320s
	iters: 200, epoch: 1 | loss: 0.1554624
	speed: 0.0585s/iter; left time: 614.6596s
	iters: 300, epoch: 1 | loss: 0.1797715
	speed: 0.0530s/iter; left time: 552.2327s
	iters: 400, epoch: 1 | loss: 0.2538843
	speed: 0.0479s/iter; left time: 494.3388s
	iters: 500, epoch: 1 | loss: 0.4266784
	speed: 0.0432s/iter; left time: 441.5311s
	iters: 600, epoch: 1 | loss: 0.1876586
	speed: 0.0453s/iter; left time: 457.7840s
	iters: 700, epoch: 1 | loss: 0.1573348
	speed: 0.0467s/iter; left time: 467.2466s
	iters: 800, epoch: 1 | loss: 0.1717877
	speed: 0.0489s/iter; left time: 484.7440s
	iters: 900, epoch: 1 | loss: 0.1415430
	speed: 0.0555s/iter; left time: 544.2440s
	iters: 1000, epoch: 1 | loss: 0.2549356
	speed: 0.0546s/iter; left time: 530.0219s
Max Memory (MB): 13.1796875
Epoch: 1 cost time: 57.86238193511963
Epoch: 1, Steps: 1071 | Train Loss: 0.2499374 Vali Loss: 0.1310526 Test Loss: 0.1779745
Validation loss decreased (inf --> 0.131053).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1937629
	speed: 2.0269s/iter; left time: 19336.2820s
	iters: 200, epoch: 2 | loss: 0.1633652
	speed: 0.0502s/iter; left time: 474.2477s
	iters: 300, epoch: 2 | loss: 0.1695269
	speed: 0.0499s/iter; left time: 465.6399s
	iters: 400, epoch: 2 | loss: 0.1781111
	speed: 0.0511s/iter; left time: 472.5435s
	iters: 500, epoch: 2 | loss: 0.3595594
	speed: 0.0555s/iter; left time: 507.6016s
	iters: 600, epoch: 2 | loss: 0.1446545
	speed: 0.0532s/iter; left time: 480.6395s
	iters: 700, epoch: 2 | loss: 0.2288531
	speed: 0.0540s/iter; left time: 482.9133s
	iters: 800, epoch: 2 | loss: 0.1514478
	speed: 0.0578s/iter; left time: 511.2813s
	iters: 900, epoch: 2 | loss: 0.1969446
	speed: 0.0538s/iter; left time: 470.4265s
	iters: 1000, epoch: 2 | loss: 0.1633200
	speed: 0.0525s/iter; left time: 453.5699s
Max Memory (MB): 13.1796875
Epoch: 2 cost time: 57.83516836166382
Epoch: 2, Steps: 1071 | Train Loss: 0.2089852 Vali Loss: 0.1355803 Test Loss: 0.1825391
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1204518
	speed: 1.9384s/iter; left time: 16416.0894s
	iters: 200, epoch: 3 | loss: 0.1996542
	speed: 0.0523s/iter; left time: 437.9809s
	iters: 300, epoch: 3 | loss: 0.0976037
	speed: 0.0505s/iter; left time: 417.5385s
	iters: 400, epoch: 3 | loss: 0.0977448
	speed: 0.0511s/iter; left time: 417.4203s
	iters: 500, epoch: 3 | loss: 0.2087764
	speed: 0.0522s/iter; left time: 420.8860s
	iters: 600, epoch: 3 | loss: 0.1457305
	speed: 0.0505s/iter; left time: 402.6996s
	iters: 700, epoch: 3 | loss: 0.1129111
	speed: 0.0508s/iter; left time: 399.6814s
	iters: 800, epoch: 3 | loss: 0.1790459
	speed: 0.0523s/iter; left time: 405.9501s
	iters: 900, epoch: 3 | loss: 0.1690228
	speed: 0.0492s/iter; left time: 377.5878s
	iters: 1000, epoch: 3 | loss: 0.1334400
	speed: 0.0470s/iter; left time: 355.7279s
Max Memory (MB): 13.1796875
Epoch: 3 cost time: 55.67149829864502
Epoch: 3, Steps: 1071 | Train Loss: 0.1907704 Vali Loss: 0.1357799 Test Loss: 0.1837186
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1219614
	speed: 2.1370s/iter; left time: 15809.8222s
	iters: 200, epoch: 4 | loss: 0.1564612
	speed: 0.0570s/iter; left time: 416.3123s
	iters: 300, epoch: 4 | loss: 0.1781623
	speed: 0.0524s/iter; left time: 376.9242s
	iters: 400, epoch: 4 | loss: 0.1281560
	speed: 0.0513s/iter; left time: 364.1550s
	iters: 500, epoch: 4 | loss: 0.1161615
	speed: 0.0497s/iter; left time: 347.8282s
	iters: 600, epoch: 4 | loss: 0.1728954
	speed: 0.0523s/iter; left time: 360.5816s
	iters: 700, epoch: 4 | loss: 0.2120869
	speed: 0.0525s/iter; left time: 356.8856s
	iters: 800, epoch: 4 | loss: 0.3355832
	speed: 0.0632s/iter; left time: 423.1983s
	iters: 900, epoch: 4 | loss: 0.1531847
	speed: 0.0587s/iter; left time: 387.4015s
	iters: 1000, epoch: 4 | loss: 0.1412087
	speed: 0.0573s/iter; left time: 372.4781s
Max Memory (MB): 13.1796875
Epoch: 4 cost time: 61.50075840950012
Epoch: 4, Steps: 1071 | Train Loss: 0.1835766 Vali Loss: 0.1336412 Test Loss: 0.1829282
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm2_192_96_iTransformer_ETTm2_M_ft192_sl48_ll96_pl128_dm8_nh2_el1_dl128_df1_fctimeF_ebTrue_dtExp_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
test shape: (11425, 1, 96, 7) (11425, 1, 96, 7)
test shape: (11425, 96, 7) (11425, 96, 7)
mse:0.17797447741031647, mae:0.2676127552986145
