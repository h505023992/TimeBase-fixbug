Args in experiment:
Namespace(is_training=1, model_id='ETTm2_336_192', model='iTransformer', data='ETTm2', root_path='./dataset/', data_path='ETTm2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=192, enc_in=7, dec_in=7, c_out=7, d_model=128, n_heads=8, e_layers=2, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='MSE', lradj='type1', use_amp=False, use_gpu=True, gpu=2, use_multi_gpu=False, devices='0,1,2,3', exp_name='MTSF', channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv', efficient_training=False, use_norm=True, partial_start_index=0)
Use GPU: cuda:2
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.dropout.Dropout'>.
[INFO] Register count_convNd() for <class 'torch.nn.modules.conv.Conv1d'>.
[INFO] Register count_normalization() for <class 'torch.nn.modules.normalization.LayerNorm'>.
MACs: 3467776.0
Params: 267328.0
3.47M MACs
>>>>>>>start training : ETTm2_336_192_iTransformer_ETTm2_M_ft336_sl48_ll192_pl128_dm8_nh2_el1_dl128_df1_fctimeF_ebTrue_dtExp_projection_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34033
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.3612571
	speed: 0.1122s/iter; left time: 1181.2148s
	iters: 200, epoch: 1 | loss: 0.2065917
	speed: 0.0933s/iter; left time: 973.4712s
	iters: 300, epoch: 1 | loss: 0.3597641
	speed: 0.0939s/iter; left time: 969.8920s
	iters: 400, epoch: 1 | loss: 0.2035773
	speed: 0.0827s/iter; left time: 845.8441s
	iters: 500, epoch: 1 | loss: 0.3396488
	speed: 0.0782s/iter; left time: 792.1039s
	iters: 600, epoch: 1 | loss: 0.4420524
	speed: 0.0739s/iter; left time: 741.3785s
	iters: 700, epoch: 1 | loss: 0.3113039
	speed: 0.0585s/iter; left time: 581.2954s
	iters: 800, epoch: 1 | loss: 0.3276830
	speed: 0.0562s/iter; left time: 552.4516s
	iters: 900, epoch: 1 | loss: 0.2542320
	speed: 0.0567s/iter; left time: 552.1832s
	iters: 1000, epoch: 1 | loss: 0.2745078
	speed: 0.0736s/iter; left time: 708.5131s
Max Memory (MB): 14.53515625
Epoch: 1 cost time: 83.24951195716858
Epoch: 1, Steps: 1063 | Train Loss: 0.3231758 Vali Loss: 0.1748362 Test Loss: 0.2394760
Validation loss decreased (inf --> 0.174836).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2344969
	speed: 2.0905s/iter; left time: 19792.8298s
	iters: 200, epoch: 2 | loss: 0.2594086
	speed: 0.0910s/iter; left time: 852.4934s
	iters: 300, epoch: 2 | loss: 0.2515528
	speed: 0.0854s/iter; left time: 791.1146s
	iters: 400, epoch: 2 | loss: 0.4919938
	speed: 0.0836s/iter; left time: 766.0809s
	iters: 500, epoch: 2 | loss: 0.3146511
	speed: 0.0860s/iter; left time: 780.0769s
	iters: 600, epoch: 2 | loss: 0.2676643
	speed: 0.0930s/iter; left time: 833.6957s
	iters: 700, epoch: 2 | loss: 0.2005320
	speed: 0.0867s/iter; left time: 768.8493s
	iters: 800, epoch: 2 | loss: 0.1571788
	speed: 0.0919s/iter; left time: 805.5945s
	iters: 900, epoch: 2 | loss: 0.4303042
	speed: 0.0894s/iter; left time: 775.0026s
	iters: 1000, epoch: 2 | loss: 0.2297980
	speed: 0.0842s/iter; left time: 721.2575s
Max Memory (MB): 14.53515625
Epoch: 2 cost time: 94.16720938682556
Epoch: 2, Steps: 1063 | Train Loss: 0.2623655 Vali Loss: 0.1761975 Test Loss: 0.2450469
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1536860
	speed: 2.1968s/iter; left time: 18463.7085s
	iters: 200, epoch: 3 | loss: 0.2820885
	speed: 0.0876s/iter; left time: 727.4883s
	iters: 300, epoch: 3 | loss: 0.1967679
	speed: 0.0865s/iter; left time: 709.5344s
	iters: 400, epoch: 3 | loss: 0.1492234
	speed: 0.0745s/iter; left time: 604.1664s
	iters: 500, epoch: 3 | loss: 0.1627545
	speed: 0.0791s/iter; left time: 633.3470s
	iters: 600, epoch: 3 | loss: 0.2802615
	speed: 0.0808s/iter; left time: 638.8974s
	iters: 700, epoch: 3 | loss: 0.2952728
	speed: 0.0851s/iter; left time: 664.0433s
	iters: 800, epoch: 3 | loss: 0.2281978
	speed: 0.0852s/iter; left time: 656.3202s
	iters: 900, epoch: 3 | loss: 0.2176971
	speed: 0.0829s/iter; left time: 630.5002s
	iters: 1000, epoch: 3 | loss: 0.1580838
	speed: 0.0865s/iter; left time: 649.5271s
Max Memory (MB): 14.53515625
Epoch: 3 cost time: 90.4357283115387
Epoch: 3, Steps: 1063 | Train Loss: 0.2365162 Vali Loss: 0.1786342 Test Loss: 0.2445354
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1758085
	speed: 2.2509s/iter; left time: 16525.9963s
	iters: 200, epoch: 4 | loss: 0.2032246
	speed: 0.0808s/iter; left time: 585.2437s
	iters: 300, epoch: 4 | loss: 0.2714812
	speed: 0.0865s/iter; left time: 617.4470s
	iters: 400, epoch: 4 | loss: 0.2894240
	speed: 0.0822s/iter; left time: 578.8766s
	iters: 500, epoch: 4 | loss: 0.1614145
	speed: 0.0819s/iter; left time: 568.7464s
	iters: 600, epoch: 4 | loss: 0.2408219
	speed: 0.0809s/iter; left time: 553.7506s
	iters: 700, epoch: 4 | loss: 0.2147672
	speed: 0.0818s/iter; left time: 551.6543s
	iters: 800, epoch: 4 | loss: 0.2628297
	speed: 0.0829s/iter; left time: 550.3583s
	iters: 900, epoch: 4 | loss: 0.2140109
	speed: 0.0825s/iter; left time: 539.8984s
	iters: 1000, epoch: 4 | loss: 0.1873116
	speed: 0.0829s/iter; left time: 533.9258s
Max Memory (MB): 14.53515625
Epoch: 4 cost time: 88.27398443222046
Epoch: 4, Steps: 1063 | Train Loss: 0.2266693 Vali Loss: 0.1788415 Test Loss: 0.2434370
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm2_336_192_iTransformer_ETTm2_M_ft336_sl48_ll192_pl128_dm8_nh2_el1_dl128_df1_fctimeF_ebTrue_dtExp_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
test shape: (11329, 1, 192, 7) (11329, 1, 192, 7)
test shape: (11329, 192, 7) (11329, 192, 7)
mse:0.23947583138942719, mae:0.3107094466686249
