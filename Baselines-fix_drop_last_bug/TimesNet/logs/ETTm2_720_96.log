True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm2_720_96        Model:              TimesNet            

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/          
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            720                 Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm2_720_96_TimesNet_ETTm2_ftM_sl720_ll48_pl96_dm16_nh8_el2_dl1_df32_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.1908590
	speed: 0.2958s/iter; left time: 9331.5181s
	iters: 200, epoch: 1 | loss: 0.4654067
	speed: 0.2397s/iter; left time: 7537.7524s
	iters: 300, epoch: 1 | loss: 0.4284883
	speed: 0.2338s/iter; left time: 7330.9622s
	iters: 400, epoch: 1 | loss: 0.2995868
	speed: 0.2223s/iter; left time: 6948.3609s
	iters: 500, epoch: 1 | loss: 0.1346060
	speed: 0.2168s/iter; left time: 6754.9217s
	iters: 600, epoch: 1 | loss: 0.2184227
	speed: 0.2363s/iter; left time: 7337.4719s
	iters: 700, epoch: 1 | loss: 0.1142100
	speed: 0.2052s/iter; left time: 6351.9473s
	iters: 800, epoch: 1 | loss: 0.2585132
	speed: 0.1912s/iter; left time: 5897.2691s
	iters: 900, epoch: 1 | loss: 0.2620223
	speed: 0.1955s/iter; left time: 6011.8748s
	iters: 1000, epoch: 1 | loss: 0.1538435
	speed: 0.2041s/iter; left time: 6256.5511s
Epoch: 1 cost time: 234.98759818077087
Epoch: 1, Steps: 1055 | Train Loss: 0.2585521 Vali Loss: 0.1389193 Test Loss: 0.1999232
Validation loss decreased (inf --> 0.138919).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1320737
	speed: 1.1948s/iter; left time: 36436.7852s
	iters: 200, epoch: 2 | loss: 0.3201870
	speed: 0.2114s/iter; left time: 6424.7920s
	iters: 300, epoch: 2 | loss: 0.1399267
	speed: 0.2287s/iter; left time: 6929.9274s
	iters: 400, epoch: 2 | loss: 0.2951899
	speed: 0.2234s/iter; left time: 6746.6675s
	iters: 500, epoch: 2 | loss: 0.2440843
	speed: 0.2208s/iter; left time: 6644.8107s
	iters: 600, epoch: 2 | loss: 0.1126110
	speed: 0.2023s/iter; left time: 6069.0986s
	iters: 700, epoch: 2 | loss: 0.1671050
	speed: 0.2117s/iter; left time: 6329.7143s
	iters: 800, epoch: 2 | loss: 0.1360005
	speed: 0.2289s/iter; left time: 6819.7897s
	iters: 900, epoch: 2 | loss: 0.2079654
	speed: 0.2264s/iter; left time: 6723.5283s
	iters: 1000, epoch: 2 | loss: 0.1281806
	speed: 0.2191s/iter; left time: 6484.8740s
Epoch: 2 cost time: 229.80745100975037
Epoch: 2, Steps: 1055 | Train Loss: 0.1892379 Vali Loss: 0.1432503 Test Loss: 0.2124607
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1927729
	speed: 1.2592s/iter; left time: 37072.8723s
	iters: 200, epoch: 3 | loss: 0.1460987
	speed: 0.2120s/iter; left time: 6219.8846s
	iters: 300, epoch: 3 | loss: 0.1468318
	speed: 0.2102s/iter; left time: 6145.4156s
	iters: 400, epoch: 3 | loss: 0.2154403
	speed: 0.2219s/iter; left time: 6465.6375s
	iters: 500, epoch: 3 | loss: 0.1856791
	speed: 0.2197s/iter; left time: 6380.3283s
	iters: 600, epoch: 3 | loss: 0.1886763
	speed: 0.2213s/iter; left time: 6404.1131s
	iters: 700, epoch: 3 | loss: 0.1777748
	speed: 0.2221s/iter; left time: 6404.2467s
	iters: 800, epoch: 3 | loss: 0.1444485
	speed: 0.2149s/iter; left time: 6175.4252s
	iters: 900, epoch: 3 | loss: 0.2236507
	speed: 0.1999s/iter; left time: 5724.8356s
	iters: 1000, epoch: 3 | loss: 0.1137776
	speed: 0.2087s/iter; left time: 5957.6614s
Epoch: 3 cost time: 226.95360255241394
Epoch: 3, Steps: 1055 | Train Loss: 0.1614677 Vali Loss: 0.1428319 Test Loss: 0.2105803
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1610877
	speed: 1.2577s/iter; left time: 35700.3521s
	iters: 200, epoch: 4 | loss: 0.0925301
	speed: 0.2295s/iter; left time: 6491.1546s
	iters: 300, epoch: 4 | loss: 0.1119459
	speed: 0.2143s/iter; left time: 6039.6504s
	iters: 400, epoch: 4 | loss: 0.1599875
	speed: 0.2219s/iter; left time: 6231.7004s
	iters: 500, epoch: 4 | loss: 0.1855126
	speed: 0.2375s/iter; left time: 6647.8299s
	iters: 600, epoch: 4 | loss: 0.1455050
	speed: 0.2153s/iter; left time: 6004.0145s
	iters: 700, epoch: 4 | loss: 0.1254647
	speed: 0.2125s/iter; left time: 5904.6864s
	iters: 800, epoch: 4 | loss: 0.2138958
	speed: 0.2342s/iter; left time: 6482.8325s
	iters: 900, epoch: 4 | loss: 0.0967731
	speed: 0.2056s/iter; left time: 5670.6178s
	iters: 1000, epoch: 4 | loss: 0.1549030
	speed: 0.2164s/iter; left time: 5946.7836s
Epoch: 4 cost time: 233.45870852470398
Epoch: 4, Steps: 1055 | Train Loss: 0.1498742 Vali Loss: 0.1418260 Test Loss: 0.2149993
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm2_720_96_TimesNet_ETTm2_ftM_sl720_ll48_pl96_dm16_nh8_el2_dl1_df32_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
test shape: (11425, 96, 7) (11425, 96, 7)
test shape: (11425, 96, 7) (11425, 96, 7)
mse:0.19985370337963104, mae:0.28762829303741455, dtw:not calculated
