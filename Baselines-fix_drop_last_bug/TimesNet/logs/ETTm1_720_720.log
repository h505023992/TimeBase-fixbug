True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm1_720_96        Model:              TimesNet            

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/          
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            720                 Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm1_720_96_TimesNet_ETTm1_ftM_sl720_ll48_pl720_dm16_nh8_el2_dl1_df32_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33121
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.4774807
	speed: 0.2678s/iter; left time: 8297.0830s
	iters: 200, epoch: 1 | loss: 0.4442143
	speed: 0.2358s/iter; left time: 7281.2607s
	iters: 300, epoch: 1 | loss: 0.4049762
	speed: 0.2446s/iter; left time: 7529.5117s
	iters: 400, epoch: 1 | loss: 0.4068976
	speed: 0.2460s/iter; left time: 7546.2048s
	iters: 500, epoch: 1 | loss: 0.3768143
	speed: 0.2302s/iter; left time: 7038.5682s
	iters: 600, epoch: 1 | loss: 0.3051206
	speed: 0.2391s/iter; left time: 7289.4493s
	iters: 700, epoch: 1 | loss: 0.3492902
	speed: 0.2351s/iter; left time: 7143.5064s
	iters: 800, epoch: 1 | loss: 0.3518254
	speed: 0.2440s/iter; left time: 7387.4155s
	iters: 900, epoch: 1 | loss: 0.3449989
	speed: 0.2275s/iter; left time: 6866.4868s
	iters: 1000, epoch: 1 | loss: 0.3156250
	speed: 0.2441s/iter; left time: 7342.4023s
Epoch: 1 cost time: 250.31839680671692
Epoch: 1, Steps: 1036 | Train Loss: 0.3911960 Vali Loss: 1.0910852 Test Loss: 0.4771475
Validation loss decreased (inf --> 1.091085).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2974384
	speed: 1.5660s/iter; left time: 46893.0368s
	iters: 200, epoch: 2 | loss: 0.3192240
	speed: 0.2320s/iter; left time: 6924.2935s
	iters: 300, epoch: 2 | loss: 0.2992493
	speed: 0.2309s/iter; left time: 6868.7827s
	iters: 400, epoch: 2 | loss: 0.3027973
	speed: 0.2559s/iter; left time: 7587.2247s
	iters: 500, epoch: 2 | loss: 0.2756401
	speed: 0.2225s/iter; left time: 6573.2646s
	iters: 600, epoch: 2 | loss: 0.2949277
	speed: 0.2470s/iter; left time: 7272.3336s
	iters: 700, epoch: 2 | loss: 0.2761921
	speed: 0.2260s/iter; left time: 6632.2563s
	iters: 800, epoch: 2 | loss: 0.2402620
	speed: 0.2415s/iter; left time: 7062.8285s
	iters: 900, epoch: 2 | loss: 0.2717459
	speed: 0.2233s/iter; left time: 6507.6076s
	iters: 1000, epoch: 2 | loss: 0.2388843
	speed: 0.2431s/iter; left time: 7061.3757s
Epoch: 2 cost time: 246.42393469810486
Epoch: 2, Steps: 1036 | Train Loss: 0.2879107 Vali Loss: 1.1911001 Test Loss: 0.6105760
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2473381
	speed: 1.4756s/iter; left time: 42659.3934s
	iters: 200, epoch: 3 | loss: 0.2443231
	speed: 0.2273s/iter; left time: 6549.3148s
	iters: 300, epoch: 3 | loss: 0.2711375
	speed: 0.2373s/iter; left time: 6813.9850s
	iters: 400, epoch: 3 | loss: 0.2405759
	speed: 0.2476s/iter; left time: 7084.8817s
	iters: 500, epoch: 3 | loss: 0.2536637
	speed: 0.2434s/iter; left time: 6938.9484s
	iters: 600, epoch: 3 | loss: 0.2469855
	speed: 0.2437s/iter; left time: 6922.0773s
	iters: 700, epoch: 3 | loss: 0.2501585
	speed: 0.2358s/iter; left time: 6674.7207s
	iters: 800, epoch: 3 | loss: 0.2236055
	speed: 0.2422s/iter; left time: 6831.7755s
	iters: 900, epoch: 3 | loss: 0.2040686
	speed: 0.2313s/iter; left time: 6502.4277s
	iters: 1000, epoch: 3 | loss: 0.2171593
	speed: 0.2213s/iter; left time: 6197.9920s
Epoch: 3 cost time: 246.52029156684875
Epoch: 3, Steps: 1036 | Train Loss: 0.2393804 Vali Loss: 1.2419764 Test Loss: 0.6724327
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2116970
	speed: 1.4689s/iter; left time: 40942.2314s
	iters: 200, epoch: 4 | loss: 0.2404580
	speed: 0.2258s/iter; left time: 6269.8631s
	iters: 300, epoch: 4 | loss: 0.2411239
	speed: 0.2189s/iter; left time: 6056.3550s
	iters: 400, epoch: 4 | loss: 0.1963269
	speed: 0.2301s/iter; left time: 6344.8158s
	iters: 500, epoch: 4 | loss: 0.2117710
	speed: 0.2414s/iter; left time: 6630.6591s
	iters: 600, epoch: 4 | loss: 0.2345463
	speed: 0.2409s/iter; left time: 6593.9338s
	iters: 700, epoch: 4 | loss: 0.2126267
	speed: 0.2571s/iter; left time: 7010.9195s
	iters: 800, epoch: 4 | loss: 0.1950648
	speed: 0.2430s/iter; left time: 6603.8110s
	iters: 900, epoch: 4 | loss: 0.2227627
	speed: 0.2357s/iter; left time: 6381.0488s
	iters: 1000, epoch: 4 | loss: 0.2164319
	speed: 0.2513s/iter; left time: 6778.8255s
Epoch: 4 cost time: 246.91501927375793
Epoch: 4, Steps: 1036 | Train Loss: 0.2154371 Vali Loss: 1.2550092 Test Loss: 0.7012503
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm1_720_96_TimesNet_ETTm1_ftM_sl720_ll48_pl720_dm16_nh8_el2_dl1_df32_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
test shape: (10801, 720, 7) (10801, 720, 7)
test shape: (10801, 720, 7) (10801, 720, 7)
mse:0.4770708680152893, mae:0.4744085371494293, dtw:not calculated
