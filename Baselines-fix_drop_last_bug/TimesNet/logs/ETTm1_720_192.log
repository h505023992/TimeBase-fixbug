True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm1_720_96        Model:              TimesNet            

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/          
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            720                 Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm1_720_96_TimesNet_ETTm1_ftM_sl720_ll48_pl192_dm16_nh8_el2_dl1_df32_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33649
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.4491736
	speed: 0.2975s/iter; left time: 9359.0453s
	iters: 200, epoch: 1 | loss: 0.3467217
	speed: 0.2567s/iter; left time: 8051.7776s
	iters: 300, epoch: 1 | loss: 0.3036000
	speed: 0.2656s/iter; left time: 8302.8714s
	iters: 400, epoch: 1 | loss: 0.3825080
	speed: 0.2912s/iter; left time: 9074.0728s
	iters: 500, epoch: 1 | loss: 0.2802314
	speed: 0.2862s/iter; left time: 8889.4698s
	iters: 600, epoch: 1 | loss: 0.3506919
	speed: 0.2396s/iter; left time: 7417.0674s
	iters: 700, epoch: 1 | loss: 0.3144602
	speed: 0.2408s/iter; left time: 7430.7786s
	iters: 800, epoch: 1 | loss: 0.2759632
	speed: 0.2366s/iter; left time: 7277.6282s
	iters: 900, epoch: 1 | loss: 0.3170043
	speed: 0.2625s/iter; left time: 8048.2267s
	iters: 1000, epoch: 1 | loss: 0.2501552
	speed: 0.2827s/iter; left time: 8640.0287s
Epoch: 1 cost time: 280.6493260860443
Epoch: 1, Steps: 1052 | Train Loss: 0.3216554 Vali Loss: 0.6325101 Test Loss: 0.3683393
Validation loss decreased (inf --> 0.632510).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2594966
	speed: 2.0499s/iter; left time: 62335.0156s
	iters: 200, epoch: 2 | loss: 0.2383377
	speed: 0.2943s/iter; left time: 8919.6580s
	iters: 300, epoch: 2 | loss: 0.2392768
	speed: 0.2991s/iter; left time: 9035.1801s
	iters: 400, epoch: 2 | loss: 0.2234003
	speed: 0.3110s/iter; left time: 9365.0397s
	iters: 500, epoch: 2 | loss: 0.2047556
	speed: 0.3084s/iter; left time: 9255.2775s
	iters: 600, epoch: 2 | loss: 0.2462016
	speed: 0.2954s/iter; left time: 8833.7950s
	iters: 700, epoch: 2 | loss: 0.2503601
	speed: 0.2956s/iter; left time: 8811.0620s
	iters: 800, epoch: 2 | loss: 0.2156487
	speed: 0.3019s/iter; left time: 8969.9219s
	iters: 900, epoch: 2 | loss: 0.2120857
	speed: 0.2995s/iter; left time: 8868.6658s
	iters: 1000, epoch: 2 | loss: 0.2000353
	speed: 0.3061s/iter; left time: 9033.7554s
Epoch: 2 cost time: 318.2593674659729
Epoch: 2, Steps: 1052 | Train Loss: 0.2330109 Vali Loss: 0.7449633 Test Loss: 0.4730960
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1759288
	speed: 2.1580s/iter; left time: 63353.3746s
	iters: 200, epoch: 3 | loss: 0.1884084
	speed: 0.2917s/iter; left time: 8534.6709s
	iters: 300, epoch: 3 | loss: 0.2059567
	speed: 0.2881s/iter; left time: 8400.7972s
	iters: 400, epoch: 3 | loss: 0.1787125
	speed: 0.2913s/iter; left time: 8463.7670s
	iters: 500, epoch: 3 | loss: 0.1927807
	speed: 0.2906s/iter; left time: 8416.1240s
	iters: 600, epoch: 3 | loss: 0.1835412
	speed: 0.2919s/iter; left time: 8424.0650s
	iters: 700, epoch: 3 | loss: 0.1904938
	speed: 0.2880s/iter; left time: 8282.3413s
	iters: 800, epoch: 3 | loss: 0.1795695
	speed: 0.2908s/iter; left time: 8332.6379s
	iters: 900, epoch: 3 | loss: 0.1824817
	speed: 0.2855s/iter; left time: 8152.0324s
	iters: 1000, epoch: 3 | loss: 0.2058332
	speed: 0.2974s/iter; left time: 8462.2852s
Epoch: 3 cost time: 306.77102279663086
Epoch: 3, Steps: 1052 | Train Loss: 0.1913139 Vali Loss: 0.8149235 Test Loss: 0.5374771
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1754576
	speed: 1.8526s/iter; left time: 52437.2142s
	iters: 200, epoch: 4 | loss: 0.1616219
	speed: 0.3019s/iter; left time: 8516.3708s
	iters: 300, epoch: 4 | loss: 0.1716675
	speed: 0.2888s/iter; left time: 8116.0803s
	iters: 400, epoch: 4 | loss: 0.1860826
	speed: 0.3115s/iter; left time: 8723.2780s
	iters: 500, epoch: 4 | loss: 0.1750307
	speed: 0.3017s/iter; left time: 8418.4840s
	iters: 600, epoch: 4 | loss: 0.1756808
	speed: 0.2941s/iter; left time: 8178.3102s
	iters: 700, epoch: 4 | loss: 0.1767638
	speed: 0.3052s/iter; left time: 8455.2775s
	iters: 800, epoch: 4 | loss: 0.1694503
	speed: 0.3005s/iter; left time: 8294.0563s
	iters: 900, epoch: 4 | loss: 0.1820984
	speed: 0.2928s/iter; left time: 8052.5274s
	iters: 1000, epoch: 4 | loss: 0.2030281
	speed: 0.2883s/iter; left time: 7899.9051s
Epoch: 4 cost time: 314.12286925315857
Epoch: 4, Steps: 1052 | Train Loss: 0.1742972 Vali Loss: 0.8410920 Test Loss: 0.5586946
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm1_720_96_TimesNet_ETTm1_ftM_sl720_ll48_pl192_dm16_nh8_el2_dl1_df32_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
test shape: (11329, 192, 7) (11329, 192, 7)
test shape: (11329, 192, 7) (11329, 192, 7)
mse:0.3682388663291931, mae:0.39845573902130127, dtw:not calculated
