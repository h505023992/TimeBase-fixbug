Args in experiment:
Namespace(is_training=1, train_only=False, model_id='Autoformer_weather_192_192', model='Autoformer', data='custom', root_path='./dataset/', data_path='weather.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=192, label_len=48, pred_len=192, individual=False, embed_type=0, enc_in=21, dec_in=21, c_out=21, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : Autoformer_weather_192_192_Autoformer_custom_ftM_sl192_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36504
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.5340959
	speed: 0.1747s/iter; left time: 5964.0482s
	iters: 200, epoch: 1 | loss: 0.5086490
	speed: 0.1304s/iter; left time: 4437.8064s
	iters: 300, epoch: 1 | loss: 1.0503411
	speed: 0.1345s/iter; left time: 4562.4227s
	iters: 400, epoch: 1 | loss: 0.4504804
	speed: 0.1280s/iter; left time: 4331.5058s
	iters: 500, epoch: 1 | loss: 0.4674192
	speed: 0.1260s/iter; left time: 4249.9524s
	iters: 600, epoch: 1 | loss: 0.8893120
	speed: 0.1343s/iter; left time: 4515.2611s
	iters: 700, epoch: 1 | loss: 0.3974612
	speed: 0.1274s/iter; left time: 4271.9664s
	iters: 800, epoch: 1 | loss: 0.4327900
	speed: 0.1274s/iter; left time: 4260.7355s
	iters: 900, epoch: 1 | loss: 0.5230817
	speed: 0.1369s/iter; left time: 4563.6439s
	iters: 1000, epoch: 1 | loss: 0.4278419
	speed: 0.1360s/iter; left time: 4518.1988s
	iters: 1100, epoch: 1 | loss: 0.4460978
	speed: 0.1417s/iter; left time: 4694.0940s
Epoch: 1 cost time: 155.66626620292664
Epoch: 1, Steps: 1141 | Train Loss: 0.5854926 Vali Loss: 0.5938492 Test Loss: 0.3063979
Validation loss decreased (inf --> 0.593849).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3900515
	speed: 0.8953s/iter; left time: 29536.5898s
	iters: 200, epoch: 2 | loss: 0.3185850
	speed: 0.1263s/iter; left time: 4154.5603s
	iters: 300, epoch: 2 | loss: 0.8150750
	speed: 0.1256s/iter; left time: 4118.3862s
	iters: 400, epoch: 2 | loss: 0.4186219
	speed: 0.1243s/iter; left time: 4063.0575s
	iters: 500, epoch: 2 | loss: 0.3639589
	speed: 0.1294s/iter; left time: 4216.7654s
	iters: 600, epoch: 2 | loss: 0.3903044
	speed: 0.1285s/iter; left time: 4176.1521s
	iters: 700, epoch: 2 | loss: 0.3604918
	speed: 0.1299s/iter; left time: 4206.3701s
	iters: 800, epoch: 2 | loss: 0.4237795
	speed: 0.1227s/iter; left time: 3962.8459s
	iters: 900, epoch: 2 | loss: 0.5057447
	speed: 0.1226s/iter; left time: 3946.7368s
	iters: 1000, epoch: 2 | loss: 0.3137571
	speed: 0.1226s/iter; left time: 3932.9277s
	iters: 1100, epoch: 2 | loss: 0.5257083
	speed: 0.1217s/iter; left time: 3894.0236s
Epoch: 2 cost time: 144.0904369354248
Epoch: 2, Steps: 1141 | Train Loss: 0.4880741 Vali Loss: 0.5987742 Test Loss: 0.3262163
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3974978
	speed: 0.7365s/iter; left time: 23455.8511s
	iters: 200, epoch: 3 | loss: 0.4439238
	speed: 0.1313s/iter; left time: 4168.1742s
	iters: 300, epoch: 3 | loss: 0.4484104
	speed: 0.1292s/iter; left time: 4088.5050s
	iters: 400, epoch: 3 | loss: 0.4108754
	speed: 0.1263s/iter; left time: 3984.3980s
	iters: 500, epoch: 3 | loss: 0.3101932
	speed: 0.1299s/iter; left time: 4084.2935s
	iters: 600, epoch: 3 | loss: 0.7253243
	speed: 0.1295s/iter; left time: 4059.1878s
	iters: 700, epoch: 3 | loss: 0.3558080
	speed: 0.1282s/iter; left time: 4006.9897s
	iters: 800, epoch: 3 | loss: 0.3588955
	speed: 0.1226s/iter; left time: 3820.3542s
	iters: 900, epoch: 3 | loss: 0.2825863
	speed: 0.1218s/iter; left time: 3781.2927s
	iters: 1000, epoch: 3 | loss: 0.7322397
	speed: 0.1225s/iter; left time: 3789.9792s
	iters: 1100, epoch: 3 | loss: 0.3816621
	speed: 0.1242s/iter; left time: 3832.9573s
Epoch: 3 cost time: 146.44696736335754
Epoch: 3, Steps: 1141 | Train Loss: 0.4263061 Vali Loss: 0.6037318 Test Loss: 0.3362060
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3497759
	speed: 0.7709s/iter; left time: 23672.9196s
	iters: 200, epoch: 4 | loss: 0.4178340
	speed: 0.1235s/iter; left time: 3779.6552s
	iters: 300, epoch: 4 | loss: 0.3410809
	speed: 0.1220s/iter; left time: 3722.8603s
	iters: 400, epoch: 4 | loss: 0.3936045
	speed: 0.1225s/iter; left time: 3725.5513s
	iters: 500, epoch: 4 | loss: 0.6131205
	speed: 0.1217s/iter; left time: 3688.4379s
	iters: 600, epoch: 4 | loss: 0.2994576
	speed: 0.1232s/iter; left time: 3722.7867s
	iters: 700, epoch: 4 | loss: 0.4451315
	speed: 0.1271s/iter; left time: 3827.5461s
	iters: 800, epoch: 4 | loss: 0.4052760
	speed: 0.1325s/iter; left time: 3974.8565s
	iters: 900, epoch: 4 | loss: 0.2784061
	speed: 0.1315s/iter; left time: 3934.2165s
	iters: 1000, epoch: 4 | loss: 0.8543029
	speed: 0.1380s/iter; left time: 4112.5364s
	iters: 1100, epoch: 4 | loss: 0.3252629
	speed: 0.1302s/iter; left time: 3867.3761s
Epoch: 4 cost time: 145.68009328842163
Epoch: 4, Steps: 1141 | Train Loss: 0.3964887 Vali Loss: 0.6092210 Test Loss: 0.3353705
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Autoformer_weather_192_192_Autoformer_custom_ftM_sl192_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
mse:0.30657902359962463, mae:0.3673864006996155
