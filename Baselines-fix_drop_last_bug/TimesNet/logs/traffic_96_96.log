True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           traffic_96_96       Model:              TimesNet            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/          
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           96                  Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         8                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_traffic_96_96_TimesNet_custom_ftM_sl96_ll48_pl96_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 12089
val 1661
test 3413
	iters: 100, epoch: 1 | loss: 0.7516182
	speed: 0.2350s/iter; left time: 10636.5788s
	iters: 200, epoch: 1 | loss: 0.5576741
	speed: 0.1684s/iter; left time: 7603.6000s
	iters: 300, epoch: 1 | loss: 0.5676448
	speed: 0.1738s/iter; left time: 7832.7742s
	iters: 400, epoch: 1 | loss: 0.5159059
	speed: 0.1759s/iter; left time: 7909.7680s
	iters: 500, epoch: 1 | loss: 0.4733917
	speed: 0.1790s/iter; left time: 8028.8643s
	iters: 600, epoch: 1 | loss: 0.3680346
	speed: 0.1739s/iter; left time: 7785.9467s
	iters: 700, epoch: 1 | loss: 0.4046664
	speed: 0.1880s/iter; left time: 8397.7822s
	iters: 800, epoch: 1 | loss: 0.3713911
	speed: 0.1864s/iter; left time: 8307.8619s
	iters: 900, epoch: 1 | loss: 0.3482323
	speed: 0.1851s/iter; left time: 8228.5023s
	iters: 1000, epoch: 1 | loss: 0.2936610
	speed: 0.1752s/iter; left time: 7771.7300s
	iters: 1100, epoch: 1 | loss: 0.3009599
	speed: 0.1729s/iter; left time: 7650.5256s
	iters: 1200, epoch: 1 | loss: 0.2932063
	speed: 0.1793s/iter; left time: 7918.6561s
	iters: 1300, epoch: 1 | loss: 0.2999694
	speed: 0.1837s/iter; left time: 8091.9165s
	iters: 1400, epoch: 1 | loss: 0.2923306
	speed: 0.1757s/iter; left time: 7725.0759s
	iters: 1500, epoch: 1 | loss: 0.2823937
	speed: 0.1824s/iter; left time: 7998.0740s
Epoch: 1 cost time: 276.1966049671173
Epoch: 1, Steps: 1512 | Train Loss: 0.4499350 Vali Loss: 0.5100681 Test Loss: 0.6526279
Validation loss decreased (inf --> 0.510068).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2673532
	speed: 1.4556s/iter; left time: 63681.2026s
	iters: 200, epoch: 2 | loss: 0.2822489
	speed: 0.2094s/iter; left time: 9142.1097s
	iters: 300, epoch: 2 | loss: 0.2572540
	speed: 0.1986s/iter; left time: 8649.5328s
	iters: 400, epoch: 2 | loss: 0.3072240
	speed: 0.2049s/iter; left time: 8902.7255s
	iters: 500, epoch: 2 | loss: 0.2667899
	speed: 0.2135s/iter; left time: 9254.6940s
	iters: 600, epoch: 2 | loss: 0.3140929
	speed: 0.2131s/iter; left time: 9216.6213s
	iters: 700, epoch: 2 | loss: 0.2714676
	speed: 0.2119s/iter; left time: 9143.9043s
	iters: 800, epoch: 2 | loss: 0.2426936
	speed: 0.2143s/iter; left time: 9225.9945s
	iters: 900, epoch: 2 | loss: 0.3144211
	speed: 0.2114s/iter; left time: 9079.7290s
	iters: 1000, epoch: 2 | loss: 0.2493208
	speed: 0.2180s/iter; left time: 9342.0735s
	iters: 1100, epoch: 2 | loss: 0.2530292
	speed: 0.2051s/iter; left time: 8767.2826s
	iters: 1200, epoch: 2 | loss: 0.2578614
	speed: 0.2061s/iter; left time: 8789.1653s
	iters: 1300, epoch: 2 | loss: 0.2757387
	speed: 0.2078s/iter; left time: 8842.6195s
	iters: 1400, epoch: 2 | loss: 0.3175135
	speed: 0.2153s/iter; left time: 9139.1026s
	iters: 1500, epoch: 2 | loss: 0.2524126
	speed: 0.2109s/iter; left time: 8932.3883s
Epoch: 2 cost time: 318.9336335659027
Epoch: 2, Steps: 1512 | Train Loss: 0.2737007 Vali Loss: 0.4900961 Test Loss: 0.6191622
Validation loss decreased (0.510068 --> 0.490096).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2314319
	speed: 1.6433s/iter; left time: 69406.9169s
	iters: 200, epoch: 3 | loss: 0.2560100
	speed: 0.2153s/iter; left time: 9074.1360s
	iters: 300, epoch: 3 | loss: 0.2824449
	speed: 0.2133s/iter; left time: 8965.7785s
	iters: 400, epoch: 3 | loss: 0.2629149
	speed: 0.2151s/iter; left time: 9021.0454s
	iters: 500, epoch: 3 | loss: 0.2228597
	speed: 0.2145s/iter; left time: 8972.6319s
	iters: 600, epoch: 3 | loss: 0.2635591
	speed: 0.2104s/iter; left time: 8780.2042s
	iters: 700, epoch: 3 | loss: 0.2360145
	speed: 0.2121s/iter; left time: 8829.5951s
	iters: 800, epoch: 3 | loss: 0.2408141
	speed: 0.2061s/iter; left time: 8562.0517s
	iters: 900, epoch: 3 | loss: 0.2374988
	speed: 0.2078s/iter; left time: 8610.1073s
	iters: 1000, epoch: 3 | loss: 0.2088785
	speed: 0.2074s/iter; left time: 8572.9035s
	iters: 1100, epoch: 3 | loss: 0.2410352
	speed: 0.2110s/iter; left time: 8701.7546s
	iters: 1200, epoch: 3 | loss: 0.2301579
	speed: 0.2064s/iter; left time: 8489.6919s
	iters: 1300, epoch: 3 | loss: 0.2381456
	speed: 0.2158s/iter; left time: 8854.4633s
	iters: 1400, epoch: 3 | loss: 0.2686116
	speed: 0.2119s/iter; left time: 8672.7358s
	iters: 1500, epoch: 3 | loss: 0.2547519
	speed: 0.2093s/iter; left time: 8545.3439s
Epoch: 3 cost time: 321.909197807312
Epoch: 3, Steps: 1512 | Train Loss: 0.2510493 Vali Loss: 0.4829530 Test Loss: 0.6109170
Validation loss decreased (0.490096 --> 0.482953).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2770865
	speed: 1.5217s/iter; left time: 61970.5957s
	iters: 200, epoch: 4 | loss: 0.2378481
	speed: 0.2133s/iter; left time: 8666.4297s
	iters: 300, epoch: 4 | loss: 0.2220022
	speed: 0.2118s/iter; left time: 8582.1193s
	iters: 400, epoch: 4 | loss: 0.2543487
	speed: 0.2107s/iter; left time: 8517.1708s
	iters: 500, epoch: 4 | loss: 0.2540270
	speed: 0.2113s/iter; left time: 8520.5813s
	iters: 600, epoch: 4 | loss: 0.2645662
	speed: 0.2099s/iter; left time: 8443.7674s
	iters: 700, epoch: 4 | loss: 0.2530839
	speed: 0.2071s/iter; left time: 8308.1201s
	iters: 800, epoch: 4 | loss: 0.2727734
	speed: 0.2055s/iter; left time: 8223.8008s
	iters: 900, epoch: 4 | loss: 0.2490599
	speed: 0.2103s/iter; left time: 8394.8885s
	iters: 1000, epoch: 4 | loss: 0.2670050
	speed: 0.2089s/iter; left time: 8320.3494s
	iters: 1100, epoch: 4 | loss: 0.2245401
	speed: 0.2052s/iter; left time: 8152.9321s
	iters: 1200, epoch: 4 | loss: 0.2084721
	speed: 0.2047s/iter; left time: 8110.1800s
	iters: 1300, epoch: 4 | loss: 0.2313994
	speed: 0.2117s/iter; left time: 8369.3186s
	iters: 1400, epoch: 4 | loss: 0.2276079
	speed: 0.2084s/iter; left time: 8216.5273s
	iters: 1500, epoch: 4 | loss: 0.2209121
	speed: 0.1976s/iter; left time: 7770.4306s
Epoch: 4 cost time: 317.1404399871826
Epoch: 4, Steps: 1512 | Train Loss: 0.2421175 Vali Loss: 0.4804964 Test Loss: 0.6064101
Validation loss decreased (0.482953 --> 0.480496).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2090550
	speed: 1.5498s/iter; left time: 60772.4854s
	iters: 200, epoch: 5 | loss: 0.2063487
	speed: 0.2070s/iter; left time: 8098.2968s
	iters: 300, epoch: 5 | loss: 0.2194081
	speed: 0.2096s/iter; left time: 8178.3902s
	iters: 400, epoch: 5 | loss: 0.2036266
	speed: 0.2105s/iter; left time: 8189.6535s
	iters: 500, epoch: 5 | loss: 0.2632399
	speed: 0.2197s/iter; left time: 8526.3772s
	iters: 600, epoch: 5 | loss: 0.2393144
	speed: 0.2197s/iter; left time: 8505.6514s
	iters: 700, epoch: 5 | loss: 0.1999328
	speed: 0.2103s/iter; left time: 8118.8146s
	iters: 800, epoch: 5 | loss: 0.1970350
	speed: 0.2070s/iter; left time: 7971.2561s
	iters: 900, epoch: 5 | loss: 0.2047475
	speed: 0.2110s/iter; left time: 8103.6784s
	iters: 1000, epoch: 5 | loss: 0.2329158
	speed: 0.2141s/iter; left time: 8201.2270s
	iters: 1100, epoch: 5 | loss: 0.2393504
	speed: 0.2092s/iter; left time: 7992.6995s
	iters: 1200, epoch: 5 | loss: 0.2105622
	speed: 0.2087s/iter; left time: 7955.8699s
	iters: 1300, epoch: 5 | loss: 0.2087029
	speed: 0.2168s/iter; left time: 8242.1948s
	iters: 1400, epoch: 5 | loss: 0.2517684
	speed: 0.2235s/iter; left time: 8473.7301s
	iters: 1500, epoch: 5 | loss: 0.2559869
	speed: 0.2228s/iter; left time: 8425.0558s
Epoch: 5 cost time: 325.0383183956146
Epoch: 5, Steps: 1512 | Train Loss: 0.2379762 Vali Loss: 0.4792500 Test Loss: 0.6040370
Validation loss decreased (0.480496 --> 0.479250).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2729087
	speed: 1.6143s/iter; left time: 60860.7132s
	iters: 200, epoch: 6 | loss: 0.2203716
	speed: 0.2251s/iter; left time: 8462.3907s
	iters: 300, epoch: 6 | loss: 0.2460821
	speed: 0.2142s/iter; left time: 8034.0250s
	iters: 400, epoch: 6 | loss: 0.2185580
	speed: 0.2090s/iter; left time: 7814.9403s
	iters: 500, epoch: 6 | loss: 0.2192133
	speed: 0.2080s/iter; left time: 7759.6402s
	iters: 600, epoch: 6 | loss: 0.2229825
	speed: 0.2119s/iter; left time: 7881.3165s
	iters: 700, epoch: 6 | loss: 0.2209063
	speed: 0.2149s/iter; left time: 7971.7674s
	iters: 800, epoch: 6 | loss: 0.2077114
	speed: 0.2180s/iter; left time: 8064.9220s
	iters: 900, epoch: 6 | loss: 0.2651574
	speed: 0.2210s/iter; left time: 8154.9070s
	iters: 1000, epoch: 6 | loss: 0.2128219
	speed: 0.2174s/iter; left time: 7999.0320s
	iters: 1100, epoch: 6 | loss: 0.2367137
	speed: 0.2147s/iter; left time: 7877.9736s
	iters: 1200, epoch: 6 | loss: 0.2315862
	speed: 0.2152s/iter; left time: 7875.0040s
	iters: 1300, epoch: 6 | loss: 0.2397616
	speed: 0.2144s/iter; left time: 7825.2548s
	iters: 1400, epoch: 6 | loss: 0.2666313
	speed: 0.2121s/iter; left time: 7720.4890s
	iters: 1500, epoch: 6 | loss: 0.2717068
	speed: 0.2116s/iter; left time: 7681.6269s
Epoch: 6 cost time: 327.0027859210968
Epoch: 6, Steps: 1512 | Train Loss: 0.2361098 Vali Loss: 0.4814723 Test Loss: 0.6059485
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2402641
	speed: 1.4928s/iter; left time: 54023.7864s
	iters: 200, epoch: 7 | loss: 0.2391609
	speed: 0.2162s/iter; left time: 7801.6380s
	iters: 300, epoch: 7 | loss: 0.2003351
	speed: 0.2131s/iter; left time: 7668.5907s
	iters: 400, epoch: 7 | loss: 0.2241532
	speed: 0.2149s/iter; left time: 7713.5614s
	iters: 500, epoch: 7 | loss: 0.2088594
	speed: 0.2192s/iter; left time: 7845.2307s
	iters: 600, epoch: 7 | loss: 0.2764406
	speed: 0.2135s/iter; left time: 7618.9367s
	iters: 700, epoch: 7 | loss: 0.2330358
	speed: 0.2123s/iter; left time: 7556.9066s
	iters: 800, epoch: 7 | loss: 0.2225878
	speed: 0.2120s/iter; left time: 7523.3313s
	iters: 900, epoch: 7 | loss: 0.2544948
	speed: 0.2188s/iter; left time: 7741.7010s
	iters: 1000, epoch: 7 | loss: 0.2357320
	speed: 0.2177s/iter; left time: 7682.1382s
	iters: 1100, epoch: 7 | loss: 0.2479399
	speed: 0.2281s/iter; left time: 8026.7732s
	iters: 1200, epoch: 7 | loss: 0.2252960
	speed: 0.2132s/iter; left time: 7481.7031s
	iters: 1300, epoch: 7 | loss: 0.2030148
	speed: 0.2045s/iter; left time: 7153.7135s
	iters: 1400, epoch: 7 | loss: 0.1842954
	speed: 0.2105s/iter; left time: 7344.3076s
	iters: 1500, epoch: 7 | loss: 0.2458739
	speed: 0.2092s/iter; left time: 7278.9070s
Epoch: 7 cost time: 325.7099666595459
Epoch: 7, Steps: 1512 | Train Loss: 0.2350374 Vali Loss: 0.4798638 Test Loss: 0.6053060
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2317735
	speed: 1.5910s/iter; left time: 55171.5571s
	iters: 200, epoch: 8 | loss: 0.2417925
	speed: 0.2164s/iter; left time: 7483.0072s
	iters: 300, epoch: 8 | loss: 0.2098093
	speed: 0.2187s/iter; left time: 7540.4353s
	iters: 400, epoch: 8 | loss: 0.2496185
	speed: 0.2110s/iter; left time: 7254.9374s
	iters: 500, epoch: 8 | loss: 0.1980159
	speed: 0.2086s/iter; left time: 7151.3735s
	iters: 600, epoch: 8 | loss: 0.2310872
	speed: 0.2130s/iter; left time: 7278.6265s
	iters: 700, epoch: 8 | loss: 0.2571618
	speed: 0.2101s/iter; left time: 7160.8884s
	iters: 800, epoch: 8 | loss: 0.2251731
	speed: 0.2090s/iter; left time: 7100.7345s
	iters: 900, epoch: 8 | loss: 0.2264716
	speed: 0.2110s/iter; left time: 7148.1119s
	iters: 1000, epoch: 8 | loss: 0.2329059
	speed: 0.2251s/iter; left time: 7602.3388s
	iters: 1100, epoch: 8 | loss: 0.2699361
	speed: 0.2267s/iter; left time: 7635.4641s
	iters: 1200, epoch: 8 | loss: 0.2644614
	speed: 0.2198s/iter; left time: 7380.7050s
	iters: 1300, epoch: 8 | loss: 0.2518812
	speed: 0.2127s/iter; left time: 7120.1228s
	iters: 1400, epoch: 8 | loss: 0.2352992
	speed: 0.2120s/iter; left time: 7077.0165s
	iters: 1500, epoch: 8 | loss: 0.2775031
	speed: 0.2132s/iter; left time: 7094.8139s
Epoch: 8 cost time: 327.34711742401123
Epoch: 8, Steps: 1512 | Train Loss: 0.2345181 Vali Loss: 0.4806635 Test Loss: 0.6055703
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_traffic_96_96_TimesNet_custom_ftM_sl96_ll48_pl96_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
test shape: (3413, 96, 862) (3413, 96, 862)
test shape: (3413, 96, 862) (3413, 96, 862)
mse:0.6043108105659485, mae:0.334475040435791, dtw:not calculated
