True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           traffic_96_720      Model:              TimesNet            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/          
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         8                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_traffic_96_720_TimesNet_custom_ftM_sl96_ll48_pl720_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11465
val 1037
test 2789
	iters: 100, epoch: 1 | loss: 0.8445030
	speed: 0.4246s/iter; left time: 18223.4458s
	iters: 200, epoch: 1 | loss: 0.6362881
	speed: 0.3109s/iter; left time: 13312.2377s
	iters: 300, epoch: 1 | loss: 0.5197324
	speed: 0.2938s/iter; left time: 12552.9202s
	iters: 400, epoch: 1 | loss: 0.4992251
	speed: 0.2927s/iter; left time: 12473.7626s
	iters: 500, epoch: 1 | loss: 0.5061097
	speed: 0.2910s/iter; left time: 12374.9086s
	iters: 600, epoch: 1 | loss: 0.4822934
	speed: 0.2981s/iter; left time: 12647.8089s
	iters: 700, epoch: 1 | loss: 0.4476299
	speed: 0.2931s/iter; left time: 12405.8695s
	iters: 800, epoch: 1 | loss: 0.4771488
	speed: 0.2868s/iter; left time: 12110.3568s
	iters: 900, epoch: 1 | loss: 0.4716170
	speed: 0.2853s/iter; left time: 12018.6083s
	iters: 1000, epoch: 1 | loss: 0.4534111
	speed: 0.2870s/iter; left time: 12060.4623s
	iters: 1100, epoch: 1 | loss: 0.4757581
	speed: 0.2849s/iter; left time: 11943.2376s
	iters: 1200, epoch: 1 | loss: 0.4505236
	speed: 0.2816s/iter; left time: 11776.9511s
	iters: 1300, epoch: 1 | loss: 0.4365592
	speed: 0.2793s/iter; left time: 11653.1432s
	iters: 1400, epoch: 1 | loss: 0.4271957
	speed: 0.2819s/iter; left time: 11731.2923s
Epoch: 1 cost time: 428.7954144477844
Epoch: 1, Steps: 1434 | Train Loss: 0.5283310 Vali Loss: 0.6357155 Test Loss: 0.8685536
Validation loss decreased (inf --> 0.635716).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4560801
	speed: 1.3457s/iter; left time: 55830.6600s
	iters: 200, epoch: 2 | loss: 0.4194749
	speed: 0.2869s/iter; left time: 11872.6524s
	iters: 300, epoch: 2 | loss: 0.4131632
	speed: 0.2837s/iter; left time: 11712.3685s
	iters: 400, epoch: 2 | loss: 0.4215786
	speed: 0.2691s/iter; left time: 11083.6754s
	iters: 500, epoch: 2 | loss: 0.3990716
	speed: 0.2538s/iter; left time: 10428.5222s
	iters: 600, epoch: 2 | loss: 0.3555882
	speed: 0.2473s/iter; left time: 10137.2203s
	iters: 700, epoch: 2 | loss: 0.3610270
	speed: 0.2561s/iter; left time: 10469.4824s
	iters: 800, epoch: 2 | loss: 0.3504457
	speed: 0.2521s/iter; left time: 10282.8047s
	iters: 900, epoch: 2 | loss: 0.3313854
	speed: 0.2454s/iter; left time: 9985.8541s
	iters: 1000, epoch: 2 | loss: 0.2924754
	speed: 0.2448s/iter; left time: 9934.8293s
	iters: 1100, epoch: 2 | loss: 0.3120197
	speed: 0.2442s/iter; left time: 9887.6148s
	iters: 1200, epoch: 2 | loss: 0.3109197
	speed: 0.2552s/iter; left time: 10304.8008s
	iters: 1300, epoch: 2 | loss: 0.2983093
	speed: 0.2738s/iter; left time: 11029.6748s
	iters: 1400, epoch: 2 | loss: 0.2903516
	speed: 0.2840s/iter; left time: 11414.5086s
Epoch: 2 cost time: 379.7814373970032
Epoch: 2, Steps: 1434 | Train Loss: 0.3633628 Vali Loss: 0.5385417 Test Loss: 0.7132595
Validation loss decreased (0.635716 --> 0.538542).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3352830
	speed: 1.4399s/iter; left time: 57672.7654s
	iters: 200, epoch: 3 | loss: 0.2946245
	speed: 0.2418s/iter; left time: 9659.7526s
	iters: 300, epoch: 3 | loss: 0.2813450
	speed: 0.2416s/iter; left time: 9628.7007s
	iters: 400, epoch: 3 | loss: 0.2742494
	speed: 0.2463s/iter; left time: 9792.6517s
	iters: 500, epoch: 3 | loss: 0.2921087
	speed: 0.2528s/iter; left time: 10022.6878s
	iters: 600, epoch: 3 | loss: 0.2890284
	speed: 0.2650s/iter; left time: 10480.2997s
	iters: 700, epoch: 3 | loss: 0.2881383
	speed: 0.2751s/iter; left time: 10854.7571s
	iters: 800, epoch: 3 | loss: 0.2729114
	speed: 0.2895s/iter; left time: 11392.6381s
	iters: 900, epoch: 3 | loss: 0.3058924
	speed: 0.2991s/iter; left time: 11738.8178s
	iters: 1000, epoch: 3 | loss: 0.2732486
	speed: 0.3042s/iter; left time: 11908.8677s
	iters: 1100, epoch: 3 | loss: 0.2687793
	speed: 0.3102s/iter; left time: 12115.3027s
	iters: 1200, epoch: 3 | loss: 0.2792796
	speed: 0.3090s/iter; left time: 12034.7519s
	iters: 1300, epoch: 3 | loss: 0.2869474
	speed: 0.3127s/iter; left time: 12149.6417s
	iters: 1400, epoch: 3 | loss: 0.2768421
	speed: 0.3106s/iter; left time: 12036.9307s
Epoch: 3 cost time: 406.80757665634155
Epoch: 3, Steps: 1434 | Train Loss: 0.2867809 Vali Loss: 0.5108279 Test Loss: 0.6857030
Validation loss decreased (0.538542 --> 0.510828).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2712286
	speed: 1.6059s/iter; left time: 62018.9978s
	iters: 200, epoch: 4 | loss: 0.2767654
	speed: 0.3135s/iter; left time: 12075.4230s
	iters: 300, epoch: 4 | loss: 0.2713861
	speed: 0.3120s/iter; left time: 11986.9435s
	iters: 400, epoch: 4 | loss: 0.2769803
	speed: 0.3133s/iter; left time: 12006.4789s
	iters: 500, epoch: 4 | loss: 0.2918747
	speed: 0.3137s/iter; left time: 11988.6528s
	iters: 600, epoch: 4 | loss: 0.2810705
	speed: 0.3131s/iter; left time: 11936.8551s
	iters: 700, epoch: 4 | loss: 0.2897469
	speed: 0.3120s/iter; left time: 11860.5217s
	iters: 800, epoch: 4 | loss: 0.2664324
	speed: 0.3091s/iter; left time: 11721.1566s
	iters: 900, epoch: 4 | loss: 0.2758968
	speed: 0.3104s/iter; left time: 11738.4525s
	iters: 1000, epoch: 4 | loss: 0.2876094
	speed: 0.3163s/iter; left time: 11928.9520s
	iters: 1100, epoch: 4 | loss: 0.2849495
	speed: 0.3130s/iter; left time: 11774.6689s
	iters: 1200, epoch: 4 | loss: 0.2599472
	speed: 0.3115s/iter; left time: 11688.1053s
	iters: 1300, epoch: 4 | loss: 0.2776193
	speed: 0.3091s/iter; left time: 11567.4918s
	iters: 1400, epoch: 4 | loss: 0.2672413
	speed: 0.3105s/iter; left time: 11586.2716s
Epoch: 4 cost time: 450.7006766796112
Epoch: 4, Steps: 1434 | Train Loss: 0.2755253 Vali Loss: 0.5073442 Test Loss: 0.6838276
Validation loss decreased (0.510828 --> 0.507344).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2583234
	speed: 1.5441s/iter; left time: 57417.9480s
	iters: 200, epoch: 5 | loss: 0.2607004
	speed: 0.3128s/iter; left time: 11601.2995s
	iters: 300, epoch: 5 | loss: 0.2733732
	speed: 0.3130s/iter; left time: 11577.7751s
	iters: 400, epoch: 5 | loss: 0.2699586
	speed: 0.3134s/iter; left time: 11560.2043s
	iters: 500, epoch: 5 | loss: 0.2625656
	speed: 0.3156s/iter; left time: 11608.7455s
	iters: 600, epoch: 5 | loss: 0.2679659
	speed: 0.3207s/iter; left time: 11763.8309s
	iters: 700, epoch: 5 | loss: 0.2765813
	speed: 0.3187s/iter; left time: 11659.8494s
	iters: 800, epoch: 5 | loss: 0.2669693
	speed: 0.3119s/iter; left time: 11379.1020s
	iters: 900, epoch: 5 | loss: 0.2677579
	speed: 0.3141s/iter; left time: 11429.5562s
	iters: 1000, epoch: 5 | loss: 0.2692990
	speed: 0.3116s/iter; left time: 11307.1960s
	iters: 1100, epoch: 5 | loss: 0.2918508
	speed: 0.3148s/iter; left time: 11390.3499s
	iters: 1200, epoch: 5 | loss: 0.2864918
	speed: 0.3110s/iter; left time: 11222.5851s
	iters: 1300, epoch: 5 | loss: 0.2649573
	speed: 0.3129s/iter; left time: 11257.9349s
	iters: 1400, epoch: 5 | loss: 0.2837829
	speed: 0.3153s/iter; left time: 11313.5722s
Epoch: 5 cost time: 453.33467650413513
Epoch: 5, Steps: 1434 | Train Loss: 0.2712321 Vali Loss: 0.5079068 Test Loss: 0.6820957
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2865117
	speed: 1.5638s/iter; left time: 55908.8822s
	iters: 200, epoch: 6 | loss: 0.2717689
	speed: 0.3148s/iter; left time: 11221.4988s
	iters: 300, epoch: 6 | loss: 0.2714875
	speed: 0.3120s/iter; left time: 11092.6415s
	iters: 400, epoch: 6 | loss: 0.2730810
	speed: 0.3128s/iter; left time: 11087.3808s
	iters: 500, epoch: 6 | loss: 0.2663206
	speed: 0.3142s/iter; left time: 11108.9662s
	iters: 600, epoch: 6 | loss: 0.2638085
	speed: 0.3101s/iter; left time: 10931.6226s
	iters: 700, epoch: 6 | loss: 0.2654514
	speed: 0.3084s/iter; left time: 10842.1104s
	iters: 800, epoch: 6 | loss: 0.2744669
	speed: 0.3094s/iter; left time: 10843.9821s
	iters: 900, epoch: 6 | loss: 0.2828935
	speed: 0.3088s/iter; left time: 10792.9458s
	iters: 1000, epoch: 6 | loss: 0.2639462
	speed: 0.3095s/iter; left time: 10785.8384s
	iters: 1100, epoch: 6 | loss: 0.2474727
	speed: 0.3119s/iter; left time: 10838.9965s
	iters: 1200, epoch: 6 | loss: 0.2724243
	speed: 0.3133s/iter; left time: 10856.9926s
	iters: 1300, epoch: 6 | loss: 0.2825707
	speed: 0.3091s/iter; left time: 10678.8344s
	iters: 1400, epoch: 6 | loss: 0.2619696
	speed: 0.3094s/iter; left time: 10658.3471s
Epoch: 6 cost time: 448.81134152412415
Epoch: 6, Steps: 1434 | Train Loss: 0.2691252 Vali Loss: 0.5134320 Test Loss: 0.6868176
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2649742
	speed: 1.6156s/iter; left time: 55441.1860s
	iters: 200, epoch: 7 | loss: 0.2623027
	speed: 0.3109s/iter; left time: 10638.6185s
	iters: 300, epoch: 7 | loss: 0.2671924
	speed: 0.3075s/iter; left time: 10489.9955s
	iters: 400, epoch: 7 | loss: 0.2911593
	speed: 0.3118s/iter; left time: 10606.3975s
	iters: 500, epoch: 7 | loss: 0.2496615
	speed: 0.3038s/iter; left time: 10305.1911s
	iters: 600, epoch: 7 | loss: 0.2685800
	speed: 0.3054s/iter; left time: 10327.2471s
	iters: 700, epoch: 7 | loss: 0.2591875
	speed: 0.3049s/iter; left time: 10281.6225s
	iters: 800, epoch: 7 | loss: 0.2653888
	speed: 0.3041s/iter; left time: 10223.2537s
	iters: 900, epoch: 7 | loss: 0.2698793
	speed: 0.3038s/iter; left time: 10183.3268s
	iters: 1000, epoch: 7 | loss: 0.2471555
	speed: 0.3106s/iter; left time: 10380.2480s
	iters: 1100, epoch: 7 | loss: 0.2675248
	speed: 0.3054s/iter; left time: 10175.9474s
	iters: 1200, epoch: 7 | loss: 0.2515473
	speed: 0.3074s/iter; left time: 10209.5846s
	iters: 1300, epoch: 7 | loss: 0.2681408
	speed: 0.3088s/iter; left time: 10227.1322s
	iters: 1400, epoch: 7 | loss: 0.2636537
	speed: 0.3067s/iter; left time: 10124.8225s
Epoch: 7 cost time: 444.93588185310364
Epoch: 7, Steps: 1434 | Train Loss: 0.2680827 Vali Loss: 0.5091058 Test Loss: 0.6825095
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_traffic_96_720_TimesNet_custom_ftM_sl96_ll48_pl720_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
test shape: (2789, 720, 862) (2789, 720, 862)
test shape: (2789, 720, 862) (2789, 720, 862)
mse:0.6837748885154724, mae:0.3662906885147095, dtw:not calculated
