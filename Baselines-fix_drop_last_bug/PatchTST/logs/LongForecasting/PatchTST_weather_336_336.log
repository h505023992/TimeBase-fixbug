Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='custom', data_path='weather.csv', dec_in=7, decomposition=0, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.2, e_layers=3, embed='timeF', embed_type=0, enc_in=21, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=48, learning_rate=0.0001, loss='mse', lradj='type3', model='PatchTST', model_id='336_336', moving_avg=25, n_heads=16, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.3, pred_len=336, random_seed=2021, revin=1, root_path='./dataset/', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : 336_336_PatchTST_custom_ftM_sl336_ll48_pl336_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36216
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.7143364
	speed: 0.1891s/iter; left time: 5314.2806s
	iters: 200, epoch: 1 | loss: 0.6723459
	speed: 0.1890s/iter; left time: 5291.4901s
Epoch: 1 cost time: 53.181915521621704
Epoch: 1, Steps: 282 | Train Loss: 0.8239692 Vali Loss: 0.6737865 Test Loss: 0.3012834
Validation loss decreased (inf --> 0.673786).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5683814
	speed: 0.7127s/iter; left time: 19825.7469s
	iters: 200, epoch: 2 | loss: 0.5738140
	speed: 0.1879s/iter; left time: 5207.6624s
Epoch: 2 cost time: 53.879247188568115
Epoch: 2, Steps: 282 | Train Loss: 0.5894259 Vali Loss: 0.5683565 Test Loss: 0.2600922
Validation loss decreased (0.673786 --> 0.568356).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.5284362
	speed: 0.7104s/iter; left time: 19561.3383s
	iters: 200, epoch: 3 | loss: 0.4549129
	speed: 0.1896s/iter; left time: 5200.7500s
Epoch: 3 cost time: 54.277098178863525
Epoch: 3, Steps: 282 | Train Loss: 0.5576411 Vali Loss: 0.5607529 Test Loss: 0.2557614
Validation loss decreased (0.568356 --> 0.560753).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.7438641
	speed: 0.7210s/iter; left time: 19649.8709s
	iters: 200, epoch: 4 | loss: 0.6030161
	speed: 0.1888s/iter; left time: 5125.5089s
Epoch: 4 cost time: 54.58799648284912
Epoch: 4, Steps: 282 | Train Loss: 0.5505795 Vali Loss: 0.5547854 Test Loss: 0.2522971
Validation loss decreased (0.560753 --> 0.554785).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.5364817
	speed: 0.7045s/iter; left time: 19002.2284s
	iters: 200, epoch: 5 | loss: 0.6454312
	speed: 0.1857s/iter; left time: 4990.8568s
Epoch: 5 cost time: 53.74643659591675
Epoch: 5, Steps: 282 | Train Loss: 0.5466968 Vali Loss: 0.5529059 Test Loss: 0.2520281
Validation loss decreased (0.554785 --> 0.552906).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.5211861
	speed: 0.6916s/iter; left time: 18459.8592s
	iters: 200, epoch: 6 | loss: 0.4812424
	speed: 0.1857s/iter; left time: 4937.6930s
Epoch: 6 cost time: 53.555752992630005
Epoch: 6, Steps: 282 | Train Loss: 0.5435260 Vali Loss: 0.5490218 Test Loss: 0.2505976
Validation loss decreased (0.552906 --> 0.549022).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.4250118
	speed: 0.6839s/iter; left time: 18060.2280s
	iters: 200, epoch: 7 | loss: 0.4283333
	speed: 0.1865s/iter; left time: 4907.0391s
Epoch: 7 cost time: 53.66591811180115
Epoch: 7, Steps: 282 | Train Loss: 0.5409726 Vali Loss: 0.5485553 Test Loss: 0.2498777
Validation loss decreased (0.549022 --> 0.548555).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.4410866
	speed: 0.7473s/iter; left time: 19524.5264s
	iters: 200, epoch: 8 | loss: 0.5294014
	speed: 0.1891s/iter; left time: 4920.4878s
Epoch: 8 cost time: 54.93732953071594
Epoch: 8, Steps: 282 | Train Loss: 0.5389682 Vali Loss: 0.5472840 Test Loss: 0.2489107
Validation loss decreased (0.548555 --> 0.547284).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.5147423
	speed: 0.7416s/iter; left time: 19167.1725s
	iters: 200, epoch: 9 | loss: 0.5180272
	speed: 0.1901s/iter; left time: 4894.7845s
Epoch: 9 cost time: 54.81676936149597
Epoch: 9, Steps: 282 | Train Loss: 0.5376376 Vali Loss: 0.5506194 Test Loss: 0.2480557
EarlyStopping counter: 1 out of 20
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.4918756
	speed: 0.7077s/iter; left time: 18089.8126s
	iters: 200, epoch: 10 | loss: 0.4853181
	speed: 0.1904s/iter; left time: 4847.5301s
Epoch: 10 cost time: 54.42910552024841
Epoch: 10, Steps: 282 | Train Loss: 0.5352820 Vali Loss: 0.5493472 Test Loss: 0.2473565
EarlyStopping counter: 2 out of 20
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.5381860
	speed: 0.7128s/iter; left time: 18020.2786s
	iters: 200, epoch: 11 | loss: 0.4885318
	speed: 0.1897s/iter; left time: 4776.4524s
Epoch: 11 cost time: 54.30025887489319
Epoch: 11, Steps: 282 | Train Loss: 0.5345691 Vali Loss: 0.5477640 Test Loss: 0.2469059
EarlyStopping counter: 3 out of 20
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.5287091
	speed: 0.7014s/iter; left time: 17534.2562s
	iters: 200, epoch: 12 | loss: 0.4325252
	speed: 0.1779s/iter; left time: 4429.5790s
Epoch: 12 cost time: 51.94944953918457
Epoch: 12, Steps: 282 | Train Loss: 0.5327144 Vali Loss: 0.5482575 Test Loss: 0.2470280
EarlyStopping counter: 4 out of 20
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.5748355
	speed: 0.7297s/iter; left time: 18034.9574s
	iters: 200, epoch: 13 | loss: 0.6700546
	speed: 0.1791s/iter; left time: 4409.9669s
Epoch: 13 cost time: 52.32927918434143
Epoch: 13, Steps: 282 | Train Loss: 0.5315635 Vali Loss: 0.5517474 Test Loss: 0.2471604
EarlyStopping counter: 5 out of 20
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.5541841
	speed: 0.6734s/iter; left time: 16453.5675s
	iters: 200, epoch: 14 | loss: 0.5369241
	speed: 0.1830s/iter; left time: 4452.7962s
Epoch: 14 cost time: 52.77005672454834
Epoch: 14, Steps: 282 | Train Loss: 0.5303611 Vali Loss: 0.5489455 Test Loss: 0.2462156
EarlyStopping counter: 6 out of 20
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.5022435
	speed: 0.6913s/iter; left time: 16697.8307s
	iters: 200, epoch: 15 | loss: 0.6262637
	speed: 0.1893s/iter; left time: 4552.9057s
Epoch: 15 cost time: 54.356107234954834
Epoch: 15, Steps: 282 | Train Loss: 0.5290604 Vali Loss: 0.5500515 Test Loss: 0.2467032
EarlyStopping counter: 7 out of 20
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.4906709
	speed: 0.6950s/iter; left time: 16590.6223s
	iters: 200, epoch: 16 | loss: 0.6028362
	speed: 0.1887s/iter; left time: 4485.2341s
Epoch: 16 cost time: 54.284820556640625
Epoch: 16, Steps: 282 | Train Loss: 0.5281429 Vali Loss: 0.5489976 Test Loss: 0.2463516
EarlyStopping counter: 8 out of 20
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.4293540
	speed: 0.7087s/iter; left time: 16717.8861s
	iters: 200, epoch: 17 | loss: 0.4307653
	speed: 0.1891s/iter; left time: 4441.5470s
Epoch: 17 cost time: 53.71327257156372
Epoch: 17, Steps: 282 | Train Loss: 0.5267493 Vali Loss: 0.5510471 Test Loss: 0.2469314
EarlyStopping counter: 9 out of 20
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.4316760
	speed: 0.6901s/iter; left time: 16084.4076s
	iters: 200, epoch: 18 | loss: 0.5630455
	speed: 0.1886s/iter; left time: 4377.1178s
Epoch: 18 cost time: 54.412050008773804
Epoch: 18, Steps: 282 | Train Loss: 0.5259761 Vali Loss: 0.5494346 Test Loss: 0.2469817
EarlyStopping counter: 10 out of 20
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.4342173
	speed: 0.7067s/iter; left time: 16272.4907s
	iters: 200, epoch: 19 | loss: 0.4628468
	speed: 0.1903s/iter; left time: 4362.0097s
Epoch: 19 cost time: 55.13577914237976
Epoch: 19, Steps: 282 | Train Loss: 0.5254580 Vali Loss: 0.5500569 Test Loss: 0.2465534
EarlyStopping counter: 11 out of 20
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.4661674
	speed: 0.7157s/iter; left time: 16277.1341s
	iters: 200, epoch: 20 | loss: 0.6821048
	speed: 0.1890s/iter; left time: 4280.1347s
Epoch: 20 cost time: 54.87436628341675
Epoch: 20, Steps: 282 | Train Loss: 0.5246401 Vali Loss: 0.5502120 Test Loss: 0.2464553
EarlyStopping counter: 12 out of 20
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.5682119
	speed: 0.7177s/iter; left time: 16119.1649s
	iters: 200, epoch: 21 | loss: 0.5065201
	speed: 0.1902s/iter; left time: 4252.3157s
Epoch: 21 cost time: 55.01190423965454
Epoch: 21, Steps: 282 | Train Loss: 0.5241638 Vali Loss: 0.5516423 Test Loss: 0.2468096
EarlyStopping counter: 13 out of 20
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.6009262
	speed: 0.7003s/iter; left time: 15532.6233s
	iters: 200, epoch: 22 | loss: 0.6737832
	speed: 0.1870s/iter; left time: 4129.5709s
Epoch: 22 cost time: 54.4798948764801
Epoch: 22, Steps: 282 | Train Loss: 0.5237507 Vali Loss: 0.5497220 Test Loss: 0.2469575
EarlyStopping counter: 14 out of 20
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.5271252
	speed: 0.7076s/iter; left time: 15495.1999s
	iters: 200, epoch: 23 | loss: 0.5050401
	speed: 0.1833s/iter; left time: 3995.0035s
Epoch: 23 cost time: 53.35745620727539
Epoch: 23, Steps: 282 | Train Loss: 0.5233612 Vali Loss: 0.5516429 Test Loss: 0.2469961
EarlyStopping counter: 15 out of 20
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.4171430
	speed: 0.6796s/iter; left time: 14690.1007s
	iters: 200, epoch: 24 | loss: 0.5228470
	speed: 0.1862s/iter; left time: 4006.1726s
Epoch: 24 cost time: 53.99710488319397
Epoch: 24, Steps: 282 | Train Loss: 0.5225851 Vali Loss: 0.5496063 Test Loss: 0.2466860
EarlyStopping counter: 16 out of 20
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.4450245
	speed: 0.7118s/iter; left time: 15185.6722s
	iters: 200, epoch: 25 | loss: 0.5098650
	speed: 0.1945s/iter; left time: 4130.5334s
Epoch: 25 cost time: 55.66383743286133
Epoch: 25, Steps: 282 | Train Loss: 0.5224709 Vali Loss: 0.5524487 Test Loss: 0.2466671
EarlyStopping counter: 17 out of 20
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.4985895
	speed: 0.6970s/iter; left time: 14673.4587s
	iters: 200, epoch: 26 | loss: 0.5646633
	speed: 0.1907s/iter; left time: 3994.5754s
Epoch: 26 cost time: 53.91619896888733
Epoch: 26, Steps: 282 | Train Loss: 0.5221859 Vali Loss: 0.5524265 Test Loss: 0.2466511
EarlyStopping counter: 18 out of 20
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.4563937
	speed: 0.7337s/iter; left time: 15237.1851s
	iters: 200, epoch: 27 | loss: 0.5646992
	speed: 0.1935s/iter; left time: 3998.6007s
Epoch: 27 cost time: 55.457398653030396
Epoch: 27, Steps: 282 | Train Loss: 0.5219647 Vali Loss: 0.5514548 Test Loss: 0.2467712
EarlyStopping counter: 19 out of 20
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.4036315
	speed: 0.7217s/iter; left time: 14785.5346s
	iters: 200, epoch: 28 | loss: 0.5792443
	speed: 0.1931s/iter; left time: 3936.9713s
Epoch: 28 cost time: 55.292826414108276
Epoch: 28, Steps: 282 | Train Loss: 0.5215633 Vali Loss: 0.5517176 Test Loss: 0.2467796
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : 336_336_PatchTST_custom_ftM_sl336_ll48_pl336_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
mse:0.24910257756710052, mae:0.2834393084049225, rse:0.6555029153823853
