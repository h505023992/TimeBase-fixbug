Args in experiment:
Namespace(is_training=1, model_id='electricity_96_96', model='FITS', data='custom', root_path='./dataset/', data_path='electricity.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=96, individual=False, embed_type=0, enc_in=321, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, ab=2, hidden_size=1, kernel=5, groups=1, levels=3, stacks=1, num_workers=10, itr=1, train_epochs=30, batch_size=128, patience=5, learning_rate=0.0005, des='Exp', loss='mse', lradj='type3', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False, aug_method='NA', aug_rate=0.5, in_batch_augmentation=False, in_dataset_augmentation=False, data_size=1, aug_data_size=1, seed=0, testset_div=2, test_time_train=False, train_mode=2, cut_freq=34, base_T=36, H_order=8)
Use GPU: cuda:0
>>>>>>>start training : electricity_96_96_FITS_custom_ftM_sl96_ll48_pl96_H8_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18221
val 2537
test 5165
Model(
  (freq_upsampler): Linear(in_features=34, out_features=68, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  94995456.0
params:  2380.0
Trainable parameters:  2380
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.7672365
	speed: 0.0723s/iter; left time: 300.9024s
Epoch: 1 cost time: 9.761536598205566
Epoch: 1, Steps: 142 | Train Loss: 0.8754750 Vali Loss: 0.6479206 Test Loss: 0.7402254
Validation loss decreased (inf --> 0.647921).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.5494700
	speed: 0.1670s/iter; left time: 671.0546s
Epoch: 2 cost time: 10.800904273986816
Epoch: 2, Steps: 142 | Train Loss: 0.5739852 Vali Loss: 0.5004638 Test Loss: 0.5732476
Validation loss decreased (0.647921 --> 0.500464).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.4200906
	speed: 0.1941s/iter; left time: 752.4258s
Epoch: 3 cost time: 11.465439319610596
Epoch: 3, Steps: 142 | Train Loss: 0.4506163 Vali Loss: 0.4316435 Test Loss: 0.4951591
Validation loss decreased (0.500464 --> 0.431644).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.3723054
	speed: 0.1975s/iter; left time: 737.5249s
Epoch: 4 cost time: 11.34194278717041
Epoch: 4, Steps: 142 | Train Loss: 0.3825108 Vali Loss: 0.3865549 Test Loss: 0.4436306
Validation loss decreased (0.431644 --> 0.386555).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.3332852
	speed: 0.2022s/iter; left time: 726.5283s
Epoch: 5 cost time: 11.738142728805542
Epoch: 5, Steps: 142 | Train Loss: 0.3338326 Vali Loss: 0.3501723 Test Loss: 0.4023618
Validation loss decreased (0.386555 --> 0.350172).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2887183
	speed: 0.2099s/iter; left time: 724.4960s
Epoch: 6 cost time: 12.072773456573486
Epoch: 6, Steps: 142 | Train Loss: 0.2952432 Vali Loss: 0.3224264 Test Loss: 0.3705952
Validation loss decreased (0.350172 --> 0.322426).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2516411
	speed: 0.1925s/iter; left time: 636.9602s
Epoch: 7 cost time: 10.660346031188965
Epoch: 7, Steps: 142 | Train Loss: 0.2635994 Vali Loss: 0.2978701 Test Loss: 0.3422635
Validation loss decreased (0.322426 --> 0.297870).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2375016
	speed: 0.1795s/iter; left time: 568.3666s
Epoch: 8 cost time: 10.6806640625
Epoch: 8, Steps: 142 | Train Loss: 0.2375272 Vali Loss: 0.2783926 Test Loss: 0.3197092
Validation loss decreased (0.297870 --> 0.278393).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.2092638
	speed: 0.1819s/iter; left time: 550.3405s
Epoch: 9 cost time: 10.617051839828491
Epoch: 9, Steps: 142 | Train Loss: 0.2158619 Vali Loss: 0.2621913 Test Loss: 0.3011441
Validation loss decreased (0.278393 --> 0.262191).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1987585
	speed: 0.1780s/iter; left time: 513.1986s
Epoch: 10 cost time: 10.269437789916992
Epoch: 10, Steps: 142 | Train Loss: 0.1978626 Vali Loss: 0.2479347 Test Loss: 0.2846533
Validation loss decreased (0.262191 --> 0.247935).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1832900
	speed: 0.1853s/iter; left time: 507.8399s
Epoch: 11 cost time: 10.405987739562988
Epoch: 11, Steps: 142 | Train Loss: 0.1828718 Vali Loss: 0.2363520 Test Loss: 0.2713553
Validation loss decreased (0.247935 --> 0.236352).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1718168
	speed: 0.1788s/iter; left time: 464.8061s
Epoch: 12 cost time: 10.652666807174683
Epoch: 12, Steps: 142 | Train Loss: 0.1703676 Vali Loss: 0.2270524 Test Loss: 0.2603953
Validation loss decreased (0.236352 --> 0.227052).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.1601845
	speed: 0.1778s/iter; left time: 436.9502s
Epoch: 13 cost time: 10.491521120071411
Epoch: 13, Steps: 142 | Train Loss: 0.1599330 Vali Loss: 0.2188310 Test Loss: 0.2509582
Validation loss decreased (0.227052 --> 0.218831).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.1448702
	speed: 0.1772s/iter; left time: 410.1856s
Epoch: 14 cost time: 10.293099164962769
Epoch: 14, Steps: 142 | Train Loss: 0.1512056 Vali Loss: 0.2124145 Test Loss: 0.2429883
Validation loss decreased (0.218831 --> 0.212414).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.1408795
	speed: 0.1781s/iter; left time: 387.0872s
Epoch: 15 cost time: 10.493189096450806
Epoch: 15, Steps: 142 | Train Loss: 0.1439141 Vali Loss: 0.2066077 Test Loss: 0.2363509
Validation loss decreased (0.212414 --> 0.206608).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.1377208
	speed: 0.1770s/iter; left time: 359.5424s
Epoch: 16 cost time: 10.63007140159607
Epoch: 16, Steps: 142 | Train Loss: 0.1378101 Vali Loss: 0.2018716 Test Loss: 0.2309043
Validation loss decreased (0.206608 --> 0.201872).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.1391319
	speed: 0.1774s/iter; left time: 335.0688s
Epoch: 17 cost time: 10.271462440490723
Epoch: 17, Steps: 142 | Train Loss: 0.1326821 Vali Loss: 0.1979410 Test Loss: 0.2264056
Validation loss decreased (0.201872 --> 0.197941).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.1228845
	speed: 0.1783s/iter; left time: 311.4967s
Epoch: 18 cost time: 10.328451871871948
Epoch: 18, Steps: 142 | Train Loss: 0.1284292 Vali Loss: 0.1951723 Test Loss: 0.2224964
Validation loss decreased (0.197941 --> 0.195172).  Saving model ...
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.1170315
	speed: 0.1775s/iter; left time: 284.8860s
Epoch: 19 cost time: 10.577656745910645
Epoch: 19, Steps: 142 | Train Loss: 0.1248284 Vali Loss: 0.1924782 Test Loss: 0.2195877
Validation loss decreased (0.195172 --> 0.192478).  Saving model ...
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.1192942
	speed: 0.1852s/iter; left time: 271.0031s
Epoch: 20 cost time: 11.383674383163452
Epoch: 20, Steps: 142 | Train Loss: 0.1218218 Vali Loss: 0.1903539 Test Loss: 0.2166702
Validation loss decreased (0.192478 --> 0.190354).  Saving model ...
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.1196353
	speed: 0.1985s/iter; left time: 262.1709s
Epoch: 21 cost time: 11.481282711029053
Epoch: 21, Steps: 142 | Train Loss: 0.1192975 Vali Loss: 0.1883064 Test Loss: 0.2143061
Validation loss decreased (0.190354 --> 0.188306).  Saving model ...
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.1236505
	speed: 0.2010s/iter; left time: 236.9346s
Epoch: 22 cost time: 11.76195240020752
Epoch: 22, Steps: 142 | Train Loss: 0.1172131 Vali Loss: 0.1866971 Test Loss: 0.2123177
Validation loss decreased (0.188306 --> 0.186697).  Saving model ...
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.1126502
	speed: 0.1993s/iter; left time: 206.6231s
Epoch: 23 cost time: 11.281944990158081
Epoch: 23, Steps: 142 | Train Loss: 0.1154571 Vali Loss: 0.1853226 Test Loss: 0.2107977
Validation loss decreased (0.186697 --> 0.185323).  Saving model ...
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.1147934
	speed: 0.2000s/iter; left time: 179.0318s
Epoch: 24 cost time: 11.372523784637451
Epoch: 24, Steps: 142 | Train Loss: 0.1139897 Vali Loss: 0.1843490 Test Loss: 0.2094896
Validation loss decreased (0.185323 --> 0.184349).  Saving model ...
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.1112568
	speed: 0.1777s/iter; left time: 133.8135s
Epoch: 25 cost time: 10.4109525680542
Epoch: 25, Steps: 142 | Train Loss: 0.1127846 Vali Loss: 0.1834037 Test Loss: 0.2084303
Validation loss decreased (0.184349 --> 0.183404).  Saving model ...
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.1143976
	speed: 0.1837s/iter; left time: 112.2166s
Epoch: 26 cost time: 10.602107048034668
Epoch: 26, Steps: 142 | Train Loss: 0.1117380 Vali Loss: 0.1825979 Test Loss: 0.2073794
Validation loss decreased (0.183404 --> 0.182598).  Saving model ...
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.1126956
	speed: 0.1781s/iter; left time: 83.5056s
Epoch: 27 cost time: 10.318894863128662
Epoch: 27, Steps: 142 | Train Loss: 0.1108713 Vali Loss: 0.1820419 Test Loss: 0.2066474
Validation loss decreased (0.182598 --> 0.182042).  Saving model ...
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.1106875
	speed: 0.1766s/iter; left time: 57.7434s
Epoch: 28 cost time: 10.367202281951904
Epoch: 28, Steps: 142 | Train Loss: 0.1101745 Vali Loss: 0.1820378 Test Loss: 0.2059344
Validation loss decreased (0.182042 --> 0.182038).  Saving model ...
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.1061827
	speed: 0.1787s/iter; left time: 33.0564s
Epoch: 29 cost time: 10.429682493209839
Epoch: 29, Steps: 142 | Train Loss: 0.1095860 Vali Loss: 0.1814472 Test Loss: 0.2054650
Validation loss decreased (0.182038 --> 0.181447).  Saving model ...
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.1101124
	speed: 0.1748s/iter; left time: 7.5161s
Epoch: 30 cost time: 10.215114831924438
Epoch: 30, Steps: 142 | Train Loss: 0.1091058 Vali Loss: 0.1804375 Test Loss: 0.2049486
Validation loss decreased (0.181447 --> 0.180437).  Saving model ...
Updating learning rate to 0.00011296777049628277
train 18221
val 2537
test 5165
Model(
  (freq_upsampler): Linear(in_features=34, out_features=68, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  94995456.0
params:  2380.0
Trainable parameters:  2380
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2019642
	speed: 0.0787s/iter; left time: 327.3011s
Epoch: 1 cost time: 10.542413234710693
Epoch: 1, Steps: 142 | Train Loss: 0.2028361 Vali Loss: 0.1789875 Test Loss: 0.2021133
Validation loss decreased (inf --> 0.178987).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2057634
	speed: 0.1894s/iter; left time: 761.1844s
Epoch: 2 cost time: 11.5258207321167
Epoch: 2, Steps: 142 | Train Loss: 0.2024172 Vali Loss: 0.1793159 Test Loss: 0.2020039
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2040385
	speed: 0.1917s/iter; left time: 743.2893s
Epoch: 3 cost time: 11.152906894683838
Epoch: 3, Steps: 142 | Train Loss: 0.2023575 Vali Loss: 0.1791375 Test Loss: 0.2019247
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2005839
	speed: 0.1974s/iter; left time: 737.2753s
Epoch: 4 cost time: 11.42522931098938
Epoch: 4, Steps: 142 | Train Loss: 0.2022906 Vali Loss: 0.1793722 Test Loss: 0.2019207
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2047791
	speed: 0.1989s/iter; left time: 714.6183s
Epoch: 5 cost time: 11.844032049179077
Epoch: 5, Steps: 142 | Train Loss: 0.2022985 Vali Loss: 0.1791854 Test Loss: 0.2019280
EarlyStopping counter: 4 out of 5
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2006795
	speed: 0.1921s/iter; left time: 662.9315s
Epoch: 6 cost time: 10.867992401123047
Epoch: 6, Steps: 142 | Train Loss: 0.2022336 Vali Loss: 0.1786972 Test Loss: 0.2019111
Validation loss decreased (0.178987 --> 0.178697).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2037829
	speed: 0.1956s/iter; left time: 647.0879s
Epoch: 7 cost time: 11.936859369277954
Epoch: 7, Steps: 142 | Train Loss: 0.2022430 Vali Loss: 0.1793026 Test Loss: 0.2019073
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2038477
	speed: 0.2178s/iter; left time: 689.7400s
Epoch: 8 cost time: 12.825652122497559
Epoch: 8, Steps: 142 | Train Loss: 0.2022500 Vali Loss: 0.1787240 Test Loss: 0.2019196
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.2062761
	speed: 0.2148s/iter; left time: 649.7256s
Epoch: 9 cost time: 12.583111047744751
Epoch: 9, Steps: 142 | Train Loss: 0.2021096 Vali Loss: 0.1791783 Test Loss: 0.2019235
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1915302
	speed: 0.2161s/iter; left time: 623.1218s
Epoch: 10 cost time: 12.427683591842651
Epoch: 10, Steps: 142 | Train Loss: 0.2021951 Vali Loss: 0.1790287 Test Loss: 0.2018986
EarlyStopping counter: 4 out of 5
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1984456
	speed: 0.2111s/iter; left time: 578.7220s
Epoch: 11 cost time: 12.574018955230713
Epoch: 11, Steps: 142 | Train Loss: 0.2021208 Vali Loss: 0.1790720 Test Loss: 0.2019175
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : electricity_96_96_FITS_custom_ftM_sl96_ll48_pl96_H8_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
mse:0.20099946856498718, mae:0.27968716621398926, rse:0.4455960690975189, corr:[0.46169868 0.4623474  0.4612107  0.46027878 0.45897067 0.45824903
 0.45708078 0.45610294 0.4554263  0.45474237 0.4541989  0.4537992
 0.4533799  0.45297104 0.45263338 0.4523312  0.4522531  0.45216763
 0.4519241  0.45172888 0.4515948  0.45159504 0.4515625  0.45152518
 0.4508648  0.44976637 0.4490793  0.4480889  0.44711652 0.44659713
 0.4459431  0.4453371  0.4449116  0.4443902  0.44410983 0.44395858
 0.44383118 0.44376114 0.44382948 0.44401455 0.4439809  0.44423896
 0.44449472 0.4445742  0.4451685  0.4459597  0.44665045 0.44812903
 0.44928995 0.44952455 0.44957545 0.44953364 0.4494211  0.44933307
 0.44926998 0.4490245  0.4487902  0.4488988  0.44904846 0.44910282
 0.44932237 0.44955474 0.44986266 0.45033517 0.4508248  0.45151436
 0.4524838  0.45313698 0.45406032 0.4555829  0.45703715 0.4593655
 0.46167532 0.4626223  0.46294886 0.46297935 0.46312228 0.46323803
 0.463246   0.46322155 0.46315628 0.4630668  0.4630289  0.46303982
 0.46295798 0.46284443 0.46285853 0.46290255 0.46286285 0.46289417
 0.4629674  0.4627255  0.4626464  0.46286753 0.46274737 0.46312252]
