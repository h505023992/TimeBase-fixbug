Args in experiment:
Namespace(is_training=1, train_only=False, model_id='DLinear_ETTm1_96_96', model='DLinear', data='ETTm1', root_path='./dataset/', data_path='ETTm1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=96, individual=False, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DLinear_ETTm1_96_96_DLinear_ETTm1_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.5962023
	speed: 0.0311s/iter; left time: 1000.6263s
	iters: 200, epoch: 1 | loss: 0.4476207
	speed: 0.0109s/iter; left time: 349.6240s
	iters: 300, epoch: 1 | loss: 0.3679236
	speed: 0.0107s/iter; left time: 343.0046s
	iters: 400, epoch: 1 | loss: 0.3876763
	speed: 0.0108s/iter; left time: 342.7002s
	iters: 500, epoch: 1 | loss: 0.4013794
	speed: 0.0110s/iter; left time: 349.6785s
	iters: 600, epoch: 1 | loss: 0.3257899
	speed: 0.0111s/iter; left time: 351.7340s
	iters: 700, epoch: 1 | loss: 0.3499563
	speed: 0.0109s/iter; left time: 345.4771s
	iters: 800, epoch: 1 | loss: 0.3187328
	speed: 0.0112s/iter; left time: 352.1963s
	iters: 900, epoch: 1 | loss: 0.4489235
	speed: 0.0108s/iter; left time: 338.9889s
	iters: 1000, epoch: 1 | loss: 0.4130741
	speed: 0.0107s/iter; left time: 334.8114s
Epoch: 1 cost time: 13.8091459274292
Epoch: 1, Steps: 1075 | Train Loss: 0.4482079 Vali Loss: 0.4305351 Test Loss: 0.3763619
Validation loss decreased (inf --> 0.430535).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3764897
	speed: 0.0921s/iter; left time: 2862.1520s
	iters: 200, epoch: 2 | loss: 0.2915067
	speed: 0.0118s/iter; left time: 365.7302s
	iters: 300, epoch: 2 | loss: 0.3263159
	speed: 0.0120s/iter; left time: 371.2184s
	iters: 400, epoch: 2 | loss: 0.3164305
	speed: 0.0128s/iter; left time: 392.5350s
	iters: 500, epoch: 2 | loss: 0.4015628
	speed: 0.0118s/iter; left time: 362.0847s
	iters: 600, epoch: 2 | loss: 0.4682997
	speed: 0.0124s/iter; left time: 378.3837s
	iters: 700, epoch: 2 | loss: 0.3348702
	speed: 0.0125s/iter; left time: 381.1404s
	iters: 800, epoch: 2 | loss: 0.3373944
	speed: 0.0120s/iter; left time: 365.6289s
	iters: 900, epoch: 2 | loss: 0.2974561
	speed: 0.0124s/iter; left time: 374.6438s
	iters: 1000, epoch: 2 | loss: 0.3287093
	speed: 0.0124s/iter; left time: 375.3864s
Epoch: 2 cost time: 13.917985200881958
Epoch: 2, Steps: 1075 | Train Loss: 0.3441814 Vali Loss: 0.4075119 Test Loss: 0.3532649
Validation loss decreased (0.430535 --> 0.407512).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3181417
	speed: 0.1012s/iter; left time: 3035.8512s
	iters: 200, epoch: 3 | loss: 0.3110272
	speed: 0.0123s/iter; left time: 369.2201s
	iters: 300, epoch: 3 | loss: 0.3123766
	speed: 0.0117s/iter; left time: 347.2700s
	iters: 400, epoch: 3 | loss: 0.3222611
	speed: 0.0127s/iter; left time: 376.2496s
	iters: 500, epoch: 3 | loss: 0.3360500
	speed: 0.0118s/iter; left time: 348.3002s
	iters: 600, epoch: 3 | loss: 0.4086916
	speed: 0.0118s/iter; left time: 349.4861s
	iters: 700, epoch: 3 | loss: 0.3589685
	speed: 0.0125s/iter; left time: 367.8111s
	iters: 800, epoch: 3 | loss: 0.3646026
	speed: 0.0121s/iter; left time: 355.4526s
	iters: 900, epoch: 3 | loss: 0.4030599
	speed: 0.0120s/iter; left time: 351.7143s
	iters: 1000, epoch: 3 | loss: 0.3583921
	speed: 0.0120s/iter; left time: 349.3713s
Epoch: 3 cost time: 13.80673360824585
Epoch: 3, Steps: 1075 | Train Loss: 0.3378641 Vali Loss: 0.4030422 Test Loss: 0.3506141
Validation loss decreased (0.407512 --> 0.403042).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3289386
	speed: 0.0998s/iter; left time: 2888.0130s
	iters: 200, epoch: 4 | loss: 0.4469641
	speed: 0.0119s/iter; left time: 343.4238s
	iters: 300, epoch: 4 | loss: 0.3917735
	speed: 0.0125s/iter; left time: 358.0957s
	iters: 400, epoch: 4 | loss: 0.3663419
	speed: 0.0130s/iter; left time: 372.6060s
	iters: 500, epoch: 4 | loss: 0.3026075
	speed: 0.0137s/iter; left time: 389.8734s
	iters: 600, epoch: 4 | loss: 0.3684181
	speed: 0.0134s/iter; left time: 379.9626s
	iters: 700, epoch: 4 | loss: 0.3139189
	speed: 0.0143s/iter; left time: 403.8689s
	iters: 800, epoch: 4 | loss: 0.3165174
	speed: 0.0146s/iter; left time: 411.7127s
	iters: 900, epoch: 4 | loss: 0.2811481
	speed: 0.0136s/iter; left time: 383.7210s
	iters: 1000, epoch: 4 | loss: 0.2849838
	speed: 0.0138s/iter; left time: 387.8740s
Epoch: 4 cost time: 14.93929648399353
Epoch: 4, Steps: 1075 | Train Loss: 0.3361592 Vali Loss: 0.4029008 Test Loss: 0.3499050
Validation loss decreased (0.403042 --> 0.402901).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3083470
	speed: 0.1051s/iter; left time: 2926.5117s
	iters: 200, epoch: 5 | loss: 0.3492189
	speed: 0.0126s/iter; left time: 350.1128s
	iters: 300, epoch: 5 | loss: 0.3253812
	speed: 0.0120s/iter; left time: 333.1681s
	iters: 400, epoch: 5 | loss: 0.3721159
	speed: 0.0125s/iter; left time: 343.2557s
	iters: 500, epoch: 5 | loss: 0.3414362
	speed: 0.0123s/iter; left time: 338.0956s
	iters: 600, epoch: 5 | loss: 0.3528227
	speed: 0.0128s/iter; left time: 350.0159s
	iters: 700, epoch: 5 | loss: 0.3274397
	speed: 0.0124s/iter; left time: 337.7148s
	iters: 800, epoch: 5 | loss: 0.3295492
	speed: 0.0125s/iter; left time: 338.7238s
	iters: 900, epoch: 5 | loss: 0.3409539
	speed: 0.0116s/iter; left time: 312.5548s
	iters: 1000, epoch: 5 | loss: 0.2998362
	speed: 0.0119s/iter; left time: 320.9969s
Epoch: 5 cost time: 14.069676876068115
Epoch: 5, Steps: 1075 | Train Loss: 0.3356285 Vali Loss: 0.4026327 Test Loss: 0.3491697
Validation loss decreased (0.402901 --> 0.402633).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3220625
	speed: 0.1040s/iter; left time: 2783.3841s
	iters: 200, epoch: 6 | loss: 0.3631772
	speed: 0.0111s/iter; left time: 295.3677s
	iters: 300, epoch: 6 | loss: 0.4039101
	speed: 0.0109s/iter; left time: 289.2232s
	iters: 400, epoch: 6 | loss: 0.3046050
	speed: 0.0118s/iter; left time: 313.2545s
	iters: 500, epoch: 6 | loss: 0.4159772
	speed: 0.0113s/iter; left time: 298.2594s
	iters: 600, epoch: 6 | loss: 0.3314880
	speed: 0.0136s/iter; left time: 357.1835s
	iters: 700, epoch: 6 | loss: 0.3072157
	speed: 0.0118s/iter; left time: 308.6294s
	iters: 800, epoch: 6 | loss: 0.3665836
	speed: 0.0116s/iter; left time: 301.8391s
	iters: 900, epoch: 6 | loss: 0.2869128
	speed: 0.0116s/iter; left time: 302.1422s
	iters: 1000, epoch: 6 | loss: 0.3513750
	speed: 0.0118s/iter; left time: 304.3590s
Epoch: 6 cost time: 13.435068368911743
Epoch: 6, Steps: 1075 | Train Loss: 0.3354580 Vali Loss: 0.4015729 Test Loss: 0.3490608
Validation loss decreased (0.402633 --> 0.401573).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3902048
	speed: 0.1010s/iter; left time: 2595.6880s
	iters: 200, epoch: 7 | loss: 0.3467744
	speed: 0.0118s/iter; left time: 301.3155s
	iters: 300, epoch: 7 | loss: 0.3333149
	speed: 0.0125s/iter; left time: 319.6237s
	iters: 400, epoch: 7 | loss: 0.3386145
	speed: 0.0125s/iter; left time: 316.9110s
	iters: 500, epoch: 7 | loss: 0.3575851
	speed: 0.0123s/iter; left time: 311.9284s
	iters: 600, epoch: 7 | loss: 0.3241591
	speed: 0.0117s/iter; left time: 294.1715s
	iters: 700, epoch: 7 | loss: 0.3476835
	speed: 0.0118s/iter; left time: 295.7286s
	iters: 800, epoch: 7 | loss: 0.3786540
	speed: 0.0116s/iter; left time: 290.5775s
	iters: 900, epoch: 7 | loss: 0.3892351
	speed: 0.0122s/iter; left time: 304.2193s
	iters: 1000, epoch: 7 | loss: 0.3111088
	speed: 0.0120s/iter; left time: 298.6016s
Epoch: 7 cost time: 13.677021741867065
Epoch: 7, Steps: 1075 | Train Loss: 0.3351896 Vali Loss: 0.4020992 Test Loss: 0.3488705
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3339861
	speed: 0.1007s/iter; left time: 2479.6642s
	iters: 200, epoch: 8 | loss: 0.3480659
	speed: 0.0117s/iter; left time: 287.1530s
	iters: 300, epoch: 8 | loss: 0.3298927
	speed: 0.0125s/iter; left time: 304.2657s
	iters: 400, epoch: 8 | loss: 0.3507622
	speed: 0.0116s/iter; left time: 283.1427s
	iters: 500, epoch: 8 | loss: 0.2553695
	speed: 0.0116s/iter; left time: 281.8272s
	iters: 600, epoch: 8 | loss: 0.2898341
	speed: 0.0120s/iter; left time: 288.6283s
	iters: 700, epoch: 8 | loss: 0.3893053
	speed: 0.0116s/iter; left time: 279.0576s
	iters: 800, epoch: 8 | loss: 0.2970665
	speed: 0.0119s/iter; left time: 284.4635s
	iters: 900, epoch: 8 | loss: 0.3057426
	speed: 0.0115s/iter; left time: 274.2359s
	iters: 1000, epoch: 8 | loss: 0.2972884
	speed: 0.0122s/iter; left time: 289.6333s
Epoch: 8 cost time: 13.501252889633179
Epoch: 8, Steps: 1075 | Train Loss: 0.3352352 Vali Loss: 0.4013607 Test Loss: 0.3487839
Validation loss decreased (0.401573 --> 0.401361).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3338941
	speed: 0.0965s/iter; left time: 2272.7273s
	iters: 200, epoch: 9 | loss: 0.3309199
	speed: 0.0111s/iter; left time: 259.8524s
	iters: 300, epoch: 9 | loss: 0.3561665
	speed: 0.0111s/iter; left time: 258.1486s
	iters: 400, epoch: 9 | loss: 0.4189532
	speed: 0.0121s/iter; left time: 280.5667s
	iters: 500, epoch: 9 | loss: 0.2650712
	speed: 0.0106s/iter; left time: 246.3471s
	iters: 600, epoch: 9 | loss: 0.2796542
	speed: 0.0105s/iter; left time: 242.8802s
	iters: 700, epoch: 9 | loss: 0.2955461
	speed: 0.0109s/iter; left time: 250.5576s
	iters: 800, epoch: 9 | loss: 0.2966792
	speed: 0.0107s/iter; left time: 244.6972s
	iters: 900, epoch: 9 | loss: 0.3191622
	speed: 0.0105s/iter; left time: 238.1062s
	iters: 1000, epoch: 9 | loss: 0.3597549
	speed: 0.0105s/iter; left time: 238.2414s
Epoch: 9 cost time: 12.40464997291565
Epoch: 9, Steps: 1075 | Train Loss: 0.3352537 Vali Loss: 0.4014317 Test Loss: 0.3487377
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.4152243
	speed: 0.0912s/iter; left time: 2049.4219s
	iters: 200, epoch: 10 | loss: 0.3220376
	speed: 0.0106s/iter; left time: 236.0706s
	iters: 300, epoch: 10 | loss: 0.3197809
	speed: 0.0103s/iter; left time: 229.1787s
	iters: 400, epoch: 10 | loss: 0.3431737
	speed: 0.0107s/iter; left time: 236.3899s
	iters: 500, epoch: 10 | loss: 0.3751958
	speed: 0.0107s/iter; left time: 236.6845s
	iters: 600, epoch: 10 | loss: 0.3283882
	speed: 0.0105s/iter; left time: 230.0565s
	iters: 700, epoch: 10 | loss: 0.3315956
	speed: 0.0105s/iter; left time: 230.5012s
	iters: 800, epoch: 10 | loss: 0.2775809
	speed: 0.0100s/iter; left time: 218.5882s
	iters: 900, epoch: 10 | loss: 0.3090207
	speed: 0.0107s/iter; left time: 231.9238s
	iters: 1000, epoch: 10 | loss: 0.3208908
	speed: 0.0109s/iter; left time: 234.7891s
Epoch: 10 cost time: 12.036163806915283
Epoch: 10, Steps: 1075 | Train Loss: 0.3351142 Vali Loss: 0.4011810 Test Loss: 0.3487201
Validation loss decreased (0.401361 --> 0.401181).  Saving model ...
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.3258640
	speed: 0.0904s/iter; left time: 1933.6153s
	iters: 200, epoch: 11 | loss: 0.3459774
	speed: 0.0108s/iter; left time: 230.5409s
	iters: 300, epoch: 11 | loss: 0.3120355
	speed: 0.0103s/iter; left time: 217.7470s
	iters: 400, epoch: 11 | loss: 0.2843883
	speed: 0.0106s/iter; left time: 224.0769s
	iters: 500, epoch: 11 | loss: 0.3208526
	speed: 0.0110s/iter; left time: 230.0777s
	iters: 600, epoch: 11 | loss: 0.3302211
	speed: 0.0119s/iter; left time: 247.8983s
	iters: 700, epoch: 11 | loss: 0.3599997
	speed: 0.0113s/iter; left time: 235.4557s
	iters: 800, epoch: 11 | loss: 0.3537093
	speed: 0.0114s/iter; left time: 236.3515s
	iters: 900, epoch: 11 | loss: 0.3544106
	speed: 0.0117s/iter; left time: 241.8477s
	iters: 1000, epoch: 11 | loss: 0.3363354
	speed: 0.0114s/iter; left time: 233.0117s
Epoch: 11 cost time: 12.667354106903076
Epoch: 11, Steps: 1075 | Train Loss: 0.3350438 Vali Loss: 0.4011347 Test Loss: 0.3487082
Validation loss decreased (0.401181 --> 0.401135).  Saving model ...
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.2994098
	speed: 0.1011s/iter; left time: 2055.3958s
	iters: 200, epoch: 12 | loss: 0.3513671
	speed: 0.0129s/iter; left time: 260.1581s
	iters: 300, epoch: 12 | loss: 0.3316959
	speed: 0.0137s/iter; left time: 276.0369s
	iters: 400, epoch: 12 | loss: 0.3373612
	speed: 0.0148s/iter; left time: 295.5558s
	iters: 500, epoch: 12 | loss: 0.3192568
	speed: 0.0129s/iter; left time: 257.0708s
	iters: 600, epoch: 12 | loss: 0.3814337
	speed: 0.0134s/iter; left time: 266.0048s
	iters: 700, epoch: 12 | loss: 0.2840435
	speed: 0.0127s/iter; left time: 249.7893s
	iters: 800, epoch: 12 | loss: 0.3718822
	speed: 0.0132s/iter; left time: 259.0878s
	iters: 900, epoch: 12 | loss: 0.2693149
	speed: 0.0129s/iter; left time: 252.2607s
	iters: 1000, epoch: 12 | loss: 0.4007502
	speed: 0.0129s/iter; left time: 250.5729s
Epoch: 12 cost time: 14.954079866409302
Epoch: 12, Steps: 1075 | Train Loss: 0.3352547 Vali Loss: 0.4018135 Test Loss: 0.3487016
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.3070073
	speed: 0.1134s/iter; left time: 2183.5102s
	iters: 200, epoch: 13 | loss: 0.3214862
	speed: 0.0163s/iter; left time: 311.8567s
	iters: 300, epoch: 13 | loss: 0.3272411
	speed: 0.0148s/iter; left time: 282.4300s
	iters: 400, epoch: 13 | loss: 0.3562796
	speed: 0.0125s/iter; left time: 237.4986s
	iters: 500, epoch: 13 | loss: 0.3086521
	speed: 0.0122s/iter; left time: 230.9194s
	iters: 600, epoch: 13 | loss: 0.3393234
	speed: 0.0119s/iter; left time: 222.5748s
	iters: 700, epoch: 13 | loss: 0.2833866
	speed: 0.0121s/iter; left time: 226.3508s
	iters: 800, epoch: 13 | loss: 0.3099526
	speed: 0.0123s/iter; left time: 228.4197s
	iters: 900, epoch: 13 | loss: 0.3456402
	speed: 0.0120s/iter; left time: 221.3716s
	iters: 1000, epoch: 13 | loss: 0.3419596
	speed: 0.0123s/iter; left time: 226.3665s
Epoch: 13 cost time: 14.780491590499878
Epoch: 13, Steps: 1075 | Train Loss: 0.3353097 Vali Loss: 0.4015582 Test Loss: 0.3486994
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.2724466
	speed: 0.1032s/iter; left time: 1876.1832s
	iters: 200, epoch: 14 | loss: 0.3140802
	speed: 0.0125s/iter; left time: 226.0217s
	iters: 300, epoch: 14 | loss: 0.2998375
	speed: 0.0119s/iter; left time: 214.0572s
	iters: 400, epoch: 14 | loss: 0.3548802
	speed: 0.0127s/iter; left time: 227.8533s
	iters: 500, epoch: 14 | loss: 0.3829905
	speed: 0.0127s/iter; left time: 226.5193s
	iters: 600, epoch: 14 | loss: 0.3635045
	speed: 0.0126s/iter; left time: 222.4550s
	iters: 700, epoch: 14 | loss: 0.2974402
	speed: 0.0128s/iter; left time: 225.7037s
	iters: 800, epoch: 14 | loss: 0.3753770
	speed: 0.0124s/iter; left time: 215.9001s
	iters: 900, epoch: 14 | loss: 0.3419075
	speed: 0.0118s/iter; left time: 204.8312s
	iters: 1000, epoch: 14 | loss: 0.3005781
	speed: 0.0109s/iter; left time: 187.4897s
Epoch: 14 cost time: 13.916359663009644
Epoch: 14, Steps: 1075 | Train Loss: 0.3352410 Vali Loss: 0.4015815 Test Loss: 0.3486980
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : DLinear_ETTm1_96_96_DLinear_ETTm1_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.3494330048561096, mae:0.37560099363327026
