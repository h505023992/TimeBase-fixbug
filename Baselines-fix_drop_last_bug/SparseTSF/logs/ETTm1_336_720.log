Args in experiment:
Namespace(is_training=1, model_id='ETTm1_336_720', model='SparseTSF', data='ETTm1', root_path='./dataset/', data_path='ETTm1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=720, period_len=4, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=256, patience=5, learning_rate=0.02, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=2, use_multi_gpu=0, devices='0,1', test_flop=False)
Use GPU: cuda:2
>>>>>>>start training : ETTm1_336_720_SparseTSF_ETTm1_ftM_sl336_pl720_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33505
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.4510137
	speed: 0.1430s/iter; left time: 543.4321s
Epoch: 1 cost time: 17.441312074661255
Epoch: 1, Steps: 130 | Train Loss: 0.5226604 Vali Loss: 1.0025345 Test Loss: 0.4646080
Validation loss decreased (inf --> 1.002535).  Saving model ...
Updating learning rate to 0.02
	iters: 100, epoch: 2 | loss: 0.3867644
	speed: 0.3300s/iter; left time: 1211.5666s
Epoch: 2 cost time: 13.93404245376587
Epoch: 2, Steps: 130 | Train Loss: 0.4277771 Vali Loss: 0.9653802 Test Loss: 0.4390398
Validation loss decreased (1.002535 --> 0.965380).  Saving model ...
Updating learning rate to 0.02
	iters: 100, epoch: 3 | loss: 0.4273078
	speed: 0.2662s/iter; left time: 942.7482s
Epoch: 3 cost time: 11.822983503341675
Epoch: 3, Steps: 130 | Train Loss: 0.4219679 Vali Loss: 0.9759554 Test Loss: 0.4324393
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.02
	iters: 100, epoch: 4 | loss: 0.4266027
	speed: 0.3130s/iter; left time: 1067.7496s
Epoch: 4 cost time: 13.218313932418823
Epoch: 4, Steps: 130 | Train Loss: 0.4208577 Vali Loss: 0.9687665 Test Loss: 0.4331870
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.016
	iters: 100, epoch: 5 | loss: 0.4317263
	speed: 0.2955s/iter; left time: 969.5299s
Epoch: 5 cost time: 13.048437118530273
Epoch: 5, Steps: 130 | Train Loss: 0.4195917 Vali Loss: 0.9652939 Test Loss: 0.4311867
Validation loss decreased (0.965380 --> 0.965294).  Saving model ...
Updating learning rate to 0.012800000000000002
	iters: 100, epoch: 6 | loss: 0.4290103
	speed: 0.2911s/iter; left time: 917.1108s
Epoch: 6 cost time: 11.627625942230225
Epoch: 6, Steps: 130 | Train Loss: 0.4187025 Vali Loss: 0.9660371 Test Loss: 0.4301156
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.010240000000000003
	iters: 100, epoch: 7 | loss: 0.4262964
	speed: 0.2887s/iter; left time: 872.0477s
Epoch: 7 cost time: 13.647656917572021
Epoch: 7, Steps: 130 | Train Loss: 0.4178392 Vali Loss: 0.9724619 Test Loss: 0.4294612
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.008192000000000001
	iters: 100, epoch: 8 | loss: 0.3954402
	speed: 0.3202s/iter; left time: 925.7332s
Epoch: 8 cost time: 13.688047647476196
Epoch: 8, Steps: 130 | Train Loss: 0.4177660 Vali Loss: 0.9681889 Test Loss: 0.4306808
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.0065536000000000014
	iters: 100, epoch: 9 | loss: 0.4284208
	speed: 0.3069s/iter; left time: 847.4319s
Epoch: 9 cost time: 13.078741788864136
Epoch: 9, Steps: 130 | Train Loss: 0.4174557 Vali Loss: 0.9638286 Test Loss: 0.4293047
Validation loss decreased (0.965294 --> 0.963829).  Saving model ...
Updating learning rate to 0.005242880000000002
	iters: 100, epoch: 10 | loss: 0.4448594
	speed: 0.2838s/iter; left time: 746.6165s
Epoch: 10 cost time: 12.856113910675049
Epoch: 10, Steps: 130 | Train Loss: 0.4173494 Vali Loss: 0.9647607 Test Loss: 0.4293131
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.004194304000000002
	iters: 100, epoch: 11 | loss: 0.3928789
	speed: 0.3077s/iter; left time: 769.5040s
Epoch: 11 cost time: 12.6450514793396
Epoch: 11, Steps: 130 | Train Loss: 0.4171953 Vali Loss: 0.9604949 Test Loss: 0.4301265
Validation loss decreased (0.963829 --> 0.960495).  Saving model ...
Updating learning rate to 0.003355443200000002
	iters: 100, epoch: 12 | loss: 0.4007833
	speed: 0.2976s/iter; left time: 705.5539s
Epoch: 12 cost time: 13.410483837127686
Epoch: 12, Steps: 130 | Train Loss: 0.4171189 Vali Loss: 0.9611878 Test Loss: 0.4290870
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.002684354560000001
	iters: 100, epoch: 13 | loss: 0.4194230
	speed: 0.3230s/iter; left time: 723.7395s
Epoch: 13 cost time: 13.219350099563599
Epoch: 13, Steps: 130 | Train Loss: 0.4168302 Vali Loss: 0.9643191 Test Loss: 0.4284811
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.0021474836480000013
	iters: 100, epoch: 14 | loss: 0.4115508
	speed: 0.3258s/iter; left time: 687.7897s
Epoch: 14 cost time: 14.047629833221436
Epoch: 14, Steps: 130 | Train Loss: 0.4170587 Vali Loss: 0.9599935 Test Loss: 0.4301254
Validation loss decreased (0.960495 --> 0.959994).  Saving model ...
Updating learning rate to 0.0017179869184000011
	iters: 100, epoch: 15 | loss: 0.4130983
	speed: 0.3211s/iter; left time: 636.0240s
Epoch: 15 cost time: 12.933427810668945
Epoch: 15, Steps: 130 | Train Loss: 0.4168454 Vali Loss: 0.9640761 Test Loss: 0.4280383
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0013743895347200009
	iters: 100, epoch: 16 | loss: 0.4313669
	speed: 0.3113s/iter; left time: 576.1517s
Epoch: 16 cost time: 13.127083778381348
Epoch: 16, Steps: 130 | Train Loss: 0.4168901 Vali Loss: 0.9646477 Test Loss: 0.4289405
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.0010995116277760007
	iters: 100, epoch: 17 | loss: 0.4213692
	speed: 0.3115s/iter; left time: 536.0477s
Epoch: 17 cost time: 13.15771222114563
Epoch: 17, Steps: 130 | Train Loss: 0.4170467 Vali Loss: 0.9631398 Test Loss: 0.4285828
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.0008796093022208007
	iters: 100, epoch: 18 | loss: 0.4342469
	speed: 0.3008s/iter; left time: 478.5138s
Epoch: 18 cost time: 12.888146877288818
Epoch: 18, Steps: 130 | Train Loss: 0.4170215 Vali Loss: 0.9640992 Test Loss: 0.4292240
EarlyStopping counter: 4 out of 5
Updating learning rate to 0.0007036874417766406
	iters: 100, epoch: 19 | loss: 0.4205115
	speed: 0.3148s/iter; left time: 459.9008s
Epoch: 19 cost time: 13.222491979598999
Epoch: 19, Steps: 130 | Train Loss: 0.4166736 Vali Loss: 0.9628688 Test Loss: 0.4290458
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTm1_336_720_SparseTSF_ETTm1_ftM_sl336_pl720_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
mse:0.4287508428096771, mae:0.41651567816734314, rse:0.6229787468910217
