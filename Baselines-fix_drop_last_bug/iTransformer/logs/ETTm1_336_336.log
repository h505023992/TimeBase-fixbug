Args in experiment:
Namespace(is_training=1, model_id='ETTm1_336_336', model='iTransformer', data='ETTm1', root_path='./dataset/', data_path='ETTm1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=336, enc_in=7, dec_in=7, c_out=7, d_model=128, n_heads=8, e_layers=2, d_layers=1, d_ff=128, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='MSE', lradj='type1', use_amp=False, use_gpu=True, gpu=2, use_multi_gpu=False, devices='0,1,2,3', exp_name='MTSF', channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv', efficient_training=False, use_norm=True, partial_start_index=0)
Use GPU: cuda:2
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.dropout.Dropout'>.
[INFO] Register count_convNd() for <class 'torch.nn.modules.conv.Conv1d'>.
[INFO] Register count_normalization() for <class 'torch.nn.modules.normalization.LayerNorm'>.
MACs: 3707392.0
Params: 285904.0
3.71M MACs
>>>>>>>start training : ETTm1_336_336_iTransformer_ETTm1_M_ft336_sl48_ll336_pl128_dm8_nh2_el1_dl128_df1_fctimeF_ebTrue_dtExp_projection_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33889
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.4466820
	speed: 0.0462s/iter; left time: 484.1672s
	iters: 200, epoch: 1 | loss: 0.3773246
	speed: 0.0294s/iter; left time: 305.9063s
	iters: 300, epoch: 1 | loss: 0.3646241
	speed: 0.0269s/iter; left time: 276.5361s
	iters: 400, epoch: 1 | loss: 0.3858204
	speed: 0.0271s/iter; left time: 275.9293s
	iters: 500, epoch: 1 | loss: 0.3929825
	speed: 0.0283s/iter; left time: 285.8010s
	iters: 600, epoch: 1 | loss: 0.3050018
	speed: 0.0286s/iter; left time: 285.7822s
	iters: 700, epoch: 1 | loss: 0.3419007
	speed: 0.0277s/iter; left time: 274.4645s
	iters: 800, epoch: 1 | loss: 0.3059580
	speed: 0.0285s/iter; left time: 279.1448s
	iters: 900, epoch: 1 | loss: 0.3479864
	speed: 0.0274s/iter; left time: 265.3148s
	iters: 1000, epoch: 1 | loss: 0.3125393
	speed: 0.0307s/iter; left time: 294.3545s
Max Memory (MB): 15.380859375
Epoch: 1 cost time: 31.798459768295288
Epoch: 1, Steps: 1059 | Train Loss: 0.3900012 Vali Loss: 0.6412730 Test Loss: 0.3808531
Validation loss decreased (inf --> 0.641273).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4021518
	speed: 0.8356s/iter; left time: 7881.5807s
	iters: 200, epoch: 2 | loss: 0.3321626
	speed: 0.0365s/iter; left time: 340.2728s
	iters: 300, epoch: 2 | loss: 0.3069880
	speed: 0.0379s/iter; left time: 350.1714s
	iters: 400, epoch: 2 | loss: 0.3709924
	speed: 0.0398s/iter; left time: 363.1592s
	iters: 500, epoch: 2 | loss: 0.3477806
	speed: 0.0353s/iter; left time: 318.8176s
	iters: 600, epoch: 2 | loss: 0.2991566
	speed: 0.0353s/iter; left time: 315.2087s
	iters: 700, epoch: 2 | loss: 0.3334025
	speed: 0.0384s/iter; left time: 339.5592s
	iters: 800, epoch: 2 | loss: 0.3200782
	speed: 0.0376s/iter; left time: 328.2780s
	iters: 900, epoch: 2 | loss: 0.4056987
	speed: 0.0342s/iter; left time: 294.9836s
	iters: 1000, epoch: 2 | loss: 0.3212598
	speed: 0.0341s/iter; left time: 291.2248s
Max Memory (MB): 15.380859375
Epoch: 2 cost time: 39.30622434616089
Epoch: 2, Steps: 1059 | Train Loss: 0.3411289 Vali Loss: 0.6492404 Test Loss: 0.3810584
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3785828
	speed: 0.8703s/iter; left time: 7286.7695s
	iters: 200, epoch: 3 | loss: 0.2844825
	speed: 0.0291s/iter; left time: 241.1537s
	iters: 300, epoch: 3 | loss: 0.3494421
	speed: 0.0284s/iter; left time: 232.0579s
	iters: 400, epoch: 3 | loss: 0.3517788
	speed: 0.0292s/iter; left time: 235.6009s
	iters: 500, epoch: 3 | loss: 0.3200671
	speed: 0.0266s/iter; left time: 212.4263s
	iters: 600, epoch: 3 | loss: 0.3115577
	speed: 0.0311s/iter; left time: 244.7737s
	iters: 700, epoch: 3 | loss: 0.2922575
	speed: 0.0332s/iter; left time: 257.9577s
	iters: 800, epoch: 3 | loss: 0.3220562
	speed: 0.0308s/iter; left time: 236.1696s
	iters: 900, epoch: 3 | loss: 0.2748430
	speed: 0.0311s/iter; left time: 235.5505s
	iters: 1000, epoch: 3 | loss: 0.2825628
	speed: 0.0357s/iter; left time: 267.0404s
Max Memory (MB): 15.380859375
Epoch: 3 cost time: 33.19883465766907
Epoch: 3, Steps: 1059 | Train Loss: 0.3252541 Vali Loss: 0.6483699 Test Loss: 0.3816571
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3492020
	speed: 0.8843s/iter; left time: 6467.5918s
	iters: 200, epoch: 4 | loss: 0.3837849
	speed: 0.0296s/iter; left time: 213.3856s
	iters: 300, epoch: 4 | loss: 0.2946112
	speed: 0.0317s/iter; left time: 225.5441s
	iters: 400, epoch: 4 | loss: 0.3041428
	speed: 0.0332s/iter; left time: 232.5530s
	iters: 500, epoch: 4 | loss: 0.3206632
	speed: 0.0299s/iter; left time: 206.7100s
	iters: 600, epoch: 4 | loss: 0.2780747
	speed: 0.0406s/iter; left time: 276.9647s
	iters: 700, epoch: 4 | loss: 0.2753443
	speed: 0.0414s/iter; left time: 277.9867s
	iters: 800, epoch: 4 | loss: 0.3408581
	speed: 0.0381s/iter; left time: 252.0984s
	iters: 900, epoch: 4 | loss: 0.2761070
	speed: 0.0393s/iter; left time: 256.0003s
	iters: 1000, epoch: 4 | loss: 0.3446243
	speed: 0.0419s/iter; left time: 268.9411s
Max Memory (MB): 15.380859375
Epoch: 4 cost time: 38.80438232421875
Epoch: 4, Steps: 1059 | Train Loss: 0.3192148 Vali Loss: 0.6432340 Test Loss: 0.3817465
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm1_336_336_iTransformer_ETTm1_M_ft336_sl48_ll336_pl128_dm8_nh2_el1_dl128_df1_fctimeF_ebTrue_dtExp_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
test shape: (11185, 1, 336, 7) (11185, 1, 336, 7)
test shape: (11185, 336, 7) (11185, 336, 7)
mse:0.3808528780937195, mae:0.4021799564361572
