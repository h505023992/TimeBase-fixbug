Args in experiment:
Namespace(is_training=1, model_id='traffic_720_192', model='iTransformer', data='custom', root_path='./dataset/', data_path='traffic.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=192, enc_in=862, dec_in=862, c_out=862, d_model=256, n_heads=8, e_layers=2, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=10, batch_size=4, patience=3, learning_rate=0.0001, des='Exp', loss='MSE', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', exp_name='MTSF', channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv', efficient_training=False, use_norm=True, partial_start_index=0)
Use GPU: cuda:0
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.dropout.Dropout'>.
[INFO] Register count_convNd() for <class 'torch.nn.modules.conv.Conv1d'>.
[INFO] Register count_normalization() for <class 'torch.nn.modules.normalization.LayerNorm'>.
MACs: 889720832.0
Params: 1025984.0
889.72M MACs
>>>>>>>start training : traffic_720_192_iTransformer_custom_M_ft720_sl48_ll192_pl256_dm8_nh2_el1_dl256_df1_fctimeF_ebTrue_dtExp_projection_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11369
val 1565
test 3317
	iters: 100, epoch: 1 | loss: 0.4531148
	speed: 0.0549s/iter; left time: 1553.4694s
	iters: 200, epoch: 1 | loss: 0.4025617
	speed: 0.0444s/iter; left time: 1251.8088s
	iters: 300, epoch: 1 | loss: 0.3556804
	speed: 0.0492s/iter; left time: 1382.2330s
	iters: 400, epoch: 1 | loss: 0.3526005
	speed: 0.0540s/iter; left time: 1514.2000s
	iters: 500, epoch: 1 | loss: 0.3408333
	speed: 0.0460s/iter; left time: 1284.8588s
	iters: 600, epoch: 1 | loss: 0.2722351
	speed: 0.0463s/iter; left time: 1286.7281s
	iters: 700, epoch: 1 | loss: 0.2976978
	speed: 0.0469s/iter; left time: 1300.7317s
	iters: 800, epoch: 1 | loss: 0.2805099
	speed: 0.0479s/iter; left time: 1322.3330s
	iters: 900, epoch: 1 | loss: 0.3253185
	speed: 0.0572s/iter; left time: 1575.4943s
	iters: 1000, epoch: 1 | loss: 0.2687882
	speed: 0.0528s/iter; left time: 1448.4476s
	iters: 1100, epoch: 1 | loss: 0.2537788
	speed: 0.0504s/iter; left time: 1375.6740s
	iters: 1200, epoch: 1 | loss: 0.2761447
	speed: 0.0511s/iter; left time: 1390.0041s
	iters: 1300, epoch: 1 | loss: 0.2526588
	speed: 0.0496s/iter; left time: 1344.4503s
	iters: 1400, epoch: 1 | loss: 0.3008222
	speed: 0.0498s/iter; left time: 1346.2671s
	iters: 1500, epoch: 1 | loss: 0.2692690
	speed: 0.0484s/iter; left time: 1304.0248s
	iters: 1600, epoch: 1 | loss: 0.3039651
	speed: 0.0461s/iter; left time: 1236.2310s
	iters: 1700, epoch: 1 | loss: 0.2809571
	speed: 0.0454s/iter; left time: 1213.5237s
	iters: 1800, epoch: 1 | loss: 0.2934366
	speed: 0.0441s/iter; left time: 1174.7312s
	iters: 1900, epoch: 1 | loss: 0.3158605
	speed: 0.0469s/iter; left time: 1244.2683s
	iters: 2000, epoch: 1 | loss: 0.2439722
	speed: 0.0443s/iter; left time: 1169.8714s
	iters: 2100, epoch: 1 | loss: 0.3213185
	speed: 0.0536s/iter; left time: 1411.6223s
	iters: 2200, epoch: 1 | loss: 0.2679547
	speed: 0.0465s/iter; left time: 1218.9118s
	iters: 2300, epoch: 1 | loss: 0.2657438
	speed: 0.0462s/iter; left time: 1206.2905s
	iters: 2400, epoch: 1 | loss: 0.2616079
	speed: 0.0443s/iter; left time: 1152.5153s
	iters: 2500, epoch: 1 | loss: 0.2931123
	speed: 0.0444s/iter; left time: 1151.8564s
	iters: 2600, epoch: 1 | loss: 0.2957541
	speed: 0.0527s/iter; left time: 1360.9196s
	iters: 2700, epoch: 1 | loss: 0.2417157
	speed: 0.0498s/iter; left time: 1281.3256s
	iters: 2800, epoch: 1 | loss: 0.2800415
	speed: 0.0486s/iter; left time: 1244.2339s
Max Memory (MB): 676.63134765625
Epoch: 1 cost time: 138.40127611160278
Epoch: 1, Steps: 2842 | Train Loss: 0.3089227 Vali Loss: 0.3472023 Test Loss: 0.4232170
Validation loss decreased (inf --> 0.347202).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2385428
	speed: 0.9642s/iter; left time: 24567.9272s
	iters: 200, epoch: 2 | loss: 0.2601517
	speed: 0.0497s/iter; left time: 1261.3691s
	iters: 300, epoch: 2 | loss: 0.2350458
	speed: 0.0503s/iter; left time: 1271.7581s
	iters: 400, epoch: 2 | loss: 0.2382731
	speed: 0.0497s/iter; left time: 1252.0612s
	iters: 500, epoch: 2 | loss: 0.2405069
	speed: 0.0512s/iter; left time: 1284.3098s
	iters: 600, epoch: 2 | loss: 0.2785112
	speed: 0.0468s/iter; left time: 1169.2305s
	iters: 700, epoch: 2 | loss: 0.2916126
	speed: 0.0471s/iter; left time: 1171.9117s
	iters: 800, epoch: 2 | loss: 0.2569860
	speed: 0.0504s/iter; left time: 1249.1084s
	iters: 900, epoch: 2 | loss: 0.2566372
	speed: 0.0485s/iter; left time: 1196.7036s
	iters: 1000, epoch: 2 | loss: 0.2333372
	speed: 0.0581s/iter; left time: 1426.8184s
	iters: 1100, epoch: 2 | loss: 0.3152235
	speed: 0.0508s/iter; left time: 1244.7226s
	iters: 1200, epoch: 2 | loss: 0.2605425
	speed: 0.0466s/iter; left time: 1137.1564s
	iters: 1300, epoch: 2 | loss: 0.2728864
	speed: 0.0497s/iter; left time: 1206.3942s
	iters: 1400, epoch: 2 | loss: 0.2842311
	speed: 0.0468s/iter; left time: 1132.2467s
	iters: 1500, epoch: 2 | loss: 0.2905026
	speed: 0.0585s/iter; left time: 1408.6584s
	iters: 1600, epoch: 2 | loss: 0.2700213
	speed: 0.0555s/iter; left time: 1331.3093s
	iters: 1700, epoch: 2 | loss: 0.2748901
	speed: 0.0506s/iter; left time: 1209.4525s
	iters: 1800, epoch: 2 | loss: 0.2170822
	speed: 0.0491s/iter; left time: 1166.5194s
	iters: 1900, epoch: 2 | loss: 0.2287282
	speed: 0.0491s/iter; left time: 1163.7449s
	iters: 2000, epoch: 2 | loss: 0.3005874
	speed: 0.0489s/iter; left time: 1154.0200s
	iters: 2100, epoch: 2 | loss: 0.2537807
	speed: 0.0517s/iter; left time: 1213.5883s
	iters: 2200, epoch: 2 | loss: 0.2577156
	speed: 0.0501s/iter; left time: 1171.3827s
	iters: 2300, epoch: 2 | loss: 0.2722452
	speed: 0.0438s/iter; left time: 1018.5133s
	iters: 2400, epoch: 2 | loss: 0.2271544
	speed: 0.0456s/iter; left time: 1057.4973s
	iters: 2500, epoch: 2 | loss: 0.2537027
	speed: 0.0478s/iter; left time: 1102.4044s
	iters: 2600, epoch: 2 | loss: 0.2511458
	speed: 0.0446s/iter; left time: 1024.3916s
	iters: 2700, epoch: 2 | loss: 0.2816432
	speed: 0.0498s/iter; left time: 1139.4486s
	iters: 2800, epoch: 2 | loss: 0.2665437
	speed: 0.0512s/iter; left time: 1166.4663s
Max Memory (MB): 676.63134765625
Epoch: 2 cost time: 143.10231947898865
Epoch: 2, Steps: 2842 | Train Loss: 0.2599707 Vali Loss: 0.3367828 Test Loss: 0.4058520
Validation loss decreased (0.347202 --> 0.336783).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2287649
	speed: 1.0200s/iter; left time: 23089.5756s
	iters: 200, epoch: 3 | loss: 0.2844841
	speed: 0.0429s/iter; left time: 966.8451s
	iters: 300, epoch: 3 | loss: 0.2607706
	speed: 0.0481s/iter; left time: 1079.9792s
	iters: 400, epoch: 3 | loss: 0.2249951
	speed: 0.0500s/iter; left time: 1116.4536s
	iters: 500, epoch: 3 | loss: 0.2391470
	speed: 0.0442s/iter; left time: 982.9463s
	iters: 600, epoch: 3 | loss: 0.2444458
	speed: 0.0460s/iter; left time: 1018.0862s
	iters: 700, epoch: 3 | loss: 0.2664790
	speed: 0.0518s/iter; left time: 1142.3561s
	iters: 800, epoch: 3 | loss: 0.2512783
	speed: 0.0531s/iter; left time: 1164.0844s
	iters: 900, epoch: 3 | loss: 0.2800661
	speed: 0.0522s/iter; left time: 1140.8869s
	iters: 1000, epoch: 3 | loss: 0.2658114
	speed: 0.0431s/iter; left time: 935.8563s
	iters: 1100, epoch: 3 | loss: 0.1957222
	speed: 0.0414s/iter; left time: 896.8225s
	iters: 1200, epoch: 3 | loss: 0.2212887
	speed: 0.0448s/iter; left time: 964.9694s
	iters: 1300, epoch: 3 | loss: 0.2058430
	speed: 0.0420s/iter; left time: 901.0299s
	iters: 1400, epoch: 3 | loss: 0.1944179
	speed: 0.0426s/iter; left time: 909.2077s
	iters: 1500, epoch: 3 | loss: 0.2434575
	speed: 0.0422s/iter; left time: 896.5051s
	iters: 1600, epoch: 3 | loss: 0.2622750
	speed: 0.0419s/iter; left time: 885.2470s
	iters: 1700, epoch: 3 | loss: 0.2874006
	speed: 0.0416s/iter; left time: 875.0471s
	iters: 1800, epoch: 3 | loss: 0.2261230
	speed: 0.0402s/iter; left time: 841.0986s
	iters: 1900, epoch: 3 | loss: 0.3154336
	speed: 0.0396s/iter; left time: 826.0325s
	iters: 2000, epoch: 3 | loss: 0.2512973
	speed: 0.0406s/iter; left time: 841.0225s
	iters: 2100, epoch: 3 | loss: 0.2348051
	speed: 0.0409s/iter; left time: 845.0350s
	iters: 2200, epoch: 3 | loss: 0.2125931
	speed: 0.0397s/iter; left time: 815.7551s
	iters: 2300, epoch: 3 | loss: 0.2531328
	speed: 0.0400s/iter; left time: 817.7307s
	iters: 2400, epoch: 3 | loss: 0.2524119
	speed: 0.0415s/iter; left time: 843.3205s
	iters: 2500, epoch: 3 | loss: 0.2533848
	speed: 0.0401s/iter; left time: 810.5136s
	iters: 2600, epoch: 3 | loss: 0.2390343
	speed: 0.0413s/iter; left time: 832.0627s
	iters: 2700, epoch: 3 | loss: 0.2422780
	speed: 0.0397s/iter; left time: 795.5316s
	iters: 2800, epoch: 3 | loss: 0.2470545
	speed: 0.0413s/iter; left time: 822.9082s
Max Memory (MB): 676.63134765625
Epoch: 3 cost time: 125.04049921035767
Epoch: 3, Steps: 2842 | Train Loss: 0.2504704 Vali Loss: 0.3327750 Test Loss: 0.3998119
Validation loss decreased (0.336783 --> 0.332775).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2194928
	speed: 0.9554s/iter; left time: 18912.8965s
	iters: 200, epoch: 4 | loss: 0.2481710
	speed: 0.0475s/iter; left time: 935.3554s
	iters: 300, epoch: 4 | loss: 0.2957210
	speed: 0.0464s/iter; left time: 909.7810s
	iters: 400, epoch: 4 | loss: 0.2438123
	speed: 0.0481s/iter; left time: 938.1047s
	iters: 500, epoch: 4 | loss: 0.2331349
	speed: 0.0450s/iter; left time: 873.0275s
	iters: 600, epoch: 4 | loss: 0.2652570
	speed: 0.0458s/iter; left time: 883.7983s
	iters: 700, epoch: 4 | loss: 0.2396083
	speed: 0.0510s/iter; left time: 978.1746s
	iters: 800, epoch: 4 | loss: 0.2246001
	speed: 0.0519s/iter; left time: 991.4463s
	iters: 900, epoch: 4 | loss: 0.2556757
	speed: 0.0487s/iter; left time: 924.8203s
	iters: 1000, epoch: 4 | loss: 0.2302315
	speed: 0.0479s/iter; left time: 905.2806s
	iters: 1100, epoch: 4 | loss: 0.2581000
	speed: 0.0547s/iter; left time: 1028.3702s
	iters: 1200, epoch: 4 | loss: 0.2131571
	speed: 0.0516s/iter; left time: 964.6565s
	iters: 1300, epoch: 4 | loss: 0.2265896
	speed: 0.0505s/iter; left time: 938.7100s
	iters: 1400, epoch: 4 | loss: 0.2814507
	speed: 0.0524s/iter; left time: 969.8836s
	iters: 1500, epoch: 4 | loss: 0.2403797
	speed: 0.0528s/iter; left time: 970.9446s
	iters: 1600, epoch: 4 | loss: 0.2360324
	speed: 0.0472s/iter; left time: 862.7085s
	iters: 1700, epoch: 4 | loss: 0.2533531
	speed: 0.0494s/iter; left time: 898.0100s
	iters: 1800, epoch: 4 | loss: 0.2459363
	speed: 0.0445s/iter; left time: 805.9573s
	iters: 1900, epoch: 4 | loss: 0.2485481
	speed: 0.0491s/iter; left time: 883.5418s
	iters: 2000, epoch: 4 | loss: 0.2051714
	speed: 0.0401s/iter; left time: 716.8569s
	iters: 2100, epoch: 4 | loss: 0.2294336
	speed: 0.0395s/iter; left time: 702.6875s
	iters: 2200, epoch: 4 | loss: 0.2304082
	speed: 0.0479s/iter; left time: 846.9616s
	iters: 2300, epoch: 4 | loss: 0.2358700
	speed: 0.0413s/iter; left time: 726.8678s
	iters: 2400, epoch: 4 | loss: 0.2069498
	speed: 0.0418s/iter; left time: 730.9035s
	iters: 2500, epoch: 4 | loss: 0.2692659
	speed: 0.0430s/iter; left time: 748.1065s
	iters: 2600, epoch: 4 | loss: 0.2295144
	speed: 0.0425s/iter; left time: 734.7969s
	iters: 2700, epoch: 4 | loss: 0.2472604
	speed: 0.0407s/iter; left time: 699.9878s
	iters: 2800, epoch: 4 | loss: 0.2364899
	speed: 0.0387s/iter; left time: 660.8205s
Max Memory (MB): 676.63134765625
Epoch: 4 cost time: 134.75088453292847
Epoch: 4, Steps: 2842 | Train Loss: 0.2466671 Vali Loss: 0.3309244 Test Loss: 0.3964451
Validation loss decreased (0.332775 --> 0.330924).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2578163
	speed: 0.8855s/iter; left time: 15011.3050s
	iters: 200, epoch: 5 | loss: 0.2253375
	speed: 0.0482s/iter; left time: 812.8895s
	iters: 300, epoch: 5 | loss: 0.2412232
	speed: 0.0488s/iter; left time: 817.0359s
	iters: 400, epoch: 5 | loss: 0.2705402
	speed: 0.0487s/iter; left time: 810.7185s
	iters: 500, epoch: 5 | loss: 0.2669349
	speed: 0.0455s/iter; left time: 753.4026s
	iters: 600, epoch: 5 | loss: 0.2912790
	speed: 0.0466s/iter; left time: 766.9441s
	iters: 700, epoch: 5 | loss: 0.2759644
	speed: 0.0453s/iter; left time: 741.1520s
	iters: 800, epoch: 5 | loss: 0.2340006
	speed: 0.0530s/iter; left time: 861.2896s
	iters: 900, epoch: 5 | loss: 0.2429942
	speed: 0.0464s/iter; left time: 749.0036s
	iters: 1000, epoch: 5 | loss: 0.3005083
	speed: 0.0484s/iter; left time: 776.6114s
	iters: 1100, epoch: 5 | loss: 0.2561143
	speed: 0.0509s/iter; left time: 812.7405s
	iters: 1200, epoch: 5 | loss: 0.2245237
	speed: 0.0511s/iter; left time: 809.8104s
	iters: 1300, epoch: 5 | loss: 0.2388366
	speed: 0.0503s/iter; left time: 791.6037s
	iters: 1400, epoch: 5 | loss: 0.2663991
	speed: 0.0481s/iter; left time: 752.6645s
	iters: 1500, epoch: 5 | loss: 0.2231582
	speed: 0.0487s/iter; left time: 756.9694s
	iters: 1600, epoch: 5 | loss: 0.1989713
	speed: 0.0452s/iter; left time: 698.6777s
	iters: 1700, epoch: 5 | loss: 0.2350388
	speed: 0.0486s/iter; left time: 746.3179s
	iters: 1800, epoch: 5 | loss: 0.2501352
	speed: 0.0520s/iter; left time: 792.6254s
	iters: 1900, epoch: 5 | loss: 0.2607541
	speed: 0.0500s/iter; left time: 757.8969s
	iters: 2000, epoch: 5 | loss: 0.2075892
	speed: 0.0459s/iter; left time: 691.3650s
	iters: 2100, epoch: 5 | loss: 0.2318604
	speed: 0.0541s/iter; left time: 809.6925s
	iters: 2200, epoch: 5 | loss: 0.2749271
	speed: 0.0487s/iter; left time: 723.3114s
	iters: 2300, epoch: 5 | loss: 0.2491339
	speed: 0.0489s/iter; left time: 720.7099s
	iters: 2400, epoch: 5 | loss: 0.2193486
	speed: 0.0476s/iter; left time: 697.6511s
	iters: 2500, epoch: 5 | loss: 0.2370606
	speed: 0.0480s/iter; left time: 697.8956s
	iters: 2600, epoch: 5 | loss: 0.2533466
	speed: 0.0459s/iter; left time: 664.0538s
	iters: 2700, epoch: 5 | loss: 0.2653075
	speed: 0.0444s/iter; left time: 637.0103s
	iters: 2800, epoch: 5 | loss: 0.2720813
	speed: 0.0469s/iter; left time: 669.1417s
Max Memory (MB): 676.63134765625
Epoch: 5 cost time: 139.23478984832764
Epoch: 5, Steps: 2842 | Train Loss: 0.2448657 Vali Loss: 0.3297161 Test Loss: 0.3945589
Validation loss decreased (0.330924 --> 0.329716).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2430497
	speed: 1.0435s/iter; left time: 14724.4404s
	iters: 200, epoch: 6 | loss: 0.2784774
	speed: 0.0454s/iter; left time: 636.1588s
	iters: 300, epoch: 6 | loss: 0.2315248
	speed: 0.0501s/iter; left time: 697.0950s
	iters: 400, epoch: 6 | loss: 0.2673521
	speed: 0.0439s/iter; left time: 605.9705s
	iters: 500, epoch: 6 | loss: 0.2690612
	speed: 0.0507s/iter; left time: 695.1319s
	iters: 600, epoch: 6 | loss: 0.2741674
	speed: 0.0464s/iter; left time: 631.2977s
	iters: 700, epoch: 6 | loss: 0.2511532
	speed: 0.0451s/iter; left time: 609.0287s
	iters: 800, epoch: 6 | loss: 0.2441313
	speed: 0.0466s/iter; left time: 624.7654s
	iters: 900, epoch: 6 | loss: 0.2306289
	speed: 0.0471s/iter; left time: 626.4215s
	iters: 1000, epoch: 6 | loss: 0.2441263
	speed: 0.0445s/iter; left time: 587.3443s
	iters: 1100, epoch: 6 | loss: 0.2539759
	speed: 0.0463s/iter; left time: 606.4330s
	iters: 1200, epoch: 6 | loss: 0.2314089
	speed: 0.0499s/iter; left time: 649.5055s
	iters: 1300, epoch: 6 | loss: 0.2556979
	speed: 0.0520s/iter; left time: 671.7298s
	iters: 1400, epoch: 6 | loss: 0.2586915
	speed: 0.0458s/iter; left time: 586.4469s
	iters: 1500, epoch: 6 | loss: 0.2895671
	speed: 0.0462s/iter; left time: 587.0052s
	iters: 1600, epoch: 6 | loss: 0.2397582
	speed: 0.0537s/iter; left time: 676.9109s
	iters: 1700, epoch: 6 | loss: 0.2741835
	speed: 0.0507s/iter; left time: 634.7926s
	iters: 1800, epoch: 6 | loss: 0.2408041
	speed: 0.0481s/iter; left time: 596.8367s
	iters: 1900, epoch: 6 | loss: 0.2521051
	speed: 0.0494s/iter; left time: 607.7666s
	iters: 2000, epoch: 6 | loss: 0.2707716
	speed: 0.0512s/iter; left time: 625.7805s
	iters: 2100, epoch: 6 | loss: 0.2406193
	speed: 0.0477s/iter; left time: 577.8501s
	iters: 2200, epoch: 6 | loss: 0.1984233
	speed: 0.0514s/iter; left time: 617.2638s
	iters: 2300, epoch: 6 | loss: 0.2328916
	speed: 0.0482s/iter; left time: 574.1785s
	iters: 2400, epoch: 6 | loss: 0.2630947
	speed: 0.0528s/iter; left time: 624.0350s
	iters: 2500, epoch: 6 | loss: 0.2704009
	speed: 0.0481s/iter; left time: 562.9582s
	iters: 2600, epoch: 6 | loss: 0.2328146
	speed: 0.0562s/iter; left time: 652.5249s
	iters: 2700, epoch: 6 | loss: 0.2481105
	speed: 0.0501s/iter; left time: 576.7741s
	iters: 2800, epoch: 6 | loss: 0.2375364
	speed: 0.0484s/iter; left time: 552.0839s
Max Memory (MB): 676.63134765625
Epoch: 6 cost time: 140.49216079711914
Epoch: 6, Steps: 2842 | Train Loss: 0.2439660 Vali Loss: 0.3292877 Test Loss: 0.3934813
Validation loss decreased (0.329716 --> 0.329288).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2466174
	speed: 1.0646s/iter; left time: 11997.4206s
	iters: 200, epoch: 7 | loss: 0.2585712
	speed: 0.0437s/iter; left time: 488.0255s
	iters: 300, epoch: 7 | loss: 0.2329862
	speed: 0.0482s/iter; left time: 533.0701s
	iters: 400, epoch: 7 | loss: 0.2654130
	speed: 0.0433s/iter; left time: 475.1300s
	iters: 500, epoch: 7 | loss: 0.2186152
	speed: 0.0400s/iter; left time: 434.8783s
	iters: 600, epoch: 7 | loss: 0.2299508
	speed: 0.0404s/iter; left time: 435.1540s
	iters: 700, epoch: 7 | loss: 0.2379617
	speed: 0.0413s/iter; left time: 440.9037s
	iters: 800, epoch: 7 | loss: 0.1944373
	speed: 0.0403s/iter; left time: 425.6661s
	iters: 900, epoch: 7 | loss: 0.2269595
	speed: 0.0392s/iter; left time: 409.9614s
	iters: 1000, epoch: 7 | loss: 0.2109477
	speed: 0.0398s/iter; left time: 412.6622s
	iters: 1100, epoch: 7 | loss: 0.2438336
	speed: 0.0384s/iter; left time: 394.3454s
	iters: 1200, epoch: 7 | loss: 0.1905923
	speed: 0.0407s/iter; left time: 413.4021s
	iters: 1300, epoch: 7 | loss: 0.2153512
	speed: 0.0550s/iter; left time: 553.7872s
	iters: 1400, epoch: 7 | loss: 0.2468712
	speed: 0.0471s/iter; left time: 470.0115s
	iters: 1500, epoch: 7 | loss: 0.2816036
	speed: 0.0509s/iter; left time: 502.0266s
	iters: 1600, epoch: 7 | loss: 0.2273396
	speed: 0.0486s/iter; left time: 474.8918s
	iters: 1700, epoch: 7 | loss: 0.2661616
	speed: 0.0480s/iter; left time: 464.1612s
	iters: 1800, epoch: 7 | loss: 0.2063519
	speed: 0.0460s/iter; left time: 440.4416s
	iters: 1900, epoch: 7 | loss: 0.2159163
	speed: 0.0444s/iter; left time: 420.4027s
	iters: 2000, epoch: 7 | loss: 0.2213825
	speed: 0.0490s/iter; left time: 459.4040s
	iters: 2100, epoch: 7 | loss: 0.2342410
	speed: 0.0463s/iter; left time: 429.2175s
	iters: 2200, epoch: 7 | loss: 0.2303344
	speed: 0.0475s/iter; left time: 435.8539s
	iters: 2300, epoch: 7 | loss: 0.2142455
	speed: 0.0430s/iter; left time: 389.8548s
	iters: 2400, epoch: 7 | loss: 0.2594277
	speed: 0.0437s/iter; left time: 391.6864s
	iters: 2500, epoch: 7 | loss: 0.2504501
	speed: 0.0551s/iter; left time: 488.9250s
	iters: 2600, epoch: 7 | loss: 0.2093521
	speed: 0.0491s/iter; left time: 430.9242s
	iters: 2700, epoch: 7 | loss: 0.2536309
	speed: 0.0478s/iter; left time: 414.4001s
	iters: 2800, epoch: 7 | loss: 0.2501287
	speed: 0.0502s/iter; left time: 430.3536s
Max Memory (MB): 676.63134765625
Epoch: 7 cost time: 131.62747359275818
Epoch: 7, Steps: 2842 | Train Loss: 0.2435084 Vali Loss: 0.3290183 Test Loss: 0.3930761
Validation loss decreased (0.329288 --> 0.329018).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2074775
	speed: 1.0966s/iter; left time: 9241.4298s
	iters: 200, epoch: 8 | loss: 0.2579013
	speed: 0.0501s/iter; left time: 416.8167s
	iters: 300, epoch: 8 | loss: 0.3082060
	speed: 0.0522s/iter; left time: 429.1552s
	iters: 400, epoch: 8 | loss: 0.2057021
	speed: 0.0514s/iter; left time: 417.7701s
	iters: 500, epoch: 8 | loss: 0.2548371
	speed: 0.0470s/iter; left time: 377.1840s
	iters: 600, epoch: 8 | loss: 0.2426815
	speed: 0.0458s/iter; left time: 362.9904s
	iters: 700, epoch: 8 | loss: 0.2826448
	speed: 0.0461s/iter; left time: 361.0640s
	iters: 800, epoch: 8 | loss: 0.2449670
	speed: 0.0457s/iter; left time: 353.3188s
	iters: 900, epoch: 8 | loss: 0.2830093
	speed: 0.0516s/iter; left time: 393.8022s
	iters: 1000, epoch: 8 | loss: 0.2555919
	speed: 0.0479s/iter; left time: 360.1698s
	iters: 1100, epoch: 8 | loss: 0.2350647
	speed: 0.0481s/iter; left time: 357.2155s
	iters: 1200, epoch: 8 | loss: 0.2260977
	speed: 0.0508s/iter; left time: 372.2813s
	iters: 1300, epoch: 8 | loss: 0.2307931
	speed: 0.0504s/iter; left time: 364.1501s
	iters: 1400, epoch: 8 | loss: 0.2428397
	speed: 0.0506s/iter; left time: 360.5284s
	iters: 1500, epoch: 8 | loss: 0.2390098
	speed: 0.0496s/iter; left time: 348.2127s
	iters: 1600, epoch: 8 | loss: 0.2148561
	speed: 0.0497s/iter; left time: 344.3582s
	iters: 1700, epoch: 8 | loss: 0.2362039
	speed: 0.0509s/iter; left time: 347.3330s
	iters: 1800, epoch: 8 | loss: 0.2179985
	speed: 0.0475s/iter; left time: 319.7961s
	iters: 1900, epoch: 8 | loss: 0.2280724
	speed: 0.0486s/iter; left time: 321.9495s
	iters: 2000, epoch: 8 | loss: 0.2559620
	speed: 0.0517s/iter; left time: 337.6248s
	iters: 2100, epoch: 8 | loss: 0.2493291
	speed: 0.0535s/iter; left time: 343.8458s
	iters: 2200, epoch: 8 | loss: 0.2159780
	speed: 0.0499s/iter; left time: 315.6633s
	iters: 2300, epoch: 8 | loss: 0.2190487
	speed: 0.0474s/iter; left time: 294.9471s
	iters: 2400, epoch: 8 | loss: 0.2450221
	speed: 0.0471s/iter; left time: 288.7011s
	iters: 2500, epoch: 8 | loss: 0.2870218
	speed: 0.0538s/iter; left time: 324.0167s
	iters: 2600, epoch: 8 | loss: 0.2183985
	speed: 0.0478s/iter; left time: 283.0775s
	iters: 2700, epoch: 8 | loss: 0.2584376
	speed: 0.0475s/iter; left time: 277.0646s
	iters: 2800, epoch: 8 | loss: 0.2451779
	speed: 0.0464s/iter; left time: 265.8633s
Max Memory (MB): 676.63134765625
Epoch: 8 cost time: 142.3223259449005
Epoch: 8, Steps: 2842 | Train Loss: 0.2432617 Vali Loss: 0.3289706 Test Loss: 0.3929207
Validation loss decreased (0.329018 --> 0.328971).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2731168
	speed: 1.0703s/iter; left time: 5977.9029s
	iters: 200, epoch: 9 | loss: 0.2156077
	speed: 0.0497s/iter; left time: 272.6523s
	iters: 300, epoch: 9 | loss: 0.3074617
	speed: 0.0452s/iter; left time: 243.5662s
	iters: 400, epoch: 9 | loss: 0.2873452
	speed: 0.0454s/iter; left time: 240.1753s
	iters: 500, epoch: 9 | loss: 0.2892245
	speed: 0.0431s/iter; left time: 223.2787s
	iters: 600, epoch: 9 | loss: 0.2651497
	speed: 0.0440s/iter; left time: 223.5803s
	iters: 700, epoch: 9 | loss: 0.2491089
	speed: 0.0451s/iter; left time: 224.9681s
	iters: 800, epoch: 9 | loss: 0.1918345
	speed: 0.0423s/iter; left time: 206.6900s
	iters: 900, epoch: 9 | loss: 0.2759542
	speed: 0.0469s/iter; left time: 224.4727s
	iters: 1000, epoch: 9 | loss: 0.2963816
	speed: 0.0431s/iter; left time: 201.9081s
	iters: 1100, epoch: 9 | loss: 0.2288415
	speed: 0.0502s/iter; left time: 230.2758s
	iters: 1200, epoch: 9 | loss: 0.2344595
	speed: 0.0411s/iter; left time: 184.3230s
	iters: 1300, epoch: 9 | loss: 0.2269935
	speed: 0.0425s/iter; left time: 186.2624s
	iters: 1400, epoch: 9 | loss: 0.2610187
	speed: 0.0473s/iter; left time: 202.4679s
	iters: 1500, epoch: 9 | loss: 0.2296659
	speed: 0.0434s/iter; left time: 181.6970s
	iters: 1600, epoch: 9 | loss: 0.2563749
	speed: 0.0456s/iter; left time: 186.4000s
	iters: 1700, epoch: 9 | loss: 0.2631367
	speed: 0.0424s/iter; left time: 169.0424s
	iters: 1800, epoch: 9 | loss: 0.2414517
	speed: 0.0424s/iter; left time: 164.6895s
	iters: 1900, epoch: 9 | loss: 0.2773530
	speed: 0.0429s/iter; left time: 162.4573s
	iters: 2000, epoch: 9 | loss: 0.2277134
	speed: 0.0446s/iter; left time: 164.3434s
	iters: 2100, epoch: 9 | loss: 0.2620800
	speed: 0.0400s/iter; left time: 143.5372s
	iters: 2200, epoch: 9 | loss: 0.2454937
	speed: 0.0387s/iter; left time: 135.0134s
	iters: 2300, epoch: 9 | loss: 0.2265476
	speed: 0.0405s/iter; left time: 137.1310s
	iters: 2400, epoch: 9 | loss: 0.2017836
	speed: 0.0402s/iter; left time: 132.1204s
	iters: 2500, epoch: 9 | loss: 0.2329100
	speed: 0.0452s/iter; left time: 143.8330s
	iters: 2600, epoch: 9 | loss: 0.2560270
	speed: 0.0400s/iter; left time: 123.4568s
	iters: 2700, epoch: 9 | loss: 0.2364728
	speed: 0.0412s/iter; left time: 123.0589s
	iters: 2800, epoch: 9 | loss: 0.2362757
	speed: 0.0410s/iter; left time: 118.2419s
Max Memory (MB): 676.63134765625
Epoch: 9 cost time: 126.27341938018799
Epoch: 9, Steps: 2842 | Train Loss: 0.2431525 Vali Loss: 0.3288096 Test Loss: 0.3927472
Validation loss decreased (0.328971 --> 0.328810).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2680753
	speed: 1.0939s/iter; left time: 3000.5091s
	iters: 200, epoch: 10 | loss: 0.2179467
	speed: 0.0527s/iter; left time: 139.1946s
	iters: 300, epoch: 10 | loss: 0.2333199
	speed: 0.0513s/iter; left time: 130.4754s
	iters: 400, epoch: 10 | loss: 0.2175060
	speed: 0.0488s/iter; left time: 119.2469s
	iters: 500, epoch: 10 | loss: 0.2368455
	speed: 0.0518s/iter; left time: 121.4275s
	iters: 600, epoch: 10 | loss: 0.2754835
	speed: 0.0518s/iter; left time: 116.1724s
	iters: 700, epoch: 10 | loss: 0.2382417
	speed: 0.0488s/iter; left time: 104.5512s
	iters: 800, epoch: 10 | loss: 0.2108289
	speed: 0.0495s/iter; left time: 101.0422s
	iters: 900, epoch: 10 | loss: 0.2446174
	speed: 0.0485s/iter; left time: 94.2626s
	iters: 1000, epoch: 10 | loss: 0.2364810
	speed: 0.0499s/iter; left time: 92.0105s
	iters: 1100, epoch: 10 | loss: 0.2516412
	speed: 0.0451s/iter; left time: 78.6001s
	iters: 1200, epoch: 10 | loss: 0.2473167
	speed: 0.0429s/iter; left time: 70.5335s
	iters: 1300, epoch: 10 | loss: 0.2383658
	speed: 0.0488s/iter; left time: 75.2860s
	iters: 1400, epoch: 10 | loss: 0.2375102
	speed: 0.0458s/iter; left time: 66.1100s
	iters: 1500, epoch: 10 | loss: 0.2580926
	speed: 0.0511s/iter; left time: 68.5692s
	iters: 1600, epoch: 10 | loss: 0.2805277
	speed: 0.0451s/iter; left time: 56.0907s
	iters: 1700, epoch: 10 | loss: 0.2713143
	speed: 0.0441s/iter; left time: 50.3981s
	iters: 1800, epoch: 10 | loss: 0.2277716
	speed: 0.0535s/iter; left time: 55.8272s
	iters: 1900, epoch: 10 | loss: 0.1955984
	speed: 0.0491s/iter; left time: 46.2799s
	iters: 2000, epoch: 10 | loss: 0.2493510
	speed: 0.0495s/iter; left time: 41.6870s
	iters: 2100, epoch: 10 | loss: 0.1995017
	speed: 0.0485s/iter; left time: 36.0437s
	iters: 2200, epoch: 10 | loss: 0.2276671
	speed: 0.0500s/iter; left time: 32.1773s
	iters: 2300, epoch: 10 | loss: 0.2586163
	speed: 0.0456s/iter; left time: 24.7570s
	iters: 2400, epoch: 10 | loss: 0.2205427
	speed: 0.0438s/iter; left time: 19.4197s
	iters: 2500, epoch: 10 | loss: 0.2548403
	speed: 0.0483s/iter; left time: 16.5728s
	iters: 2600, epoch: 10 | loss: 0.2621049
	speed: 0.0439s/iter; left time: 10.6686s
	iters: 2700, epoch: 10 | loss: 0.2124280
	speed: 0.0505s/iter; left time: 7.2272s
	iters: 2800, epoch: 10 | loss: 0.2350899
	speed: 0.0447s/iter; left time: 1.9200s
Max Memory (MB): 676.63134765625
Epoch: 10 cost time: 139.66591811180115
Epoch: 10, Steps: 2842 | Train Loss: 0.2430897 Vali Loss: 0.3289018 Test Loss: 0.3926868
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : traffic_720_192_iTransformer_custom_M_ft720_sl48_ll192_pl256_dm8_nh2_el1_dl256_df1_fctimeF_ebTrue_dtExp_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3317
test shape: (3317, 1, 192, 862) (3317, 1, 192, 862)
test shape: (3317, 192, 862) (3317, 192, 862)
mse:0.3927482068538666, mae:0.2827509343624115
