Args in experiment:
Namespace(is_training=1, train_only=False, model_id='DLinear_electricity_192_336', model='DLinear', data='custom', root_path='./dataset/', data_path='electricity.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=192, label_len=48, pred_len=336, individual=False, embed_type=0, enc_in=321, dec_in=321, c_out=321, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DLinear_electricity_192_336_DLinear_custom_ftM_sl192_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17885
val 2297
test 4925
	iters: 100, epoch: 1 | loss: 0.4505011
	speed: 0.0791s/iter; left time: 1318.6062s
	iters: 200, epoch: 1 | loss: 0.3334875
	speed: 0.0543s/iter; left time: 899.1553s
	iters: 300, epoch: 1 | loss: 0.2893613
	speed: 0.0528s/iter; left time: 869.2660s
	iters: 400, epoch: 1 | loss: 0.2707294
	speed: 0.0520s/iter; left time: 850.7694s
	iters: 500, epoch: 1 | loss: 0.2739751
	speed: 0.0442s/iter; left time: 719.3888s
Epoch: 1 cost time: 31.279673099517822
Epoch: 1, Steps: 559 | Train Loss: 0.3827100 Vali Loss: 0.2215107 Test Loss: 0.2483279
Validation loss decreased (inf --> 0.221511).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2618432
	speed: 0.3736s/iter; left time: 6019.7614s
	iters: 200, epoch: 2 | loss: 0.2236306
	speed: 0.0576s/iter; left time: 921.4996s
	iters: 300, epoch: 2 | loss: 0.2751001
	speed: 0.0559s/iter; left time: 888.7045s
	iters: 400, epoch: 2 | loss: 0.2298296
	speed: 0.0578s/iter; left time: 913.3849s
	iters: 500, epoch: 2 | loss: 0.2327535
	speed: 0.0598s/iter; left time: 939.2216s
Epoch: 2 cost time: 34.12231945991516
Epoch: 2, Steps: 559 | Train Loss: 0.2341157 Vali Loss: 0.1913663 Test Loss: 0.2170758
Validation loss decreased (0.221511 --> 0.191366).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2115975
	speed: 0.3762s/iter; left time: 5851.1351s
	iters: 200, epoch: 3 | loss: 0.1921348
	speed: 0.0509s/iter; left time: 786.1519s
	iters: 300, epoch: 3 | loss: 0.2205829
	speed: 0.0511s/iter; left time: 783.9834s
	iters: 400, epoch: 3 | loss: 0.2206956
	speed: 0.0542s/iter; left time: 826.2744s
	iters: 500, epoch: 3 | loss: 0.1945615
	speed: 0.0537s/iter; left time: 813.6775s
Epoch: 3 cost time: 31.20779848098755
Epoch: 3, Steps: 559 | Train Loss: 0.2165714 Vali Loss: 0.1832531 Test Loss: 0.2087196
Validation loss decreased (0.191366 --> 0.183253).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2015334
	speed: 0.4128s/iter; left time: 6190.0922s
	iters: 200, epoch: 4 | loss: 0.2026334
	speed: 0.0562s/iter; left time: 836.3453s
	iters: 300, epoch: 4 | loss: 0.2272753
	speed: 0.0537s/iter; left time: 795.0683s
	iters: 400, epoch: 4 | loss: 0.2067519
	speed: 0.0533s/iter; left time: 783.2810s
	iters: 500, epoch: 4 | loss: 0.2017810
	speed: 0.0498s/iter; left time: 726.1322s
Epoch: 4 cost time: 31.924059867858887
Epoch: 4, Steps: 559 | Train Loss: 0.2107291 Vali Loss: 0.1796726 Test Loss: 0.2049144
Validation loss decreased (0.183253 --> 0.179673).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2062149
	speed: 0.4040s/iter; left time: 5831.7693s
	iters: 200, epoch: 5 | loss: 0.1922604
	speed: 0.0567s/iter; left time: 813.1675s
	iters: 300, epoch: 5 | loss: 0.2180185
	speed: 0.0553s/iter; left time: 786.6431s
	iters: 400, epoch: 5 | loss: 0.2255279
	speed: 0.0572s/iter; left time: 808.0360s
	iters: 500, epoch: 5 | loss: 0.1943941
	speed: 0.0591s/iter; left time: 829.1568s
Epoch: 5 cost time: 33.33141469955444
Epoch: 5, Steps: 559 | Train Loss: 0.2080582 Vali Loss: 0.1779679 Test Loss: 0.2031105
Validation loss decreased (0.179673 --> 0.177968).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2164084
	speed: 0.3233s/iter; left time: 4486.7079s
	iters: 200, epoch: 6 | loss: 0.1976522
	speed: 0.0432s/iter; left time: 595.7305s
	iters: 300, epoch: 6 | loss: 0.1924479
	speed: 0.0426s/iter; left time: 583.2672s
	iters: 400, epoch: 6 | loss: 0.2003921
	speed: 0.0431s/iter; left time: 584.8034s
	iters: 500, epoch: 6 | loss: 0.2132635
	speed: 0.0440s/iter; left time: 592.8935s
Epoch: 6 cost time: 26.08624839782715
Epoch: 6, Steps: 559 | Train Loss: 0.2066951 Vali Loss: 0.1771081 Test Loss: 0.2023658
Validation loss decreased (0.177968 --> 0.177108).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2151208
	speed: 0.3322s/iter; left time: 4423.7229s
	iters: 200, epoch: 7 | loss: 0.2037867
	speed: 0.0430s/iter; left time: 568.4633s
	iters: 300, epoch: 7 | loss: 0.2412101
	speed: 0.0442s/iter; left time: 579.5860s
	iters: 400, epoch: 7 | loss: 0.1928115
	speed: 0.0437s/iter; left time: 569.0821s
	iters: 500, epoch: 7 | loss: 0.2111820
	speed: 0.0441s/iter; left time: 569.9753s
Epoch: 7 cost time: 26.468780755996704
Epoch: 7, Steps: 559 | Train Loss: 0.2059846 Vali Loss: 0.1765829 Test Loss: 0.2016902
Validation loss decreased (0.177108 --> 0.176583).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2264197
	speed: 0.3594s/iter; left time: 4584.9853s
	iters: 200, epoch: 8 | loss: 0.1841733
	speed: 0.0494s/iter; left time: 624.6771s
	iters: 300, epoch: 8 | loss: 0.1994295
	speed: 0.0484s/iter; left time: 607.5034s
	iters: 400, epoch: 8 | loss: 0.2173139
	speed: 0.0478s/iter; left time: 595.0655s
	iters: 500, epoch: 8 | loss: 0.2124063
	speed: 0.0480s/iter; left time: 592.9071s
Epoch: 8 cost time: 29.728548526763916
Epoch: 8, Steps: 559 | Train Loss: 0.2055973 Vali Loss: 0.1763388 Test Loss: 0.2014447
Validation loss decreased (0.176583 --> 0.176339).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2160340
	speed: 0.3800s/iter; left time: 4635.4708s
	iters: 200, epoch: 9 | loss: 0.1896966
	speed: 0.0513s/iter; left time: 620.3551s
	iters: 300, epoch: 9 | loss: 0.2067594
	speed: 0.0520s/iter; left time: 624.4604s
	iters: 400, epoch: 9 | loss: 0.1853123
	speed: 0.0503s/iter; left time: 598.2657s
	iters: 500, epoch: 9 | loss: 0.1803429
	speed: 0.0501s/iter; left time: 590.8409s
Epoch: 9 cost time: 30.736188411712646
Epoch: 9, Steps: 559 | Train Loss: 0.2053962 Vali Loss: 0.1762216 Test Loss: 0.2012938
Validation loss decreased (0.176339 --> 0.176222).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1950289
	speed: 0.3724s/iter; left time: 4334.8789s
	iters: 200, epoch: 10 | loss: 0.1982687
	speed: 0.0480s/iter; left time: 554.0311s
	iters: 300, epoch: 10 | loss: 0.2077610
	speed: 0.0476s/iter; left time: 544.8319s
	iters: 400, epoch: 10 | loss: 0.1918455
	speed: 0.0488s/iter; left time: 553.0650s
	iters: 500, epoch: 10 | loss: 0.2132559
	speed: 0.0487s/iter; left time: 547.6357s
Epoch: 10 cost time: 28.85156011581421
Epoch: 10, Steps: 559 | Train Loss: 0.2052904 Vali Loss: 0.1761316 Test Loss: 0.2012199
Validation loss decreased (0.176222 --> 0.176132).  Saving model ...
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.2315063
	speed: 0.3883s/iter; left time: 4302.2851s
	iters: 200, epoch: 11 | loss: 0.2103572
	speed: 0.0542s/iter; left time: 595.4497s
	iters: 300, epoch: 11 | loss: 0.2057940
	speed: 0.0577s/iter; left time: 627.4720s
	iters: 400, epoch: 11 | loss: 0.2005133
	speed: 0.0587s/iter; left time: 632.8597s
	iters: 500, epoch: 11 | loss: 0.2302807
	speed: 0.0552s/iter; left time: 589.7240s
Epoch: 11 cost time: 33.67000699043274
Epoch: 11, Steps: 559 | Train Loss: 0.2052395 Vali Loss: 0.1761144 Test Loss: 0.2011804
Validation loss decreased (0.176132 --> 0.176114).  Saving model ...
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.2293109
	speed: 0.3944s/iter; left time: 4149.6434s
	iters: 200, epoch: 12 | loss: 0.1841187
	speed: 0.0510s/iter; left time: 531.4685s
	iters: 300, epoch: 12 | loss: 0.1879931
	speed: 0.0510s/iter; left time: 526.3599s
	iters: 400, epoch: 12 | loss: 0.1879994
	speed: 0.0492s/iter; left time: 502.5371s
	iters: 500, epoch: 12 | loss: 0.2070815
	speed: 0.0500s/iter; left time: 506.5003s
Epoch: 12 cost time: 30.292292594909668
Epoch: 12, Steps: 559 | Train Loss: 0.2052038 Vali Loss: 0.1760944 Test Loss: 0.2011603
Validation loss decreased (0.176114 --> 0.176094).  Saving model ...
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.2012425
	speed: 0.3785s/iter; left time: 3770.8864s
	iters: 200, epoch: 13 | loss: 0.2189788
	speed: 0.0536s/iter; left time: 528.6240s
	iters: 300, epoch: 13 | loss: 0.2245603
	speed: 0.0554s/iter; left time: 540.6269s
	iters: 400, epoch: 13 | loss: 0.1930677
	speed: 0.0517s/iter; left time: 499.6806s
	iters: 500, epoch: 13 | loss: 0.2107632
	speed: 0.0527s/iter; left time: 503.9505s
Epoch: 13 cost time: 31.422601222991943
Epoch: 13, Steps: 559 | Train Loss: 0.2051914 Vali Loss: 0.1760660 Test Loss: 0.2011509
Validation loss decreased (0.176094 --> 0.176066).  Saving model ...
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.1918832
	speed: 0.4349s/iter; left time: 4089.4353s
	iters: 200, epoch: 14 | loss: 0.1947540
	speed: 0.0513s/iter; left time: 476.9170s
	iters: 300, epoch: 14 | loss: 0.1943231
	speed: 0.0525s/iter; left time: 483.5776s
	iters: 400, epoch: 14 | loss: 0.2062026
	speed: 0.0534s/iter; left time: 485.7023s
	iters: 500, epoch: 14 | loss: 0.2256559
	speed: 0.0538s/iter; left time: 484.6778s
Epoch: 14 cost time: 32.97615718841553
Epoch: 14, Steps: 559 | Train Loss: 0.2051841 Vali Loss: 0.1760705 Test Loss: 0.2011460
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.220703125e-08
	iters: 100, epoch: 15 | loss: 0.2132576
	speed: 0.3577s/iter; left time: 3163.6700s
	iters: 200, epoch: 15 | loss: 0.1818838
	speed: 0.0448s/iter; left time: 391.9206s
	iters: 300, epoch: 15 | loss: 0.2095847
	speed: 0.0468s/iter; left time: 404.6967s
	iters: 400, epoch: 15 | loss: 0.2139129
	speed: 0.0468s/iter; left time: 400.2172s
	iters: 500, epoch: 15 | loss: 0.2344467
	speed: 0.0457s/iter; left time: 385.7189s
Epoch: 15 cost time: 27.701741456985474
Epoch: 15, Steps: 559 | Train Loss: 0.2051808 Vali Loss: 0.1760714 Test Loss: 0.2011434
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.103515625e-09
	iters: 100, epoch: 16 | loss: 0.2143217
	speed: 0.3282s/iter; left time: 2719.1927s
	iters: 200, epoch: 16 | loss: 0.2110253
	speed: 0.0436s/iter; left time: 356.5344s
	iters: 300, epoch: 16 | loss: 0.1777851
	speed: 0.0429s/iter; left time: 346.6964s
	iters: 400, epoch: 16 | loss: 0.1886290
	speed: 0.0444s/iter; left time: 354.4038s
	iters: 500, epoch: 16 | loss: 0.2057538
	speed: 0.0435s/iter; left time: 342.9085s
Epoch: 16 cost time: 26.39968991279602
Epoch: 16, Steps: 559 | Train Loss: 0.2051792 Vali Loss: 0.1761042 Test Loss: 0.2011423
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : DLinear_electricity_192_336_DLinear_custom_ftM_sl192_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4925
mse:0.20104606449604034, mae:0.30441462993621826
