True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           traffic_192_720     Model:              TimesNet            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/          
  Data Path:          traffic.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            192                 Label Len:          48                  
  Pred Len:           720                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             862                 Dec In:             862                 
  C Out:              862                 d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         8                   
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_traffic_192_720_TimesNet_custom_ftM_sl192_ll48_pl720_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11369
val 1037
test 2789
	iters: 100, epoch: 1 | loss: 0.8720244
	speed: 0.3811s/iter; left time: 16221.4543s
	iters: 200, epoch: 1 | loss: 0.5756494
	speed: 0.2472s/iter; left time: 10496.0734s
	iters: 300, epoch: 1 | loss: 0.4964853
	speed: 0.2358s/iter; left time: 9987.3471s
	iters: 400, epoch: 1 | loss: 0.4440673
	speed: 0.2333s/iter; left time: 9859.9328s
	iters: 500, epoch: 1 | loss: 0.4754808
	speed: 0.2352s/iter; left time: 9917.8730s
	iters: 600, epoch: 1 | loss: 0.4578688
	speed: 0.2398s/iter; left time: 10086.6215s
	iters: 700, epoch: 1 | loss: 0.4256231
	speed: 0.2392s/iter; left time: 10038.4360s
	iters: 800, epoch: 1 | loss: 0.4347621
	speed: 0.2328s/iter; left time: 9743.2305s
	iters: 900, epoch: 1 | loss: 0.4212778
	speed: 0.2273s/iter; left time: 9492.4014s
	iters: 1000, epoch: 1 | loss: 0.4388475
	speed: 0.2277s/iter; left time: 9484.5258s
	iters: 1100, epoch: 1 | loss: 0.4202370
	speed: 0.2341s/iter; left time: 9727.4785s
	iters: 1200, epoch: 1 | loss: 0.4122154
	speed: 0.2301s/iter; left time: 9538.7344s
	iters: 1300, epoch: 1 | loss: 0.4046668
	speed: 0.2297s/iter; left time: 9500.8619s
	iters: 1400, epoch: 1 | loss: 0.4242211
	speed: 0.2314s/iter; left time: 9546.3170s
Epoch: 1 cost time: 347.5726890563965
Epoch: 1, Steps: 1422 | Train Loss: 0.5027083 Vali Loss: 0.6032361 Test Loss: 0.8456562
Validation loss decreased (inf --> 0.603236).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4029593
	speed: 1.2538s/iter; left time: 51578.5943s
	iters: 200, epoch: 2 | loss: 0.3950840
	speed: 0.2446s/iter; left time: 10038.2400s
	iters: 300, epoch: 2 | loss: 0.4233543
	speed: 0.2718s/iter; left time: 11128.0128s
	iters: 400, epoch: 2 | loss: 0.3065704
	speed: 0.2899s/iter; left time: 11838.4153s
	iters: 500, epoch: 2 | loss: 0.3026623
	speed: 0.3273s/iter; left time: 13331.9807s
	iters: 600, epoch: 2 | loss: 0.2882211
	speed: 0.3560s/iter; left time: 14465.9675s
	iters: 700, epoch: 2 | loss: 0.2607027
	speed: 0.3639s/iter; left time: 14754.1139s
	iters: 800, epoch: 2 | loss: 0.2723567
	speed: 0.3692s/iter; left time: 14929.6931s
	iters: 900, epoch: 2 | loss: 0.2707382
	speed: 0.3612s/iter; left time: 14569.0683s
	iters: 1000, epoch: 2 | loss: 0.2726880
	speed: 0.3589s/iter; left time: 14441.3552s
	iters: 1100, epoch: 2 | loss: 0.2715593
	speed: 0.3543s/iter; left time: 14222.0219s
	iters: 1200, epoch: 2 | loss: 0.2557915
	speed: 0.3592s/iter; left time: 14381.1654s
	iters: 1300, epoch: 2 | loss: 0.2666458
	speed: 0.3616s/iter; left time: 14441.3567s
	iters: 1400, epoch: 2 | loss: 0.2561510
	speed: 0.3606s/iter; left time: 14366.7639s
Epoch: 2 cost time: 470.9342486858368
Epoch: 2, Steps: 1422 | Train Loss: 0.3088774 Vali Loss: 0.4678409 Test Loss: 0.6567555
Validation loss decreased (0.603236 --> 0.467841).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2577465
	speed: 1.9903s/iter; left time: 79047.8976s
	iters: 200, epoch: 3 | loss: 0.2467044
	speed: 0.3580s/iter; left time: 14184.1065s
	iters: 300, epoch: 3 | loss: 0.2549269
	speed: 0.3573s/iter; left time: 14119.1512s
	iters: 400, epoch: 3 | loss: 0.2602534
	speed: 0.3609s/iter; left time: 14225.2233s
	iters: 500, epoch: 3 | loss: 0.2664749
	speed: 0.3654s/iter; left time: 14366.9114s
	iters: 600, epoch: 3 | loss: 0.2518433
	speed: 0.3553s/iter; left time: 13933.5393s
	iters: 700, epoch: 3 | loss: 0.2522619
	speed: 0.3569s/iter; left time: 13959.6983s
	iters: 800, epoch: 3 | loss: 0.2586159
	speed: 0.3621s/iter; left time: 14128.6528s
	iters: 900, epoch: 3 | loss: 0.2534840
	speed: 0.3561s/iter; left time: 13857.4003s
	iters: 1000, epoch: 3 | loss: 0.2802721
	speed: 0.3566s/iter; left time: 13841.1320s
	iters: 1100, epoch: 3 | loss: 0.2518438
	speed: 0.3579s/iter; left time: 13855.8515s
	iters: 1200, epoch: 3 | loss: 0.2538088
	speed: 0.3562s/iter; left time: 13756.8987s
	iters: 1300, epoch: 3 | loss: 0.2608580
	speed: 0.3496s/iter; left time: 13465.5129s
	iters: 1400, epoch: 3 | loss: 0.2545238
	speed: 0.3502s/iter; left time: 13452.7372s
Epoch: 3 cost time: 511.4730784893036
Epoch: 3, Steps: 1422 | Train Loss: 0.2565851 Vali Loss: 0.4664907 Test Loss: 0.6490829
Validation loss decreased (0.467841 --> 0.466491).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2601286
	speed: 1.9813s/iter; left time: 75872.4872s
	iters: 200, epoch: 4 | loss: 0.2498727
	speed: 0.3584s/iter; left time: 13690.3463s
	iters: 300, epoch: 4 | loss: 0.2531891
	speed: 0.3586s/iter; left time: 13660.9296s
	iters: 400, epoch: 4 | loss: 0.2520097
	speed: 0.3582s/iter; left time: 13609.1644s
	iters: 500, epoch: 4 | loss: 0.2548060
	speed: 0.3519s/iter; left time: 13333.5579s
	iters: 600, epoch: 4 | loss: 0.2398002
	speed: 0.3548s/iter; left time: 13411.3969s
	iters: 700, epoch: 4 | loss: 0.2479466
	speed: 0.3522s/iter; left time: 13275.9909s
	iters: 800, epoch: 4 | loss: 0.2405424
	speed: 0.3561s/iter; left time: 13389.3742s
	iters: 900, epoch: 4 | loss: 0.2453033
	speed: 0.3612s/iter; left time: 13542.3511s
	iters: 1000, epoch: 4 | loss: 0.2451206
	speed: 0.3650s/iter; left time: 13649.7083s
	iters: 1100, epoch: 4 | loss: 0.2397662
	speed: 0.3612s/iter; left time: 13472.3424s
	iters: 1200, epoch: 4 | loss: 0.2510777
	speed: 0.3620s/iter; left time: 13463.1378s
	iters: 1300, epoch: 4 | loss: 0.2490253
	speed: 0.3569s/iter; left time: 13240.7782s
	iters: 1400, epoch: 4 | loss: 0.2614169
	speed: 0.3594s/iter; left time: 13295.0529s
Epoch: 4 cost time: 513.5812168121338
Epoch: 4, Steps: 1422 | Train Loss: 0.2499817 Vali Loss: 0.4598074 Test Loss: 0.6441453
Validation loss decreased (0.466491 --> 0.459807).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2600344
	speed: 2.0059s/iter; left time: 73965.1554s
	iters: 200, epoch: 5 | loss: 0.2391029
	speed: 0.3631s/iter; left time: 13353.0311s
	iters: 300, epoch: 5 | loss: 0.2621348
	speed: 0.3595s/iter; left time: 13183.4617s
	iters: 400, epoch: 5 | loss: 0.2348955
	speed: 0.3626s/iter; left time: 13260.2374s
	iters: 500, epoch: 5 | loss: 0.2387181
	speed: 0.3573s/iter; left time: 13031.5222s
	iters: 600, epoch: 5 | loss: 0.2433322
	speed: 0.3638s/iter; left time: 13231.7329s
	iters: 700, epoch: 5 | loss: 0.2431159
	speed: 0.3624s/iter; left time: 13144.8156s
	iters: 800, epoch: 5 | loss: 0.2490730
	speed: 0.3613s/iter; left time: 13068.7827s
	iters: 900, epoch: 5 | loss: 0.2367224
	speed: 0.3615s/iter; left time: 13039.6704s
	iters: 1000, epoch: 5 | loss: 0.2366619
	speed: 0.3534s/iter; left time: 12712.7109s
	iters: 1100, epoch: 5 | loss: 0.2576957
	speed: 0.3627s/iter; left time: 13012.7879s
	iters: 1200, epoch: 5 | loss: 0.2439050
	speed: 0.3633s/iter; left time: 12996.6361s
	iters: 1300, epoch: 5 | loss: 0.2377841
	speed: 0.3626s/iter; left time: 12934.7900s
	iters: 1400, epoch: 5 | loss: 0.2377429
	speed: 0.3656s/iter; left time: 13005.1046s
Epoch: 5 cost time: 517.9060142040253
Epoch: 5, Steps: 1422 | Train Loss: 0.2466762 Vali Loss: 0.4640904 Test Loss: 0.6469290
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2517323
	speed: 2.0351s/iter; left time: 72145.1761s
	iters: 200, epoch: 6 | loss: 0.2535425
	speed: 0.3561s/iter; left time: 12587.9357s
	iters: 300, epoch: 6 | loss: 0.2325008
	speed: 0.3648s/iter; left time: 12858.6303s
	iters: 400, epoch: 6 | loss: 0.2464759
	speed: 0.3551s/iter; left time: 12482.0953s
	iters: 500, epoch: 6 | loss: 0.2426639
	speed: 0.3570s/iter; left time: 12513.3687s
	iters: 600, epoch: 6 | loss: 0.2491470
	speed: 0.3584s/iter; left time: 12525.0566s
	iters: 700, epoch: 6 | loss: 0.2407684
	speed: 0.3687s/iter; left time: 12851.2271s
	iters: 800, epoch: 6 | loss: 0.2499083
	speed: 0.3677s/iter; left time: 12778.2057s
	iters: 900, epoch: 6 | loss: 0.2424487
	speed: 0.3674s/iter; left time: 12731.8578s
	iters: 1000, epoch: 6 | loss: 0.2431254
	speed: 0.3685s/iter; left time: 12731.5303s
	iters: 1100, epoch: 6 | loss: 0.2550039
	speed: 0.3647s/iter; left time: 12563.8091s
	iters: 1200, epoch: 6 | loss: 0.2468292
	speed: 0.3637s/iter; left time: 12494.2551s
	iters: 1300, epoch: 6 | loss: 0.2548368
	speed: 0.3666s/iter; left time: 12554.9276s
	iters: 1400, epoch: 6 | loss: 0.2540360
	speed: 0.3726s/iter; left time: 12725.6762s
Epoch: 6 cost time: 521.3257374763489
Epoch: 6, Steps: 1422 | Train Loss: 0.2449478 Vali Loss: 0.4586147 Test Loss: 0.6464661
Validation loss decreased (0.459807 --> 0.458615).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2439071
	speed: 2.0575s/iter; left time: 70013.6323s
	iters: 200, epoch: 7 | loss: 0.2425922
	speed: 0.3676s/iter; left time: 12470.8371s
	iters: 300, epoch: 7 | loss: 0.2399498
	speed: 0.3671s/iter; left time: 12418.6823s
	iters: 400, epoch: 7 | loss: 0.2441838
	speed: 0.3620s/iter; left time: 12210.4635s
	iters: 500, epoch: 7 | loss: 0.2386796
	speed: 0.3629s/iter; left time: 12205.5219s
	iters: 600, epoch: 7 | loss: 0.2350495
	speed: 0.3549s/iter; left time: 11900.6147s
	iters: 700, epoch: 7 | loss: 0.2515057
	speed: 0.3512s/iter; left time: 11741.0547s
	iters: 800, epoch: 7 | loss: 0.2472993
	speed: 0.3535s/iter; left time: 11782.7443s
	iters: 900, epoch: 7 | loss: 0.2493713
	speed: 0.3578s/iter; left time: 11889.8076s
	iters: 1000, epoch: 7 | loss: 0.2399173
	speed: 0.3556s/iter; left time: 11780.2925s
	iters: 1100, epoch: 7 | loss: 0.2546065
	speed: 0.3524s/iter; left time: 11640.9345s
	iters: 1200, epoch: 7 | loss: 0.2238508
	speed: 0.3511s/iter; left time: 11561.7752s
	iters: 1300, epoch: 7 | loss: 0.2577957
	speed: 0.3503s/iter; left time: 11498.4626s
	iters: 1400, epoch: 7 | loss: 0.2512142
	speed: 0.3537s/iter; left time: 11574.9513s
Epoch: 7 cost time: 511.7688744068146
Epoch: 7, Steps: 1422 | Train Loss: 0.2439638 Vali Loss: 0.4573283 Test Loss: 0.6470628
Validation loss decreased (0.458615 --> 0.457328).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2344019
	speed: 1.9872s/iter; left time: 64797.3588s
	iters: 200, epoch: 8 | loss: 0.2374390
	speed: 0.3558s/iter; left time: 11565.1246s
	iters: 300, epoch: 8 | loss: 0.2457379
	speed: 0.3551s/iter; left time: 11509.1941s
	iters: 400, epoch: 8 | loss: 0.2306946
	speed: 0.3640s/iter; left time: 11759.3013s
	iters: 500, epoch: 8 | loss: 0.2415584
	speed: 0.3630s/iter; left time: 11692.4110s
	iters: 600, epoch: 8 | loss: 0.2447660
	speed: 0.3628s/iter; left time: 11649.1367s
	iters: 700, epoch: 8 | loss: 0.2438639
	speed: 0.3602s/iter; left time: 11529.0720s
	iters: 800, epoch: 8 | loss: 0.2514843
	speed: 0.3547s/iter; left time: 11318.6696s
	iters: 900, epoch: 8 | loss: 0.2492552
	speed: 0.3599s/iter; left time: 11447.7154s
	iters: 1000, epoch: 8 | loss: 0.2537855
	speed: 0.3656s/iter; left time: 11591.3317s
	iters: 1100, epoch: 8 | loss: 0.2474328
	speed: 0.3649s/iter; left time: 11534.8625s
	iters: 1200, epoch: 8 | loss: 0.2404782
	speed: 0.3628s/iter; left time: 11432.1284s
	iters: 1300, epoch: 8 | loss: 0.2404667
	speed: 0.3678s/iter; left time: 11551.0145s
	iters: 1400, epoch: 8 | loss: 0.2399928
	speed: 0.3663s/iter; left time: 11467.5222s
Epoch: 8 cost time: 517.6119821071625
Epoch: 8, Steps: 1422 | Train Loss: 0.2434472 Vali Loss: 0.4586665 Test Loss: 0.6465537
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2424083
	speed: 2.0803s/iter; left time: 64872.6543s
	iters: 200, epoch: 9 | loss: 0.2445085
	speed: 0.3602s/iter; left time: 11197.9003s
	iters: 300, epoch: 9 | loss: 0.2493298
	speed: 0.3572s/iter; left time: 11068.9455s
	iters: 400, epoch: 9 | loss: 0.2410681
	speed: 0.3599s/iter; left time: 11115.6401s
	iters: 500, epoch: 9 | loss: 0.2428239
	speed: 0.3641s/iter; left time: 11208.0733s
	iters: 600, epoch: 9 | loss: 0.2446858
	speed: 0.3647s/iter; left time: 11189.8773s
	iters: 700, epoch: 9 | loss: 0.2393968
	speed: 0.3640s/iter; left time: 11133.0848s
	iters: 800, epoch: 9 | loss: 0.2512278
	speed: 0.3721s/iter; left time: 11342.6938s
	iters: 900, epoch: 9 | loss: 0.2504326
	speed: 0.3685s/iter; left time: 11197.9804s
	iters: 1000, epoch: 9 | loss: 0.2449192
	speed: 0.3605s/iter; left time: 10917.9853s
	iters: 1100, epoch: 9 | loss: 0.2405430
	speed: 0.3541s/iter; left time: 10687.2621s
	iters: 1200, epoch: 9 | loss: 0.2499448
	speed: 0.3682s/iter; left time: 11078.7299s
	iters: 1300, epoch: 9 | loss: 0.2355235
	speed: 0.3613s/iter; left time: 10832.3934s
	iters: 1400, epoch: 9 | loss: 0.2495368
	speed: 0.3620s/iter; left time: 10819.7630s
Epoch: 9 cost time: 519.2279579639435
Epoch: 9, Steps: 1422 | Train Loss: 0.2431811 Vali Loss: 0.4588084 Test Loss: 0.6466149
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2531300
	speed: 1.9617s/iter; left time: 58386.3539s
	iters: 200, epoch: 10 | loss: 0.2414217
	speed: 0.3577s/iter; left time: 10610.8772s
	iters: 300, epoch: 10 | loss: 0.2411644
	speed: 0.3646s/iter; left time: 10778.5327s
	iters: 400, epoch: 10 | loss: 0.2269473
	speed: 0.3626s/iter; left time: 10683.3616s
	iters: 500, epoch: 10 | loss: 0.2398968
	speed: 0.3627s/iter; left time: 10648.5601s
	iters: 600, epoch: 10 | loss: 0.2446665
	speed: 0.3604s/iter; left time: 10547.4641s
	iters: 700, epoch: 10 | loss: 0.2404088
	speed: 0.3594s/iter; left time: 10481.3330s
	iters: 800, epoch: 10 | loss: 0.2449603
	speed: 0.3609s/iter; left time: 10488.8988s
	iters: 900, epoch: 10 | loss: 0.2427628
	speed: 0.3622s/iter; left time: 10491.0554s
	iters: 1000, epoch: 10 | loss: 0.2450713
	speed: 0.3612s/iter; left time: 10424.2674s
	iters: 1100, epoch: 10 | loss: 0.2404469
	speed: 0.3597s/iter; left time: 10345.0534s
	iters: 1200, epoch: 10 | loss: 0.2392304
	speed: 0.3555s/iter; left time: 10189.5554s
	iters: 1300, epoch: 10 | loss: 0.2415374
	speed: 0.3553s/iter; left time: 10148.6982s
	iters: 1400, epoch: 10 | loss: 0.2398232
	speed: 0.3628s/iter; left time: 10326.4755s
Epoch: 10 cost time: 515.6307640075684
Epoch: 10, Steps: 1422 | Train Loss: 0.2430607 Vali Loss: 0.4585994 Test Loss: 0.6467570
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_traffic_192_720_TimesNet_custom_ftM_sl192_ll48_pl720_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
test shape: (2789, 720, 862) (2789, 720, 862)
test shape: (2789, 720, 862) (2789, 720, 862)
mse:0.6470877528190613, mae:0.347855806350708, dtw:not calculated
