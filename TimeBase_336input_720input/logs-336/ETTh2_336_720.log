Args in experiment:
Namespace(is_training=1, model_id='ETTh2-i_336_720', model='LightTimeBaseTST', data='ETTh2', root_path='./dataset/', data_path='ETTh2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=720, period_len=4, basis_num=20, use_period_norm=1, use_orthogonal=1, orthogonal_weight=0.04, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=7, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=512, patience=5, learning_rate=0.05, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=4, use_multi_gpu=0, devices='0,1', test_flop=False)
Use GPU: cuda:4
5480
>>>>>>>start training : ETTh2-i_336_720_LightTimeBaseTST_ETTh2_ftM_sl336_pl720_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7585
val 2161
test 2161
Epoch: 1 cost time: 3.2213704586029053
Epoch: 1, Steps: 15 | Train Loss: 0.9116915 Vali Loss: 0.7456447 Test Loss: 0.5164272
Validation loss decreased (inf --> 0.745645).  Saving model ...
Updating learning rate to 0.05
Epoch: 2 cost time: 2.7061026096343994
Epoch: 2, Steps: 15 | Train Loss: 0.9158550 Vali Loss: 0.6830249 Test Loss: 0.5200919
Validation loss decreased (0.745645 --> 0.683025).  Saving model ...
Updating learning rate to 0.05
Epoch: 3 cost time: 2.432880163192749
Epoch: 3, Steps: 15 | Train Loss: 0.8687047 Vali Loss: 0.6300105 Test Loss: 0.4801759
Validation loss decreased (0.683025 --> 0.630010).  Saving model ...
Updating learning rate to 0.05
Epoch: 4 cost time: 2.865790843963623
Epoch: 4, Steps: 15 | Train Loss: 0.8436611 Vali Loss: 0.6131808 Test Loss: 0.4543551
Validation loss decreased (0.630010 --> 0.613181).  Saving model ...
Updating learning rate to 0.04000000000000001
Epoch: 5 cost time: 2.8145904541015625
Epoch: 5, Steps: 15 | Train Loss: 0.8230177 Vali Loss: 0.6268457 Test Loss: 0.4500383
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.03200000000000001
Epoch: 6 cost time: 2.405336380004883
Epoch: 6, Steps: 15 | Train Loss: 0.8123246 Vali Loss: 0.6327749 Test Loss: 0.4426321
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.025600000000000008
Epoch: 7 cost time: 2.747514486312866
Epoch: 7, Steps: 15 | Train Loss: 0.8097879 Vali Loss: 0.6427913 Test Loss: 0.4432480
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.020480000000000005
Epoch: 8 cost time: 2.762176752090454
Epoch: 8, Steps: 15 | Train Loss: 0.8062009 Vali Loss: 0.6116551 Test Loss: 0.4363745
Validation loss decreased (0.613181 --> 0.611655).  Saving model ...
Updating learning rate to 0.016384000000000006
Epoch: 9 cost time: 2.3560476303100586
Epoch: 9, Steps: 15 | Train Loss: 0.8010303 Vali Loss: 0.6192392 Test Loss: 0.4368210
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.013107200000000006
Epoch: 10 cost time: 2.695211410522461
Epoch: 10, Steps: 15 | Train Loss: 0.7997454 Vali Loss: 0.6121291 Test Loss: 0.4324793
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.010485760000000004
Epoch: 11 cost time: 2.706883430480957
Epoch: 11, Steps: 15 | Train Loss: 0.7982156 Vali Loss: 0.6017730 Test Loss: 0.4334340
Validation loss decreased (0.611655 --> 0.601773).  Saving model ...
Updating learning rate to 0.008388608000000004
Epoch: 12 cost time: 2.681366205215454
Epoch: 12, Steps: 15 | Train Loss: 0.7982358 Vali Loss: 0.6157525 Test Loss: 0.4332281
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.006710886400000004
Epoch: 13 cost time: 2.932284116744995
Epoch: 13, Steps: 15 | Train Loss: 0.7962538 Vali Loss: 0.6101400 Test Loss: 0.4337171
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.005368709120000003
Epoch: 14 cost time: 2.768038034439087
Epoch: 14, Steps: 15 | Train Loss: 0.7958095 Vali Loss: 0.6033260 Test Loss: 0.4348024
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.0042949672960000025
Epoch: 15 cost time: 2.562633514404297
Epoch: 15, Steps: 15 | Train Loss: 0.7949813 Vali Loss: 0.6078297 Test Loss: 0.4325406
EarlyStopping counter: 4 out of 5
Updating learning rate to 0.0034359738368000023
Epoch: 16 cost time: 2.7813544273376465
Epoch: 16, Steps: 15 | Train Loss: 0.7948687 Vali Loss: 0.6094780 Test Loss: 0.4328349
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTh2-i_336_720_LightTimeBaseTST_ETTh2_ftM_sl336_pl720_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.3974655866622925, mae:0.4368267059326172, rse:0.5039129257202148
