Args in experiment:
Namespace(is_training=1, model_id='Electricity_720_336', model='SparseTSF', data='custom', root_path='./dataset/', data_path='electricity.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=336, period_len=24, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=321, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=128, patience=5, learning_rate=0.02, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=0, devices='0,1', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : Electricity_720_336_SparseTSF_custom_ftM_sl720_pl336_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17357
val 2297
test 4925
	iters: 100, epoch: 1 | loss: 0.2754948
	speed: 0.1771s/iter; left time: 699.5700s
Epoch: 1 cost time: 22.92909026145935
Epoch: 1, Steps: 135 | Train Loss: 0.4578132 Vali Loss: 0.2247842 Test Loss: 0.2563734
Validation loss decreased (inf --> 0.224784).  Saving model ...
Updating learning rate to 0.02
	iters: 100, epoch: 2 | loss: 0.1887198
	speed: 0.3851s/iter; left time: 1469.4147s
Epoch: 2 cost time: 24.784767389297485
Epoch: 2, Steps: 135 | Train Loss: 0.1951932 Vali Loss: 0.1441993 Test Loss: 0.1706420
Validation loss decreased (0.224784 --> 0.144199).  Saving model ...
Updating learning rate to 0.02
	iters: 100, epoch: 3 | loss: 0.1698082
	speed: 0.3949s/iter; left time: 1453.4466s
Epoch: 3 cost time: 22.563782453536987
Epoch: 3, Steps: 135 | Train Loss: 0.1753273 Vali Loss: 0.1431478 Test Loss: 0.1687604
Validation loss decreased (0.144199 --> 0.143148).  Saving model ...
Updating learning rate to 0.02
	iters: 100, epoch: 4 | loss: 0.1789897
	speed: 0.3946s/iter; left time: 1399.3217s
Epoch: 4 cost time: 23.62661576271057
Epoch: 4, Steps: 135 | Train Loss: 0.1743293 Vali Loss: 0.1424418 Test Loss: 0.1687145
Validation loss decreased (0.143148 --> 0.142442).  Saving model ...
Updating learning rate to 0.016
	iters: 100, epoch: 5 | loss: 0.1629788
	speed: 0.3787s/iter; left time: 1291.5874s
Epoch: 5 cost time: 22.015225887298584
Epoch: 5, Steps: 135 | Train Loss: 0.1742252 Vali Loss: 0.1425150 Test Loss: 0.1683421
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.012800000000000002
	iters: 100, epoch: 6 | loss: 0.1723564
	speed: 0.3583s/iter; left time: 1173.6765s
Epoch: 6 cost time: 21.51322364807129
Epoch: 6, Steps: 135 | Train Loss: 0.1740627 Vali Loss: 0.1423313 Test Loss: 0.1685832
Validation loss decreased (0.142442 --> 0.142331).  Saving model ...
Updating learning rate to 0.010240000000000003
	iters: 100, epoch: 7 | loss: 0.1757607
	speed: 0.3575s/iter; left time: 1122.9762s
Epoch: 7 cost time: 21.63304901123047
Epoch: 7, Steps: 135 | Train Loss: 0.1741359 Vali Loss: 0.1424872 Test Loss: 0.1689215
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.008192000000000001
	iters: 100, epoch: 8 | loss: 0.1732071
	speed: 0.3596s/iter; left time: 1081.0211s
Epoch: 8 cost time: 21.35554003715515
Epoch: 8, Steps: 135 | Train Loss: 0.1740928 Vali Loss: 0.1423888 Test Loss: 0.1683238
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.0065536000000000014
	iters: 100, epoch: 9 | loss: 0.1755004
	speed: 0.3588s/iter; left time: 1029.9881s
Epoch: 9 cost time: 21.556365728378296
Epoch: 9, Steps: 135 | Train Loss: 0.1741183 Vali Loss: 0.1426343 Test Loss: 0.1682619
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.005242880000000002
	iters: 100, epoch: 10 | loss: 0.1709657
	speed: 0.3710s/iter; left time: 1014.9371s
Epoch: 10 cost time: 21.963393449783325
Epoch: 10, Steps: 135 | Train Loss: 0.1739925 Vali Loss: 0.1422915 Test Loss: 0.1683556
Validation loss decreased (0.142331 --> 0.142292).  Saving model ...
Updating learning rate to 0.004194304000000002
	iters: 100, epoch: 11 | loss: 0.1747967
	speed: 0.3682s/iter; left time: 957.7783s
Epoch: 11 cost time: 22.139897346496582
Epoch: 11, Steps: 135 | Train Loss: 0.1738506 Vali Loss: 0.1423815 Test Loss: 0.1685743
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.003355443200000002
	iters: 100, epoch: 12 | loss: 0.1675927
	speed: 0.3706s/iter; left time: 913.8062s
Epoch: 12 cost time: 22.337459325790405
Epoch: 12, Steps: 135 | Train Loss: 0.1739593 Vali Loss: 0.1427019 Test Loss: 0.1683202
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.002684354560000001
	iters: 100, epoch: 13 | loss: 0.1675516
	speed: 0.3612s/iter; left time: 841.8507s
Epoch: 13 cost time: 21.505354642868042
Epoch: 13, Steps: 135 | Train Loss: 0.1740023 Vali Loss: 0.1423356 Test Loss: 0.1683111
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.0021474836480000013
	iters: 100, epoch: 14 | loss: 0.1765814
	speed: 0.3616s/iter; left time: 794.0471s
Epoch: 14 cost time: 21.733172178268433
Epoch: 14, Steps: 135 | Train Loss: 0.1739158 Vali Loss: 0.1422281 Test Loss: 0.1683801
Validation loss decreased (0.142292 --> 0.142228).  Saving model ...
Updating learning rate to 0.0017179869184000011
	iters: 100, epoch: 15 | loss: 0.1619636
	speed: 0.3679s/iter; left time: 758.1693s
Epoch: 15 cost time: 22.367533683776855
Epoch: 15, Steps: 135 | Train Loss: 0.1739297 Vali Loss: 0.1421062 Test Loss: 0.1682439
Validation loss decreased (0.142228 --> 0.142106).  Saving model ...
Updating learning rate to 0.0013743895347200009
	iters: 100, epoch: 16 | loss: 0.1780482
	speed: 0.3756s/iter; left time: 723.3582s
Epoch: 16 cost time: 22.801348209381104
Epoch: 16, Steps: 135 | Train Loss: 0.1738813 Vali Loss: 0.1423841 Test Loss: 0.1683155
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0010995116277760007
	iters: 100, epoch: 17 | loss: 0.1770726
	speed: 0.3733s/iter; left time: 668.6294s
Epoch: 17 cost time: 22.17886447906494
Epoch: 17, Steps: 135 | Train Loss: 0.1739649 Vali Loss: 0.1423072 Test Loss: 0.1683318
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.0008796093022208007
	iters: 100, epoch: 18 | loss: 0.1739403
	speed: 0.3666s/iter; left time: 607.0342s
Epoch: 18 cost time: 22.087642192840576
Epoch: 18, Steps: 135 | Train Loss: 0.1739039 Vali Loss: 0.1422355 Test Loss: 0.1682450
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.0007036874417766406
	iters: 100, epoch: 19 | loss: 0.1811235
	speed: 0.3734s/iter; left time: 568.0153s
Epoch: 19 cost time: 22.736993074417114
Epoch: 19, Steps: 135 | Train Loss: 0.1739151 Vali Loss: 0.1422514 Test Loss: 0.1683106
EarlyStopping counter: 4 out of 5
Updating learning rate to 0.0005629499534213125
	iters: 100, epoch: 20 | loss: 0.1702724
	speed: 0.3974s/iter; left time: 550.8019s
Epoch: 20 cost time: 23.64806818962097
Epoch: 20, Steps: 135 | Train Loss: 0.1738318 Vali Loss: 0.1423036 Test Loss: 0.1682736
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : Electricity_720_336_SparseTSF_custom_ftM_sl720_pl336_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4925
mse:0.16685497896671295, mae:0.2649561810493469, rse:0.405571311712265
