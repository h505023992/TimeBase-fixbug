Args in experiment:
Namespace(is_training=1, model_id='ETTh2_336_720', model='SparseTSF', data='ETTh2', root_path='./dataset/', data_path='ETTh2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=336, label_len=48, pred_len=720, period_len=24, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='learned', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=256, patience=5, learning_rate=0.03, des='test', loss='mse', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=2, use_multi_gpu=0, devices='0,1', test_flop=False)
Use GPU: cuda:2
>>>>>>>start training : ETTh2_336_720_SparseTSF_ETTh2_ftM_sl336_pl720_test_0_seed2023>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7585
val 2161
test 2161
Epoch: 1 cost time: 6.176301717758179
Epoch: 1, Steps: 29 | Train Loss: 0.9579493 Vali Loss: 0.7542128 Test Loss: 0.4827029
Validation loss decreased (inf --> 0.754213).  Saving model ...
Updating learning rate to 0.03
Epoch: 2 cost time: 2.3750109672546387
Epoch: 2, Steps: 29 | Train Loss: 0.9096750 Vali Loss: 0.7227428 Test Loss: 0.4477611
Validation loss decreased (0.754213 --> 0.722743).  Saving model ...
Updating learning rate to 0.03
Epoch: 3 cost time: 2.2717039585113525
Epoch: 3, Steps: 29 | Train Loss: 0.8542262 Vali Loss: 0.6700813 Test Loss: 0.4233627
Validation loss decreased (0.722743 --> 0.670081).  Saving model ...
Updating learning rate to 0.03
Epoch: 4 cost time: 2.575965166091919
Epoch: 4, Steps: 29 | Train Loss: 0.8241499 Vali Loss: 0.6525015 Test Loss: 0.4120544
Validation loss decreased (0.670081 --> 0.652502).  Saving model ...
Updating learning rate to 0.024
Epoch: 5 cost time: 2.458237886428833
Epoch: 5, Steps: 29 | Train Loss: 0.8153280 Vali Loss: 0.6565034 Test Loss: 0.4132300
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.019200000000000002
Epoch: 6 cost time: 2.4393584728240967
Epoch: 6, Steps: 29 | Train Loss: 0.8082415 Vali Loss: 0.6582254 Test Loss: 0.4056553
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.015360000000000004
Epoch: 7 cost time: 2.369014024734497
Epoch: 7, Steps: 29 | Train Loss: 0.8058795 Vali Loss: 0.6428099 Test Loss: 0.4079153
Validation loss decreased (0.652502 --> 0.642810).  Saving model ...
Updating learning rate to 0.012288000000000002
Epoch: 8 cost time: 2.3958990573883057
Epoch: 8, Steps: 29 | Train Loss: 0.8091452 Vali Loss: 0.6540163 Test Loss: 0.4059798
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.009830400000000001
Epoch: 9 cost time: 2.440819501876831
Epoch: 9, Steps: 29 | Train Loss: 0.8039409 Vali Loss: 0.6486871 Test Loss: 0.4057337
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.007864320000000003
Epoch: 10 cost time: 2.3302531242370605
Epoch: 10, Steps: 29 | Train Loss: 0.8054696 Vali Loss: 0.6445415 Test Loss: 0.4068627
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.006291456000000002
Epoch: 11 cost time: 2.182940721511841
Epoch: 11, Steps: 29 | Train Loss: 0.8061464 Vali Loss: 0.6437142 Test Loss: 0.4057835
EarlyStopping counter: 4 out of 5
Updating learning rate to 0.005033164800000003
Epoch: 12 cost time: 2.2778358459472656
Epoch: 12, Steps: 29 | Train Loss: 0.8021355 Vali Loss: 0.6417841 Test Loss: 0.4066946
Validation loss decreased (0.642810 --> 0.641784).  Saving model ...
Updating learning rate to 0.004026531840000002
Epoch: 13 cost time: 2.316575527191162
Epoch: 13, Steps: 29 | Train Loss: 0.8053881 Vali Loss: 0.6441314 Test Loss: 0.4057079
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0032212254720000015
Epoch: 14 cost time: 2.1483006477355957
Epoch: 14, Steps: 29 | Train Loss: 0.8018367 Vali Loss: 0.6407154 Test Loss: 0.4057060
Validation loss decreased (0.641784 --> 0.640715).  Saving model ...
Updating learning rate to 0.0025769803776000016
Epoch: 15 cost time: 2.3542380332946777
Epoch: 15, Steps: 29 | Train Loss: 0.8034868 Vali Loss: 0.6447611 Test Loss: 0.4059328
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.002061584302080001
Epoch: 16 cost time: 2.297250509262085
Epoch: 16, Steps: 29 | Train Loss: 0.8029594 Vali Loss: 0.6414167 Test Loss: 0.4061551
EarlyStopping counter: 2 out of 5
Updating learning rate to 0.001649267441664001
Epoch: 17 cost time: 2.441854953765869
Epoch: 17, Steps: 29 | Train Loss: 0.8063755 Vali Loss: 0.6435255 Test Loss: 0.4059328
EarlyStopping counter: 3 out of 5
Updating learning rate to 0.001319413953331201
Epoch: 18 cost time: 2.3752150535583496
Epoch: 18, Steps: 29 | Train Loss: 0.8058395 Vali Loss: 0.6417250 Test Loss: 0.4058415
EarlyStopping counter: 4 out of 5
Updating learning rate to 0.0010555311626649609
Epoch: 19 cost time: 2.248120069503784
Epoch: 19, Steps: 29 | Train Loss: 0.8027032 Vali Loss: 0.6443114 Test Loss: 0.4054669
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : ETTh2_336_720_SparseTSF_ETTh2_ftM_sl336_pl720_test_0_seed2023<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.3877376317977905, mae:0.4237634837627411, rse:0.4977080821990967
