True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm1_96_96         Model:              TimesNet            

[1mData Loader[0m
  Data:               ETTm1               Root Path:          ./dataset/          
  Data Path:          ETTm1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm1_96_96_TimesNet_ETTm1_ftM_sl96_ll48_pl192_dm16_nh8_el2_dl1_df32_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34273
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.3841394
	speed: 0.2003s/iter; left time: 6420.2799s
	iters: 200, epoch: 1 | loss: 0.3978544
	speed: 0.1745s/iter; left time: 5577.4011s
	iters: 300, epoch: 1 | loss: 0.4432419
	speed: 0.1796s/iter; left time: 5722.7687s
	iters: 400, epoch: 1 | loss: 0.3449565
	speed: 0.1734s/iter; left time: 5508.1763s
	iters: 500, epoch: 1 | loss: 0.3186392
	speed: 0.1744s/iter; left time: 5520.8080s
	iters: 600, epoch: 1 | loss: 0.3319023
	speed: 0.1740s/iter; left time: 5490.0972s
	iters: 700, epoch: 1 | loss: 0.3020952
	speed: 0.1746s/iter; left time: 5493.0549s
	iters: 800, epoch: 1 | loss: 0.3185735
	speed: 0.1710s/iter; left time: 5364.2341s
	iters: 900, epoch: 1 | loss: 0.3651932
	speed: 0.1721s/iter; left time: 5378.8685s
	iters: 1000, epoch: 1 | loss: 0.3172973
	speed: 0.1730s/iter; left time: 5392.2389s
Epoch: 1 cost time: 189.2257058620453
Epoch: 1, Steps: 1072 | Train Loss: 0.3702350 Vali Loss: 0.5150722 Test Loss: 0.3821458
Validation loss decreased (inf --> 0.515072).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2712272
	speed: 0.8654s/iter; left time: 26817.0291s
	iters: 200, epoch: 2 | loss: 0.2905189
	speed: 0.1717s/iter; left time: 5304.2909s
	iters: 300, epoch: 2 | loss: 0.3513702
	speed: 0.1743s/iter; left time: 5365.5715s
	iters: 400, epoch: 2 | loss: 0.2556212
	speed: 0.1714s/iter; left time: 5260.5541s
	iters: 500, epoch: 2 | loss: 0.3359866
	speed: 0.1713s/iter; left time: 5240.1695s
	iters: 600, epoch: 2 | loss: 0.3037430
	speed: 0.1725s/iter; left time: 5258.4374s
	iters: 700, epoch: 2 | loss: 0.3479490
	speed: 0.1711s/iter; left time: 5200.8049s
	iters: 800, epoch: 2 | loss: 0.2615296
	speed: 0.1722s/iter; left time: 5215.1108s
	iters: 900, epoch: 2 | loss: 0.2887125
	speed: 0.1738s/iter; left time: 5245.4897s
	iters: 1000, epoch: 2 | loss: 0.3574061
	speed: 0.1719s/iter; left time: 5171.6528s
Epoch: 2 cost time: 185.45088291168213
Epoch: 2, Steps: 1072 | Train Loss: 0.3073543 Vali Loss: 0.5157184 Test Loss: 0.3791904
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3564876
	speed: 0.9223s/iter; left time: 27592.9893s
	iters: 200, epoch: 3 | loss: 0.2514879
	speed: 0.1743s/iter; left time: 5196.3447s
	iters: 300, epoch: 3 | loss: 0.2844674
	speed: 0.1746s/iter; left time: 5188.7488s
	iters: 400, epoch: 3 | loss: 0.2588044
	speed: 0.1738s/iter; left time: 5146.3292s
	iters: 500, epoch: 3 | loss: 0.2301697
	speed: 0.1752s/iter; left time: 5170.2863s
	iters: 600, epoch: 3 | loss: 0.2544128
	speed: 0.1726s/iter; left time: 5078.2864s
	iters: 700, epoch: 3 | loss: 0.3245786
	speed: 0.1734s/iter; left time: 5082.1549s
	iters: 800, epoch: 3 | loss: 0.2780874
	speed: 0.1655s/iter; left time: 4835.5178s
	iters: 900, epoch: 3 | loss: 0.2423234
	speed: 0.1682s/iter; left time: 4896.4939s
	iters: 1000, epoch: 3 | loss: 0.3232545
	speed: 0.1712s/iter; left time: 4966.3303s
Epoch: 3 cost time: 185.36432552337646
Epoch: 3, Steps: 1072 | Train Loss: 0.2894173 Vali Loss: 0.5145520 Test Loss: 0.3874720
Validation loss decreased (0.515072 --> 0.514552).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3060321
	speed: 0.9157s/iter; left time: 26414.6269s
	iters: 200, epoch: 4 | loss: 0.2612321
	speed: 0.1685s/iter; left time: 4842.3962s
	iters: 300, epoch: 4 | loss: 0.2381467
	speed: 0.1697s/iter; left time: 4861.3339s
	iters: 400, epoch: 4 | loss: 0.2816946
	speed: 0.1718s/iter; left time: 4904.5308s
	iters: 500, epoch: 4 | loss: 0.2842551
	speed: 0.1733s/iter; left time: 4928.2959s
	iters: 600, epoch: 4 | loss: 0.2443168
	speed: 0.1709s/iter; left time: 4844.4767s
	iters: 700, epoch: 4 | loss: 0.2915688
	speed: 0.1735s/iter; left time: 4901.7016s
	iters: 800, epoch: 4 | loss: 0.3066991
	speed: 0.1732s/iter; left time: 4874.0900s
	iters: 900, epoch: 4 | loss: 0.2664851
	speed: 0.1714s/iter; left time: 4806.9934s
	iters: 1000, epoch: 4 | loss: 0.2399186
	speed: 0.1720s/iter; left time: 4807.0608s
Epoch: 4 cost time: 184.8939118385315
Epoch: 4, Steps: 1072 | Train Loss: 0.2818847 Vali Loss: 0.5174518 Test Loss: 0.3946052
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3339812
	speed: 0.8613s/iter; left time: 23919.6370s
	iters: 200, epoch: 5 | loss: 0.3228986
	speed: 0.1706s/iter; left time: 4720.9185s
	iters: 300, epoch: 5 | loss: 0.2577573
	speed: 0.1752s/iter; left time: 4829.8968s
	iters: 400, epoch: 5 | loss: 0.3316752
	speed: 0.1707s/iter; left time: 4689.1462s
	iters: 500, epoch: 5 | loss: 0.2318112
	speed: 0.1709s/iter; left time: 4677.5841s
	iters: 600, epoch: 5 | loss: 0.3666406
	speed: 0.1707s/iter; left time: 4654.1590s
	iters: 700, epoch: 5 | loss: 0.4116080
	speed: 0.1721s/iter; left time: 4676.8723s
	iters: 800, epoch: 5 | loss: 0.2873331
	speed: 0.1730s/iter; left time: 4683.7380s
	iters: 900, epoch: 5 | loss: 0.2944260
	speed: 0.1723s/iter; left time: 4647.0421s
	iters: 1000, epoch: 5 | loss: 0.2518534
	speed: 0.1724s/iter; left time: 4632.8929s
Epoch: 5 cost time: 185.19222950935364
Epoch: 5, Steps: 1072 | Train Loss: 0.2776150 Vali Loss: 0.5241616 Test Loss: 0.3929526
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2438991
	speed: 0.8970s/iter; left time: 23951.5594s
	iters: 200, epoch: 6 | loss: 0.2202521
	speed: 0.1723s/iter; left time: 4582.1136s
	iters: 300, epoch: 6 | loss: 0.2936642
	speed: 0.1724s/iter; left time: 4568.1943s
	iters: 400, epoch: 6 | loss: 0.2710832
	speed: 0.1716s/iter; left time: 4529.6686s
	iters: 500, epoch: 6 | loss: 0.2203779
	speed: 0.1716s/iter; left time: 4512.3728s
	iters: 600, epoch: 6 | loss: 0.2485546
	speed: 0.1725s/iter; left time: 4520.4723s
	iters: 700, epoch: 6 | loss: 0.2761163
	speed: 0.1712s/iter; left time: 4468.7222s
	iters: 800, epoch: 6 | loss: 0.2783916
	speed: 0.1734s/iter; left time: 4509.3926s
	iters: 900, epoch: 6 | loss: 0.2561275
	speed: 0.1720s/iter; left time: 4454.1907s
	iters: 1000, epoch: 6 | loss: 0.3422927
	speed: 0.1741s/iter; left time: 4493.1013s
Epoch: 6 cost time: 185.62132048606873
Epoch: 6, Steps: 1072 | Train Loss: 0.2758992 Vali Loss: 0.5248810 Test Loss: 0.3935635
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm1_96_96_TimesNet_ETTm1_ftM_sl96_ll48_pl192_dm16_nh8_el2_dl1_df32_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
test shape: (11329, 192, 7) (11329, 192, 7)
test shape: (11329, 192, 7) (11329, 192, 7)
mse:0.38716572523117065, mae:0.4016279876232147, dtw:not calculated
