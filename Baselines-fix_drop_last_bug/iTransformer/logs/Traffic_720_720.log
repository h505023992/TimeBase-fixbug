Args in experiment:
Namespace(is_training=1, model_id='traffic_720_720', model='iTransformer', data='custom', root_path='./dataset/', data_path='traffic.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=720, enc_in=862, dec_in=862, c_out=862, d_model=256, n_heads=8, e_layers=2, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=10, batch_size=4, patience=3, learning_rate=0.0001, des='Exp', loss='MSE', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', exp_name='MTSF', channel_independence=False, inverse=False, class_strategy='projection', target_root_path='./data/electricity/', target_data_path='electricity.csv', efficient_training=False, use_norm=True, partial_start_index=0)
Use GPU: cuda:0
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
[INFO] Register zero_ops() for <class 'torch.nn.modules.dropout.Dropout'>.
[INFO] Register count_convNd() for <class 'torch.nn.modules.conv.Conv1d'>.
[INFO] Register count_normalization() for <class 'torch.nn.modules.normalization.LayerNorm'>.
MACs: 1007046656.0
Params: 1161680.0
1.01G MACs
>>>>>>>start training : traffic_720_720_iTransformer_custom_M_ft720_sl48_ll720_pl256_dm8_nh2_el1_dl256_df1_fctimeF_ebTrue_dtExp_projection_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 10841
val 1037
test 2789
	iters: 100, epoch: 1 | loss: 0.5490538
	speed: 0.0592s/iter; left time: 1598.1444s
	iters: 200, epoch: 1 | loss: 0.4775835
	speed: 0.0607s/iter; left time: 1632.2669s
	iters: 300, epoch: 1 | loss: 0.4417587
	speed: 0.0511s/iter; left time: 1368.7235s
	iters: 400, epoch: 1 | loss: 0.4064164
	speed: 0.0493s/iter; left time: 1317.0459s
	iters: 500, epoch: 1 | loss: 0.3948777
	speed: 0.0502s/iter; left time: 1334.4116s
	iters: 600, epoch: 1 | loss: 0.4002177
	speed: 0.0521s/iter; left time: 1379.7046s
	iters: 700, epoch: 1 | loss: 0.3306289
	speed: 0.0612s/iter; left time: 1614.9525s
	iters: 800, epoch: 1 | loss: 0.3626156
	speed: 0.0549s/iter; left time: 1443.7261s
	iters: 900, epoch: 1 | loss: 0.3346020
	speed: 0.0548s/iter; left time: 1435.6342s
	iters: 1000, epoch: 1 | loss: 0.3614493
	speed: 0.0571s/iter; left time: 1490.0652s
	iters: 1100, epoch: 1 | loss: 0.3613727
	speed: 0.0541s/iter; left time: 1406.9304s
	iters: 1200, epoch: 1 | loss: 0.3673092
	speed: 0.0561s/iter; left time: 1453.7901s
	iters: 1300, epoch: 1 | loss: 0.3183095
	speed: 0.0534s/iter; left time: 1377.2557s
	iters: 1400, epoch: 1 | loss: 0.3667001
	speed: 0.0495s/iter; left time: 1273.0615s
	iters: 1500, epoch: 1 | loss: 0.3682743
	speed: 0.0513s/iter; left time: 1314.4809s
	iters: 1600, epoch: 1 | loss: 0.3751693
	speed: 0.0487s/iter; left time: 1242.0163s
	iters: 1700, epoch: 1 | loss: 0.2861468
	speed: 0.0500s/iter; left time: 1270.2121s
	iters: 1800, epoch: 1 | loss: 0.3176690
	speed: 0.0579s/iter; left time: 1465.0571s
	iters: 1900, epoch: 1 | loss: 0.3426274
	speed: 0.0510s/iter; left time: 1285.5504s
	iters: 2000, epoch: 1 | loss: 0.3097238
	speed: 0.0492s/iter; left time: 1234.5630s
	iters: 2100, epoch: 1 | loss: 0.3414856
	speed: 0.0475s/iter; left time: 1188.3450s
	iters: 2200, epoch: 1 | loss: 0.3541713
	speed: 0.0567s/iter; left time: 1413.0743s
	iters: 2300, epoch: 1 | loss: 0.2909819
	speed: 0.0586s/iter; left time: 1452.4875s
	iters: 2400, epoch: 1 | loss: 0.3210213
	speed: 0.0547s/iter; left time: 1352.2674s
	iters: 2500, epoch: 1 | loss: 0.3088219
	speed: 0.0551s/iter; left time: 1356.6984s
	iters: 2600, epoch: 1 | loss: 0.3200792
	speed: 0.0535s/iter; left time: 1311.4437s
	iters: 2700, epoch: 1 | loss: 0.3389505
	speed: 0.0551s/iter; left time: 1345.5766s
Max Memory (MB): 707.36376953125
Epoch: 1 cost time: 145.94325613975525
Epoch: 1, Steps: 2710 | Train Loss: 0.3656259 Vali Loss: 0.4167307 Test Loss: 0.4872149
Validation loss decreased (inf --> 0.416731).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2891436
	speed: 0.9334s/iter; left time: 22673.3017s
	iters: 200, epoch: 2 | loss: 0.3078804
	speed: 0.0523s/iter; left time: 1264.7470s
	iters: 300, epoch: 2 | loss: 0.3044952
	speed: 0.0488s/iter; left time: 1175.5239s
	iters: 400, epoch: 2 | loss: 0.3440089
	speed: 0.0518s/iter; left time: 1242.6763s
	iters: 500, epoch: 2 | loss: 0.3112031
	speed: 0.0494s/iter; left time: 1179.2920s
	iters: 600, epoch: 2 | loss: 0.2741210
	speed: 0.0607s/iter; left time: 1443.7576s
	iters: 700, epoch: 2 | loss: 0.2838939
	speed: 0.0500s/iter; left time: 1183.5964s
	iters: 800, epoch: 2 | loss: 0.3275621
	speed: 0.0493s/iter; left time: 1162.1845s
	iters: 900, epoch: 2 | loss: 0.2981886
	speed: 0.0505s/iter; left time: 1185.3971s
	iters: 1000, epoch: 2 | loss: 0.3185854
	speed: 0.0556s/iter; left time: 1299.9247s
	iters: 1100, epoch: 2 | loss: 0.2766099
	speed: 0.0642s/iter; left time: 1494.8974s
	iters: 1200, epoch: 2 | loss: 0.2851861
	speed: 0.0574s/iter; left time: 1330.5519s
	iters: 1300, epoch: 2 | loss: 0.2712604
	speed: 0.0579s/iter; left time: 1336.2362s
	iters: 1400, epoch: 2 | loss: 0.3127272
	speed: 0.0594s/iter; left time: 1365.6253s
	iters: 1500, epoch: 2 | loss: 0.3409351
	speed: 0.0595s/iter; left time: 1362.5224s
	iters: 1600, epoch: 2 | loss: 0.2967699
	speed: 0.0590s/iter; left time: 1344.7125s
	iters: 1700, epoch: 2 | loss: 0.2571548
	speed: 0.0564s/iter; left time: 1279.3807s
	iters: 1800, epoch: 2 | loss: 0.2789948
	speed: 0.0525s/iter; left time: 1187.0442s
	iters: 1900, epoch: 2 | loss: 0.3078969
	speed: 0.0531s/iter; left time: 1193.3594s
	iters: 2000, epoch: 2 | loss: 0.3024362
	speed: 0.0556s/iter; left time: 1245.8510s
	iters: 2100, epoch: 2 | loss: 0.3026346
	speed: 0.0538s/iter; left time: 1199.6412s
	iters: 2200, epoch: 2 | loss: 0.2990796
	speed: 0.0623s/iter; left time: 1382.9892s
	iters: 2300, epoch: 2 | loss: 0.2911553
	speed: 0.0528s/iter; left time: 1166.4707s
	iters: 2400, epoch: 2 | loss: 0.2769161
	speed: 0.0543s/iter; left time: 1193.2795s
	iters: 2500, epoch: 2 | loss: 0.2831643
	speed: 0.0531s/iter; left time: 1162.9441s
	iters: 2600, epoch: 2 | loss: 0.3026874
	speed: 0.0620s/iter; left time: 1351.9107s
	iters: 2700, epoch: 2 | loss: 0.3376060
	speed: 0.0596s/iter; left time: 1292.1159s
Max Memory (MB): 707.36376953125
Epoch: 2 cost time: 153.7079849243164
Epoch: 2, Steps: 2710 | Train Loss: 0.2998529 Vali Loss: 0.4066955 Test Loss: 0.4694029
Validation loss decreased (0.416731 --> 0.406695).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3044524
	speed: 1.0820s/iter; left time: 23350.4263s
	iters: 200, epoch: 3 | loss: 0.2812925
	speed: 0.0550s/iter; left time: 1182.3897s
	iters: 300, epoch: 3 | loss: 0.2720222
	speed: 0.0516s/iter; left time: 1103.2501s
	iters: 400, epoch: 3 | loss: 0.2839046
	speed: 0.0498s/iter; left time: 1059.8315s
	iters: 500, epoch: 3 | loss: 0.2800165
	speed: 0.0510s/iter; left time: 1079.7451s
	iters: 600, epoch: 3 | loss: 0.3048523
	speed: 0.0501s/iter; left time: 1056.0845s
	iters: 700, epoch: 3 | loss: 0.2668881
	speed: 0.0581s/iter; left time: 1219.6578s
	iters: 800, epoch: 3 | loss: 0.2936558
	speed: 0.0533s/iter; left time: 1112.6850s
	iters: 900, epoch: 3 | loss: 0.2507394
	speed: 0.0522s/iter; left time: 1083.9244s
	iters: 1000, epoch: 3 | loss: 0.2423448
	speed: 0.0528s/iter; left time: 1090.9676s
	iters: 1100, epoch: 3 | loss: 0.3179762
	speed: 0.0573s/iter; left time: 1178.2652s
	iters: 1200, epoch: 3 | loss: 0.2810226
	speed: 0.0593s/iter; left time: 1214.6053s
	iters: 1300, epoch: 3 | loss: 0.2586335
	speed: 0.0585s/iter; left time: 1193.1656s
	iters: 1400, epoch: 3 | loss: 0.2852062
	speed: 0.0561s/iter; left time: 1137.7789s
	iters: 1500, epoch: 3 | loss: 0.2784675
	speed: 0.0546s/iter; left time: 1101.6099s
	iters: 1600, epoch: 3 | loss: 0.2841386
	speed: 0.0564s/iter; left time: 1132.2555s
	iters: 1700, epoch: 3 | loss: 0.3006469
	speed: 0.0545s/iter; left time: 1088.6213s
	iters: 1800, epoch: 3 | loss: 0.2923607
	speed: 0.0513s/iter; left time: 1019.4297s
	iters: 1900, epoch: 3 | loss: 0.3191429
	speed: 0.0497s/iter; left time: 983.6505s
	iters: 2000, epoch: 3 | loss: 0.2585311
	speed: 0.0548s/iter; left time: 1079.2290s
	iters: 2100, epoch: 3 | loss: 0.2655699
	speed: 0.0532s/iter; left time: 1042.5391s
	iters: 2200, epoch: 3 | loss: 0.2917818
	speed: 0.0642s/iter; left time: 1250.6622s
	iters: 2300, epoch: 3 | loss: 0.2738241
	speed: 0.0525s/iter; left time: 1017.2787s
	iters: 2400, epoch: 3 | loss: 0.2761524
	speed: 0.0518s/iter; left time: 997.8810s
	iters: 2500, epoch: 3 | loss: 0.3255798
	speed: 0.0495s/iter; left time: 950.2882s
	iters: 2600, epoch: 3 | loss: 0.2745972
	speed: 0.0598s/iter; left time: 1140.2388s
	iters: 2700, epoch: 3 | loss: 0.2642010
	speed: 0.0556s/iter; left time: 1054.7827s
Max Memory (MB): 707.36376953125
Epoch: 3 cost time: 151.71791100502014
Epoch: 3, Steps: 2710 | Train Loss: 0.2888255 Vali Loss: 0.3990493 Test Loss: 0.4590763
Validation loss decreased (0.406695 --> 0.399049).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2893439
	speed: 1.1702s/iter; left time: 22082.9006s
	iters: 200, epoch: 4 | loss: 0.2967366
	speed: 0.0551s/iter; left time: 1034.4416s
	iters: 300, epoch: 4 | loss: 0.2829197
	speed: 0.0565s/iter; left time: 1055.0008s
	iters: 400, epoch: 4 | loss: 0.2833088
	speed: 0.0598s/iter; left time: 1110.3160s
	iters: 500, epoch: 4 | loss: 0.3139207
	speed: 0.0565s/iter; left time: 1043.7330s
	iters: 600, epoch: 4 | loss: 0.2787421
	speed: 0.0608s/iter; left time: 1117.3346s
	iters: 700, epoch: 4 | loss: 0.2908149
	speed: 0.0535s/iter; left time: 978.2375s
	iters: 800, epoch: 4 | loss: 0.3011794
	speed: 0.0550s/iter; left time: 998.7695s
	iters: 900, epoch: 4 | loss: 0.2603172
	speed: 0.0536s/iter; left time: 968.5367s
	iters: 1000, epoch: 4 | loss: 0.2613243
	speed: 0.0659s/iter; left time: 1184.2573s
	iters: 1100, epoch: 4 | loss: 0.2602991
	speed: 0.0595s/iter; left time: 1064.1429s
	iters: 1200, epoch: 4 | loss: 0.2469372
	speed: 0.0547s/iter; left time: 972.2710s
	iters: 1300, epoch: 4 | loss: 0.2697518
	speed: 0.0543s/iter; left time: 958.8660s
	iters: 1400, epoch: 4 | loss: 0.2882632
	speed: 0.0550s/iter; left time: 967.1368s
	iters: 1500, epoch: 4 | loss: 0.2970642
	speed: 0.0540s/iter; left time: 942.6894s
	iters: 1600, epoch: 4 | loss: 0.3038325
	speed: 0.0553s/iter; left time: 960.5324s
	iters: 1700, epoch: 4 | loss: 0.2703079
	speed: 0.0494s/iter; left time: 853.4336s
	iters: 1800, epoch: 4 | loss: 0.2715387
	speed: 0.0510s/iter; left time: 875.6376s
	iters: 1900, epoch: 4 | loss: 0.2865969
	speed: 0.0518s/iter; left time: 884.7604s
	iters: 2000, epoch: 4 | loss: 0.2711063
	speed: 0.0539s/iter; left time: 915.0547s
	iters: 2100, epoch: 4 | loss: 0.3646884
	speed: 0.0593s/iter; left time: 999.9034s
	iters: 2200, epoch: 4 | loss: 0.2727672
	speed: 0.0495s/iter; left time: 830.1919s
	iters: 2300, epoch: 4 | loss: 0.2843308
	speed: 0.0523s/iter; left time: 871.5097s
	iters: 2400, epoch: 4 | loss: 0.2669316
	speed: 0.0490s/iter; left time: 812.6967s
	iters: 2500, epoch: 4 | loss: 0.2658275
	speed: 0.0570s/iter; left time: 939.6631s
	iters: 2600, epoch: 4 | loss: 0.2418390
	speed: 0.0558s/iter; left time: 912.9901s
	iters: 2700, epoch: 4 | loss: 0.3558261
	speed: 0.0546s/iter; left time: 888.5757s
Max Memory (MB): 707.36376953125
Epoch: 4 cost time: 155.16009950637817
Epoch: 4, Steps: 2710 | Train Loss: 0.2845652 Vali Loss: 0.3965666 Test Loss: 0.4539804
Validation loss decreased (0.399049 --> 0.396567).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.2895807
	speed: 1.0446s/iter; left time: 16881.5463s
	iters: 200, epoch: 5 | loss: 0.2797515
	speed: 0.0520s/iter; left time: 835.7198s
	iters: 300, epoch: 5 | loss: 0.2886834
	speed: 0.0480s/iter; left time: 766.5956s
	iters: 400, epoch: 5 | loss: 0.3178794
	speed: 0.0453s/iter; left time: 718.1018s
	iters: 500, epoch: 5 | loss: 0.3019396
	speed: 0.0533s/iter; left time: 839.8367s
	iters: 600, epoch: 5 | loss: 0.2728003
	speed: 0.0482s/iter; left time: 754.5265s
	iters: 700, epoch: 5 | loss: 0.2857079
	speed: 0.0543s/iter; left time: 844.2026s
	iters: 800, epoch: 5 | loss: 0.2780100
	speed: 0.0510s/iter; left time: 789.1903s
	iters: 900, epoch: 5 | loss: 0.2499330
	speed: 0.0491s/iter; left time: 753.9069s
	iters: 1000, epoch: 5 | loss: 0.3296480
	speed: 0.0520s/iter; left time: 792.8272s
	iters: 1100, epoch: 5 | loss: 0.2839370
	speed: 0.0547s/iter; left time: 828.7896s
	iters: 1200, epoch: 5 | loss: 0.3287756
	speed: 0.0618s/iter; left time: 930.1370s
	iters: 1300, epoch: 5 | loss: 0.2686854
	speed: 0.0562s/iter; left time: 841.2925s
	iters: 1400, epoch: 5 | loss: 0.3193956
	speed: 0.0549s/iter; left time: 815.5075s
	iters: 1500, epoch: 5 | loss: 0.3054156
	speed: 0.0545s/iter; left time: 804.1739s
	iters: 1600, epoch: 5 | loss: 0.3351552
	speed: 0.0549s/iter; left time: 804.7637s
	iters: 1700, epoch: 5 | loss: 0.2852611
	speed: 0.0552s/iter; left time: 804.4725s
	iters: 1800, epoch: 5 | loss: 0.3001714
	speed: 0.0535s/iter; left time: 773.3694s
	iters: 1900, epoch: 5 | loss: 0.3128844
	speed: 0.0494s/iter; left time: 709.7256s
	iters: 2000, epoch: 5 | loss: 0.3048508
	speed: 0.0536s/iter; left time: 763.8048s
	iters: 2100, epoch: 5 | loss: 0.2977126
	speed: 0.0515s/iter; left time: 729.2584s
	iters: 2200, epoch: 5 | loss: 0.2646362
	speed: 0.0604s/iter; left time: 848.9089s
	iters: 2300, epoch: 5 | loss: 0.3147378
	speed: 0.0515s/iter; left time: 718.5212s
	iters: 2400, epoch: 5 | loss: 0.2728309
	speed: 0.0511s/iter; left time: 707.8728s
	iters: 2500, epoch: 5 | loss: 0.3039821
	speed: 0.0505s/iter; left time: 694.7771s
	iters: 2600, epoch: 5 | loss: 0.2767094
	speed: 0.0654s/iter; left time: 892.8835s
	iters: 2700, epoch: 5 | loss: 0.2724729
	speed: 0.0593s/iter; left time: 804.4046s
Max Memory (MB): 707.36376953125
Epoch: 5 cost time: 149.97604274749756
Epoch: 5, Steps: 2710 | Train Loss: 0.2826643 Vali Loss: 0.3953227 Test Loss: 0.4517687
Validation loss decreased (0.396567 --> 0.395323).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.2465449
	speed: 1.2618s/iter; left time: 16972.8625s
	iters: 200, epoch: 6 | loss: 0.2686200
	speed: 0.0528s/iter; left time: 704.9693s
	iters: 300, epoch: 6 | loss: 0.2838420
	speed: 0.0539s/iter; left time: 714.7001s
	iters: 400, epoch: 6 | loss: 0.2777216
	speed: 0.0532s/iter; left time: 700.0064s
	iters: 500, epoch: 6 | loss: 0.3037704
	speed: 0.0537s/iter; left time: 701.2850s
	iters: 600, epoch: 6 | loss: 0.2906684
	speed: 0.0613s/iter; left time: 794.3424s
	iters: 700, epoch: 6 | loss: 0.2908120
	speed: 0.0519s/iter; left time: 666.4850s
	iters: 800, epoch: 6 | loss: 0.2963778
	speed: 0.0542s/iter; left time: 691.4334s
	iters: 900, epoch: 6 | loss: 0.3075422
	speed: 0.0534s/iter; left time: 675.6776s
	iters: 1000, epoch: 6 | loss: 0.2798011
	speed: 0.0620s/iter; left time: 777.7993s
	iters: 1100, epoch: 6 | loss: 0.2565871
	speed: 0.0589s/iter; left time: 732.8751s
	iters: 1200, epoch: 6 | loss: 0.3010183
	speed: 0.0581s/iter; left time: 717.4207s
	iters: 1300, epoch: 6 | loss: 0.3047201
	speed: 0.0580s/iter; left time: 710.0265s
	iters: 1400, epoch: 6 | loss: 0.2796568
	speed: 0.0585s/iter; left time: 710.6056s
	iters: 1500, epoch: 6 | loss: 0.2432685
	speed: 0.0571s/iter; left time: 687.9365s
	iters: 1600, epoch: 6 | loss: 0.2830273
	speed: 0.0589s/iter; left time: 704.5008s
	iters: 1700, epoch: 6 | loss: 0.3014178
	speed: 0.0525s/iter; left time: 622.3319s
	iters: 1800, epoch: 6 | loss: 0.2857264
	speed: 0.0519s/iter; left time: 610.2140s
	iters: 1900, epoch: 6 | loss: 0.3210647
	speed: 0.0559s/iter; left time: 650.7157s
	iters: 2000, epoch: 6 | loss: 0.2665180
	speed: 0.0533s/iter; left time: 615.7811s
	iters: 2100, epoch: 6 | loss: 0.2710954
	speed: 0.0607s/iter; left time: 695.1476s
	iters: 2200, epoch: 6 | loss: 0.3112224
	speed: 0.0524s/iter; left time: 595.2108s
	iters: 2300, epoch: 6 | loss: 0.2926863
	speed: 0.0511s/iter; left time: 574.3914s
	iters: 2400, epoch: 6 | loss: 0.2629167
	speed: 0.0543s/iter; left time: 606.0215s
	iters: 2500, epoch: 6 | loss: 0.2778459
	speed: 0.0506s/iter; left time: 559.5049s
	iters: 2600, epoch: 6 | loss: 0.2951518
	speed: 0.0639s/iter; left time: 700.0597s
	iters: 2700, epoch: 6 | loss: 0.2808701
	speed: 0.0522s/iter; left time: 566.7002s
Max Memory (MB): 707.36376953125
Epoch: 6 cost time: 155.70945930480957
Epoch: 6, Steps: 2710 | Train Loss: 0.2816925 Vali Loss: 0.3945194 Test Loss: 0.4497468
Validation loss decreased (0.395323 --> 0.394519).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.2387003
	speed: 0.9646s/iter; left time: 10361.2009s
	iters: 200, epoch: 7 | loss: 0.2651657
	speed: 0.0496s/iter; left time: 527.5332s
	iters: 300, epoch: 7 | loss: 0.2511974
	speed: 0.0469s/iter; left time: 494.8112s
	iters: 400, epoch: 7 | loss: 0.3061411
	speed: 0.0492s/iter; left time: 513.8843s
	iters: 500, epoch: 7 | loss: 0.3025810
	speed: 0.0488s/iter; left time: 504.5498s
	iters: 600, epoch: 7 | loss: 0.2949498
	speed: 0.0462s/iter; left time: 473.2303s
	iters: 700, epoch: 7 | loss: 0.3302036
	speed: 0.0436s/iter; left time: 442.1686s
	iters: 800, epoch: 7 | loss: 0.2606016
	speed: 0.0455s/iter; left time: 456.7087s
	iters: 900, epoch: 7 | loss: 0.2427357
	speed: 0.0469s/iter; left time: 466.6366s
	iters: 1000, epoch: 7 | loss: 0.2888330
	speed: 0.0611s/iter; left time: 601.7629s
	iters: 1100, epoch: 7 | loss: 0.2659189
	speed: 0.0535s/iter; left time: 521.5149s
	iters: 1200, epoch: 7 | loss: 0.2680532
	speed: 0.0530s/iter; left time: 510.5729s
	iters: 1300, epoch: 7 | loss: 0.2688997
	speed: 0.0535s/iter; left time: 510.3052s
	iters: 1400, epoch: 7 | loss: 0.2897727
	speed: 0.0495s/iter; left time: 467.1632s
	iters: 1500, epoch: 7 | loss: 0.2501955
	speed: 0.0547s/iter; left time: 511.3747s
	iters: 1600, epoch: 7 | loss: 0.2670826
	speed: 0.0552s/iter; left time: 509.9370s
	iters: 1700, epoch: 7 | loss: 0.2753122
	speed: 0.0518s/iter; left time: 473.4115s
	iters: 1800, epoch: 7 | loss: 0.2848363
	speed: 0.0553s/iter; left time: 499.9397s
	iters: 1900, epoch: 7 | loss: 0.2486373
	speed: 0.0571s/iter; left time: 510.4891s
	iters: 2000, epoch: 7 | loss: 0.2592939
	speed: 0.0564s/iter; left time: 498.7334s
	iters: 2100, epoch: 7 | loss: 0.2922409
	speed: 0.0597s/iter; left time: 522.1636s
	iters: 2200, epoch: 7 | loss: 0.3004588
	speed: 0.0552s/iter; left time: 476.7120s
	iters: 2300, epoch: 7 | loss: 0.2675653
	speed: 0.0514s/iter; left time: 438.9414s
	iters: 2400, epoch: 7 | loss: 0.2843837
	speed: 0.0551s/iter; left time: 465.4748s
	iters: 2500, epoch: 7 | loss: 0.2664271
	speed: 0.0562s/iter; left time: 468.7262s
	iters: 2600, epoch: 7 | loss: 0.2900724
	speed: 0.0497s/iter; left time: 409.5330s
	iters: 2700, epoch: 7 | loss: 0.2861393
	speed: 0.0564s/iter; left time: 459.0379s
Max Memory (MB): 707.36376953125
Epoch: 7 cost time: 146.03929924964905
Epoch: 7, Steps: 2710 | Train Loss: 0.2812331 Vali Loss: 0.3943126 Test Loss: 0.4498767
Validation loss decreased (0.394519 --> 0.394313).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2625677
	speed: 1.1642s/iter; left time: 9349.9765s
	iters: 200, epoch: 8 | loss: 0.2813814
	speed: 0.0531s/iter; left time: 421.5167s
	iters: 300, epoch: 8 | loss: 0.2941321
	speed: 0.0525s/iter; left time: 410.8210s
	iters: 400, epoch: 8 | loss: 0.2581058
	speed: 0.0484s/iter; left time: 373.8784s
	iters: 500, epoch: 8 | loss: 0.2988079
	speed: 0.0519s/iter; left time: 396.3451s
	iters: 600, epoch: 8 | loss: 0.2594376
	speed: 0.0545s/iter; left time: 410.3427s
	iters: 700, epoch: 8 | loss: 0.2893551
	speed: 0.0497s/iter; left time: 369.6724s
	iters: 800, epoch: 8 | loss: 0.2611013
	speed: 0.0529s/iter; left time: 387.5848s
	iters: 900, epoch: 8 | loss: 0.3084558
	speed: 0.0528s/iter; left time: 381.5063s
	iters: 1000, epoch: 8 | loss: 0.2895262
	speed: 0.0535s/iter; left time: 381.3115s
	iters: 1100, epoch: 8 | loss: 0.2711454
	speed: 0.0511s/iter; left time: 359.4539s
	iters: 1200, epoch: 8 | loss: 0.3106499
	speed: 0.0514s/iter; left time: 356.5101s
	iters: 1300, epoch: 8 | loss: 0.2878199
	speed: 0.0507s/iter; left time: 346.1441s
	iters: 1400, epoch: 8 | loss: 0.2528665
	speed: 0.0522s/iter; left time: 351.5083s
	iters: 1500, epoch: 8 | loss: 0.2771678
	speed: 0.0529s/iter; left time: 350.8404s
	iters: 1600, epoch: 8 | loss: 0.2864436
	speed: 0.0517s/iter; left time: 337.7243s
	iters: 1700, epoch: 8 | loss: 0.2901234
	speed: 0.0503s/iter; left time: 323.2346s
	iters: 1800, epoch: 8 | loss: 0.2559624
	speed: 0.0566s/iter; left time: 358.1568s
	iters: 1900, epoch: 8 | loss: 0.2973689
	speed: 0.0503s/iter; left time: 313.3846s
	iters: 2000, epoch: 8 | loss: 0.2948617
	speed: 0.0527s/iter; left time: 323.2660s
	iters: 2100, epoch: 8 | loss: 0.2717175
	speed: 0.0527s/iter; left time: 317.5601s
	iters: 2200, epoch: 8 | loss: 0.2950035
	speed: 0.0500s/iter; left time: 296.4246s
	iters: 2300, epoch: 8 | loss: 0.2709346
	speed: 0.0500s/iter; left time: 291.4987s
	iters: 2400, epoch: 8 | loss: 0.3094709
	speed: 0.0511s/iter; left time: 292.9032s
	iters: 2500, epoch: 8 | loss: 0.2697496
	speed: 0.0550s/iter; left time: 309.9096s
	iters: 2600, epoch: 8 | loss: 0.3196340
	speed: 0.0497s/iter; left time: 275.1154s
	iters: 2700, epoch: 8 | loss: 0.2648483
	speed: 0.0557s/iter; left time: 302.7117s
Max Memory (MB): 707.36376953125
Epoch: 8 cost time: 145.5453383922577
Epoch: 8, Steps: 2710 | Train Loss: 0.2809971 Vali Loss: 0.3942692 Test Loss: 0.4497827
Validation loss decreased (0.394313 --> 0.394269).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.2943383
	speed: 1.0524s/iter; left time: 5599.6191s
	iters: 200, epoch: 9 | loss: 0.2787846
	speed: 0.0504s/iter; left time: 263.0757s
	iters: 300, epoch: 9 | loss: 0.2897790
	speed: 0.0490s/iter; left time: 250.8238s
	iters: 400, epoch: 9 | loss: 0.2832767
	speed: 0.0466s/iter; left time: 233.8149s
	iters: 500, epoch: 9 | loss: 0.2921716
	speed: 0.0481s/iter; left time: 236.5545s
	iters: 600, epoch: 9 | loss: 0.2816409
	speed: 0.0461s/iter; left time: 222.2797s
	iters: 700, epoch: 9 | loss: 0.2510222
	speed: 0.0493s/iter; left time: 232.8312s
	iters: 800, epoch: 9 | loss: 0.2680300
	speed: 0.0452s/iter; left time: 208.8694s
	iters: 900, epoch: 9 | loss: 0.2570578
	speed: 0.0505s/iter; left time: 228.2163s
	iters: 1000, epoch: 9 | loss: 0.2865331
	speed: 0.0418s/iter; left time: 185.0080s
	iters: 1100, epoch: 9 | loss: 0.2824304
	speed: 0.0477s/iter; left time: 206.3129s
	iters: 1200, epoch: 9 | loss: 0.2523945
	speed: 0.0499s/iter; left time: 210.5060s
	iters: 1300, epoch: 9 | loss: 0.3029561
	speed: 0.0481s/iter; left time: 198.3291s
	iters: 1400, epoch: 9 | loss: 0.2563950
	speed: 0.0486s/iter; left time: 195.2610s
	iters: 1500, epoch: 9 | loss: 0.3052662
	speed: 0.0497s/iter; left time: 194.9470s
	iters: 1600, epoch: 9 | loss: 0.2651747
	speed: 0.0501s/iter; left time: 191.4339s
	iters: 1700, epoch: 9 | loss: 0.2926670
	speed: 0.0477s/iter; left time: 177.6759s
	iters: 1800, epoch: 9 | loss: 0.2707676
	speed: 0.0438s/iter; left time: 158.7193s
	iters: 1900, epoch: 9 | loss: 0.2816113
	speed: 0.0528s/iter; left time: 185.9736s
	iters: 2000, epoch: 9 | loss: 0.3247673
	speed: 0.0592s/iter; left time: 202.4079s
	iters: 2100, epoch: 9 | loss: 0.2890184
	speed: 0.0510s/iter; left time: 169.3593s
	iters: 2200, epoch: 9 | loss: 0.3033805
	speed: 0.0564s/iter; left time: 181.6721s
	iters: 2300, epoch: 9 | loss: 0.3162208
	speed: 0.0583s/iter; left time: 182.0521s
	iters: 2400, epoch: 9 | loss: 0.2616643
	speed: 0.0565s/iter; left time: 170.6110s
	iters: 2500, epoch: 9 | loss: 0.2800872
	speed: 0.0560s/iter; left time: 163.4349s
	iters: 2600, epoch: 9 | loss: 0.2972584
	speed: 0.0574s/iter; left time: 161.8480s
	iters: 2700, epoch: 9 | loss: 0.2797361
	speed: 0.0557s/iter; left time: 151.5380s
Max Memory (MB): 707.36376953125
Epoch: 9 cost time: 142.23951601982117
Epoch: 9, Steps: 2710 | Train Loss: 0.2808702 Vali Loss: 0.3941033 Test Loss: 0.4496815
Validation loss decreased (0.394269 --> 0.394103).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3123181
	speed: 1.1830s/iter; left time: 3088.8641s
	iters: 200, epoch: 10 | loss: 0.2854648
	speed: 0.0580s/iter; left time: 145.6727s
	iters: 300, epoch: 10 | loss: 0.3020005
	speed: 0.0509s/iter; left time: 122.7983s
	iters: 400, epoch: 10 | loss: 0.2894750
	speed: 0.0567s/iter; left time: 131.0929s
	iters: 500, epoch: 10 | loss: 0.2857659
	speed: 0.0534s/iter; left time: 117.9878s
	iters: 600, epoch: 10 | loss: 0.2974221
	speed: 0.0538s/iter; left time: 113.5114s
	iters: 700, epoch: 10 | loss: 0.2689832
	speed: 0.0535s/iter; left time: 107.6276s
	iters: 800, epoch: 10 | loss: 0.2863089
	speed: 0.0536s/iter; left time: 102.4069s
	iters: 900, epoch: 10 | loss: 0.3301710
	speed: 0.0509s/iter; left time: 92.2422s
	iters: 1000, epoch: 10 | loss: 0.2664699
	speed: 0.0534s/iter; left time: 91.3975s
	iters: 1100, epoch: 10 | loss: 0.3198268
	speed: 0.0594s/iter; left time: 95.7288s
	iters: 1200, epoch: 10 | loss: 0.2544629
	speed: 0.0517s/iter; left time: 78.1136s
	iters: 1300, epoch: 10 | loss: 0.2569733
	speed: 0.0570s/iter; left time: 80.4111s
	iters: 1400, epoch: 10 | loss: 0.2720761
	speed: 0.0533s/iter; left time: 69.9311s
	iters: 1500, epoch: 10 | loss: 0.3566537
	speed: 0.0545s/iter; left time: 65.9978s
	iters: 1600, epoch: 10 | loss: 0.2770376
	speed: 0.0536s/iter; left time: 59.5447s
	iters: 1700, epoch: 10 | loss: 0.2821976
	speed: 0.0516s/iter; left time: 52.1852s
	iters: 1800, epoch: 10 | loss: 0.2766214
	speed: 0.0531s/iter; left time: 48.3333s
	iters: 1900, epoch: 10 | loss: 0.2788407
	speed: 0.0542s/iter; left time: 43.9270s
	iters: 2000, epoch: 10 | loss: 0.2695651
	speed: 0.0553s/iter; left time: 39.2936s
	iters: 2100, epoch: 10 | loss: 0.2639823
	speed: 0.0503s/iter; left time: 30.7606s
	iters: 2200, epoch: 10 | loss: 0.2437209
	speed: 0.0576s/iter; left time: 29.4223s
	iters: 2300, epoch: 10 | loss: 0.2790017
	speed: 0.0540s/iter; left time: 22.1967s
	iters: 2400, epoch: 10 | loss: 0.2637706
	speed: 0.0518s/iter; left time: 16.1003s
	iters: 2500, epoch: 10 | loss: 0.2972568
	speed: 0.0528s/iter; left time: 11.1488s
	iters: 2600, epoch: 10 | loss: 0.2604611
	speed: 0.0526s/iter; left time: 5.8393s
	iters: 2700, epoch: 10 | loss: 0.2682855
	speed: 0.0516s/iter; left time: 0.5672s
Max Memory (MB): 707.36376953125
Epoch: 10 cost time: 150.1668667793274
Epoch: 10, Steps: 2710 | Train Loss: 0.2808079 Vali Loss: 0.3941939 Test Loss: 0.4496534
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : traffic_720_720_iTransformer_custom_M_ft720_sl48_ll720_pl256_dm8_nh2_el1_dl256_df1_fctimeF_ebTrue_dtExp_projection_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2789
test shape: (2789, 1, 720, 862) (2789, 1, 720, 862)
test shape: (2789, 720, 862) (2789, 720, 862)
mse:0.4496792256832123, mae:0.31372442841529846
