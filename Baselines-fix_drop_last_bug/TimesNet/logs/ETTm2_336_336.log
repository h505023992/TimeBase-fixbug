True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm2_336_96        Model:              TimesNet            

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/          
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            336                 Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm2_336_96_TimesNet_ETTm2_ftM_sl336_ll48_pl336_dm16_nh8_el2_dl1_df32_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33889
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.4882745
	speed: 0.4090s/iter; left time: 12966.5592s
	iters: 200, epoch: 1 | loss: 0.2415663
	speed: 0.3064s/iter; left time: 9683.3879s
	iters: 300, epoch: 1 | loss: 0.4671427
	speed: 0.2929s/iter; left time: 9227.8922s
	iters: 400, epoch: 1 | loss: 0.8151913
	speed: 0.2922s/iter; left time: 9174.0439s
	iters: 500, epoch: 1 | loss: 0.2630078
	speed: 0.2976s/iter; left time: 9314.2046s
	iters: 600, epoch: 1 | loss: 0.2337347
	speed: 0.2959s/iter; left time: 9233.1070s
	iters: 700, epoch: 1 | loss: 0.4420524
	speed: 0.2935s/iter; left time: 9127.8785s
	iters: 800, epoch: 1 | loss: 0.4681532
	speed: 0.2939s/iter; left time: 9110.9686s
	iters: 900, epoch: 1 | loss: 0.2519307
	speed: 0.2869s/iter; left time: 8864.2202s
	iters: 1000, epoch: 1 | loss: 0.2795344
	speed: 0.2846s/iter; left time: 8767.3757s
Epoch: 1 cost time: 322.43266677856445
Epoch: 1, Steps: 1060 | Train Loss: 0.3880373 Vali Loss: 0.2380340 Test Loss: 0.2935692
Validation loss decreased (inf --> 0.238034).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2600279
	speed: 1.2340s/iter; left time: 37810.8841s
	iters: 200, epoch: 2 | loss: 0.2454810
	speed: 0.2814s/iter; left time: 8593.6065s
	iters: 300, epoch: 2 | loss: 0.5231361
	speed: 0.2790s/iter; left time: 8492.7242s
	iters: 400, epoch: 2 | loss: 0.2060539
	speed: 0.2765s/iter; left time: 8388.6206s
	iters: 500, epoch: 2 | loss: 0.3275942
	speed: 0.2762s/iter; left time: 8353.7176s
	iters: 600, epoch: 2 | loss: 0.2301996
	speed: 0.2727s/iter; left time: 8219.6213s
	iters: 700, epoch: 2 | loss: 0.2413837
	speed: 0.2742s/iter; left time: 8238.2400s
	iters: 800, epoch: 2 | loss: 0.2395778
	speed: 0.2715s/iter; left time: 8130.1367s
	iters: 900, epoch: 2 | loss: 0.3043736
	speed: 0.2713s/iter; left time: 8097.0715s
	iters: 1000, epoch: 2 | loss: 0.2007701
	speed: 0.2688s/iter; left time: 7994.6066s
Epoch: 2 cost time: 291.86242151260376
Epoch: 2, Steps: 1060 | Train Loss: 0.3057432 Vali Loss: 0.2572249 Test Loss: 0.3022147
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2650529
	speed: 1.2304s/iter; left time: 36395.1657s
	iters: 200, epoch: 3 | loss: 0.2361166
	speed: 0.2682s/iter; left time: 7906.1546s
	iters: 300, epoch: 3 | loss: 0.2412210
	speed: 0.2711s/iter; left time: 7963.9920s
	iters: 400, epoch: 3 | loss: 0.2933890
	speed: 0.2705s/iter; left time: 7919.7351s
	iters: 500, epoch: 3 | loss: 0.3174616
	speed: 0.2713s/iter; left time: 7918.2406s
	iters: 600, epoch: 3 | loss: 0.2893512
	speed: 0.2656s/iter; left time: 7723.0237s
	iters: 700, epoch: 3 | loss: 0.3259143
	speed: 0.2686s/iter; left time: 7784.6758s
	iters: 800, epoch: 3 | loss: 0.3625850
	speed: 0.2700s/iter; left time: 7797.8381s
	iters: 900, epoch: 3 | loss: 0.2556702
	speed: 0.2695s/iter; left time: 7757.1066s
	iters: 1000, epoch: 3 | loss: 0.2548681
	speed: 0.2692s/iter; left time: 7721.3213s
Epoch: 3 cost time: 285.93160820007324
Epoch: 3, Steps: 1060 | Train Loss: 0.2721128 Vali Loss: 0.2600639 Test Loss: 0.3030274
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2723068
	speed: 1.2141s/iter; left time: 34626.1895s
	iters: 200, epoch: 4 | loss: 0.1602330
	speed: 0.2684s/iter; left time: 7628.1542s
	iters: 300, epoch: 4 | loss: 0.2937698
	speed: 0.2705s/iter; left time: 7660.0422s
	iters: 400, epoch: 4 | loss: 0.2275692
	speed: 0.2670s/iter; left time: 7535.9293s
	iters: 500, epoch: 4 | loss: 0.2231761
	speed: 0.2696s/iter; left time: 7581.0397s
	iters: 600, epoch: 4 | loss: 0.2330926
	speed: 0.2692s/iter; left time: 7543.9176s
	iters: 700, epoch: 4 | loss: 0.4019472
	speed: 0.2707s/iter; left time: 7558.8205s
	iters: 800, epoch: 4 | loss: 0.2376377
	speed: 0.2721s/iter; left time: 7571.3304s
	iters: 900, epoch: 4 | loss: 0.3080399
	speed: 0.2691s/iter; left time: 7459.2745s
	iters: 1000, epoch: 4 | loss: 0.3783065
	speed: 0.2708s/iter; left time: 7480.0974s
Epoch: 4 cost time: 286.2725763320923
Epoch: 4, Steps: 1060 | Train Loss: 0.2568867 Vali Loss: 0.2566863 Test Loss: 0.3098084
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm2_336_96_TimesNet_ETTm2_ftM_sl336_ll48_pl336_dm16_nh8_el2_dl1_df32_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
test shape: (11185, 336, 7) (11185, 336, 7)
test shape: (11185, 336, 7) (11185, 336, 7)
mse:0.2938326299190521, mae:0.3460358679294586, dtw:not calculated
