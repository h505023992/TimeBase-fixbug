True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           ETTm2_96_96         Model:              TimesNet            

[1mData Loader[0m
  Data:               ETTm2               Root Path:          ./dataset/          
  Data Path:          ETTm2.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            96                  Label Len:          48                  
  Pred Len:           192                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              7                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ETTm2_96_96_TimesNet_ETTm2_ftM_sl96_ll48_pl192_dm16_nh8_el2_dl1_df32_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34273
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.4664763
	speed: 0.2542s/iter; left time: 8148.9471s
	iters: 200, epoch: 1 | loss: 0.6422542
	speed: 0.1991s/iter; left time: 6364.1404s
	iters: 300, epoch: 1 | loss: 0.3796689
	speed: 0.2024s/iter; left time: 6447.6176s
	iters: 400, epoch: 1 | loss: 0.1739679
	speed: 0.2057s/iter; left time: 6534.7226s
	iters: 500, epoch: 1 | loss: 0.2056702
	speed: 0.2146s/iter; left time: 6795.9649s
	iters: 600, epoch: 1 | loss: 0.3194313
	speed: 0.2007s/iter; left time: 6335.6639s
	iters: 700, epoch: 1 | loss: 0.5202106
	speed: 0.1976s/iter; left time: 6216.1163s
	iters: 800, epoch: 1 | loss: 0.2495974
	speed: 0.1981s/iter; left time: 6211.0496s
	iters: 900, epoch: 1 | loss: 0.3435732
	speed: 0.1946s/iter; left time: 6084.3781s
	iters: 1000, epoch: 1 | loss: 0.3750327
	speed: 0.1900s/iter; left time: 5921.4852s
Epoch: 1 cost time: 220.02729201316833
Epoch: 1, Steps: 1072 | Train Loss: 0.3480885 Vali Loss: 0.1771209 Test Loss: 0.2534183
Validation loss decreased (inf --> 0.177121).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2128041
	speed: 1.5693s/iter; left time: 48629.9495s
	iters: 200, epoch: 2 | loss: 0.3069676
	speed: 0.2109s/iter; left time: 6513.8078s
	iters: 300, epoch: 2 | loss: 0.2446228
	speed: 0.2094s/iter; left time: 6446.0530s
	iters: 400, epoch: 2 | loss: 0.4290218
	speed: 0.2037s/iter; left time: 6252.2750s
	iters: 500, epoch: 2 | loss: 0.3622452
	speed: 0.2122s/iter; left time: 6492.0963s
	iters: 600, epoch: 2 | loss: 0.2940707
	speed: 0.2164s/iter; left time: 6599.1828s
	iters: 700, epoch: 2 | loss: 0.4389085
	speed: 0.2151s/iter; left time: 6537.1601s
	iters: 800, epoch: 2 | loss: 0.3377756
	speed: 0.2054s/iter; left time: 6222.4549s
	iters: 900, epoch: 2 | loss: 0.2885251
	speed: 0.2050s/iter; left time: 6187.5111s
	iters: 1000, epoch: 2 | loss: 0.2931869
	speed: 0.2164s/iter; left time: 6511.8239s
Epoch: 2 cost time: 226.7808701992035
Epoch: 2, Steps: 1072 | Train Loss: 0.3172915 Vali Loss: 0.1753345 Test Loss: 0.2515042
Validation loss decreased (0.177121 --> 0.175334).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4872323
	speed: 1.7141s/iter; left time: 51281.0485s
	iters: 200, epoch: 3 | loss: 0.2222267
	speed: 0.2205s/iter; left time: 6575.4431s
	iters: 300, epoch: 3 | loss: 0.3795768
	speed: 0.2091s/iter; left time: 6212.9069s
	iters: 400, epoch: 3 | loss: 0.6207249
	speed: 0.2057s/iter; left time: 6092.7032s
	iters: 500, epoch: 3 | loss: 0.1955578
	speed: 0.2026s/iter; left time: 5979.4059s
	iters: 600, epoch: 3 | loss: 0.1930125
	speed: 0.2123s/iter; left time: 6246.3934s
	iters: 700, epoch: 3 | loss: 0.1920174
	speed: 0.2109s/iter; left time: 6184.1342s
	iters: 800, epoch: 3 | loss: 0.1342106
	speed: 0.2095s/iter; left time: 6121.9743s
	iters: 900, epoch: 3 | loss: 0.1906689
	speed: 0.2179s/iter; left time: 6344.8672s
	iters: 1000, epoch: 3 | loss: 0.5201494
	speed: 0.2141s/iter; left time: 6213.0986s
Epoch: 3 cost time: 230.46274638175964
Epoch: 3, Steps: 1072 | Train Loss: 0.3031028 Vali Loss: 0.1711894 Test Loss: 0.2498027
Validation loss decreased (0.175334 --> 0.171189).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1219045
	speed: 1.6405s/iter; left time: 47319.5939s
	iters: 200, epoch: 4 | loss: 0.2233881
	speed: 0.2219s/iter; left time: 6377.8716s
	iters: 300, epoch: 4 | loss: 0.2252940
	speed: 0.2160s/iter; left time: 6188.1448s
	iters: 400, epoch: 4 | loss: 0.4398227
	speed: 0.2198s/iter; left time: 6274.3147s
	iters: 500, epoch: 4 | loss: 0.2106653
	speed: 0.2209s/iter; left time: 6284.0872s
	iters: 600, epoch: 4 | loss: 0.4350646
	speed: 0.2141s/iter; left time: 6067.4448s
	iters: 700, epoch: 4 | loss: 0.1749183
	speed: 0.2073s/iter; left time: 5855.4973s
	iters: 800, epoch: 4 | loss: 0.2174952
	speed: 0.2121s/iter; left time: 5970.1543s
	iters: 900, epoch: 4 | loss: 0.1600390
	speed: 0.2192s/iter; left time: 6147.8990s
	iters: 1000, epoch: 4 | loss: 0.3458522
	speed: 0.2072s/iter; left time: 5789.9193s
Epoch: 4 cost time: 232.5303511619568
Epoch: 4, Steps: 1072 | Train Loss: 0.2961198 Vali Loss: 0.1735012 Test Loss: 0.2507643
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3408825
	speed: 1.6193s/iter; left time: 44972.5863s
	iters: 200, epoch: 5 | loss: 0.1702219
	speed: 0.2026s/iter; left time: 5605.3974s
	iters: 300, epoch: 5 | loss: 0.3328073
	speed: 0.2047s/iter; left time: 5644.1752s
	iters: 400, epoch: 5 | loss: 0.3364752
	speed: 0.2056s/iter; left time: 5649.2275s
	iters: 500, epoch: 5 | loss: 0.4888825
	speed: 0.2155s/iter; left time: 5898.8854s
	iters: 600, epoch: 5 | loss: 0.1753221
	speed: 0.2031s/iter; left time: 5538.5562s
	iters: 700, epoch: 5 | loss: 0.4323119
	speed: 0.2070s/iter; left time: 5623.7712s
	iters: 800, epoch: 5 | loss: 0.2351279
	speed: 0.1973s/iter; left time: 5341.8198s
	iters: 900, epoch: 5 | loss: 0.1812630
	speed: 0.2164s/iter; left time: 5835.8106s
	iters: 1000, epoch: 5 | loss: 0.3075386
	speed: 0.2164s/iter; left time: 5815.8239s
Epoch: 5 cost time: 223.0685544013977
Epoch: 5, Steps: 1072 | Train Loss: 0.2970989 Vali Loss: 0.1711517 Test Loss: 0.2502519
Validation loss decreased (0.171189 --> 0.171152).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1746346
	speed: 1.6274s/iter; left time: 43453.0810s
	iters: 200, epoch: 6 | loss: 0.2215948
	speed: 0.1976s/iter; left time: 5257.2834s
	iters: 300, epoch: 6 | loss: 0.4461607
	speed: 0.2029s/iter; left time: 5376.5123s
	iters: 400, epoch: 6 | loss: 0.2477235
	speed: 0.2122s/iter; left time: 5602.9404s
	iters: 500, epoch: 6 | loss: 0.1607749
	speed: 0.2157s/iter; left time: 5673.6645s
	iters: 600, epoch: 6 | loss: 0.2782556
	speed: 0.2262s/iter; left time: 5926.3894s
	iters: 700, epoch: 6 | loss: 0.3285103
	speed: 0.2253s/iter; left time: 5880.4748s
	iters: 800, epoch: 6 | loss: 0.2148035
	speed: 0.2158s/iter; left time: 5610.6898s
	iters: 900, epoch: 6 | loss: 0.3309862
	speed: 0.2163s/iter; left time: 5602.1114s
	iters: 1000, epoch: 6 | loss: 0.1601344
	speed: 0.2248s/iter; left time: 5799.8252s
Epoch: 6 cost time: 231.7779083251953
Epoch: 6, Steps: 1072 | Train Loss: 0.2914139 Vali Loss: 0.1713086 Test Loss: 0.2507199
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1829581
	speed: 1.6439s/iter; left time: 42131.0607s
	iters: 200, epoch: 7 | loss: 0.1984318
	speed: 0.2209s/iter; left time: 5640.3232s
	iters: 300, epoch: 7 | loss: 0.1706523
	speed: 0.2232s/iter; left time: 5676.1149s
	iters: 400, epoch: 7 | loss: 0.3166128
	speed: 0.2201s/iter; left time: 5575.2490s
	iters: 500, epoch: 7 | loss: 0.1821342
	speed: 0.2161s/iter; left time: 5451.8332s
	iters: 600, epoch: 7 | loss: 0.2412875
	speed: 0.2167s/iter; left time: 5445.0542s
	iters: 700, epoch: 7 | loss: 0.2789346
	speed: 0.2241s/iter; left time: 5608.7929s
	iters: 800, epoch: 7 | loss: 0.1738966
	speed: 0.2120s/iter; left time: 5285.1155s
	iters: 900, epoch: 7 | loss: 0.2273126
	speed: 0.2193s/iter; left time: 5445.5533s
	iters: 1000, epoch: 7 | loss: 0.2645591
	speed: 0.2279s/iter; left time: 5636.4592s
Epoch: 7 cost time: 237.53884291648865
Epoch: 7, Steps: 1072 | Train Loss: 0.2906782 Vali Loss: 0.1717720 Test Loss: 0.2506585
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.2378878
	speed: 1.6888s/iter; left time: 41471.6092s
	iters: 200, epoch: 8 | loss: 0.2261371
	speed: 0.2088s/iter; left time: 5106.4595s
	iters: 300, epoch: 8 | loss: 0.1479174
	speed: 0.2154s/iter; left time: 5247.0633s
	iters: 400, epoch: 8 | loss: 0.4035769
	speed: 0.2133s/iter; left time: 5174.9840s
	iters: 500, epoch: 8 | loss: 0.6114485
	speed: 0.2056s/iter; left time: 4966.4390s
	iters: 600, epoch: 8 | loss: 0.3281150
	speed: 0.2133s/iter; left time: 5131.9135s
	iters: 700, epoch: 8 | loss: 0.2779895
	speed: 0.2165s/iter; left time: 5187.5419s
	iters: 800, epoch: 8 | loss: 0.5016262
	speed: 0.2170s/iter; left time: 5177.6005s
	iters: 900, epoch: 8 | loss: 0.1459855
	speed: 0.2224s/iter; left time: 5283.4192s
	iters: 1000, epoch: 8 | loss: 0.4850995
	speed: 0.2222s/iter; left time: 5256.9752s
Epoch: 8 cost time: 232.62787747383118
Epoch: 8, Steps: 1072 | Train Loss: 0.2902120 Vali Loss: 0.1717382 Test Loss: 0.2508340
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_ETTm2_96_96_TimesNet_ETTm2_ftM_sl96_ll48_pl192_dm16_nh8_el2_dl1_df32_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
test shape: (11329, 192, 7) (11329, 192, 7)
test shape: (11329, 192, 7) (11329, 192, 7)
mse:0.25069859623908997, mae:0.30593374371528625, dtw:not calculated
