True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           weather_720_336     Model:              TimesNet            

[1mData Loader[0m
  Data:               custom              Root Path:          ./dataset/          
  Data Path:          weather.csv         Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            720                 Label Len:          48                  
  Pred Len:           336                 Seasonal Patterns:  Monthly             
  Inverse:            0                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             21                  Dec In:             21                  
  C Out:              21                  d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_weather_720_336_TimesNet_custom_ftM_sl720_ll48_pl336_dm32_nh8_el2_dl1_df32_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35832
val 4935
test 10204
	iters: 100, epoch: 1 | loss: 0.4680433
	speed: 0.4550s/iter; left time: 15243.5976s
	iters: 200, epoch: 1 | loss: 0.7193961
	speed: 0.4224s/iter; left time: 14109.0296s
	iters: 300, epoch: 1 | loss: 0.4140634
	speed: 0.4108s/iter; left time: 13678.5635s
	iters: 400, epoch: 1 | loss: 0.3997149
	speed: 0.4196s/iter; left time: 13930.1194s
	iters: 500, epoch: 1 | loss: 0.3277112
	speed: 0.4249s/iter; left time: 14066.2542s
	iters: 600, epoch: 1 | loss: 0.5903482
	speed: 0.4182s/iter; left time: 13801.1887s
	iters: 700, epoch: 1 | loss: 0.4044500
	speed: 0.4339s/iter; left time: 14274.5229s
	iters: 800, epoch: 1 | loss: 0.4024547
	speed: 0.4248s/iter; left time: 13933.7140s
	iters: 900, epoch: 1 | loss: 0.3330697
	speed: 0.4196s/iter; left time: 13721.7944s
	iters: 1000, epoch: 1 | loss: 0.9269174
	speed: 0.4368s/iter; left time: 14240.3565s
	iters: 1100, epoch: 1 | loss: 0.3643071
	speed: 0.4261s/iter; left time: 13848.0410s
Epoch: 1 cost time: 478.5096700191498
Epoch: 1, Steps: 1120 | Train Loss: 0.5064925 Vali Loss: 0.5731273 Test Loss: 0.2765909
Validation loss decreased (inf --> 0.573127).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3026316
	speed: 1.9378s/iter; left time: 62746.5102s
	iters: 200, epoch: 2 | loss: 0.3553475
	speed: 0.4004s/iter; left time: 12924.8365s
	iters: 300, epoch: 2 | loss: 0.6870404
	speed: 0.3858s/iter; left time: 12416.1718s
	iters: 400, epoch: 2 | loss: 0.3267321
	speed: 0.4002s/iter; left time: 12838.1143s
	iters: 500, epoch: 2 | loss: 0.3284788
	speed: 0.4068s/iter; left time: 13009.1471s
	iters: 600, epoch: 2 | loss: 0.6031392
	speed: 0.4200s/iter; left time: 13391.1693s
	iters: 700, epoch: 2 | loss: 0.3422093
	speed: 0.4306s/iter; left time: 13685.1529s
	iters: 800, epoch: 2 | loss: 0.6625989
	speed: 0.4174s/iter; left time: 13224.8289s
	iters: 900, epoch: 2 | loss: 0.3131879
	speed: 0.4177s/iter; left time: 13190.4709s
	iters: 1000, epoch: 2 | loss: 0.5314348
	speed: 0.4129s/iter; left time: 12997.8230s
	iters: 1100, epoch: 2 | loss: 0.5275182
	speed: 0.4183s/iter; left time: 13127.4725s
Epoch: 2 cost time: 461.9693305492401
Epoch: 2, Steps: 1120 | Train Loss: 0.4107396 Vali Loss: 0.5851318 Test Loss: 0.3135054
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3220788
	speed: 1.8525s/iter; left time: 57909.6644s
	iters: 200, epoch: 3 | loss: 0.5475764
	speed: 0.4240s/iter; left time: 13212.1199s
	iters: 300, epoch: 3 | loss: 0.2750594
	speed: 0.4177s/iter; left time: 12975.0915s
	iters: 400, epoch: 3 | loss: 0.5537705
	speed: 0.4105s/iter; left time: 12710.3296s
	iters: 500, epoch: 3 | loss: 0.4086018
	speed: 0.4083s/iter; left time: 12600.5514s
	iters: 600, epoch: 3 | loss: 0.2146816
	speed: 0.4166s/iter; left time: 12813.8876s
	iters: 700, epoch: 3 | loss: 0.5377360
	speed: 0.4142s/iter; left time: 12700.4404s
	iters: 800, epoch: 3 | loss: 0.2582368
	speed: 0.4188s/iter; left time: 12798.7225s
	iters: 900, epoch: 3 | loss: 0.3164318
	speed: 0.4188s/iter; left time: 12757.5891s
	iters: 1000, epoch: 3 | loss: 0.6193594
	speed: 0.4214s/iter; left time: 12793.5881s
	iters: 1100, epoch: 3 | loss: 0.2483279
	speed: 0.4141s/iter; left time: 12529.7580s
Epoch: 3 cost time: 467.7362790107727
Epoch: 3, Steps: 1120 | Train Loss: 0.3606242 Vali Loss: 0.6157601 Test Loss: 0.3538083
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2637853
	speed: 1.7922s/iter; left time: 54019.4105s
	iters: 200, epoch: 4 | loss: 0.4589491
	speed: 0.4167s/iter; left time: 12517.5577s
	iters: 300, epoch: 4 | loss: 0.2934468
	speed: 0.4188s/iter; left time: 12539.9835s
	iters: 400, epoch: 4 | loss: 0.1870312
	speed: 0.4184s/iter; left time: 12486.0620s
	iters: 500, epoch: 4 | loss: 0.1937945
	speed: 0.4168s/iter; left time: 12396.8015s
	iters: 600, epoch: 4 | loss: 0.3982720
	speed: 0.4138s/iter; left time: 12266.0734s
	iters: 700, epoch: 4 | loss: 0.2493501
	speed: 0.4173s/iter; left time: 12328.3379s
	iters: 800, epoch: 4 | loss: 0.3627829
	speed: 0.4146s/iter; left time: 12205.5360s
	iters: 900, epoch: 4 | loss: 0.2156270
	speed: 0.4185s/iter; left time: 12278.1321s
	iters: 1000, epoch: 4 | loss: 0.4548457
	speed: 0.4208s/iter; left time: 12303.1583s
	iters: 1100, epoch: 4 | loss: 0.2247756
	speed: 0.4192s/iter; left time: 12217.0781s
Epoch: 4 cost time: 469.3021423816681
Epoch: 4, Steps: 1120 | Train Loss: 0.3388622 Vali Loss: 0.6078145 Test Loss: 0.3659199
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_weather_720_336_TimesNet_custom_ftM_sl720_ll48_pl336_dm32_nh8_el2_dl1_df32_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
test shape: (10204, 336, 21) (10204, 336, 21)
test shape: (10204, 336, 21) (10204, 336, 21)
mse:0.2765801250934601, mae:0.31127414107322693, dtw:not calculated
