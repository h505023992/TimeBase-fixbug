Args in experiment:
Namespace(is_training=1, train_only=False, model_id='Electricity_720_192', model='DLinear', data='custom', root_path='./dataset/', data_path='electricity.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=720, label_len=48, pred_len=192, individual=False, embed_type=0, enc_in=321, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=10, batch_size=16, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=7, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:7
>>>>>>>start training : Electricity_720_192_DLinear_custom_ftM_sl720_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17501
val 2441
test 5069
	iters: 100, epoch: 1 | loss: 0.2677253
	speed: 0.0349s/iter; left time: 377.9262s
	iters: 200, epoch: 1 | loss: 0.2824138
	speed: 0.0284s/iter; left time: 304.6606s
	iters: 300, epoch: 1 | loss: 0.2171360
	speed: 0.0236s/iter; left time: 251.1550s
	iters: 400, epoch: 1 | loss: 0.1956760
	speed: 0.0236s/iter; left time: 248.6981s
	iters: 500, epoch: 1 | loss: 0.1777009
	speed: 0.0229s/iter; left time: 238.5337s
	iters: 600, epoch: 1 | loss: 0.1603181
	speed: 0.0223s/iter; left time: 230.3923s
	iters: 700, epoch: 1 | loss: 0.1718038
	speed: 0.0230s/iter; left time: 235.5846s
	iters: 800, epoch: 1 | loss: 0.1824044
	speed: 0.0232s/iter; left time: 234.6242s
	iters: 900, epoch: 1 | loss: 0.1854539
	speed: 0.0226s/iter; left time: 226.8370s
	iters: 1000, epoch: 1 | loss: 0.1628267
	speed: 0.0229s/iter; left time: 227.6680s
Epoch: 1 cost time: 26.774657487869263
Epoch: 1, Steps: 1093 | Train Loss: 0.2162649 Vali Loss: 0.1455981 Test Loss: 0.1698225
Validation loss decreased (inf --> 0.145598).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1746994
	speed: 0.1893s/iter; left time: 1843.2611s
	iters: 200, epoch: 2 | loss: 0.1585964
	speed: 0.0228s/iter; left time: 219.6848s
	iters: 300, epoch: 2 | loss: 0.1676367
	speed: 0.0230s/iter; left time: 219.3651s
	iters: 400, epoch: 2 | loss: 0.1657073
	speed: 0.0223s/iter; left time: 210.6163s
	iters: 500, epoch: 2 | loss: 0.1825413
	speed: 0.0265s/iter; left time: 247.6188s
	iters: 600, epoch: 2 | loss: 0.1631285
	speed: 0.0231s/iter; left time: 213.1390s
	iters: 700, epoch: 2 | loss: 0.1559445
	speed: 0.0235s/iter; left time: 214.7170s
	iters: 800, epoch: 2 | loss: 0.1543642
	speed: 0.0229s/iter; left time: 206.9858s
	iters: 900, epoch: 2 | loss: 0.1479974
	speed: 0.0226s/iter; left time: 201.7162s
	iters: 1000, epoch: 2 | loss: 0.1474743
	speed: 0.0225s/iter; left time: 198.9186s
Epoch: 2 cost time: 26.283873319625854
Epoch: 2, Steps: 1093 | Train Loss: 0.1634192 Vali Loss: 0.1345239 Test Loss: 0.1584551
Validation loss decreased (0.145598 --> 0.134524).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1989521
	speed: 0.2073s/iter; left time: 1791.7778s
	iters: 200, epoch: 3 | loss: 0.1439363
	speed: 0.0294s/iter; left time: 251.5562s
	iters: 300, epoch: 3 | loss: 0.1703462
	speed: 0.0235s/iter; left time: 198.6820s
	iters: 400, epoch: 3 | loss: 0.1904804
	speed: 0.0231s/iter; left time: 192.6088s
	iters: 500, epoch: 3 | loss: 0.1317648
	speed: 0.0227s/iter; left time: 187.5433s
	iters: 600, epoch: 3 | loss: 0.1358104
	speed: 0.0254s/iter; left time: 206.5629s
	iters: 700, epoch: 3 | loss: 0.1504954
	speed: 0.0270s/iter; left time: 216.8391s
	iters: 800, epoch: 3 | loss: 0.1448357
	speed: 0.0228s/iter; left time: 181.3622s
	iters: 900, epoch: 3 | loss: 0.1758386
	speed: 0.0229s/iter; left time: 179.6366s
	iters: 1000, epoch: 3 | loss: 0.1792906
	speed: 0.0230s/iter; left time: 178.2248s
Epoch: 3 cost time: 27.440847396850586
Epoch: 3, Steps: 1093 | Train Loss: 0.1570958 Vali Loss: 0.1317724 Test Loss: 0.1558162
Validation loss decreased (0.134524 --> 0.131772).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1739656
	speed: 0.2140s/iter; left time: 1615.8915s
	iters: 200, epoch: 4 | loss: 0.1627357
	speed: 0.0243s/iter; left time: 180.9517s
	iters: 300, epoch: 4 | loss: 0.1510534
	speed: 0.0243s/iter; left time: 178.3070s
	iters: 400, epoch: 4 | loss: 0.1618232
	speed: 0.0279s/iter; left time: 202.6799s
	iters: 500, epoch: 4 | loss: 0.1740108
	speed: 0.0234s/iter; left time: 167.6889s
	iters: 600, epoch: 4 | loss: 0.1557744
	speed: 0.0239s/iter; left time: 168.4250s
	iters: 700, epoch: 4 | loss: 0.1563205
	speed: 0.0240s/iter; left time: 166.5199s
	iters: 800, epoch: 4 | loss: 0.1495581
	speed: 0.0279s/iter; left time: 191.1406s
	iters: 900, epoch: 4 | loss: 0.2058639
	speed: 0.0232s/iter; left time: 156.7876s
	iters: 1000, epoch: 4 | loss: 0.1488043
	speed: 0.0237s/iter; left time: 157.5834s
Epoch: 4 cost time: 27.915710926055908
Epoch: 4, Steps: 1093 | Train Loss: 0.1551517 Vali Loss: 0.1305311 Test Loss: 0.1544934
Validation loss decreased (0.131772 --> 0.130531).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1447257
	speed: 0.2168s/iter; left time: 1400.6341s
	iters: 200, epoch: 5 | loss: 0.1489400
	speed: 0.0259s/iter; left time: 164.4266s
	iters: 300, epoch: 5 | loss: 0.1706421
	speed: 0.0234s/iter; left time: 146.7525s
	iters: 400, epoch: 5 | loss: 0.1718159
	speed: 0.0258s/iter; left time: 158.7227s
	iters: 500, epoch: 5 | loss: 0.1586516
	speed: 0.0285s/iter; left time: 172.9822s
	iters: 600, epoch: 5 | loss: 0.1805112
	speed: 0.0246s/iter; left time: 146.7212s
	iters: 700, epoch: 5 | loss: 0.1593829
	speed: 0.0240s/iter; left time: 140.6889s
	iters: 800, epoch: 5 | loss: 0.1610185
	speed: 0.0249s/iter; left time: 143.5252s
	iters: 900, epoch: 5 | loss: 0.1425006
	speed: 0.0328s/iter; left time: 185.5286s
	iters: 1000, epoch: 5 | loss: 0.1656990
	speed: 0.0260s/iter; left time: 144.4046s
Epoch: 5 cost time: 29.5029935836792
Epoch: 5, Steps: 1093 | Train Loss: 0.1542828 Vali Loss: 0.1302629 Test Loss: 0.1543622
Validation loss decreased (0.130531 --> 0.130263).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.1609076
	speed: 0.2313s/iter; left time: 1241.2967s
	iters: 200, epoch: 6 | loss: 0.1808987
	speed: 0.0263s/iter; left time: 138.6174s
	iters: 300, epoch: 6 | loss: 0.1373404
	speed: 0.0258s/iter; left time: 133.1850s
	iters: 400, epoch: 6 | loss: 0.1661451
	speed: 0.0255s/iter; left time: 129.3036s
	iters: 500, epoch: 6 | loss: 0.1721197
	speed: 0.0309s/iter; left time: 153.6633s
	iters: 600, epoch: 6 | loss: 0.1608142
	speed: 0.0275s/iter; left time: 133.6550s
	iters: 700, epoch: 6 | loss: 0.1405847
	speed: 0.0249s/iter; left time: 118.4603s
	iters: 800, epoch: 6 | loss: 0.1472736
	speed: 0.0245s/iter; left time: 114.4664s
	iters: 900, epoch: 6 | loss: 0.1424540
	speed: 0.0263s/iter; left time: 120.1085s
	iters: 1000, epoch: 6 | loss: 0.1769431
	speed: 0.0307s/iter; left time: 136.9387s
Epoch: 6 cost time: 30.167764902114868
Epoch: 6, Steps: 1093 | Train Loss: 0.1548696 Vali Loss: 0.1298678 Test Loss: 0.1548892
Validation loss decreased (0.130263 --> 0.129868).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.1363337
	speed: 0.2355s/iter; left time: 1006.1797s
	iters: 200, epoch: 7 | loss: 0.1521375
	speed: 0.0235s/iter; left time: 98.2226s
	iters: 300, epoch: 7 | loss: 0.1407254
	speed: 0.0285s/iter; left time: 115.8817s
	iters: 400, epoch: 7 | loss: 0.1336281
	speed: 0.0247s/iter; left time: 98.1814s
	iters: 500, epoch: 7 | loss: 0.1730559
	speed: 0.0279s/iter; left time: 107.9540s
	iters: 600, epoch: 7 | loss: 0.1475353
	speed: 0.0287s/iter; left time: 108.2874s
	iters: 700, epoch: 7 | loss: 0.1474351
	speed: 0.0237s/iter; left time: 86.9992s
	iters: 800, epoch: 7 | loss: 0.1491236
	speed: 0.0240s/iter; left time: 85.5933s
	iters: 900, epoch: 7 | loss: 0.1375103
	speed: 0.0246s/iter; left time: 85.5924s
	iters: 1000, epoch: 7 | loss: 0.1415677
	speed: 0.0284s/iter; left time: 95.9526s
Epoch: 7 cost time: 29.171874523162842
Epoch: 7, Steps: 1093 | Train Loss: 0.1546691 Vali Loss: 0.1296478 Test Loss: 0.1547335
Validation loss decreased (0.129868 --> 0.129648).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.1386130
	speed: 0.2161s/iter; left time: 687.2042s
	iters: 200, epoch: 8 | loss: 0.1551978
	speed: 0.0230s/iter; left time: 70.7626s
	iters: 300, epoch: 8 | loss: 0.1371957
	speed: 0.0232s/iter; left time: 69.1393s
	iters: 400, epoch: 8 | loss: 0.1567059
	speed: 0.0243s/iter; left time: 70.0728s
	iters: 500, epoch: 8 | loss: 0.1380925
	speed: 0.0239s/iter; left time: 66.5308s
	iters: 600, epoch: 8 | loss: 0.1506087
	speed: 0.0239s/iter; left time: 64.0769s
	iters: 700, epoch: 8 | loss: 0.1837595
	speed: 0.0276s/iter; left time: 71.2974s
	iters: 800, epoch: 8 | loss: 0.1363001
	speed: 0.0232s/iter; left time: 57.4961s
	iters: 900, epoch: 8 | loss: 0.1258713
	speed: 0.0231s/iter; left time: 55.0728s
	iters: 1000, epoch: 8 | loss: 0.1968619
	speed: 0.0241s/iter; left time: 54.9298s
Epoch: 8 cost time: 27.190348625183105
Epoch: 8, Steps: 1093 | Train Loss: 0.1545707 Vali Loss: 0.1297412 Test Loss: 0.1548204
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.1543163
	speed: 0.2118s/iter; left time: 441.9800s
	iters: 200, epoch: 9 | loss: 0.1251010
	speed: 0.0225s/iter; left time: 44.6846s
	iters: 300, epoch: 9 | loss: 0.1347339
	speed: 0.0229s/iter; left time: 43.2483s
	iters: 400, epoch: 9 | loss: 0.1563798
	speed: 0.0225s/iter; left time: 40.1974s
	iters: 500, epoch: 9 | loss: 0.1591106
	speed: 0.0230s/iter; left time: 38.7909s
	iters: 600, epoch: 9 | loss: 0.1405720
	speed: 0.0241s/iter; left time: 38.2960s
	iters: 700, epoch: 9 | loss: 0.1484750
	speed: 0.0233s/iter; left time: 34.6462s
	iters: 800, epoch: 9 | loss: 0.1460714
	speed: 0.0256s/iter; left time: 35.4428s
	iters: 900, epoch: 9 | loss: 0.1314544
	speed: 0.0279s/iter; left time: 35.8641s
	iters: 1000, epoch: 9 | loss: 0.1452078
	speed: 0.0230s/iter; left time: 27.2625s
Epoch: 9 cost time: 27.198200941085815
Epoch: 9, Steps: 1093 | Train Loss: 0.1545254 Vali Loss: 0.1297089 Test Loss: 0.1547633
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.1432596
	speed: 0.2272s/iter; left time: 225.8500s
	iters: 200, epoch: 10 | loss: 0.1491488
	speed: 0.0238s/iter; left time: 21.2536s
	iters: 300, epoch: 10 | loss: 0.1669819
	speed: 0.0238s/iter; left time: 18.9236s
	iters: 400, epoch: 10 | loss: 0.1568529
	speed: 0.0232s/iter; left time: 16.1037s
	iters: 500, epoch: 10 | loss: 0.1267972
	speed: 0.0224s/iter; left time: 13.3069s
	iters: 600, epoch: 10 | loss: 0.1201754
	speed: 0.0226s/iter; left time: 11.1726s
	iters: 700, epoch: 10 | loss: 0.1499131
	speed: 0.0261s/iter; left time: 10.2713s
	iters: 800, epoch: 10 | loss: 0.1370731
	speed: 0.0240s/iter; left time: 7.0440s
	iters: 900, epoch: 10 | loss: 0.1711713
	speed: 0.0236s/iter; left time: 4.5852s
	iters: 1000, epoch: 10 | loss: 0.1419740
	speed: 0.0300s/iter; left time: 2.8194s
Epoch: 10 cost time: 27.56118631362915
Epoch: 10, Steps: 1093 | Train Loss: 0.1544857 Vali Loss: 0.1297151 Test Loss: 0.1547328
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Electricity_720_192_DLinear_custom_ftM_sl720_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5069
mse:0.15454754030704498, mae:0.2583165514469147
