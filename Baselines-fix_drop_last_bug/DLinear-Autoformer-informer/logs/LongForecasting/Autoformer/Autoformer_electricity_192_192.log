Args in experiment:
Namespace(is_training=1, train_only=False, model_id='Autoformer_electricity_192_192', model='Autoformer', data='custom', root_path='./dataset/', data_path='electricity.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=192, label_len=48, pred_len=192, individual=False, embed_type=0, enc_in=321, dec_in=321, c_out=321, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=30, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : Autoformer_electricity_192_192_Autoformer_custom_ftM_sl192_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18029
val 2441
test 5069
	iters: 100, epoch: 1 | loss: 0.2534347
	speed: 0.1863s/iter; left time: 3134.3854s
	iters: 200, epoch: 1 | loss: 0.2163728
	speed: 0.1688s/iter; left time: 2822.7707s
	iters: 300, epoch: 1 | loss: 0.2236207
	speed: 0.1628s/iter; left time: 2706.0928s
	iters: 400, epoch: 1 | loss: 0.2131841
	speed: 0.1623s/iter; left time: 2681.7596s
	iters: 500, epoch: 1 | loss: 0.1790638
	speed: 0.1512s/iter; left time: 2482.6997s
Epoch: 1 cost time: 92.89854264259338
Epoch: 1, Steps: 564 | Train Loss: 0.2315068 Vali Loss: 0.1793830 Test Loss: 0.2163497
Validation loss decreased (inf --> 0.179383).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1733582
	speed: 0.7234s/iter; left time: 11759.9356s
	iters: 200, epoch: 2 | loss: 0.1573493
	speed: 0.1447s/iter; left time: 2338.6951s
	iters: 300, epoch: 2 | loss: 0.1530530
	speed: 0.1479s/iter; left time: 2374.6126s
	iters: 400, epoch: 2 | loss: 0.1453063
	speed: 0.1479s/iter; left time: 2359.5979s
	iters: 500, epoch: 2 | loss: 0.1323395
	speed: 0.1410s/iter; left time: 2235.3113s
Epoch: 2 cost time: 84.46383333206177
Epoch: 2, Steps: 564 | Train Loss: 0.1529810 Vali Loss: 0.1685455 Test Loss: 0.2093097
Validation loss decreased (0.179383 --> 0.168546).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1316675
	speed: 0.7119s/iter; left time: 11172.5574s
	iters: 200, epoch: 3 | loss: 0.1310892
	speed: 0.1488s/iter; left time: 2319.6514s
	iters: 300, epoch: 3 | loss: 0.1236877
	speed: 0.1440s/iter; left time: 2231.3396s
	iters: 400, epoch: 3 | loss: 0.1321100
	speed: 0.1418s/iter; left time: 2183.2724s
	iters: 500, epoch: 3 | loss: 0.1210954
	speed: 0.1526s/iter; left time: 2333.7387s
Epoch: 3 cost time: 83.14534664154053
Epoch: 3, Steps: 564 | Train Loss: 0.1296603 Vali Loss: 0.1718365 Test Loss: 0.2134089
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1213253
	speed: 0.6863s/iter; left time: 10383.0048s
	iters: 200, epoch: 4 | loss: 0.1154968
	speed: 0.1495s/iter; left time: 2247.2184s
	iters: 300, epoch: 4 | loss: 0.1202915
	speed: 0.1447s/iter; left time: 2160.3555s
	iters: 400, epoch: 4 | loss: 0.1215498
	speed: 0.1395s/iter; left time: 2068.3756s
	iters: 500, epoch: 4 | loss: 0.1188899
	speed: 0.1518s/iter; left time: 2236.1284s
Epoch: 4 cost time: 83.69488549232483
Epoch: 4, Steps: 564 | Train Loss: 0.1209763 Vali Loss: 0.1747064 Test Loss: 0.2122576
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1180536
	speed: 0.7269s/iter; left time: 10587.4439s
	iters: 200, epoch: 5 | loss: 0.1167136
	speed: 0.1610s/iter; left time: 2328.2843s
	iters: 300, epoch: 5 | loss: 0.1194562
	speed: 0.1588s/iter; left time: 2281.8325s
	iters: 400, epoch: 5 | loss: 0.1132693
	speed: 0.1483s/iter; left time: 2114.8900s
	iters: 500, epoch: 5 | loss: 0.1179730
	speed: 0.1557s/iter; left time: 2205.0272s
Epoch: 5 cost time: 90.05220031738281
Epoch: 5, Steps: 564 | Train Loss: 0.1167614 Vali Loss: 0.1749191 Test Loss: 0.2114579
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Autoformer_electricity_192_192_Autoformer_custom_ftM_sl192_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5069
mse:0.2082592248916626, mae:0.32088881731033325
